/*! aws-chime-client - 0.9.0 */!function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/js/chime/",n(n.s=300)}([function(e,t,n){"use strict";(function(e){function i(e,t){const n=Object.create(null),i=e.split(",");for(let e=0;e<i.length;e++)n[i[e]]=!0;return t?e=>!!n[e.toLowerCase()]:e=>!!n[e]}n.d(t,"a",(function(){return S})),n.d(t,"b",(function(){return b})),n.d(t,"c",(function(){return C})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return G})),n.d(t,"f",(function(){return Y})),n.d(t,"g",(function(){return Z})),n.d(t,"h",(function(){return k})),n.d(t,"i",(function(){return ne})),n.d(t,"j",(function(){return X})),n.d(t,"k",(function(){return O})),n.d(t,"l",(function(){return z})),n.d(t,"m",(function(){return Q})),n.d(t,"n",(function(){return E})),n.d(t,"o",(function(){return D})),n.d(t,"p",(function(){return r})),n.d(t,"q",(function(){return h})),n.d(t,"r",(function(){return W})),n.d(t,"s",(function(){return x})),n.d(t,"t",(function(){return A})),n.d(t,"u",(function(){return N})),n.d(t,"v",(function(){return _})),n.d(t,"w",(function(){return L})),n.d(t,"x",(function(){return H})),n.d(t,"y",(function(){return p})),n.d(t,"z",(function(){return P})),n.d(t,"A",(function(){return o})),n.d(t,"B",(function(){return R})),n.d(t,"C",(function(){return F})),n.d(t,"D",(function(){return f})),n.d(t,"E",(function(){return g})),n.d(t,"F",(function(){return i})),n.d(t,"G",(function(){return u})),n.d(t,"H",(function(){return a})),n.d(t,"I",(function(){return T})),n.d(t,"J",(function(){return m})),n.d(t,"K",(function(){return J})),n.d(t,"L",(function(){return ee})),n.d(t,"M",(function(){return B}));const r=i("Infinity,undefined,NaN,isFinite,isNaN,parseFloat,parseInt,decodeURI,decodeURIComponent,encodeURI,encodeURIComponent,Math,Number,Date,Array,Object,Boolean,String,RegExp,Map,Set,JSON,Intl,BigInt");const s="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",o=i(s);function a(e){if(E(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=a(R(i)?d(i):i);if(r)for(const e in r)t[e]=r[e]}return t}if(N(e))return e}const c=/;(?![^(]*\))/g,l=/:(.+)/;function d(e){const t={};return e.split(c).forEach(e=>{if(e){const n=e.split(l);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function u(e){let t="";if(R(e))t=e;else if(E(e))for(let n=0;n<e.length;n++){const i=u(e[n]);i&&(t+=i+" ")}else if(N(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const h=i("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot"),p=i("svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view");function f(e,t){if(e===t)return!0;let n=M(e),i=M(t);if(n||i)return!(!n||!i)&&e.getTime()===t.getTime();if(n=E(e),i=E(t),n||i)return!(!n||!i)&&function(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=f(e[i],t[i]);return n}(e,t);if(n=N(e),i=N(t),n||i){if(!n||!i)return!1;if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e){const i=e.hasOwnProperty(n),r=t.hasOwnProperty(n);if(i&&!r||!i&&r||!f(e[n],t[n]))return!1}}return String(e)===String(t)}function g(e,t){return e.findIndex(e=>f(e,t))}const m=e=>null==e?"":N(e)?JSON.stringify(e,v,2):String(e),v=(e,t)=>x(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((e,[t,n])=>(e[t+" =>"]=n,e),{})}:P(t)?{[`Set(${t.size})`]:[...t.values()]}:!N(t)||E(t)||U(t)?t:String(t),b={},S=[],y=()=>{},C=()=>!1,w=/^on[^a-z]/,_=e=>w.test(e),A=e=>e.startsWith("onUpdate:"),k=Object.assign,T=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},I=Object.prototype.hasOwnProperty,O=(e,t)=>I.call(e,t),E=Array.isArray,x=e=>"[object Map]"===V(e),P=e=>"[object Set]"===V(e),M=e=>e instanceof Date,D=e=>"function"==typeof e,R=e=>"string"==typeof e,F=e=>"symbol"==typeof e,N=e=>null!==e&&"object"==typeof e,L=e=>N(e)&&D(e.then)&&D(e.catch),j=Object.prototype.toString,V=e=>j.call(e),B=e=>V(e).slice(8,-1),U=e=>"[object Object]"===V(e),W=e=>R(e)&&"NaN"!==e&&"-"!==e[0]&&""+parseInt(e,10)===e,H=i(",key,ref,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),q=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},$=/-(\w)/g,G=q(e=>e.replace($,(e,t)=>t?t.toUpperCase():"")),K=/\B([A-Z])/g,z=q(e=>e.replace(K,"-$1").toLowerCase()),Y=q(e=>e.charAt(0).toUpperCase()+e.slice(1)),J=q(e=>e?"on"+Y(e):""),X=(e,t)=>e!==t&&(e==e||t==t),Q=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Z=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},ee=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let te;const ne=()=>te||(te="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==e?e:{})}).call(this,n(13))},function(e,t,n){"use strict";n.d(t,"a",(function(){return _e})),n.d(t,"b",(function(){return l})),n.d(t,"c",(function(){return ue})),n.d(t,"d",(function(){return le})),n.d(t,"e",(function(){return de})),n.d(t,"f",(function(){return fe})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return Se})),n.d(t,"i",(function(){return se})),n.d(t,"j",(function(){return ge})),n.d(t,"k",(function(){return m})),n.d(t,"l",(function(){return oe})),n.d(t,"m",(function(){return d})),n.d(t,"n",(function(){return he})),n.d(t,"o",(function(){return Ce})),n.d(t,"p",(function(){return v})),n.d(t,"q",(function(){return b}));var i=n(0);const r=new WeakMap,s=[];let o;const a=Symbol(""),c=Symbol("");function l(e,t=i.b){(function(e){return e&&!0===e._isEffect})(e)&&(e=e.raw);const n=function(e,t){const n=function(){if(!n.active)return t.scheduler?void 0:e();if(!s.includes(n)){h(n);try{return f.push(p),p=!0,s.push(n),o=n,e()}finally{s.pop(),m(),o=s[s.length-1]}}};return n.id=u++,n.allowRecurse=!!t.allowRecurse,n._isEffect=!0,n.active=!0,n.raw=e,n.deps=[],n.options=t,n}(e,t);return t.lazy||n(),n}function d(e){e.active&&(h(e),e.options.onStop&&e.options.onStop(),e.active=!1)}let u=0;function h(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let p=!0;const f=[];function g(){f.push(p),p=!1}function m(){const e=f.pop();p=void 0===e||e}function v(e,t,n){if(!p||void 0===o)return;let i=r.get(e);i||r.set(e,i=new Map);let s=i.get(n);s||i.set(n,s=new Set),s.has(o)||(s.add(o),o.deps.push(s))}function b(e,t,n,s,l,d){const u=r.get(e);if(!u)return;const h=new Set,p=e=>{e&&e.forEach(e=>{(e!==o||e.allowRecurse)&&h.add(e)})};if("clear"===t)u.forEach(p);else if("length"===n&&Object(i.n)(e))u.forEach((e,t)=>{("length"===t||t>=s)&&p(e)});else switch(void 0!==n&&p(u.get(n)),t){case"add":Object(i.n)(e)?Object(i.r)(n)&&p(u.get("length")):(p(u.get(a)),Object(i.s)(e)&&p(u.get(c)));break;case"delete":Object(i.n)(e)||(p(u.get(a)),Object(i.s)(e)&&p(u.get(c)));break;case"set":Object(i.s)(e)&&p(u.get(a))}h.forEach(e=>{e.options.scheduler?e.options.scheduler(e):e()})}const S=Object(i.F)("__proto__,__v_isRef,__isVue"),y=new Set(Object.getOwnPropertyNames(Symbol).map(e=>Symbol[e]).filter(i.C)),C=T(),w=T(!1,!0),_=T(!0),A=T(!0,!0),k={};function T(e=!1,t=!1){return function(n,r,s){if("__v_isReactive"===r)return!e;if("__v_isReadonly"===r)return e;if("__v_raw"===r&&s===(e?t?re:ie:t?ne:te).get(n))return n;const o=Object(i.n)(n);if(!e&&o&&Object(i.k)(k,r))return Reflect.get(k,r,s);const a=Reflect.get(n,r,s);if(Object(i.C)(r)?y.has(r):S(r))return a;if(e||v(n,0,r),t)return a;if(fe(a)){return!o||!Object(i.r)(r)?a.value:a}return Object(i.u)(a)?e?ae(a):se(a):a}}["includes","indexOf","lastIndexOf"].forEach(e=>{const t=Array.prototype[e];k[e]=function(...e){const n=he(this);for(let e=0,t=this.length;e<t;e++)v(n,0,e+"");const i=t.apply(n,e);return-1===i||!1===i?t.apply(n,e.map(he)):i}}),["push","pop","shift","unshift","splice"].forEach(e=>{const t=Array.prototype[e];k[e]=function(...e){g();const n=t.apply(this,e);return m(),n}});const I=E(),O=E(!0);function E(e=!1){return function(t,n,r,s){let o=t[n];if(!e&&(r=he(r),o=he(o),!Object(i.n)(t)&&fe(o)&&!fe(r)))return o.value=r,!0;const a=Object(i.n)(t)&&Object(i.r)(n)?Number(n)<t.length:Object(i.k)(t,n),c=Reflect.set(t,n,r,s);return t===he(s)&&(a?Object(i.j)(r,o)&&b(t,"set",n,r):b(t,"add",n,r)),c}}const x={get:C,set:I,deleteProperty:function(e,t){const n=Object(i.k)(e,t),r=(e[t],Reflect.deleteProperty(e,t));return r&&n&&b(e,"delete",t,void 0),r},has:function(e,t){const n=Reflect.has(e,t);return Object(i.C)(t)&&y.has(t)||v(e,0,t),n},ownKeys:function(e){return v(e,0,Object(i.n)(e)?"length":a),Reflect.ownKeys(e)}},P={get:_,set:(e,t)=>!0,deleteProperty:(e,t)=>!0},M=Object(i.h)({},x,{get:w,set:O}),D=(Object(i.h)({},P,{get:A}),e=>Object(i.u)(e)?se(e):e),R=e=>Object(i.u)(e)?ae(e):e,F=e=>e,N=e=>Reflect.getPrototypeOf(e);function L(e,t,n=!1,i=!1){const r=he(e=e.__v_raw),s=he(t);t!==s&&!n&&v(r,0,t),!n&&v(r,0,s);const{has:o}=N(r),a=i?F:n?R:D;return o.call(r,t)?a(e.get(t)):o.call(r,s)?a(e.get(s)):void 0}function j(e,t=!1){const n=this.__v_raw,i=he(n),r=he(e);return e!==r&&!t&&v(i,0,e),!t&&v(i,0,r),e===r?n.has(e):n.has(e)||n.has(r)}function V(e,t=!1){return e=e.__v_raw,!t&&v(he(e),0,a),Reflect.get(e,"size",e)}function B(e){e=he(e);const t=he(this);return N(t).has.call(t,e)||(t.add(e),b(t,"add",e,e)),this}function U(e,t){t=he(t);const n=he(this),{has:r,get:s}=N(n);let o=r.call(n,e);o||(e=he(e),o=r.call(n,e));const a=s.call(n,e);return n.set(e,t),o?Object(i.j)(t,a)&&b(n,"set",e,t):b(n,"add",e,t),this}function W(e){const t=he(this),{has:n,get:i}=N(t);let r=n.call(t,e);r||(e=he(e),r=n.call(t,e));i&&i.call(t,e);const s=t.delete(e);return r&&b(t,"delete",e,void 0),s}function H(){const e=he(this),t=0!==e.size,n=e.clear();return t&&b(e,"clear",void 0,void 0),n}function q(e,t){return function(n,i){const r=this,s=r.__v_raw,o=he(s),c=t?F:e?R:D;return!e&&v(o,0,a),s.forEach((e,t)=>n.call(i,c(e),c(t),r))}}function $(e,t,n){return function(...r){const s=this.__v_raw,o=he(s),l=Object(i.s)(o),d="entries"===e||e===Symbol.iterator&&l,u="keys"===e&&l,h=s[e](...r),p=n?F:t?R:D;return!t&&v(o,0,u?c:a),{next(){const{value:e,done:t}=h.next();return t?{value:e,done:t}:{value:d?[p(e[0]),p(e[1])]:p(e),done:t}},[Symbol.iterator](){return this}}}}function G(e){return function(...t){return"delete"!==e&&this}}const K={get(e){return L(this,e)},get size(){return V(this)},has:j,add:B,set:U,delete:W,clear:H,forEach:q(!1,!1)},z={get(e){return L(this,e,!1,!0)},get size(){return V(this)},has:j,add:B,set:U,delete:W,clear:H,forEach:q(!1,!0)},Y={get(e){return L(this,e,!0)},get size(){return V(this,!0)},has(e){return j.call(this,e,!0)},add:G("add"),set:G("set"),delete:G("delete"),clear:G("clear"),forEach:q(!0,!1)},J={get(e){return L(this,e,!0,!0)},get size(){return V(this,!0)},has(e){return j.call(this,e,!0)},add:G("add"),set:G("set"),delete:G("delete"),clear:G("clear"),forEach:q(!0,!0)};function X(e,t){const n=t?e?J:z:e?Y:K;return(t,r,s)=>"__v_isReactive"===r?!e:"__v_isReadonly"===r?e:"__v_raw"===r?t:Reflect.get(Object(i.k)(n,r)&&r in t?n:t,r,s)}["keys","values","entries",Symbol.iterator].forEach(e=>{K[e]=$(e,!1,!1),Y[e]=$(e,!0,!1),z[e]=$(e,!1,!0),J[e]=$(e,!0,!0)});const Q={get:X(!1,!1)},Z={get:X(!1,!0)},ee={get:X(!0,!1)};X(!0,!0);const te=new WeakMap,ne=new WeakMap,ie=new WeakMap,re=new WeakMap;function se(e){return e&&e.__v_isReadonly?e:ce(e,!1,x,Q,te)}function oe(e){return ce(e,!1,M,Z,ne)}function ae(e){return ce(e,!0,P,ee,ie)}function ce(e,t,n,r,s){if(!Object(i.u)(e))return e;if(e.__v_raw&&(!t||!e.__v_isReactive))return e;const o=s.get(e);if(o)return o;const a=(c=e).__v_skip||!Object.isExtensible(c)?0:function(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}(Object(i.M)(c));var c;if(0===a)return e;const l=new Proxy(e,2===a?r:n);return s.set(e,l),l}function le(e){return de(e)?le(e.__v_raw):!(!e||!e.__v_isReactive)}function de(e){return!(!e||!e.__v_isReadonly)}function ue(e){return le(e)||de(e)}function he(e){return e&&he(e.__v_raw)||e}const pe=e=>Object(i.u)(e)?se(e):e;function fe(e){return Boolean(e&&!0===e.__v_isRef)}function ge(e){return ve(e)}class me{constructor(e,t=!1){this._rawValue=e,this._shallow=t,this.__v_isRef=!0,this._value=t?e:pe(e)}get value(){return v(he(this),0,"value"),this._value}set value(e){Object(i.j)(he(e),this._rawValue)&&(this._rawValue=e,this._value=this._shallow?e:pe(e),b(he(this),"set","value",e))}}function ve(e,t=!1){return fe(e)?e:new me(e,t)}const be={get:(e,t,n)=>function(e){return fe(e)?e.value:e}(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return fe(r)&&!fe(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function Se(e){return le(e)?e:new Proxy(e,be)}class ye{constructor(e,t){this._object=e,this._key=t,this.__v_isRef=!0}get value(){return this._object[this._key]}set value(e){this._object[this._key]=e}}function Ce(e,t){return fe(e[t])?e[t]:new ye(e,t)}class we{constructor(e,t,n){this._setter=t,this._dirty=!0,this.__v_isRef=!0,this.effect=l(e,{lazy:!0,scheduler:()=>{this._dirty||(this._dirty=!0,b(he(this),"set","value"))}}),this.__v_isReadonly=n}get value(){const e=he(this);return e._dirty&&(e._value=this.effect(),e._dirty=!1),v(e,0,"value"),e._value}set value(e){this._setter(e)}}function _e(e){let t,n;return Object(i.o)(e)?(t=e,n=i.d):(t=e.get,n=e.set),new we(t,n,Object(i.o)(e)||!e.set)}},function(e,t,n){"use strict";n.d(t,"a",(function(){return X})),n.d(t,"b",(function(){return U})),n.d(t,"c",(function(){return B})),n.d(t,"d",(function(){return K}));var i=n(0),r=n(3);n(1);const s="http://www.w3.org/2000/svg",o="undefined"!=typeof document?document:null;let a,c;const l={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t?o.createElementNS(s,e):o.createElement(e,n?{is:n}:void 0);return"select"===e&&i&&null!=i.multiple&&r.setAttribute("multiple",i.multiple),r},createText:e=>o.createTextNode(e),createComment:e=>o.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>o.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,i){const r=i?c||(c=o.createElementNS(s,"svg")):a||(a=o.createElement("div"));r.innerHTML=e;const d=r.firstChild;let u=d,h=u;for(;u;)h=u,l.insert(u,t,n),u=r.firstChild;return[d,h]}};const d=/\s*!important$/;function u(e,t,n){if(Object(i.n)(n))n.forEach(n=>u(e,t,n));else if(t.startsWith("--"))e.setProperty(t,n);else{const r=function(e,t){const n=p[t];if(n)return n;let r=Object(i.e)(t);if("filter"!==r&&r in e)return p[t]=r;r=Object(i.f)(r);for(let n=0;n<h.length;n++){const i=h[n]+r;if(i in e)return p[t]=i}return t}(e,t);d.test(n)?e.setProperty(Object(i.l)(r),n.replace(d,""),"important"):e[r]=n}}const h=["Webkit","Moz","ms"],p={};const f="http://www.w3.org/1999/xlink";let g=Date.now,m=!1;if("undefined"!=typeof window){g()>document.createEvent("Event").timeStamp&&(g=()=>performance.now());const e=navigator.userAgent.match(/firefox\/(\d+)/i);m=!!(e&&Number(e[1])<=53)}let v=0;const b=Promise.resolve(),S=()=>{v=0};function y(e,t,n,i){e.addEventListener(t,n,i)}function C(e,t,n,s,o=null){const a=e._vei||(e._vei={}),c=a[t];if(s&&c)c.value=s;else{const[n,l]=function(e){let t;if(w.test(e)){let n;for(t={};n=e.match(w);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Object(i.l)(e.slice(2)),t]}(t);if(s){y(e,n,a[t]=function(e,t){const n=e=>{const s=e.timeStamp||g();(m||s>=n.attached-1)&&Object(r.c)(function(e,t){if(Object(i.n)(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(e=>t=>!t._stopped&&e(t))}return t}(e,n.value),t,5,[e])};return n.value=e,n.attached=(()=>v||(b.then(S),v=g()))(),n}(s,o),l)}else c&&(!function(e,t,n,i){e.removeEventListener(t,n,i)}(e,n,c,l),a[t]=void 0)}}const w=/(?:Once|Passive|Capture)$/;const _=/^on[a-z]/;const A=(e,{slots:t})=>Object(r.l)(r.a,T(e),t);A.displayName="Transition";const k={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};A.props=Object(i.h)({},r.a.props,k);function T(e){let{name:t="v",type:n,css:r=!0,duration:s,enterFromClass:o=t+"-enter-from",enterActiveClass:a=t+"-enter-active",enterToClass:c=t+"-enter-to",appearFromClass:l=o,appearActiveClass:d=a,appearToClass:u=c,leaveFromClass:h=t+"-leave-from",leaveActiveClass:p=t+"-leave-active",leaveToClass:f=t+"-leave-to"}=e;const g={};for(const t in e)t in k||(g[t]=e[t]);if(!r)return g;const m=function(e){if(null==e)return null;if(Object(i.u)(e))return[I(e.enter),I(e.leave)];{const t=I(e);return[t,t]}}(s),v=m&&m[0],b=m&&m[1],{onBeforeEnter:S,onEnter:y,onEnterCancelled:C,onLeave:w,onLeaveCancelled:_,onBeforeAppear:A=S,onAppear:T=y,onAppearCancelled:P=C}=g,D=(e,t,n)=>{E(e,t?u:c),E(e,t?d:a),n&&n()},R=(e,t)=>{E(e,f),E(e,p),t&&t()},F=e=>(t,i)=>{const r=e?T:y,s=()=>D(t,e,i);r&&r(t,s),x(()=>{E(t,e?l:o),O(t,e?u:c),r&&r.length>1||M(t,n,v,s)})};return Object(i.h)(g,{onBeforeEnter(e){S&&S(e),O(e,o),O(e,a)},onBeforeAppear(e){A&&A(e),O(e,l),O(e,d)},onEnter:F(!1),onAppear:F(!0),onLeave(e,t){const i=()=>R(e,t);O(e,h),N(),O(e,p),x(()=>{E(e,h),O(e,f),w&&w.length>1||M(e,n,b,i)}),w&&w(e,i)},onEnterCancelled(e){D(e,!1),C&&C(e)},onAppearCancelled(e){D(e,!0),P&&P(e)},onLeaveCancelled(e){R(e),_&&_(e)}})}function I(e){return Object(i.L)(e)}function O(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.add(t)),(e._vtc||(e._vtc=new Set)).add(t)}function E(e,t){t.split(/\s+/).forEach(t=>t&&e.classList.remove(t));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function x(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let P=0;function M(e,t,n,i){const r=e._endId=++P,s=()=>{r===e._endId&&i()};if(n)return setTimeout(s,n);const{type:o,timeout:a,propCount:c}=D(e,t);if(!o)return i();const l=o+"end";let d=0;const u=()=>{e.removeEventListener(l,h),s()},h=t=>{t.target===e&&++d>=c&&u()};setTimeout(()=>{d<c&&u()},a+1),e.addEventListener(l,h)}function D(e,t){const n=window.getComputedStyle(e),i=e=>(n[e]||"").split(", "),r=i("transitionDelay"),s=i("transitionDuration"),o=R(r,s),a=i("animationDelay"),c=i("animationDuration"),l=R(a,c);let d=null,u=0,h=0;"transition"===t?o>0&&(d="transition",u=o,h=s.length):"animation"===t?l>0&&(d="animation",u=l,h=c.length):(u=Math.max(o,l),d=u>0?o>l?"transition":"animation":null,h=d?"transition"===d?s.length:c.length:0);return{type:d,timeout:u,propCount:h,hasTransform:"transition"===d&&/\b(transform|all)(,|$)/.test(n.transitionProperty)}}function R(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((t,n)=>F(t)+F(e[n])))}function F(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function N(){return document.body.offsetHeight}new WeakMap,new WeakMap;const L=e=>{const t=e.props["onUpdate:modelValue"];return Object(i.n)(t)?e=>Object(i.m)(t,e):t};function j(e){e.target.composing=!0}function V(e){const t=e.target;t.composing&&(t.composing=!1,function(e,t){const n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}(t,"input"))}const B={created(e,{modifiers:{lazy:t,trim:n,number:r}},s){e._assign=L(s);const o=r||"number"===e.type;y(e,t?"change":"input",t=>{if(t.target.composing)return;let r=e.value;n?r=r.trim():o&&(r=Object(i.L)(r)),e._assign(r)}),n&&y(e,"change",()=>{e.value=e.value.trim()}),t||(y(e,"compositionstart",j),y(e,"compositionend",V),y(e,"change",V))},mounted(e,{value:t}){e.value=null==t?"":t},beforeUpdate(e,{value:t,modifiers:{trim:n,number:r}},s){if(e._assign=L(s),e.composing)return;if(document.activeElement===e){if(n&&e.value.trim()===t)return;if((r||"number"===e.type)&&Object(i.L)(e.value)===t)return}const o=null==t?"":t;e.value!==o&&(e.value=o)}},U={created(e,t,n){e._assign=L(n),y(e,"change",()=>{const t=e._modelValue,n=H(e),r=e.checked,s=e._assign;if(Object(i.n)(t)){const e=Object(i.E)(t,n),o=-1!==e;if(r&&!o)s(t.concat(n));else if(!r&&o){const n=[...t];n.splice(e,1),s(n)}}else if(Object(i.z)(t)){const e=new Set(t);r?e.add(n):e.delete(n),s(e)}else s(q(e,r))})},mounted:W,beforeUpdate(e,t,n){e._assign=L(n),W(e,t,n)}};function W(e,{value:t,oldValue:n},r){e._modelValue=t,Object(i.n)(t)?e.checked=Object(i.E)(t,r.props.value)>-1:Object(i.z)(t)?e.checked=t.has(r.props.value):t!==n&&(e.checked=Object(i.D)(t,q(e,!0)))}function H(e){return"_value"in e?e._value:e.value}function q(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const $=["ctrl","shift","alt","meta"],G={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&0!==e.button,middle:e=>"button"in e&&1!==e.button,right:e=>"button"in e&&2!==e.button,exact:(e,t)=>$.some(n=>e[n+"Key"]&&!t.includes(n))},K=(e,t)=>(n,...i)=>{for(let e=0;e<t.length;e++){const i=G[t[e]];if(i&&i(n,t))return}return e(n,...i)};const z=Object(i.h)({patchProp:(e,t,n,r,s=!1,o,a,c,l)=>{switch(t){case"class":!function(e,t,n){if(null==t&&(t=""),n)e.setAttribute("class",t);else{const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),e.className=t}}(e,r,s);break;case"style":!function(e,t,n){const r=e.style;if(n)if(Object(i.B)(n)){if(t!==n){const t=r.display;r.cssText=n,"_vod"in e&&(r.display=t)}}else{for(const e in n)u(r,e,n[e]);if(t&&!Object(i.B)(t))for(const e in t)null==n[e]&&u(r,e,"")}else e.removeAttribute("style")}(e,n,r);break;default:Object(i.v)(t)?Object(i.t)(t)||C(e,t,0,r,a):function(e,t,n,r){if(r)return"innerHTML"===t||!!(t in e&&_.test(t)&&Object(i.o)(n));if("spellcheck"===t||"draggable"===t)return!1;if("form"===t)return!1;if("list"===t&&"INPUT"===e.tagName)return!1;if("type"===t&&"TEXTAREA"===e.tagName)return!1;if(_.test(t)&&Object(i.B)(n))return!1;return t in e}(e,t,r,s)?function(e,t,n,i,r,s,o){if("innerHTML"===t||"textContent"===t)return i&&o(i,r,s),void(e[t]=null==n?"":n);if("value"!==t||"PROGRESS"===e.tagName){if(""===n||null==n){const i=typeof e[t];if(""===n&&"boolean"===i)return void(e[t]=!0);if(null==n&&"string"===i)return e[t]="",void e.removeAttribute(t);if("number"===i)return e[t]=0,void e.removeAttribute(t)}try{e[t]=n}catch(e){0}}else{e._value=n;const t=null==n?"":n;e.value!==t&&(e.value=t)}}(e,t,r,o,a,c,l):("true-value"===t?e._trueValue=r:"false-value"===t&&(e._falseValue=r),function(e,t,n,r){if(r&&t.startsWith("xlink:"))null==n?e.removeAttributeNS(f,t.slice(6,t.length)):e.setAttributeNS(f,t,n);else{const r=Object(i.A)(t);null==n||r&&!1===n?e.removeAttribute(t):e.setAttribute(t,r?"":n)}}(e,t,r,s))}},forcePatchProp:(e,t)=>"value"===t},l);let Y;function J(){return Y||(Y=Object(r.g)(z))}const X=(...e)=>{const t=J().createApp(...e);const{mount:n}=t;return t.mount=e=>{const r=Q(e);if(!r)return;const s=t._component;Object(i.o)(s)||s.render||s.template||(s.template=r.innerHTML),r.innerHTML="";const o=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),o},t};function Q(e){if(Object(i.B)(e)){return document.querySelector(e)}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return Te})),n.d(t,"b",(function(){return ut})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return yt})),n.d(t,"e",(function(){return xt})),n.d(t,"f",(function(){return it})),n.d(t,"g",(function(){return nt})),n.d(t,"h",(function(){return Et})),n.d(t,"i",(function(){return Tt})),n.d(t,"j",(function(){return Jt})),n.d(t,"k",(function(){return Me})),n.d(t,"l",(function(){return hn})),n.d(t,"m",(function(){return Rt})),n.d(t,"n",(function(){return nn})),n.d(t,"o",(function(){return ue})),n.d(t,"p",(function(){return pe})),n.d(t,"q",(function(){return vt})),n.d(t,"r",(function(){return pn})),n.d(t,"s",(function(){return at})),n.d(t,"t",(function(){return Oe})),n.d(t,"u",(function(){return Pe})),n.d(t,"v",(function(){return Ae})),n.d(t,"w",(function(){return o})),n.d(t,"x",(function(){return ye})),n.d(t,"y",(function(){return be})),n.d(t,"z",(function(){return qe}));var i=n(1),r=n(0);const s=[];function o(e,...t){Object(i.g)();const n=s.length?s[s.length-1].component:null,r=n&&n.appContext.config.warnHandler,o=function(){let e=s[s.length-1];if(!e)return[];const t=[];for(;e;){const n=t[0];n&&n.vnode===e?n.recurseCount++:t.push({vnode:e,recurseCount:0});const i=e.component&&e.component.parent;e=i&&i.vnode}return t}();if(r)c(r,n,11,[e+t.join(""),n&&n.proxy,o.map(({vnode:e})=>`at <${ln(n,e.type)}>`).join("\n"),o]);else{const n=["[Vue warn]: "+e,...t];o.length&&n.push("\n",...function(e){const t=[];return e.forEach((e,n)=>{t.push(...0===n?[]:["\n"],...function({vnode:e,recurseCount:t}){const n=t>0?`... (${t} recursive calls)`:"",i=!!e.component&&null==e.component.parent,r=" at <"+ln(e.component,e.type,i),s=">"+n;return e.props?[r,...a(e.props),s]:[r+s]}(e))}),t}(o)),console.warn(...n)}Object(i.k)()}function a(e){const t=[],n=Object.keys(e);return n.slice(0,3).forEach(n=>{t.push(...function e(t,n,s){return Object(r.B)(n)?(n=JSON.stringify(n),s?n:[`${t}=${n}`]):"number"==typeof n||"boolean"==typeof n||null==n?s?n:[`${t}=${n}`]:Object(i.f)(n)?(n=e(t,Object(i.n)(n.value),!0),s?n:[t+"=Ref<",n,">"]):Object(r.o)(n)?[`${t}=fn${n.name?`<${n.name}>`:""}`]:(n=Object(i.n)(n),s?n:[t+"=",n])}(n,e[n]))}),n.length>3&&t.push(" ..."),t}function c(e,t,n,i){let r;try{r=i?e(...i):e()}catch(e){d(e,t,n)}return r}function l(e,t,n,i){if(Object(r.o)(e)){const s=c(e,t,n,i);return s&&Object(r.w)(s)&&s.catch(e=>{d(e,t,n)}),s}const s=[];for(let r=0;r<e.length;r++)s.push(l(e[r],t,n,i));return s}function d(e,t,n,i=!0){t&&t.vnode;if(t){let i=t.parent;const r=t.proxy,s=n;for(;i;){const t=i.ec;if(t)for(let n=0;n<t.length;n++)if(!1===t[n](e,r,s))return;i=i.parent}const o=t.appContext.config.errorHandler;if(o)return void c(o,null,10,[e,r,s])}!function(e,t,n,i=!0){console.error(e)}(e,0,0,i)}let u=!1,h=!1;const p=[];let f=0;const g=[];let m=null,v=0;const b=[];let S=null,y=0;const C=Promise.resolve();let w=null,_=null;function A(e){const t=w||C;return e?t.then(this?e.bind(this):e):t}function k(e){if(!(p.length&&p.includes(e,u&&e.allowRecurse?f+1:f)||e===_)){const t=function(e){let t=f+1,n=p.length;const i=P(e);for(;t<n;){const e=t+n>>>1;P(p[e])<i?t=e+1:n=e}return t}(e);t>-1?p.splice(t,0,e):p.push(e),T()}}function T(){u||h||(h=!0,w=C.then(M))}function I(e,t,n,i){Object(r.n)(e)?n.push(...e):t&&t.includes(e,e.allowRecurse?i+1:i)||n.push(e),T()}function O(e){I(e,S,b,y)}function E(e,t=null){if(g.length){for(_=t,m=[...new Set(g)],g.length=0,v=0;v<m.length;v++)m[v]();m=null,v=0,_=null,E(e,t)}}function x(e){if(b.length){const e=[...new Set(b)];if(b.length=0,S)return void S.push(...e);for(S=e,S.sort((e,t)=>P(e)-P(t)),y=0;y<S.length;y++)S[y]();S=null,y=0}}const P=e=>null==e.id?1/0:e.id;function M(e){h=!1,u=!0,E(e),p.sort((e,t)=>P(e)-P(t));try{for(f=0;f<p.length;f++){const e=p[f];e&&c(e,null,14)}}finally{f=0,p.length=0,x(),u=!1,w=null,(p.length||b.length)&&M(e)}}new Set;new Map;let D;const R=L("component:added"),F=L("component:updated"),N=L("component:removed");function L(e){return t=>{D&&D.emit(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}function j(e,t,...n){const i=e.vnode.props||r.b;let s=n;const o=t.startsWith("update:"),a=o&&t.slice(7);if(a&&a in i){const e=("modelValue"===a?"model":a)+"Modifiers",{number:t,trim:o}=i[e]||r.b;o?s=n.map(e=>e.trim()):t&&(s=n.map(r.L))}let c;__VUE_PROD_DEVTOOLS__&&function(e,t,n){D&&D.emit("component:emit",e.appContext.app,e,t,n)}(e,t,s);let d=i[c=Object(r.K)(t)]||i[c=Object(r.K)(Object(r.e)(t))];!d&&o&&(d=i[c=Object(r.K)(Object(r.l)(t))]),d&&l(d,e,6,s);const u=i[c+"Once"];if(u){if(e.emitted){if(e.emitted[c])return}else(e.emitted={})[c]=!0;l(u,e,6,s)}}function V(e,t,n=!1){if(!t.deopt&&void 0!==e.__emits)return e.__emits;const i=e.emits;let s={},o=!1;if(__VUE_OPTIONS_API__&&!Object(r.o)(e)){const i=e=>{const n=V(e,t,!0);n&&(o=!0,Object(r.h)(s,n))};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}return i||o?(Object(r.n)(i)?i.forEach(e=>s[e]=null):Object(r.h)(s,i),e.__emits=s):e.__emits=null}function B(e,t){return!(!e||!Object(r.v)(t))&&(t=t.slice(2).replace(/Once$/,""),Object(r.k)(e,t[0].toLowerCase()+t.slice(1))||Object(r.k)(e,Object(r.l)(t))||Object(r.k)(e,t))}let U=0;const W=e=>U+=e;let H=null,q=null;function $(e){const t=H;return H=e,q=e&&e.type.__scopeId||null,t}function G(e,t=H){if(!t)return e;const n=(...n)=>{U||vt(!0);const i=$(t),r=e(...n);return $(i),U||bt(),r};return n._c=!0,n}function K(e){const{type:t,vnode:n,proxy:i,withProxy:s,props:o,propsOptions:[a],slots:c,attrs:l,emit:u,render:h,renderCache:p,data:f,setupState:g,ctx:m}=e;let v;const b=$(e);try{let e;if(4&n.shapeFlag){const t=s||i;v=Pt(h.call(t,t,p,o,g,f,m)),e=l}else{const n=t;0,v=Pt(n.length>1?n(o,{attrs:l,slots:c,emit:u}):n(o,null)),e=t.props?l:Y(l)}let d=v;if(!1!==t.inheritAttrs&&e){const t=Object.keys(e),{shapeFlag:n}=d;t.length&&(1&n||6&n)&&(a&&t.some(r.t)&&(e=J(e,a)),d=Ot(d,e))}n.dirs&&(d.dirs=d.dirs?d.dirs.concat(n.dirs):n.dirs),n.transition&&(d.transition=n.transition),v=d}catch(t){gt.length=0,d(t,e,1),v=Tt(pt)}return $(b),v}function z(e){let t;for(let n=0;n<e.length;n++){const i=e[n];if(!Ct(i))return;if(i.type!==pt||"v-if"===i.children){if(t)return;t=i}}return t}const Y=e=>{let t;for(const n in e)("class"===n||"style"===n||Object(r.v)(n))&&((t||(t={}))[n]=e[n]);return t},J=(e,t)=>{const n={};for(const i in e)Object(r.t)(i)&&i.slice(9)in t||(n[i]=e[i]);return n};function X(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!B(n,s))return!0}return!1}function Q({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}function Z(e){if(Object(r.o)(e)&&(e=e()),Object(r.n)(e)){0,e=z(e)}return Pt(e)}function ee(e,t){t&&t.pendingBranch?Object(r.n)(e)?t.effects.push(...e):t.effects.push(e):O(e)}function te(e,t,n,s){const[o,a]=e.propsOptions;if(t)for(const i in t){const a=t[i];if(Object(r.x)(i))continue;let c;o&&Object(r.k)(o,c=Object(r.e)(i))?n[c]=a:B(e.emitsOptions,i)||(s[i]=a)}if(a){const t=Object(i.n)(n);for(let i=0;i<a.length;i++){const r=a[i];n[r]=ne(o,t,r,t[r],e)}}}function ne(e,t,n,i,s){const o=e[n];if(null!=o){const e=Object(r.k)(o,"default");if(e&&void 0===i){const e=o.default;if(o.type!==Function&&Object(r.o)(e)){const{propsDefaults:r}=s;n in r?i=r[n]:(Xt(s),i=r[n]=e(t),Xt(null))}else i=e}o[0]&&(Object(r.k)(t,n)||e?!o[1]||""!==i&&i!==Object(r.l)(n)||(i=!0):i=!1)}return i}function ie(e,t,n=!1){if(!t.deopt&&e.__props)return e.__props;const i=e.props,s={},o=[];let a=!1;if(__VUE_OPTIONS_API__&&!Object(r.o)(e)){const i=e=>{a=!0;const[n,i]=ie(e,t,!0);Object(r.h)(s,n),i&&o.push(...i)};!n&&t.mixins.length&&t.mixins.forEach(i),e.extends&&i(e.extends),e.mixins&&e.mixins.forEach(i)}if(!i&&!a)return e.__props=r.a;if(Object(r.n)(i))for(let e=0;e<i.length;e++){0;const t=Object(r.e)(i[e]);re(t)&&(s[t]=r.b)}else if(i){0;for(const e in i){const t=Object(r.e)(e);if(re(t)){const n=i[e],a=s[t]=Object(r.n)(n)||Object(r.o)(n)?{type:n}:n;if(a){const e=ae(Boolean,a.type),n=ae(String,a.type);a[0]=e>-1,a[1]=n<0||e<n,(e>-1||Object(r.k)(a,"default"))&&o.push(t)}}}}return e.__props=[s,o]}function re(e){return"$"!==e[0]}function se(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:""}function oe(e,t){return se(e)===se(t)}function ae(e,t){return Object(r.n)(t)?t.findIndex(t=>oe(t,e)):Object(r.o)(t)&&oe(t,e)?0:-1}function ce(e,t,n=Yt,r=!1){if(n){const s=n[e]||(n[e]=[]),o=t.__weh||(t.__weh=(...r)=>{if(n.isUnmounted)return;Object(i.g)(),Xt(n);const s=l(t,n,e,r);return Xt(null),Object(i.k)(),s});return r?s.unshift(o):s.push(o),o}}const le=e=>(t,n=Yt)=>!en&&ce(e,t,n),de=le("bm"),ue=le("m"),he=le("bu"),pe=le("u"),fe=le("bum"),ge=le("um"),me=le("rtg"),ve=le("rtc");function be(e,t){return Ce(e,null,t)}const Se={};function ye(e,t,n){return Ce(e,t,n)}function Ce(e,t,{immediate:n,deep:s,flush:o,onTrack:a,onTrigger:d}=r.b,u=Yt){let h,p,f=!1;if(Object(i.f)(e)?(h=()=>e.value,f=!!e._shallow):Object(i.d)(e)?(h=()=>e,s=!0):h=Object(r.n)(e)?()=>e.map(e=>Object(i.f)(e)?e.value:Object(i.d)(e)?_e(e):Object(r.o)(e)?c(e,u,2,[u&&u.proxy]):void 0):Object(r.o)(e)?t?()=>c(e,u,2,[u&&u.proxy]):()=>{if(!u||!u.isUnmounted)return p&&p(),l(e,u,3,[b])}:r.d,t&&s){const e=h;h=()=>_e(e())}let b=e=>{p=w.options.onStop=()=>{c(e,u,4)}},S=Object(r.n)(e)?[]:Se;const y=()=>{if(w.active)if(t){const e=w();(s||f||Object(r.j)(e,S))&&(p&&p(),l(t,u,3,[e,S===Se?void 0:S,b]),S=e)}else w()};let C;y.allowRecurse=!!t,C="sync"===o?y:"post"===o?()=>et(y,u&&u.suspense):()=>{!u||u.isMounted?function(e){I(e,m,g,v)}(y):y()};const w=Object(i.b)(h,{lazy:!0,onTrack:a,onTrigger:d,scheduler:C});return on(w,u),t?n?y():S=w():"post"===o?et(w,u&&u.suspense):w(),()=>{Object(i.m)(w),u&&Object(r.I)(u.effects,w)}}function we(e,t,n){const i=this.proxy;return Ce(Object(r.B)(e)?()=>i[e]:e.bind(i),t.bind(i),n,this)}function _e(e,t=new Set){if(!Object(r.u)(e)||t.has(e))return e;if(t.add(e),Object(i.f)(e))_e(e.value,t);else if(Object(r.n)(e))for(let n=0;n<e.length;n++)_e(e[n],t);else if(Object(r.z)(e)||Object(r.s)(e))e.forEach(e=>{_e(e,t)});else for(const n in e)_e(e[n],t);return e}function Ae(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ue(()=>{e.isMounted=!0}),fe(()=>{e.isUnmounting=!0}),e}const ke=[Function,Array],Te={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ke,onEnter:ke,onAfterEnter:ke,onEnterCancelled:ke,onBeforeLeave:ke,onLeave:ke,onAfterLeave:ke,onLeaveCancelled:ke,onBeforeAppear:ke,onAppear:ke,onAfterAppear:ke,onAppearCancelled:ke},setup(e,{slots:t}){const n=Jt(),r=Ae();let s;return()=>{const o=t.default&&Me(t.default(),!0);if(!o||!o.length)return;const a=Object(i.n)(e),{mode:c}=a;const l=o[0];if(r.isLeaving)return Ee(l);const d=xe(l);if(!d)return Ee(l);const u=Oe(d,a,r,n);Pe(d,u);const h=n.subTree,p=h&&xe(h);let f=!1;const{getTransitionKey:g}=d.type;if(g){const e=g();void 0===s?s=e:e!==s&&(s=e,f=!0)}if(p&&p.type!==pt&&(!wt(d,p)||f)){const e=Oe(p,a,r,n);if(Pe(p,e),"out-in"===c)return r.isLeaving=!0,e.afterLeave=()=>{r.isLeaving=!1,n.update()},Ee(l);"in-out"===c&&d.type!==pt&&(e.delayLeave=(e,t,n)=>{Ie(r,p)[String(p.key)]=p,e._leaveCb=()=>{t(),e._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=n})}return l}}};function Ie(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function Oe(e,t,n,i){const{appear:r,mode:s,persisted:o=!1,onBeforeEnter:a,onEnter:c,onAfterEnter:d,onEnterCancelled:u,onBeforeLeave:h,onLeave:p,onAfterLeave:f,onLeaveCancelled:g,onBeforeAppear:m,onAppear:v,onAfterAppear:b,onAppearCancelled:S}=t,y=String(e.key),C=Ie(n,e),w=(e,t)=>{e&&l(e,i,9,t)},_={mode:s,persisted:o,beforeEnter(t){let i=a;if(!n.isMounted){if(!r)return;i=m||a}t._leaveCb&&t._leaveCb(!0);const s=C[y];s&&wt(e,s)&&s.el._leaveCb&&s.el._leaveCb(),w(i,[t])},enter(e){let t=c,i=d,s=u;if(!n.isMounted){if(!r)return;t=v||c,i=b||d,s=S||u}let o=!1;const a=e._enterCb=t=>{o||(o=!0,w(t?s:i,[e]),_.delayedLeave&&_.delayedLeave(),e._enterCb=void 0)};t?(t(e,a),t.length<=1&&a()):a()},leave(t,i){const r=String(e.key);if(t._enterCb&&t._enterCb(!0),n.isUnmounting)return i();w(h,[t]);let s=!1;const o=t._leaveCb=n=>{s||(s=!0,i(),w(n?g:f,[t]),t._leaveCb=void 0,C[r]===e&&delete C[r])};C[r]=e,p?(p(t,o),p.length<=1&&o()):o()},clone:e=>Oe(e,t,n,i)};return _}function Ee(e){if(De(e))return(e=Ot(e)).children=null,e}function xe(e){return De(e)?e.children?e.children[0]:void 0:e}function Pe(e,t){6&e.shapeFlag&&e.component?Pe(e.component.subTree,t):128&e.shapeFlag?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Me(e,t=!1){let n=[],i=0;for(let r=0;r<e.length;r++){const s=e[r];s.type===ut?(128&s.patchFlag&&i++,n=n.concat(Me(s.children,t))):(t||s.type!==pt)&&n.push(s)}if(i>1)for(let e=0;e<n.length;e++)n[e].patchFlag=-2;return n}const De=e=>e.type.__isKeepAlive;RegExp,RegExp;function Re(e,t){return Object(r.n)(e)?e.some(e=>Re(e,t)):Object(r.B)(e)?e.split(",").indexOf(t)>-1:!!e.test&&e.test(t)}function Fe(e,t,n=Yt){const i=e.__wdc||(e.__wdc=()=>{let t=n;for(;t;){if(t.isDeactivated)return;t=t.parent}e()});if(ce(t,i,n),n){let e=n.parent;for(;e&&e.parent;)De(e.parent.vnode)&&Ne(i,t,n,e),e=e.parent}}function Ne(e,t,n,i){const s=ce(t,e,i,!0);ge(()=>{Object(r.I)(i[t],s)},n)}function Le(e){let t=e.shapeFlag;256&t&&(t-=256),512&t&&(t-=512),e.shapeFlag=t}function je(e){return 128&e.shapeFlag?e.ssContent:e}const Ve=e=>"_"===e[0]||"$stable"===e,Be=e=>Object(r.n)(e)?e.map(Pt):[Pt(e)],Ue=(e,t,n)=>G(e=>Be(t(e)),n),We=(e,t)=>{const n=e._ctx;for(const i in e){if(Ve(i))continue;const s=e[i];if(Object(r.o)(s))t[i]=Ue(0,s,n);else if(null!=s){0;const e=Be(s);t[i]=()=>e}}},He=(e,t)=>{const n=Be(t);e.slots.default=()=>n};function qe(e,t){if(null===H)return e;const n=H.proxy,i=e.dirs||(e.dirs=[]);for(let e=0;e<t.length;e++){let[s,o,a,c=r.b]=t[e];Object(r.o)(s)&&(s={mounted:s,updated:s}),i.push({dir:s,instance:n,value:o,oldValue:void 0,arg:a,modifiers:c})}return e}function $e(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let o=0;o<r.length;o++){const a=r[o];s&&(a.oldValue=s[o].value);const c=a.dir[i];c&&l(c,n,8,[e.el,a,e,t])}}function Ge(){return{app:null,config:{isNativeTag:r.c,performance:!1,globalProperties:{},optionMergeStrategies:{},isCustomElement:r.c,errorHandler:void 0,warnHandler:void 0},mixins:[],components:{},directives:{},provides:Object.create(null)}}let Ke=0;function ze(e,t){return function(n,i=null){null==i||Object(r.u)(i)||(i=null);const s=Ge(),o=new Set;let a=!1;const c=s.app={_uid:Ke++,_component:n,_props:i,_container:null,_context:s,version:fn,get config(){return s.config},set config(e){0},use:(e,...t)=>(o.has(e)||(e&&Object(r.o)(e.install)?(o.add(e),e.install(c,...t)):Object(r.o)(e)&&(o.add(e),e(c,...t))),c),mixin:e=>(__VUE_OPTIONS_API__&&(s.mixins.includes(e)||(s.mixins.push(e),(e.props||e.emits)&&(s.deopt=!0))),c),component:(e,t)=>t?(s.components[e]=t,c):s.components[e],directive:(e,t)=>t?(s.directives[e]=t,c):s.directives[e],mount(r,o,l){if(!a){const d=Tt(n,i);return d.appContext=s,o&&t?t(d,r):e(d,r,l),a=!0,c._container=r,r.__vue_app__=c,__VUE_PROD_DEVTOOLS__&&function(e,t){D&&D.emit("app:init",e,t,{Fragment:ut,Text:ht,Comment:pt,Static:ft})}(c,fn),d.component.proxy}},unmount(){a&&(e(null,c._container),__VUE_PROD_DEVTOOLS__&&function(e){D&&D.emit("app:unmount",e)}(c),delete c._container.__vue_app__)},provide:(e,t)=>(s.provides[e]=t,c)};return c}}let Ye=!1;const Je=e=>/svg/.test(e.namespaceURI)&&"foreignObject"!==e.tagName,Xe=e=>8===e.nodeType;function Qe(e){const{mt:t,p:n,o:{patchProp:i,nextSibling:s,parentNode:o,remove:a,insert:c,createComment:l}}=e,d=(n,i,r,a,c,l=!1)=>{const m=Xe(n)&&"["===n.data,v=()=>f(n,i,r,a,c,m),{type:b,ref:S,shapeFlag:y}=i,C=n.nodeType;i.el=n;let w=null;switch(b){case ht:3!==C?w=v():(n.data!==i.children&&(Ye=!0,n.data=i.children),w=s(n));break;case pt:w=8!==C||m?v():s(n);break;case ft:if(1===C){w=n;const e=!i.children.length;for(let t=0;t<i.staticCount;t++)e&&(i.children+=w.outerHTML),t===i.staticCount-1&&(i.anchor=w),w=s(w);return w}w=v();break;case ut:w=m?p(n,i,r,a,c,l):v();break;default:if(1&y)w=1!==C||i.type.toLowerCase()!==n.tagName.toLowerCase()?v():u(n,i,r,a,c,l);else if(6&y){i.slotScopeIds=c;const e=o(n),d=()=>{t(i,e,null,r,a,Je(e),l)},u=i.type.__asyncLoader;u?u().then(d):d(),w=m?g(n):s(n)}else 64&y?w=8!==C?v():i.type.hydrate(n,i,r,a,c,l,e,h):128&y&&(w=i.type.hydrate(n,i,r,a,Je(o(n)),c,l,e,d))}return null!=S&&tt(S,null,a,i),w},u=(e,t,n,s,o,c)=>{c=c||!!t.dynamicChildren;const{props:l,patchFlag:d,shapeFlag:u,dirs:p}=t;if(-1!==d){if(p&&$e(t,null,n,"created"),l)if(!c||16&d||32&d)for(const t in l)!Object(r.x)(t)&&Object(r.v)(t)&&i(e,t,null,l[t]);else l.onClick&&i(e,"onClick",null,l.onClick);let f;if((f=l&&l.onVnodeBeforeMount)&&st(f,n,t),p&&$e(t,null,n,"beforeMount"),((f=l&&l.onVnodeMounted)||p)&&ee(()=>{f&&st(f,n,t),p&&$e(t,null,n,"mounted")},s),16&u&&(!l||!l.innerHTML&&!l.textContent)){let i=h(e.firstChild,t,e,n,s,o,c);for(;i;){Ye=!0;const e=i;i=i.nextSibling,a(e)}}else 8&u&&e.textContent!==t.children&&(Ye=!0,e.textContent=t.children)}return e.nextSibling},h=(e,t,i,r,s,o,a)=>{a=a||!!t.dynamicChildren;const c=t.children,l=c.length;for(let t=0;t<l;t++){const l=a?c[t]:c[t]=Pt(c[t]);if(e)e=d(e,l,r,s,o,a);else{if(l.type===ht&&!l.children)continue;Ye=!0,n(null,l,i,null,r,s,Je(i),o)}}return e},p=(e,t,n,i,r,a)=>{const{slotScopeIds:d}=t;d&&(r=r?r.concat(d):d);const u=o(e),p=h(s(e),t,u,n,i,r,a);return p&&Xe(p)&&"]"===p.data?s(t.anchor=p):(Ye=!0,c(t.anchor=l("]"),u,p),p)},f=(e,t,i,r,c,l)=>{if(Ye=!0,t.el=null,l){const t=g(e);for(;;){const n=s(e);if(!n||n===t)break;a(n)}}const d=s(e),u=o(e);return a(e),n(null,t,u,d,i,r,Je(u),c),d},g=e=>{let t=0;for(;e;)if((e=s(e))&&Xe(e)&&("["===e.data&&t++,"]"===e.data)){if(0===t)return s(e);t--}return e};return[(e,t)=>{Ye=!1,d(t.firstChild,e,null,null,null),x(),Ye&&console.error("Hydration completed but contains mismatches.")},d]}const Ze={scheduler:k,allowRecurse:!0};const et=ee,tt=(e,t,n,s)=>{if(Object(r.n)(e))return void e.forEach((e,i)=>tt(e,t&&(Object(r.n)(t)?t[i]:t),n,s));let o;if(s){if(s.type.__asyncLoader)return;o=4&s.shapeFlag?s.component.exposed||s.component.proxy:s.el}else o=null;const{i:a,r:l}=e;const d=t&&t.r,u=a.refs===r.b?a.refs={}:a.refs,h=a.setupState;if(null!=d&&d!==l&&(Object(r.B)(d)?(u[d]=null,Object(r.k)(h,d)&&(h[d]=null)):Object(i.f)(d)&&(d.value=null)),Object(r.B)(l)){const e=()=>{u[l]=o,Object(r.k)(h,l)&&(h[l]=o)};o?(e.id=-1,et(e,n)):e()}else if(Object(i.f)(l)){const e=()=>{l.value=o};o?(e.id=-1,et(e,n)):e()}else Object(r.o)(l)&&c(l,a,12,[o,u])};function nt(e){return rt(e)}function it(e){return rt(e,Qe)}function rt(e,t){if(function(){let e=!1;"boolean"!=typeof __VUE_OPTIONS_API__&&(e=!0,Object(r.i)().__VUE_OPTIONS_API__=!0),"boolean"!=typeof __VUE_PROD_DEVTOOLS__&&(e=!0,Object(r.i)().__VUE_PROD_DEVTOOLS__=!1)}(),__VUE_PROD_DEVTOOLS__){const e=Object(r.i)();e.__VUE__=!0,n=e.__VUE_DEVTOOLS_GLOBAL_HOOK__,D=n}var n;const{insert:s,remove:o,patchProp:a,forcePatchProp:l,createElement:u,createText:h,createComment:g,setText:m,setElementText:v,parentNode:b,nextSibling:S,setScopeId:y=r.d,cloneNode:C,insertStaticContent:w}=e,_=(e,t,n,i=null,r=null,s=null,o=!1,a=null,c=!1)=>{e&&!wt(e,t)&&(i=ue(e),oe(e,r,s,!0),e=null),-2===t.patchFlag&&(c=!1,t.dynamicChildren=null);const{type:l,ref:d,shapeFlag:u}=t;switch(l){case ht:A(e,t,n,i);break;case pt:k(e,t,n,i);break;case ft:null==e&&T(t,n,i,o);break;case ut:q(e,t,n,i,r,s,o,a,c);break;default:1&u?O(e,t,n,i,r,s,o,a,c):6&u?$(e,t,n,i,r,s,o,a,c):(64&u||128&u)&&l.process(e,t,n,i,r,s,o,a,c,pe)}null!=d&&r&&tt(d,e&&e.ref,s,t)},A=(e,t,n,i)=>{if(null==e)s(t.el=h(t.children),n,i);else{const n=t.el=e.el;t.children!==e.children&&m(n,t.children)}},k=(e,t,n,i)=>{null==e?s(t.el=g(t.children||""),n,i):t.el=e.el},T=(e,t,n,i)=>{[e.el,e.anchor]=w(e.children,t,n,i)},I=({el:e,anchor:t})=>{let n;for(;e&&e!==t;)n=S(e),o(e),e=n;o(t)},O=(e,t,n,i,r,s,o,a,c)=>{o=o||"svg"===t.type,null==e?P(t,n,i,r,s,o,a,c):U(e,t,r,s,o,a,c)},P=(e,t,n,i,o,c,l,d)=>{let h,p;const{type:f,props:g,shapeFlag:m,transition:b,patchFlag:S,dirs:y}=e;if(e.el&&void 0!==C&&-1===S)h=e.el=C(e.el);else{if(h=e.el=u(e.type,c,g&&g.is,g),8&m?v(h,e.children):16&m&&L(e.children,h,null,i,o,c&&"foreignObject"!==f,l,d||!!e.dynamicChildren),y&&$e(e,null,i,"created"),g){for(const t in g)Object(r.x)(t)||a(h,t,null,g[t],c,e.children,i,o,de);(p=g.onVnodeBeforeMount)&&st(p,i,e)}M(h,e,e.scopeId,l,i)}__VUE_PROD_DEVTOOLS__&&(Object.defineProperty(h,"__vnode",{value:e,enumerable:!1}),Object.defineProperty(h,"__vueParentComponent",{value:i,enumerable:!1})),y&&$e(e,null,i,"beforeMount");const w=(!o||o&&!o.pendingBranch)&&b&&!b.persisted;w&&b.beforeEnter(h),s(h,t,n),((p=g&&g.onVnodeMounted)||w||y)&&et(()=>{p&&st(p,i,e),w&&b.enter(h),y&&$e(e,null,i,"mounted")},o)},M=(e,t,n,i,r)=>{if(n&&y(e,n),i)for(let t=0;t<i.length;t++)y(e,i[t]);if(r){if(t===r.subTree){const t=r.vnode;M(e,t,t.scopeId,t.slotScopeIds,r.parent)}}},L=(e,t,n,i,r,s,o,a,c=0)=>{for(let l=c;l<e.length;l++){const c=e[l]=o?Mt(e[l]):Pt(e[l]);_(null,c,t,n,i,r,s,o,a)}},U=(e,t,n,i,s,o,c)=>{const d=t.el=e.el;let{patchFlag:u,dynamicChildren:h,dirs:p}=t;u|=16&e.patchFlag;const f=e.props||r.b,g=t.props||r.b;let m;if((m=g.onVnodeBeforeUpdate)&&st(m,n,t,e),p&&$e(t,e,n,"beforeUpdate"),u>0){if(16&u)H(d,t,f,g,n,i,s);else if(2&u&&f.class!==g.class&&a(d,"class",null,g.class,s),4&u&&a(d,"style",f.style,g.style,s),8&u){const r=t.dynamicProps;for(let t=0;t<r.length;t++){const o=r[t],c=f[o],u=g[o];(u!==c||l&&l(d,o))&&a(d,o,c,u,s,e.children,n,i,de)}}1&u&&e.children!==t.children&&v(d,t.children)}else c||null!=h||H(d,t,f,g,n,i,s);const b=s&&"foreignObject"!==t.type;h?W(e.dynamicChildren,h,d,n,i,b,o):c||Z(e,t,d,null,n,i,b,o,!1),((m=g.onVnodeUpdated)||p)&&et(()=>{m&&st(m,n,t,e),p&&$e(t,e,n,"updated")},i)},W=(e,t,n,i,r,s,o)=>{for(let a=0;a<t.length;a++){const c=e[a],l=t[a],d=c.type===ut||!wt(c,l)||6&c.shapeFlag||64&c.shapeFlag?b(c.el):n;_(c,l,d,null,i,r,s,o,!0)}},H=(e,t,n,i,s,o,c)=>{if(n!==i){for(const d in i){if(Object(r.x)(d))continue;const u=i[d],h=n[d];(u!==h||l&&l(e,d))&&a(e,d,h,u,c,t.children,s,o,de)}if(n!==r.b)for(const l in n)Object(r.x)(l)||l in i||a(e,l,n[l],null,c,t.children,s,o,de)}},q=(e,t,n,i,r,o,a,c,l)=>{const d=t.el=e?e.el:h(""),u=t.anchor=e?e.anchor:h("");let{patchFlag:p,dynamicChildren:f,slotScopeIds:g}=t;p>0&&(l=!0),g&&(c=c?c.concat(g):g),null==e?(s(d,n,i),s(u,n,i),L(t.children,n,u,r,o,a,c,l)):p>0&&64&p&&f&&e.dynamicChildren?(W(e.dynamicChildren,f,n,r,o,a,c),(null!=t.key||r&&t===r.subTree)&&ot(e,t,!0)):Z(e,t,n,u,r,o,a,c,l)},$=(e,t,n,i,r,s,o,a,c)=>{t.slotScopeIds=a,null==e?512&t.shapeFlag?r.ctx.activate(t,n,i,o,c):G(t,n,i,r,s,o,c):z(e,t,c)},G=(e,t,n,s,o,a,l)=>{const u=e.component=function(e,t,n){const i=e.type,s=(t?t.appContext:e.appContext)||Kt,o={uid:zt++,vnode:e,type:i,parent:t,appContext:s,root:null,next:null,subTree:null,update:null,render:null,proxy:null,exposed:null,withProxy:null,effects:null,provides:t?t.provides:Object.create(s.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ie(i,s),emitsOptions:V(i,s),emit:null,emitted:null,propsDefaults:r.b,ctx:r.b,data:r.b,props:r.b,attrs:r.b,slots:r.b,refs:r.b,setupState:r.b,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null};o.ctx={_:o};return o.root=t?t.root:o,o.emit=j.bind(null,o),o}(e,s,o);if(De(e)&&(u.ctx.renderer=pe),function(e,t=!1){en=t;const{props:n,children:s}=e.vnode,o=Qt(e);(function(e,t,n,s=!1){const o={},a={};Object(r.g)(a,_t,1),e.propsDefaults=Object.create(null),te(e,t,o,a),n?e.props=s?o:Object(i.l)(o):e.type.props?e.props=o:e.props=a,e.attrs=a})(e,n,o,t),((e,t)=>{if(32&e.vnode.shapeFlag){const n=t._;n?(e.slots=t,Object(r.g)(t,"_",n)):We(t,e.slots={})}else e.slots={},t&&He(e,t);Object(r.g)(e.slots,_t,1)})(e,s);const a=o?function(e,t){const n=e.type;0;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,$t),!1;const{setup:s}=n;if(s){const n=e.setupContext=s.length>1?sn(e):null;Yt=e,Object(i.g)();const o=c(s,e,0,[e.props,n]);if(Object(i.k)(),Yt=null,Object(r.w)(o)){if(t)return o.then(n=>{tn(e,n,t)}).catch(t=>{d(t,e,0)});e.asyncDep=o}else tn(e,o,t)}else rn(e,t)}(e,t):void 0;en=!1}(u),u.asyncDep){if(o&&o.registerDep(u,Y),!e.el){const e=u.subTree=Tt(pt);k(null,e,t,n)}}else Y(u,e,t,n,o,a,l)},z=(e,t,n)=>{const i=t.component=e.component;if(function(e,t,n){const{props:i,children:r,component:s}=e,{props:o,children:a,patchFlag:c}=t,l=s.emitsOptions;if(t.dirs||t.transition)return!0;if(!(n&&c>=0))return!(!r&&!a||a&&a.$stable)||i!==o&&(i?!o||X(i,o,l):!!o);if(1024&c)return!0;if(16&c)return i?X(i,o,l):!!o;if(8&c){const e=t.dynamicProps;for(let t=0;t<e.length;t++){const n=e[t];if(o[n]!==i[n]&&!B(l,n))return!0}}return!1}(e,t,n)){if(i.asyncDep&&!i.asyncResolved)return void J(i,t,n);i.next=t,function(e){const t=p.indexOf(e);t>f&&p.splice(t,1)}(i.update),i.update()}else t.component=e.component,t.el=e.el,i.vnode=t},Y=(e,t,n,s,o,a,c)=>{e.update=Object(i.b)((function(){if(e.isMounted){let t,{next:n,bu:i,u:s,parent:l,vnode:d}=e,u=n;0,n?(n.el=d.el,J(e,n,c)):n=d,i&&Object(r.m)(i),(t=n.props&&n.props.onVnodeBeforeUpdate)&&st(t,l,n,d);const h=K(e);0;const p=e.subTree;e.subTree=h,_(p,h,b(p.el),ue(p),e,o,a),n.el=h.el,null===u&&Q(e,h.el),s&&et(s,o),(t=n.props&&n.props.onVnodeUpdated)&&et(()=>{st(t,l,n,d)},o),__VUE_PROD_DEVTOOLS__&&F(e)}else{let i;const{el:c,props:l}=t,{bm:d,m:u,parent:h}=e;d&&Object(r.m)(d),(i=l&&l.onVnodeBeforeMount)&&st(i,h,t);const p=e.subTree=K(e);if(c&&ge?ge(t.el,p,e,o,null):(_(null,p,n,s,e,o,a),t.el=p.el),u&&et(u,o),i=l&&l.onVnodeMounted){const e=t;et(()=>{st(i,h,e)},o)}const{a:f}=e;f&&256&t.shapeFlag&&et(f,o),e.isMounted=!0,__VUE_PROD_DEVTOOLS__&&R(e),t=n=s=null}}),Ze)},J=(e,t,n)=>{t.component=e;const s=e.vnode.props;e.vnode=t,e.next=null,function(e,t,n,s){const{props:o,attrs:a,vnode:{patchFlag:c}}=e,l=Object(i.n)(o),[d]=e.propsOptions;if(!(s||c>0)||16&c){let i;te(e,t,o,a);for(const s in l)t&&(Object(r.k)(t,s)||(i=Object(r.l)(s))!==s&&Object(r.k)(t,i))||(d?!n||void 0===n[s]&&void 0===n[i]||(o[s]=ne(d,t||r.b,s,void 0,e)):delete o[s]);if(a!==l)for(const e in a)t&&Object(r.k)(t,e)||delete a[e]}else if(8&c){const n=e.vnode.dynamicProps;for(let i=0;i<n.length;i++){const s=n[i],c=t[s];if(d)if(Object(r.k)(a,s))a[s]=c;else{const t=Object(r.e)(s);o[t]=ne(d,l,t,c,e)}else a[s]=c}}Object(i.q)(e,"set","$attrs")}(e,t.props,s,n),((e,t,n)=>{const{vnode:i,slots:s}=e;let o=!0,a=r.b;if(32&i.shapeFlag){const e=t._;e?n&&1===e?o=!1:(Object(r.h)(s,t),n||1!==e||delete s._):(o=!t.$stable,We(t,s)),a=t}else t&&(He(e,t),a={default:1});if(o)for(const e in s)Ve(e)||e in a||delete s[e]})(e,t.children,n),Object(i.g)(),E(void 0,e.update),Object(i.k)()},Z=(e,t,n,i,r,s,o,a,c=!1)=>{const l=e&&e.children,d=e?e.shapeFlag:0,u=t.children,{patchFlag:h,shapeFlag:p}=t;if(h>0){if(128&h)return void re(l,u,n,i,r,s,o,a,c);if(256&h)return void ee(l,u,n,i,r,s,o,a,c)}8&p?(16&d&&de(l,r,s),u!==l&&v(n,u)):16&d?16&p?re(l,u,n,i,r,s,o,a,c):de(l,r,s,!0):(8&d&&v(n,""),16&p&&L(u,n,i,r,s,o,a,c))},ee=(e,t,n,i,s,o,a,c,l)=>{e=e||r.a,t=t||r.a;const d=e.length,u=t.length,h=Math.min(d,u);let p;for(p=0;p<h;p++){const i=t[p]=l?Mt(t[p]):Pt(t[p]);_(e[p],i,n,null,s,o,a,c,l)}d>u?de(e,s,o,!0,!1,h):L(t,n,i,s,o,a,c,l,h)},re=(e,t,n,i,s,o,a,c,l)=>{let d=0;const u=t.length;let h=e.length-1,p=u-1;for(;d<=h&&d<=p;){const i=e[d],r=t[d]=l?Mt(t[d]):Pt(t[d]);if(!wt(i,r))break;_(i,r,n,null,s,o,a,c,l),d++}for(;d<=h&&d<=p;){const i=e[h],r=t[p]=l?Mt(t[p]):Pt(t[p]);if(!wt(i,r))break;_(i,r,n,null,s,o,a,c,l),h--,p--}if(d>h){if(d<=p){const e=p+1,r=e<u?t[e].el:i;for(;d<=p;)_(null,t[d]=l?Mt(t[d]):Pt(t[d]),n,r,s,o,a,c,l),d++}}else if(d>p)for(;d<=h;)oe(e[d],s,o,!0),d++;else{const f=d,g=d,m=new Map;for(d=g;d<=p;d++){const e=t[d]=l?Mt(t[d]):Pt(t[d]);null!=e.key&&m.set(e.key,d)}let v,b=0;const S=p-g+1;let y=!1,C=0;const w=new Array(S);for(d=0;d<S;d++)w[d]=0;for(d=f;d<=h;d++){const i=e[d];if(b>=S){oe(i,s,o,!0);continue}let r;if(null!=i.key)r=m.get(i.key);else for(v=g;v<=p;v++)if(0===w[v-g]&&wt(i,t[v])){r=v;break}void 0===r?oe(i,s,o,!0):(w[r-g]=d+1,r>=C?C=r:y=!0,_(i,t[r],n,null,s,o,a,c,l),b++)}const A=y?function(e){const t=e.slice(),n=[0];let i,r,s,o,a;const c=e.length;for(i=0;i<c;i++){const c=e[i];if(0!==c){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(s=0,o=n.length-1;s<o;)a=(s+o)/2|0,e[n[a]]<c?s=a+1:o=a;c<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}s=n.length,o=n[s-1];for(;s-- >0;)n[s]=o,o=t[o];return n}(w):r.a;for(v=A.length-1,d=S-1;d>=0;d--){const e=g+d,r=t[e],h=e+1<u?t[e+1].el:i;0===w[d]?_(null,r,n,h,s,o,a,c,l):y&&(v<0||d!==A[v]?se(r,n,h,2):v--)}}},se=(e,t,n,i,r=null)=>{const{el:o,type:a,transition:c,children:l,shapeFlag:d}=e;if(6&d)return void se(e.component.subTree,t,n,i);if(128&d)return void e.suspense.move(t,n,i);if(64&d)return void a.move(e,t,n,pe);if(a===ut){s(o,t,n);for(let e=0;e<l.length;e++)se(l[e],t,n,i);return void s(e.anchor,t,n)}if(a===ft)return void(({el:e,anchor:t},n,i)=>{let r;for(;e&&e!==t;)r=S(e),s(e,n,i),e=r;s(t,n,i)})(e,t,n);if(2!==i&&1&d&&c)if(0===i)c.beforeEnter(o),s(o,t,n),et(()=>c.enter(o),r);else{const{leave:e,delayLeave:i,afterLeave:r}=c,a=()=>s(o,t,n),l=()=>{e(o,()=>{a(),r&&r()})};i?i(o,a,l):l()}else s(o,t,n)},oe=(e,t,n,i=!1,r=!1)=>{const{type:s,props:o,ref:a,children:c,dynamicChildren:l,shapeFlag:d,patchFlag:u,dirs:h}=e;if(null!=a&&tt(a,null,n,null),256&d)return void t.ctx.deactivate(e);const p=1&d&&h;let f;if((f=o&&o.onVnodeBeforeUnmount)&&st(f,t,e),6&d)le(e.component,n,i);else{if(128&d)return void e.suspense.unmount(n,i);p&&$e(e,null,t,"beforeUnmount"),64&d?e.type.remove(e,t,n,r,pe,i):l&&(s!==ut||u>0&&64&u)?de(l,t,n,!1,!0):(s===ut&&(128&u||256&u)||!r&&16&d)&&de(c,t,n),i&&ae(e)}((f=o&&o.onVnodeUnmounted)||p)&&et(()=>{f&&st(f,t,e),p&&$e(e,null,t,"unmounted")},n)},ae=e=>{const{type:t,el:n,anchor:i,transition:r}=e;if(t===ut)return void ce(n,i);if(t===ft)return void I(e);const s=()=>{o(n),r&&!r.persisted&&r.afterLeave&&r.afterLeave()};if(1&e.shapeFlag&&r&&!r.persisted){const{leave:t,delayLeave:i}=r,o=()=>t(n,s);i?i(e.el,s,o):o()}else s()},ce=(e,t)=>{let n;for(;e!==t;)n=S(e),o(e),e=n;o(t)},le=(e,t,n)=>{const{bum:s,effects:o,update:a,subTree:c,um:l}=e;if(s&&Object(r.m)(s),o)for(let e=0;e<o.length;e++)Object(i.m)(o[e]);a&&(Object(i.m)(a),oe(c,e,t,n)),l&&et(l,t),et(()=>{e.isUnmounted=!0},t),t&&t.pendingBranch&&!t.isUnmounted&&e.asyncDep&&!e.asyncResolved&&e.suspenseId===t.pendingId&&(t.deps--,0===t.deps&&t.resolve()),__VUE_PROD_DEVTOOLS__&&N(e)},de=(e,t,n,i=!1,r=!1,s=0)=>{for(let o=s;o<e.length;o++)oe(e[o],t,n,i,r)},ue=e=>6&e.shapeFlag?ue(e.component.subTree):128&e.shapeFlag?e.suspense.next():S(e.anchor||e.el),he=(e,t,n)=>{null==e?t._vnode&&oe(t._vnode,null,null,!0):_(t._vnode||null,e,t,null,null,null,n),x(),t._vnode=e},pe={p:_,um:oe,m:se,r:ae,mt:G,mc:L,pc:Z,pbc:W,n:ue,o:e};let fe,ge;return t&&([fe,ge]=t(pe)),{render:he,hydrate:fe,createApp:ze(he,fe)}}function st(e,t,n,i=null){l(e,t,7,[n,i])}function ot(e,t,n=!1){const i=e.children,s=t.children;if(Object(r.n)(i)&&Object(r.n)(s))for(let e=0;e<i.length;e++){const t=i[e];let r=s[e];1&r.shapeFlag&&!r.dynamicChildren&&((r.patchFlag<=0||32===r.patchFlag)&&(r=s[e]=Mt(s[e]),r.el=t.el),n||ot(t,r))}}function at(e,t){return lt("components",e,!0,t)||e}const ct=Symbol();function lt(e,t,n=!0,i=!1){const s=H||Yt;if(s){const n=s.type;if("components"===e){const e=cn(n);if(e&&(e===t||e===Object(r.e)(t)||e===Object(r.f)(Object(r.e)(t))))return n}const o=dt(s[e]||n[e],t)||dt(s.appContext[e],t);return!o&&i?n:o}}function dt(e,t){return e&&(e[t]||e[Object(r.e)(t)]||e[Object(r.f)(Object(r.e)(t))])}const ut=Symbol(void 0),ht=Symbol(void 0),pt=Symbol(void 0),ft=Symbol(void 0),gt=[];let mt=null;function vt(e=!1){gt.push(mt=e?null:[])}function bt(){gt.pop(),mt=gt[gt.length-1]||null}let St=1;function yt(e,t,n,i,s){const o=Tt(e,t,n,i,s,!0);return o.dynamicChildren=mt||r.a,bt(),St>0&&mt&&mt.push(o),o}function Ct(e){return!!e&&!0===e.__v_isVNode}function wt(e,t){return e.type===t.type&&e.key===t.key}const _t="__vInternal",At=({key:e})=>null!=e?e:null,kt=({ref:e})=>null!=e?Object(r.B)(e)||Object(i.f)(e)||Object(r.o)(e)?{i:H,r:e}:e:null,Tt=It;function It(e,t=null,n=null,s=0,o=null,a=!1){if(e&&e!==ct||(e=pt),Ct(e)){const i=Ot(e,t,!0);return n&&Dt(i,n),i}if(dn(e)&&(e=e.__vccOpts),t){(Object(i.c)(t)||_t in t)&&(t=Object(r.h)({},t));let{class:e,style:n}=t;e&&!Object(r.B)(e)&&(t.class=Object(r.G)(e)),Object(r.u)(n)&&(Object(i.c)(n)&&!Object(r.n)(n)&&(n=Object(r.h)({},n)),t.style=Object(r.H)(n))}const c=Object(r.B)(e)?1:(e=>e.__isSuspense)(e)?128:(e=>e.__isTeleport)(e)?64:Object(r.u)(e)?4:Object(r.o)(e)?2:0;const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&At(t),ref:t&&kt(t),scopeId:q,slotScopeIds:null,children:null,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:c,patchFlag:s,dynamicProps:o,dynamicChildren:null,appContext:null};if(Dt(l,n),128&c){const{content:e,fallback:t}=function(e){const{shapeFlag:t,children:n}=e;let i,r;return 32&t?(i=Z(n.default),r=Z(n.fallback)):(i=Z(n),r=Pt(null)),{content:i,fallback:r}}(l);l.ssContent=e,l.ssFallback=t}return St>0&&!a&&mt&&(s>0||6&c)&&32!==s&&mt.push(l),l}function Ot(e,t,n=!1){const{props:i,ref:s,patchFlag:o,children:a}=e,c=t?function(...e){const t=Object(r.h)({},e[0]);for(let n=1;n<e.length;n++){const i=e[n];for(const e in i)if("class"===e)t.class!==i.class&&(t.class=Object(r.G)([t.class,i.class]));else if("style"===e)t.style=Object(r.H)([t.style,i.style]);else if(Object(r.v)(e)){const n=t[e],r=i[e];n!==r&&(t[e]=n?[].concat(n,i[e]):r)}else""!==e&&(t[e]=i[e])}return t}(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:c,key:c&&At(c),ref:t&&t.ref?n&&s?Object(r.n)(s)?s.concat(kt(t)):[s,kt(t)]:kt(t):s,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==ut?-1===o?16:16|o:o,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ot(e.ssContent),ssFallback:e.ssFallback&&Ot(e.ssFallback),el:e.el,anchor:e.anchor}}function Et(e=" ",t=0){return Tt(ht,null,e,t)}function xt(e="",t=!1){return t?(vt(),yt(pt,null,e)):Tt(pt,null,e)}function Pt(e){return null==e||"boolean"==typeof e?Tt(pt):Object(r.n)(e)?Tt(ut,null,e):"object"==typeof e?null===e.el?e:Ot(e):Tt(ht,null,String(e))}function Mt(e){return null===e.el?e:Ot(e)}function Dt(e,t){let n=0;const{shapeFlag:i}=e;if(null==t)t=null;else if(Object(r.n)(t))n=16;else if("object"==typeof t){if(1&i||64&i){const n=t.default;return void(n&&(n._c&&W(1),Dt(e,n()),n._c&&W(-1)))}{n=32;const i=t._;i||_t in t?3===i&&H&&(1024&H.vnode.patchFlag?(t._=2,e.patchFlag|=1024):t._=1):t._ctx=H}}else Object(r.o)(t)?(t={default:t,_ctx:H},n=32):(t=String(t),64&i?(n=16,t=[Et(t)]):n=8);e.children=t,e.shapeFlag|=n}function Rt(e,t,n=!1){const i=Yt||H;if(i){const s=null==i.parent?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(s&&e in s)return s[e];if(arguments.length>1)return n&&Object(r.o)(t)?t():t}else 0}let Ft=!0;function Nt(e,t,n=[],s=[],o=[],a=!1){const{mixins:c,extends:l,data:d,computed:u,methods:h,watch:p,provide:f,inject:g,components:m,directives:v,beforeMount:b,mounted:S,beforeUpdate:y,updated:C,activated:w,deactivated:_,beforeDestroy:A,beforeUnmount:k,destroyed:T,unmounted:I,render:O,renderTracked:E,renderTriggered:x,errorCaptured:P,expose:M}=t,D=e.proxy,R=e.ctx,F=e.appContext.mixins;a&&O&&e.render===r.d&&(e.render=O),a||(Ft=!1,Lt("beforeCreate","bc",t,e,F),Ft=!0,Vt(e,F,n,s,o)),l&&Nt(e,l,n,s,o,!0),c&&Vt(e,c,n,s,o);if(g)if(Object(r.n)(g))for(let e=0;e<g.length;e++){const t=g[e];R[t]=Rt(t)}else for(const e in g){const t=g[e];Object(r.u)(t)?R[e]=Rt(t.from||e,t.default,!0):R[e]=Rt(t)}if(h)for(const e in h){const t=h[e];Object(r.o)(t)&&(R[e]=t.bind(D))}if(a?d&&n.push(d):(n.length&&n.forEach(t=>Bt(e,t,D)),d&&Bt(e,d,D)),u)for(const e in u){const t=u[e];0;const n=un({get:Object(r.o)(t)?t.bind(D,D):Object(r.o)(t.get)?t.get.bind(D,D):r.d,set:!Object(r.o)(t)&&Object(r.o)(t.set)?t.set.bind(D):r.d});Object.defineProperty(R,e,{enumerable:!0,configurable:!0,get:()=>n.value,set:e=>n.value=e})}var N;if(p&&s.push(p),!a&&s.length&&s.forEach(e=>{for(const t in e)Ut(e[t],R,D,t)}),f&&o.push(f),!a&&o.length&&o.forEach(e=>{const t=Object(r.o)(e)?e.call(D):e;Reflect.ownKeys(t).forEach(e=>{!function(e,t){if(Yt){let n=Yt.provides;const i=Yt.parent&&Yt.parent.provides;i===n&&(n=Yt.provides=Object.create(i)),n[e]=t}else 0}(e,t[e])})}),a&&(m&&Object(r.h)(e.components||(e.components=Object(r.h)({},e.type.components)),m),v&&Object(r.h)(e.directives||(e.directives=Object(r.h)({},e.type.directives)),v)),a||Lt("created","c",t,e,F),b&&de(b.bind(D)),S&&ue(S.bind(D)),y&&he(y.bind(D)),C&&pe(C.bind(D)),w&&Fe(w.bind(D),"a",N),_&&function(e,t){Fe(e,"da",t)}(_.bind(D)),P&&((e,t=Yt)=>{ce("ec",e,t)})(P.bind(D)),E&&ve(E.bind(D)),x&&me(x.bind(D)),k&&fe(k.bind(D)),I&&ge(I.bind(D)),Object(r.n)(M))if(a)0;else if(M.length){const t=e.exposed||(e.exposed=Object(i.h)({}));M.forEach(e=>{t[e]=Object(i.o)(D,e)})}else e.exposed||(e.exposed=r.b)}function Lt(e,t,n,i,r){for(let n=0;n<r.length;n++)jt(e,t,r[n],i);jt(e,t,n,i)}function jt(e,t,n,i){const{extends:r,mixins:s}=n,o=n[e];if(r&&jt(e,t,r,i),s)for(let n=0;n<s.length;n++)jt(e,t,s[n],i);o&&l(o.bind(i.proxy),i,t)}function Vt(e,t,n,i,r){for(let s=0;s<t.length;s++)Nt(e,t[s],n,i,r,!0)}function Bt(e,t,n){Ft=!1;const s=t.call(n,n);Ft=!0,Object(r.u)(s)&&(e.data===r.b?e.data=Object(i.i)(s):Object(r.h)(e.data,s))}function Ut(e,t,n,i){const s=i.includes(".")?function(e,t){const n=t.split(".");return()=>{let t=e;for(let e=0;e<n.length&&t;e++)t=t[n[e]];return t}}(n,i):()=>n[i];if(Object(r.B)(e)){const n=t[e];Object(r.o)(n)&&ye(s,n)}else if(Object(r.o)(e))ye(s,e.bind(n));else if(Object(r.u)(e))if(Object(r.n)(e))e.forEach(e=>Ut(e,t,n,i));else{const i=Object(r.o)(e.handler)?e.handler.bind(n):t[e.handler];Object(r.o)(i)&&ye(s,i,e)}else 0}function Wt(e,t,n){const i=n.appContext.config.optionMergeStrategies,{mixins:s,extends:o}=t;o&&Wt(e,o,n),s&&s.forEach(t=>Wt(e,t,n));for(const s in t)i&&Object(r.k)(i,s)?e[s]=i[s](e[s],t[s],n.proxy,s):e[s]=t[s]}const Ht=e=>e?Qt(e)?e.exposed?e.exposed:e.proxy:Ht(e.parent):null,qt=Object(r.h)(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ht(e.parent),$root:e=>Ht(e.root),$emit:e=>e.emit,$options:e=>__VUE_OPTIONS_API__?function(e){const t=e.type,{__merged:n,mixins:i,extends:r}=t;if(n)return n;const s=e.appContext.mixins;if(!s.length&&!i&&!r)return t;const o={};return s.forEach(t=>Wt(o,t,e)),Wt(o,t,e),t.__merged=o}(e):e.type,$forceUpdate:e=>()=>k(e.update),$nextTick:e=>A.bind(e.proxy),$watch:e=>__VUE_OPTIONS_API__?we.bind(e):r.d}),$t={get({_:e},t){const{ctx:n,setupState:s,data:o,props:a,accessCache:c,type:l,appContext:d}=e;if("__v_skip"===t)return!0;let u;if("$"!==t[0]){const i=c[t];if(void 0!==i)switch(i){case 0:return s[t];case 1:return o[t];case 3:return n[t];case 2:return a[t]}else{if(s!==r.b&&Object(r.k)(s,t))return c[t]=0,s[t];if(o!==r.b&&Object(r.k)(o,t))return c[t]=1,o[t];if((u=e.propsOptions[0])&&Object(r.k)(u,t))return c[t]=2,a[t];if(n!==r.b&&Object(r.k)(n,t))return c[t]=3,n[t];__VUE_OPTIONS_API__&&!Ft||(c[t]=4)}}const h=qt[t];let p,f;return h?("$attrs"===t&&Object(i.p)(e,"get",t),h(e)):(p=l.__cssModules)&&(p=p[t])?p:n!==r.b&&Object(r.k)(n,t)?(c[t]=3,n[t]):(f=d.config.globalProperties,Object(r.k)(f,t)?f[t]:void 0)},set({_:e},t,n){const{data:i,setupState:s,ctx:o}=e;if(s!==r.b&&Object(r.k)(s,t))s[t]=n;else if(i!==r.b&&Object(r.k)(i,t))i[t]=n;else if(Object(r.k)(e.props,t))return!1;return("$"!==t[0]||!(t.slice(1)in e))&&(o[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:s,propsOptions:o}},a){let c;return void 0!==n[a]||e!==r.b&&Object(r.k)(e,a)||t!==r.b&&Object(r.k)(t,a)||(c=o[0])&&Object(r.k)(c,a)||Object(r.k)(i,a)||Object(r.k)(qt,a)||Object(r.k)(s.config.globalProperties,a)}};const Gt=Object(r.h)({},$t,{get(e,t){if(t!==Symbol.unscopables)return $t.get(e,t,e)},has:(e,t)=>"_"!==t[0]&&!Object(r.p)(t)});const Kt=Ge();let zt=0;let Yt=null;const Jt=()=>Yt||H,Xt=e=>{Yt=e};function Qt(e){return 4&e.vnode.shapeFlag}let Zt,en=!1;function tn(e,t,n){Object(r.o)(t)?e.render=t:Object(r.u)(t)&&(__VUE_PROD_DEVTOOLS__&&(e.devtoolsRawSetupState=t),e.setupState=Object(i.h)(t)),rn(e,n)}const nn=()=>!Zt;function rn(e,t){const n=e.type;e.render||(Zt&&n.template&&!n.render&&(n.render=Zt(n.template,{isCustomElement:e.appContext.config.isCustomElement,delimiters:n.delimiters})),e.render=n.render||r.d,e.render._rc&&(e.withProxy=new Proxy(e.ctx,Gt))),__VUE_OPTIONS_API__&&(Yt=e,Object(i.g)(),Nt(e,n),Object(i.k)(),Yt=null)}function sn(e){const t=t=>{e.exposed=Object(i.h)(t)};return{attrs:e.attrs,slots:e.slots,emit:e.emit,expose:t}}function on(e,t=Yt){t&&(t.effects||(t.effects=[])).push(e)}const an=/(?:^|[-_])(\w)/g;function cn(e){return Object(r.o)(e)&&e.displayName||e.name}function ln(e,t,n=!1){let i=cn(t);if(!i&&t.__file){const e=t.__file.match(/([^/\\]+)\.\w+$/);e&&(i=e[1])}if(!i&&e&&e.parent){const n=e=>{for(const n in e)if(e[n]===t)return n};i=n(e.components||e.parent.type.components)||n(e.appContext.components)}return i?i.replace(an,e=>e.toUpperCase()).replace(/[-_]/g,""):n?"App":"Anonymous"}function dn(e){return Object(r.o)(e)&&"__vccOpts"in e}function un(e){const t=Object(i.a)(e);return on(t.effect),t}function hn(e,t,n){const i=arguments.length;return 2===i?Object(r.u)(t)&&!Object(r.n)(t)?Ct(t)?Tt(e,null,[t]):Tt(e,t):Tt(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):3===i&&Ct(n)&&(n=[n]),Tt(e,t,n))}Symbol("");function pn(e,t){let n;if(Object(r.n)(e)||Object(r.B)(e)){n=new Array(e.length);for(let i=0,r=e.length;i<r;i++)n[i]=t(e[i],i)}else if("number"==typeof e){0,n=new Array(e);for(let i=0;i<e;i++)n[i]=t(i+1,i)}else if(Object(r.u)(e))if(e[Symbol.iterator])n=Array.from(e,t);else{const i=Object.keys(e);n=new Array(i.length);for(let r=0,s=i.length;r<s;r++){const s=i[r];n[r]=t(e[s],s,r)}}else n=[];return n}const fn="3.0.11"},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(43);t.default=class{constructor(e){this.logger=e,this.taskName="BaseTask",this.parentTask=null,this.status=r.default.IDLE,this.run=this.baseRun.bind(this,this.run),this.cancel=this.baseCancel.bind(this,this.cancel)}cancel(){}name(){return this.parentTask?`${this.parentTask.name()}/${this.taskName}`:this.taskName}setParent(e){this.parentTask=e}getStatus(){return this.status}logAndThrow(e){throw this.logger.info(e),new Error(e)}baseRun(e){return i(this,void 0,void 0,(function*(){try{const t=Date.now();switch(this.logger.info("running task "+this.name()),this.status){case r.default.RUNNING:this.logAndThrow(this.name()+" is already running");case r.default.CANCELED:this.logAndThrow(this.name()+" was canceled before running");case r.default.FINISHED:this.logAndThrow(this.name()+" was already finished")}this.status=r.default.RUNNING,yield e.call(this),this.logger.info(`${this.name()} took ${Math.round(Date.now()-t)} ms`)}catch(e){throw e}finally{this.status!==r.default.CANCELED&&(this.status=r.default.FINISHED)}}))}baseCancel(e){this.status!==r.default.CANCELED&&this.status!==r.default.FINISHED&&(this.logger.info("canceling task "+this.name()),this.status=r.default.CANCELED,e.call(this))}}},function(e,t,n){"use strict";var i,r,s=n(202),o=s.Reader,a=s.Writer,c=s.util,l=s.roots.default||(s.roots.default={});l.SdkSignalFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}var t,n;return e.prototype.timestampMs=c.Long?c.Long.fromBits(0,0,!0):0,e.prototype.type=1,e.prototype.error=null,e.prototype.join=null,e.prototype.joinack=null,e.prototype.sub=null,e.prototype.suback=null,e.prototype.index=null,e.prototype.pause=null,e.prototype.leave=null,e.prototype.leaveAck=null,e.prototype.bitrates=null,e.prototype.audioControl=null,e.prototype.audioMetadata=null,e.prototype.audioStreamIdInfo=null,e.prototype.pingPong=null,e.prototype.audioStatus=null,e.prototype.clientMetric=null,e.prototype.dataMessage=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).uint64(e.timestampMs),t.uint32(16).int32(e.type),null!=e.error&&e.hasOwnProperty("error")&&l.SdkErrorFrame.encode(e.error,t.uint32(26).fork()).ldelim(),null!=e.join&&e.hasOwnProperty("join")&&l.SdkJoinFrame.encode(e.join,t.uint32(34).fork()).ldelim(),null!=e.joinack&&e.hasOwnProperty("joinack")&&l.SdkJoinAckFrame.encode(e.joinack,t.uint32(42).fork()).ldelim(),null!=e.sub&&e.hasOwnProperty("sub")&&l.SdkSubscribeFrame.encode(e.sub,t.uint32(50).fork()).ldelim(),null!=e.suback&&e.hasOwnProperty("suback")&&l.SdkSubscribeAckFrame.encode(e.suback,t.uint32(58).fork()).ldelim(),null!=e.index&&e.hasOwnProperty("index")&&l.SdkIndexFrame.encode(e.index,t.uint32(66).fork()).ldelim(),null!=e.pause&&e.hasOwnProperty("pause")&&l.SdkPauseResumeFrame.encode(e.pause,t.uint32(82).fork()).ldelim(),null!=e.leave&&e.hasOwnProperty("leave")&&l.SdkLeaveFrame.encode(e.leave,t.uint32(90).fork()).ldelim(),null!=e.leaveAck&&e.hasOwnProperty("leaveAck")&&l.SdkLeaveAckFrame.encode(e.leaveAck,t.uint32(98).fork()).ldelim(),null!=e.bitrates&&e.hasOwnProperty("bitrates")&&l.SdkBitrateFrame.encode(e.bitrates,t.uint32(114).fork()).ldelim(),null!=e.audioControl&&e.hasOwnProperty("audioControl")&&l.SdkAudioControlFrame.encode(e.audioControl,t.uint32(138).fork()).ldelim(),null!=e.audioMetadata&&e.hasOwnProperty("audioMetadata")&&l.SdkAudioMetadataFrame.encode(e.audioMetadata,t.uint32(146).fork()).ldelim(),null!=e.audioStreamIdInfo&&e.hasOwnProperty("audioStreamIdInfo")&&l.SdkAudioStreamIdInfoFrame.encode(e.audioStreamIdInfo,t.uint32(154).fork()).ldelim(),null!=e.pingPong&&e.hasOwnProperty("pingPong")&&l.SdkPingPongFrame.encode(e.pingPong,t.uint32(162).fork()).ldelim(),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&l.SdkAudioStatusFrame.encode(e.audioStatus,t.uint32(170).fork()).ldelim(),null!=e.clientMetric&&e.hasOwnProperty("clientMetric")&&l.SdkClientMetricFrame.encode(e.clientMetric,t.uint32(178).fork()).ldelim(),null!=e.dataMessage&&e.hasOwnProperty("dataMessage")&&l.SdkDataMessageFrame.encode(e.dataMessage,t.uint32(186).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkSignalFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.timestampMs=e.uint64();break;case 2:i.type=e.int32();break;case 3:i.error=l.SdkErrorFrame.decode(e,e.uint32());break;case 4:i.join=l.SdkJoinFrame.decode(e,e.uint32());break;case 5:i.joinack=l.SdkJoinAckFrame.decode(e,e.uint32());break;case 6:i.sub=l.SdkSubscribeFrame.decode(e,e.uint32());break;case 7:i.suback=l.SdkSubscribeAckFrame.decode(e,e.uint32());break;case 8:i.index=l.SdkIndexFrame.decode(e,e.uint32());break;case 10:i.pause=l.SdkPauseResumeFrame.decode(e,e.uint32());break;case 11:i.leave=l.SdkLeaveFrame.decode(e,e.uint32());break;case 12:i.leaveAck=l.SdkLeaveAckFrame.decode(e,e.uint32());break;case 14:i.bitrates=l.SdkBitrateFrame.decode(e,e.uint32());break;case 17:i.audioControl=l.SdkAudioControlFrame.decode(e,e.uint32());break;case 18:i.audioMetadata=l.SdkAudioMetadataFrame.decode(e,e.uint32());break;case 19:i.audioStreamIdInfo=l.SdkAudioStreamIdInfoFrame.decode(e,e.uint32());break;case 20:i.pingPong=l.SdkPingPongFrame.decode(e,e.uint32());break;case 21:i.audioStatus=l.SdkAudioStatusFrame.decode(e,e.uint32());break;case 22:i.clientMetric=l.SdkClientMetricFrame.decode(e,e.uint32());break;case 23:i.dataMessage=l.SdkDataMessageFrame.decode(e,e.uint32());break;default:e.skipType(7&r)}}if(!i.hasOwnProperty("timestampMs"))throw c.ProtocolError("missing required 'timestampMs'",{instance:i});if(!i.hasOwnProperty("type"))throw c.ProtocolError("missing required 'type'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(!(c.isInteger(e.timestampMs)||e.timestampMs&&c.isInteger(e.timestampMs.low)&&c.isInteger(e.timestampMs.high)))return"timestampMs: integer|Long expected";switch(e.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 7:case 8:case 9:case 10:case 13:case 16:case 17:case 18:case 19:case 20:case 21:case 22:}var t;if(null!=e.error&&e.hasOwnProperty("error")&&(t=l.SdkErrorFrame.verify(e.error)))return"error."+t;if(null!=e.join&&e.hasOwnProperty("join")&&(t=l.SdkJoinFrame.verify(e.join)))return"join."+t;if(null!=e.joinack&&e.hasOwnProperty("joinack")&&(t=l.SdkJoinAckFrame.verify(e.joinack)))return"joinack."+t;if(null!=e.sub&&e.hasOwnProperty("sub")&&(t=l.SdkSubscribeFrame.verify(e.sub)))return"sub."+t;if(null!=e.suback&&e.hasOwnProperty("suback")&&(t=l.SdkSubscribeAckFrame.verify(e.suback)))return"suback."+t;if(null!=e.index&&e.hasOwnProperty("index")&&(t=l.SdkIndexFrame.verify(e.index)))return"index."+t;if(null!=e.pause&&e.hasOwnProperty("pause")&&(t=l.SdkPauseResumeFrame.verify(e.pause)))return"pause."+t;if(null!=e.leave&&e.hasOwnProperty("leave")&&(t=l.SdkLeaveFrame.verify(e.leave)))return"leave."+t;if(null!=e.leaveAck&&e.hasOwnProperty("leaveAck")&&(t=l.SdkLeaveAckFrame.verify(e.leaveAck)))return"leaveAck."+t;if(null!=e.bitrates&&e.hasOwnProperty("bitrates")&&(t=l.SdkBitrateFrame.verify(e.bitrates)))return"bitrates."+t;if(null!=e.audioControl&&e.hasOwnProperty("audioControl")&&(t=l.SdkAudioControlFrame.verify(e.audioControl)))return"audioControl."+t;if(null!=e.audioMetadata&&e.hasOwnProperty("audioMetadata")&&(t=l.SdkAudioMetadataFrame.verify(e.audioMetadata)))return"audioMetadata."+t;if(null!=e.audioStreamIdInfo&&e.hasOwnProperty("audioStreamIdInfo")&&(t=l.SdkAudioStreamIdInfoFrame.verify(e.audioStreamIdInfo)))return"audioStreamIdInfo."+t;if(null!=e.pingPong&&e.hasOwnProperty("pingPong")&&(t=l.SdkPingPongFrame.verify(e.pingPong)))return"pingPong."+t;if(null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&(t=l.SdkAudioStatusFrame.verify(e.audioStatus)))return"audioStatus."+t;if(null!=e.clientMetric&&e.hasOwnProperty("clientMetric")&&(t=l.SdkClientMetricFrame.verify(e.clientMetric)))return"clientMetric."+t;if(null!=e.dataMessage&&e.hasOwnProperty("dataMessage")&&(t=l.SdkDataMessageFrame.verify(e.dataMessage)))return"dataMessage."+t;return null},e.fromObject=function(e){if(e instanceof l.SdkSignalFrame)return e;var t=new l.SdkSignalFrame;switch(null!=e.timestampMs&&(c.Long?(t.timestampMs=c.Long.fromValue(e.timestampMs)).unsigned=!0:"string"==typeof e.timestampMs?t.timestampMs=parseInt(e.timestampMs,10):"number"==typeof e.timestampMs?t.timestampMs=e.timestampMs:"object"==typeof e.timestampMs&&(t.timestampMs=new c.LongBits(e.timestampMs.low>>>0,e.timestampMs.high>>>0).toNumber(!0))),e.type){case"JOIN":case 1:t.type=1;break;case"JOIN_ACK":case 2:t.type=2;break;case"SUBSCRIBE":case 3:t.type=3;break;case"SUBSCRIBE_ACK":case 4:t.type=4;break;case"INDEX":case 5:t.type=5;break;case"PAUSE":case 7:t.type=7;break;case"RESUME":case 8:t.type=8;break;case"LEAVE":case 9:t.type=9;break;case"LEAVE_ACK":case 10:t.type=10;break;case"BITRATES":case 13:t.type=13;break;case"AUDIO_CONTROL":case 16:t.type=16;break;case"AUDIO_METADATA":case 17:t.type=17;break;case"AUDIO_STREAM_ID_INFO":case 18:t.type=18;break;case"PING_PONG":case 19:t.type=19;break;case"AUDIO_STATUS":case 20:t.type=20;break;case"CLIENT_METRIC":case 21:t.type=21;break;case"DATA_MESSAGE":case 22:t.type=22}if(null!=e.error){if("object"!=typeof e.error)throw TypeError(".SdkSignalFrame.error: object expected");t.error=l.SdkErrorFrame.fromObject(e.error)}if(null!=e.join){if("object"!=typeof e.join)throw TypeError(".SdkSignalFrame.join: object expected");t.join=l.SdkJoinFrame.fromObject(e.join)}if(null!=e.joinack){if("object"!=typeof e.joinack)throw TypeError(".SdkSignalFrame.joinack: object expected");t.joinack=l.SdkJoinAckFrame.fromObject(e.joinack)}if(null!=e.sub){if("object"!=typeof e.sub)throw TypeError(".SdkSignalFrame.sub: object expected");t.sub=l.SdkSubscribeFrame.fromObject(e.sub)}if(null!=e.suback){if("object"!=typeof e.suback)throw TypeError(".SdkSignalFrame.suback: object expected");t.suback=l.SdkSubscribeAckFrame.fromObject(e.suback)}if(null!=e.index){if("object"!=typeof e.index)throw TypeError(".SdkSignalFrame.index: object expected");t.index=l.SdkIndexFrame.fromObject(e.index)}if(null!=e.pause){if("object"!=typeof e.pause)throw TypeError(".SdkSignalFrame.pause: object expected");t.pause=l.SdkPauseResumeFrame.fromObject(e.pause)}if(null!=e.leave){if("object"!=typeof e.leave)throw TypeError(".SdkSignalFrame.leave: object expected");t.leave=l.SdkLeaveFrame.fromObject(e.leave)}if(null!=e.leaveAck){if("object"!=typeof e.leaveAck)throw TypeError(".SdkSignalFrame.leaveAck: object expected");t.leaveAck=l.SdkLeaveAckFrame.fromObject(e.leaveAck)}if(null!=e.bitrates){if("object"!=typeof e.bitrates)throw TypeError(".SdkSignalFrame.bitrates: object expected");t.bitrates=l.SdkBitrateFrame.fromObject(e.bitrates)}if(null!=e.audioControl){if("object"!=typeof e.audioControl)throw TypeError(".SdkSignalFrame.audioControl: object expected");t.audioControl=l.SdkAudioControlFrame.fromObject(e.audioControl)}if(null!=e.audioMetadata){if("object"!=typeof e.audioMetadata)throw TypeError(".SdkSignalFrame.audioMetadata: object expected");t.audioMetadata=l.SdkAudioMetadataFrame.fromObject(e.audioMetadata)}if(null!=e.audioStreamIdInfo){if("object"!=typeof e.audioStreamIdInfo)throw TypeError(".SdkSignalFrame.audioStreamIdInfo: object expected");t.audioStreamIdInfo=l.SdkAudioStreamIdInfoFrame.fromObject(e.audioStreamIdInfo)}if(null!=e.pingPong){if("object"!=typeof e.pingPong)throw TypeError(".SdkSignalFrame.pingPong: object expected");t.pingPong=l.SdkPingPongFrame.fromObject(e.pingPong)}if(null!=e.audioStatus){if("object"!=typeof e.audioStatus)throw TypeError(".SdkSignalFrame.audioStatus: object expected");t.audioStatus=l.SdkAudioStatusFrame.fromObject(e.audioStatus)}if(null!=e.clientMetric){if("object"!=typeof e.clientMetric)throw TypeError(".SdkSignalFrame.clientMetric: object expected");t.clientMetric=l.SdkClientMetricFrame.fromObject(e.clientMetric)}if(null!=e.dataMessage){if("object"!=typeof e.dataMessage)throw TypeError(".SdkSignalFrame.dataMessage: object expected");t.dataMessage=l.SdkDataMessageFrame.fromObject(e.dataMessage)}return t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(c.Long){var i=new c.Long(0,0,!0);n.timestampMs=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.timestampMs=t.longs===String?"0":0;n.type=t.enums===String?"JOIN":1,n.error=null,n.join=null,n.joinack=null,n.sub=null,n.suback=null,n.index=null,n.pause=null,n.leave=null,n.leaveAck=null,n.bitrates=null,n.audioControl=null,n.audioMetadata=null,n.audioStreamIdInfo=null,n.pingPong=null,n.audioStatus=null,n.clientMetric=null,n.dataMessage=null}return null!=e.timestampMs&&e.hasOwnProperty("timestampMs")&&("number"==typeof e.timestampMs?n.timestampMs=t.longs===String?String(e.timestampMs):e.timestampMs:n.timestampMs=t.longs===String?c.Long.prototype.toString.call(e.timestampMs):t.longs===Number?new c.LongBits(e.timestampMs.low>>>0,e.timestampMs.high>>>0).toNumber(!0):e.timestampMs),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?l.SdkSignalFrame.Type[e.type]:e.type),null!=e.error&&e.hasOwnProperty("error")&&(n.error=l.SdkErrorFrame.toObject(e.error,t)),null!=e.join&&e.hasOwnProperty("join")&&(n.join=l.SdkJoinFrame.toObject(e.join,t)),null!=e.joinack&&e.hasOwnProperty("joinack")&&(n.joinack=l.SdkJoinAckFrame.toObject(e.joinack,t)),null!=e.sub&&e.hasOwnProperty("sub")&&(n.sub=l.SdkSubscribeFrame.toObject(e.sub,t)),null!=e.suback&&e.hasOwnProperty("suback")&&(n.suback=l.SdkSubscribeAckFrame.toObject(e.suback,t)),null!=e.index&&e.hasOwnProperty("index")&&(n.index=l.SdkIndexFrame.toObject(e.index,t)),null!=e.pause&&e.hasOwnProperty("pause")&&(n.pause=l.SdkPauseResumeFrame.toObject(e.pause,t)),null!=e.leave&&e.hasOwnProperty("leave")&&(n.leave=l.SdkLeaveFrame.toObject(e.leave,t)),null!=e.leaveAck&&e.hasOwnProperty("leaveAck")&&(n.leaveAck=l.SdkLeaveAckFrame.toObject(e.leaveAck,t)),null!=e.bitrates&&e.hasOwnProperty("bitrates")&&(n.bitrates=l.SdkBitrateFrame.toObject(e.bitrates,t)),null!=e.audioControl&&e.hasOwnProperty("audioControl")&&(n.audioControl=l.SdkAudioControlFrame.toObject(e.audioControl,t)),null!=e.audioMetadata&&e.hasOwnProperty("audioMetadata")&&(n.audioMetadata=l.SdkAudioMetadataFrame.toObject(e.audioMetadata,t)),null!=e.audioStreamIdInfo&&e.hasOwnProperty("audioStreamIdInfo")&&(n.audioStreamIdInfo=l.SdkAudioStreamIdInfoFrame.toObject(e.audioStreamIdInfo,t)),null!=e.pingPong&&e.hasOwnProperty("pingPong")&&(n.pingPong=l.SdkPingPongFrame.toObject(e.pingPong,t)),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&(n.audioStatus=l.SdkAudioStatusFrame.toObject(e.audioStatus,t)),null!=e.clientMetric&&e.hasOwnProperty("clientMetric")&&(n.clientMetric=l.SdkClientMetricFrame.toObject(e.clientMetric,t)),null!=e.dataMessage&&e.hasOwnProperty("dataMessage")&&(n.dataMessage=l.SdkDataMessageFrame.toObject(e.dataMessage,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Type=(t={},(n=Object.create(t))[t[1]="JOIN"]=1,n[t[2]="JOIN_ACK"]=2,n[t[3]="SUBSCRIBE"]=3,n[t[4]="SUBSCRIBE_ACK"]=4,n[t[5]="INDEX"]=5,n[t[7]="PAUSE"]=7,n[t[8]="RESUME"]=8,n[t[9]="LEAVE"]=9,n[t[10]="LEAVE_ACK"]=10,n[t[13]="BITRATES"]=13,n[t[16]="AUDIO_CONTROL"]=16,n[t[17]="AUDIO_METADATA"]=17,n[t[18]="AUDIO_STREAM_ID_INFO"]=18,n[t[19]="PING_PONG"]=19,n[t[20]="AUDIO_STATUS"]=20,n[t[21]="CLIENT_METRIC"]=21,n[t[22]="DATA_MESSAGE"]=22,n),e}(),l.SdkErrorFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.status=0,e.prototype.description="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.status&&e.hasOwnProperty("status")&&t.uint32(8).uint32(e.status),null!=e.description&&e.hasOwnProperty("description")&&t.uint32(18).string(e.description),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkErrorFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.status=e.uint32();break;case 2:i.description=e.string();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.status&&e.hasOwnProperty("status")&&!c.isInteger(e.status)?"status: integer expected":null!=e.description&&e.hasOwnProperty("description")&&!c.isString(e.description)?"description: string expected":null},e.fromObject=function(e){if(e instanceof l.SdkErrorFrame)return e;var t=new l.SdkErrorFrame;return null!=e.status&&(t.status=e.status>>>0),null!=e.description&&(t.description=String(e.description)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.status=0,n.description=""),null!=e.status&&e.hasOwnProperty("status")&&(n.status=e.status),null!=e.description&&e.hasOwnProperty("description")&&(n.description=e.description),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkJoinFlags=(i={},(r=Object.create(i))[i[1]="SEND_BITRATES"]=1,r[i[2]="HAS_STREAM_UPDATE"]=2,r[i[8]="USE_SEND_SIDE_BWE"]=8,r[i[16]="COMPLETE_VIDEO_SOURCES_LIST"]=16,r[i[32]="EXCLUDE_SELF_CONTENT_IN_INDEX"]=32,r),l.SdkClientDetails=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.appVersionName="",e.prototype.appVersionCode="",e.prototype.deviceModel="",e.prototype.deviceMake="",e.prototype.platformName="",e.prototype.platformVersion="",e.prototype.clientSource="",e.prototype.chimeSdkVersion="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.appVersionName&&e.hasOwnProperty("appVersionName")&&t.uint32(10).string(e.appVersionName),null!=e.appVersionCode&&e.hasOwnProperty("appVersionCode")&&t.uint32(18).string(e.appVersionCode),null!=e.deviceModel&&e.hasOwnProperty("deviceModel")&&t.uint32(26).string(e.deviceModel),null!=e.deviceMake&&e.hasOwnProperty("deviceMake")&&t.uint32(34).string(e.deviceMake),null!=e.platformName&&e.hasOwnProperty("platformName")&&t.uint32(42).string(e.platformName),null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&t.uint32(50).string(e.platformVersion),null!=e.clientSource&&e.hasOwnProperty("clientSource")&&t.uint32(58).string(e.clientSource),null!=e.chimeSdkVersion&&e.hasOwnProperty("chimeSdkVersion")&&t.uint32(66).string(e.chimeSdkVersion),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkClientDetails;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.appVersionName=e.string();break;case 2:i.appVersionCode=e.string();break;case 3:i.deviceModel=e.string();break;case 4:i.deviceMake=e.string();break;case 5:i.platformName=e.string();break;case 6:i.platformVersion=e.string();break;case 7:i.clientSource=e.string();break;case 8:i.chimeSdkVersion=e.string();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.appVersionName&&e.hasOwnProperty("appVersionName")&&!c.isString(e.appVersionName)?"appVersionName: string expected":null!=e.appVersionCode&&e.hasOwnProperty("appVersionCode")&&!c.isString(e.appVersionCode)?"appVersionCode: string expected":null!=e.deviceModel&&e.hasOwnProperty("deviceModel")&&!c.isString(e.deviceModel)?"deviceModel: string expected":null!=e.deviceMake&&e.hasOwnProperty("deviceMake")&&!c.isString(e.deviceMake)?"deviceMake: string expected":null!=e.platformName&&e.hasOwnProperty("platformName")&&!c.isString(e.platformName)?"platformName: string expected":null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&!c.isString(e.platformVersion)?"platformVersion: string expected":null!=e.clientSource&&e.hasOwnProperty("clientSource")&&!c.isString(e.clientSource)?"clientSource: string expected":null!=e.chimeSdkVersion&&e.hasOwnProperty("chimeSdkVersion")&&!c.isString(e.chimeSdkVersion)?"chimeSdkVersion: string expected":null},e.fromObject=function(e){if(e instanceof l.SdkClientDetails)return e;var t=new l.SdkClientDetails;return null!=e.appVersionName&&(t.appVersionName=String(e.appVersionName)),null!=e.appVersionCode&&(t.appVersionCode=String(e.appVersionCode)),null!=e.deviceModel&&(t.deviceModel=String(e.deviceModel)),null!=e.deviceMake&&(t.deviceMake=String(e.deviceMake)),null!=e.platformName&&(t.platformName=String(e.platformName)),null!=e.platformVersion&&(t.platformVersion=String(e.platformVersion)),null!=e.clientSource&&(t.clientSource=String(e.clientSource)),null!=e.chimeSdkVersion&&(t.chimeSdkVersion=String(e.chimeSdkVersion)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.appVersionName="",n.appVersionCode="",n.deviceModel="",n.deviceMake="",n.platformName="",n.platformVersion="",n.clientSource="",n.chimeSdkVersion=""),null!=e.appVersionName&&e.hasOwnProperty("appVersionName")&&(n.appVersionName=e.appVersionName),null!=e.appVersionCode&&e.hasOwnProperty("appVersionCode")&&(n.appVersionCode=e.appVersionCode),null!=e.deviceModel&&e.hasOwnProperty("deviceModel")&&(n.deviceModel=e.deviceModel),null!=e.deviceMake&&e.hasOwnProperty("deviceMake")&&(n.deviceMake=e.deviceMake),null!=e.platformName&&e.hasOwnProperty("platformName")&&(n.platformName=e.platformName),null!=e.platformVersion&&e.hasOwnProperty("platformVersion")&&(n.platformVersion=e.platformVersion),null!=e.clientSource&&e.hasOwnProperty("clientSource")&&(n.clientSource=e.clientSource),null!=e.chimeSdkVersion&&e.hasOwnProperty("chimeSdkVersion")&&(n.chimeSdkVersion=e.chimeSdkVersion),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkJoinFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.protocolVersion=2,e.prototype.maxNumOfVideos=8,e.prototype.flags=0,e.prototype.clientDetails=null,e.prototype.audioSessionId=c.Long?c.Long.fromBits(0,0,!0):0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&t.uint32(8).uint32(e.protocolVersion),null!=e.maxNumOfVideos&&e.hasOwnProperty("maxNumOfVideos")&&t.uint32(16).uint32(e.maxNumOfVideos),null!=e.flags&&e.hasOwnProperty("flags")&&t.uint32(24).uint32(e.flags),null!=e.clientDetails&&e.hasOwnProperty("clientDetails")&&l.SdkClientDetails.encode(e.clientDetails,t.uint32(34).fork()).ldelim(),null!=e.audioSessionId&&e.hasOwnProperty("audioSessionId")&&t.uint32(48).uint64(e.audioSessionId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkJoinFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.protocolVersion=e.uint32();break;case 2:i.maxNumOfVideos=e.uint32();break;case 3:i.flags=e.uint32();break;case 4:i.clientDetails=l.SdkClientDetails.decode(e,e.uint32());break;case 6:i.audioSessionId=e.uint64();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&!c.isInteger(e.protocolVersion))return"protocolVersion: integer expected";if(null!=e.maxNumOfVideos&&e.hasOwnProperty("maxNumOfVideos")&&!c.isInteger(e.maxNumOfVideos))return"maxNumOfVideos: integer expected";if(null!=e.flags&&e.hasOwnProperty("flags")&&!c.isInteger(e.flags))return"flags: integer expected";if(null!=e.clientDetails&&e.hasOwnProperty("clientDetails")){var t=l.SdkClientDetails.verify(e.clientDetails);if(t)return"clientDetails."+t}return null!=e.audioSessionId&&e.hasOwnProperty("audioSessionId")&&!(c.isInteger(e.audioSessionId)||e.audioSessionId&&c.isInteger(e.audioSessionId.low)&&c.isInteger(e.audioSessionId.high))?"audioSessionId: integer|Long expected":null},e.fromObject=function(e){if(e instanceof l.SdkJoinFrame)return e;var t=new l.SdkJoinFrame;if(null!=e.protocolVersion&&(t.protocolVersion=e.protocolVersion>>>0),null!=e.maxNumOfVideos&&(t.maxNumOfVideos=e.maxNumOfVideos>>>0),null!=e.flags&&(t.flags=e.flags>>>0),null!=e.clientDetails){if("object"!=typeof e.clientDetails)throw TypeError(".SdkJoinFrame.clientDetails: object expected");t.clientDetails=l.SdkClientDetails.fromObject(e.clientDetails)}return null!=e.audioSessionId&&(c.Long?(t.audioSessionId=c.Long.fromValue(e.audioSessionId)).unsigned=!0:"string"==typeof e.audioSessionId?t.audioSessionId=parseInt(e.audioSessionId,10):"number"==typeof e.audioSessionId?t.audioSessionId=e.audioSessionId:"object"==typeof e.audioSessionId&&(t.audioSessionId=new c.LongBits(e.audioSessionId.low>>>0,e.audioSessionId.high>>>0).toNumber(!0))),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults)if(n.protocolVersion=2,n.maxNumOfVideos=8,n.flags=0,n.clientDetails=null,c.Long){var i=new c.Long(0,0,!0);n.audioSessionId=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.audioSessionId=t.longs===String?"0":0;return null!=e.protocolVersion&&e.hasOwnProperty("protocolVersion")&&(n.protocolVersion=e.protocolVersion),null!=e.maxNumOfVideos&&e.hasOwnProperty("maxNumOfVideos")&&(n.maxNumOfVideos=e.maxNumOfVideos),null!=e.flags&&e.hasOwnProperty("flags")&&(n.flags=e.flags),null!=e.clientDetails&&e.hasOwnProperty("clientDetails")&&(n.clientDetails=l.SdkClientDetails.toObject(e.clientDetails,t)),null!=e.audioSessionId&&e.hasOwnProperty("audioSessionId")&&("number"==typeof e.audioSessionId?n.audioSessionId=t.longs===String?String(e.audioSessionId):e.audioSessionId:n.audioSessionId=t.longs===String?c.Long.prototype.toString.call(e.audioSessionId):t.longs===Number?new c.LongBits(e.audioSessionId.low>>>0,e.audioSessionId.high>>>0).toNumber(!0):e.audioSessionId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkJoinAckFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.turnCredentials=null,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.turnCredentials&&e.hasOwnProperty("turnCredentials")&&l.SdkTurnCredentials.encode(e.turnCredentials,t.uint32(10).fork()).ldelim(),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkJoinAckFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.turnCredentials=l.SdkTurnCredentials.decode(e,e.uint32());break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.turnCredentials&&e.hasOwnProperty("turnCredentials")){var t=l.SdkTurnCredentials.verify(e.turnCredentials);if(t)return"turnCredentials."+t}return null},e.fromObject=function(e){if(e instanceof l.SdkJoinAckFrame)return e;var t=new l.SdkJoinAckFrame;if(null!=e.turnCredentials){if("object"!=typeof e.turnCredentials)throw TypeError(".SdkJoinAckFrame.turnCredentials: object expected");t.turnCredentials=l.SdkTurnCredentials.fromObject(e.turnCredentials)}return t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.turnCredentials=null),null!=e.turnCredentials&&e.hasOwnProperty("turnCredentials")&&(n.turnCredentials=l.SdkTurnCredentials.toObject(e.turnCredentials,t)),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkLeaveFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkLeaveFrame;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof l.SdkLeaveFrame?e:new l.SdkLeaveFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkLeaveAckFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkLeaveAckFrame;e.pos<n;){var r=e.uint32();e.skipType(7&r)}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null},e.fromObject=function(e){return e instanceof l.SdkLeaveAckFrame?e:new l.SdkLeaveAckFrame},e.toObject=function(){return{}},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkStreamServiceType=function(){var e={},t=Object.create(e);return t[e[1]="RX"]=1,t[e[2]="TX"]=2,t[e[3]="DUPLEX"]=3,t}(),l.SdkStreamMediaType=function(){var e={},t=Object.create(e);return t[e[1]="AUDIO"]=1,t[e[2]="VIDEO"]=2,t}(),l.SdkSubscribeFrame=function(){function e(e){if(this.sendStreams=[],this.receiveStreamIds=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.duplex=1,e.prototype.sendStreams=c.emptyArray,e.prototype.receiveStreamIds=c.emptyArray,e.prototype.sdpOffer="",e.prototype.audioHost="",e.prototype.audioCheckin=!1,e.prototype.audioMuted=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.duplex&&e.hasOwnProperty("duplex")&&t.uint32(8).int32(e.duplex),null!=e.sendStreams&&e.sendStreams.length)for(var n=0;n<e.sendStreams.length;++n)l.SdkStreamDescriptor.encode(e.sendStreams[n],t.uint32(18).fork()).ldelim();if(null!=e.receiveStreamIds&&e.receiveStreamIds.length)for(n=0;n<e.receiveStreamIds.length;++n)t.uint32(24).uint32(e.receiveStreamIds[n]);return null!=e.sdpOffer&&e.hasOwnProperty("sdpOffer")&&t.uint32(34).string(e.sdpOffer),null!=e.audioHost&&e.hasOwnProperty("audioHost")&&t.uint32(42).string(e.audioHost),null!=e.audioCheckin&&e.hasOwnProperty("audioCheckin")&&t.uint32(48).bool(e.audioCheckin),null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&t.uint32(56).bool(e.audioMuted),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkSubscribeFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.duplex=e.int32();break;case 2:i.sendStreams&&i.sendStreams.length||(i.sendStreams=[]),i.sendStreams.push(l.SdkStreamDescriptor.decode(e,e.uint32()));break;case 3:if(i.receiveStreamIds&&i.receiveStreamIds.length||(i.receiveStreamIds=[]),2==(7&r))for(var s=e.uint32()+e.pos;e.pos<s;)i.receiveStreamIds.push(e.uint32());else i.receiveStreamIds.push(e.uint32());break;case 4:i.sdpOffer=e.string();break;case 5:i.audioHost=e.string();break;case 6:i.audioCheckin=e.bool();break;case 7:i.audioMuted=e.bool();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.duplex&&e.hasOwnProperty("duplex"))switch(e.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:}if(null!=e.sendStreams&&e.hasOwnProperty("sendStreams")){if(!Array.isArray(e.sendStreams))return"sendStreams: array expected";for(var t=0;t<e.sendStreams.length;++t){var n=l.SdkStreamDescriptor.verify(e.sendStreams[t]);if(n)return"sendStreams."+n}}if(null!=e.receiveStreamIds&&e.hasOwnProperty("receiveStreamIds")){if(!Array.isArray(e.receiveStreamIds))return"receiveStreamIds: array expected";for(t=0;t<e.receiveStreamIds.length;++t)if(!c.isInteger(e.receiveStreamIds[t]))return"receiveStreamIds: integer[] expected"}return null!=e.sdpOffer&&e.hasOwnProperty("sdpOffer")&&!c.isString(e.sdpOffer)?"sdpOffer: string expected":null!=e.audioHost&&e.hasOwnProperty("audioHost")&&!c.isString(e.audioHost)?"audioHost: string expected":null!=e.audioCheckin&&e.hasOwnProperty("audioCheckin")&&"boolean"!=typeof e.audioCheckin?"audioCheckin: boolean expected":null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&"boolean"!=typeof e.audioMuted?"audioMuted: boolean expected":null},e.fromObject=function(e){if(e instanceof l.SdkSubscribeFrame)return e;var t=new l.SdkSubscribeFrame;switch(e.duplex){case"RX":case 1:t.duplex=1;break;case"TX":case 2:t.duplex=2;break;case"DUPLEX":case 3:t.duplex=3}if(e.sendStreams){if(!Array.isArray(e.sendStreams))throw TypeError(".SdkSubscribeFrame.sendStreams: array expected");t.sendStreams=[];for(var n=0;n<e.sendStreams.length;++n){if("object"!=typeof e.sendStreams[n])throw TypeError(".SdkSubscribeFrame.sendStreams: object expected");t.sendStreams[n]=l.SdkStreamDescriptor.fromObject(e.sendStreams[n])}}if(e.receiveStreamIds){if(!Array.isArray(e.receiveStreamIds))throw TypeError(".SdkSubscribeFrame.receiveStreamIds: array expected");t.receiveStreamIds=[];for(n=0;n<e.receiveStreamIds.length;++n)t.receiveStreamIds[n]=e.receiveStreamIds[n]>>>0}return null!=e.sdpOffer&&(t.sdpOffer=String(e.sdpOffer)),null!=e.audioHost&&(t.audioHost=String(e.audioHost)),null!=e.audioCheckin&&(t.audioCheckin=Boolean(e.audioCheckin)),null!=e.audioMuted&&(t.audioMuted=Boolean(e.audioMuted)),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.sendStreams=[],n.receiveStreamIds=[]),t.defaults&&(n.duplex=t.enums===String?"RX":1,n.sdpOffer="",n.audioHost="",n.audioCheckin=!1,n.audioMuted=!1),null!=e.duplex&&e.hasOwnProperty("duplex")&&(n.duplex=t.enums===String?l.SdkStreamServiceType[e.duplex]:e.duplex),e.sendStreams&&e.sendStreams.length){n.sendStreams=[];for(var i=0;i<e.sendStreams.length;++i)n.sendStreams[i]=l.SdkStreamDescriptor.toObject(e.sendStreams[i],t)}if(e.receiveStreamIds&&e.receiveStreamIds.length){n.receiveStreamIds=[];for(i=0;i<e.receiveStreamIds.length;++i)n.receiveStreamIds[i]=e.receiveStreamIds[i]}return null!=e.sdpOffer&&e.hasOwnProperty("sdpOffer")&&(n.sdpOffer=e.sdpOffer),null!=e.audioHost&&e.hasOwnProperty("audioHost")&&(n.audioHost=e.audioHost),null!=e.audioCheckin&&e.hasOwnProperty("audioCheckin")&&(n.audioCheckin=e.audioCheckin),null!=e.audioMuted&&e.hasOwnProperty("audioMuted")&&(n.audioMuted=e.audioMuted),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkSubscribeAckFrame=function(){function e(e){if(this.allocations=[],this.tracks=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.duplex=1,e.prototype.allocations=c.emptyArray,e.prototype.sdpAnswer="",e.prototype.tracks=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.duplex&&e.hasOwnProperty("duplex")&&t.uint32(8).int32(e.duplex),null!=e.allocations&&e.allocations.length)for(var n=0;n<e.allocations.length;++n)l.SdkStreamAllocation.encode(e.allocations[n],t.uint32(18).fork()).ldelim();if(null!=e.sdpAnswer&&e.hasOwnProperty("sdpAnswer")&&t.uint32(26).string(e.sdpAnswer),null!=e.tracks&&e.tracks.length)for(n=0;n<e.tracks.length;++n)l.SdkTrackMapping.encode(e.tracks[n],t.uint32(34).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkSubscribeAckFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.duplex=e.int32();break;case 2:i.allocations&&i.allocations.length||(i.allocations=[]),i.allocations.push(l.SdkStreamAllocation.decode(e,e.uint32()));break;case 3:i.sdpAnswer=e.string();break;case 4:i.tracks&&i.tracks.length||(i.tracks=[]),i.tracks.push(l.SdkTrackMapping.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.duplex&&e.hasOwnProperty("duplex"))switch(e.duplex){default:return"duplex: enum value expected";case 1:case 2:case 3:}if(null!=e.allocations&&e.hasOwnProperty("allocations")){if(!Array.isArray(e.allocations))return"allocations: array expected";for(var t=0;t<e.allocations.length;++t){if(n=l.SdkStreamAllocation.verify(e.allocations[t]))return"allocations."+n}}if(null!=e.sdpAnswer&&e.hasOwnProperty("sdpAnswer")&&!c.isString(e.sdpAnswer))return"sdpAnswer: string expected";if(null!=e.tracks&&e.hasOwnProperty("tracks")){if(!Array.isArray(e.tracks))return"tracks: array expected";for(t=0;t<e.tracks.length;++t){var n;if(n=l.SdkTrackMapping.verify(e.tracks[t]))return"tracks."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkSubscribeAckFrame)return e;var t=new l.SdkSubscribeAckFrame;switch(e.duplex){case"RX":case 1:t.duplex=1;break;case"TX":case 2:t.duplex=2;break;case"DUPLEX":case 3:t.duplex=3}if(e.allocations){if(!Array.isArray(e.allocations))throw TypeError(".SdkSubscribeAckFrame.allocations: array expected");t.allocations=[];for(var n=0;n<e.allocations.length;++n){if("object"!=typeof e.allocations[n])throw TypeError(".SdkSubscribeAckFrame.allocations: object expected");t.allocations[n]=l.SdkStreamAllocation.fromObject(e.allocations[n])}}if(null!=e.sdpAnswer&&(t.sdpAnswer=String(e.sdpAnswer)),e.tracks){if(!Array.isArray(e.tracks))throw TypeError(".SdkSubscribeAckFrame.tracks: array expected");t.tracks=[];for(n=0;n<e.tracks.length;++n){if("object"!=typeof e.tracks[n])throw TypeError(".SdkSubscribeAckFrame.tracks: object expected");t.tracks[n]=l.SdkTrackMapping.fromObject(e.tracks[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.allocations=[],n.tracks=[]),t.defaults&&(n.duplex=t.enums===String?"RX":1,n.sdpAnswer=""),null!=e.duplex&&e.hasOwnProperty("duplex")&&(n.duplex=t.enums===String?l.SdkStreamServiceType[e.duplex]:e.duplex),e.allocations&&e.allocations.length){n.allocations=[];for(var i=0;i<e.allocations.length;++i)n.allocations[i]=l.SdkStreamAllocation.toObject(e.allocations[i],t)}if(null!=e.sdpAnswer&&e.hasOwnProperty("sdpAnswer")&&(n.sdpAnswer=e.sdpAnswer),e.tracks&&e.tracks.length){n.tracks=[];for(i=0;i<e.tracks.length;++i)n.tracks[i]=l.SdkTrackMapping.toObject(e.tracks[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkIndexFrame=function(){function e(e){if(this.sources=[],this.pausedAtSourceIds=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.atCapacity=!1,e.prototype.sources=c.emptyArray,e.prototype.pausedAtSourceIds=c.emptyArray,e.prototype.numParticipants=0,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.atCapacity&&e.hasOwnProperty("atCapacity")&&t.uint32(8).bool(e.atCapacity),null!=e.sources&&e.sources.length)for(var n=0;n<e.sources.length;++n)l.SdkStreamDescriptor.encode(e.sources[n],t.uint32(18).fork()).ldelim();if(null!=e.pausedAtSourceIds&&e.pausedAtSourceIds.length)for(n=0;n<e.pausedAtSourceIds.length;++n)t.uint32(24).uint32(e.pausedAtSourceIds[n]);return null!=e.numParticipants&&e.hasOwnProperty("numParticipants")&&t.uint32(32).uint32(e.numParticipants),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkIndexFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.atCapacity=e.bool();break;case 2:i.sources&&i.sources.length||(i.sources=[]),i.sources.push(l.SdkStreamDescriptor.decode(e,e.uint32()));break;case 3:if(i.pausedAtSourceIds&&i.pausedAtSourceIds.length||(i.pausedAtSourceIds=[]),2==(7&r))for(var s=e.uint32()+e.pos;e.pos<s;)i.pausedAtSourceIds.push(e.uint32());else i.pausedAtSourceIds.push(e.uint32());break;case 4:i.numParticipants=e.uint32();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.atCapacity&&e.hasOwnProperty("atCapacity")&&"boolean"!=typeof e.atCapacity)return"atCapacity: boolean expected";if(null!=e.sources&&e.hasOwnProperty("sources")){if(!Array.isArray(e.sources))return"sources: array expected";for(var t=0;t<e.sources.length;++t){var n=l.SdkStreamDescriptor.verify(e.sources[t]);if(n)return"sources."+n}}if(null!=e.pausedAtSourceIds&&e.hasOwnProperty("pausedAtSourceIds")){if(!Array.isArray(e.pausedAtSourceIds))return"pausedAtSourceIds: array expected";for(t=0;t<e.pausedAtSourceIds.length;++t)if(!c.isInteger(e.pausedAtSourceIds[t]))return"pausedAtSourceIds: integer[] expected"}return null!=e.numParticipants&&e.hasOwnProperty("numParticipants")&&!c.isInteger(e.numParticipants)?"numParticipants: integer expected":null},e.fromObject=function(e){if(e instanceof l.SdkIndexFrame)return e;var t=new l.SdkIndexFrame;if(null!=e.atCapacity&&(t.atCapacity=Boolean(e.atCapacity)),e.sources){if(!Array.isArray(e.sources))throw TypeError(".SdkIndexFrame.sources: array expected");t.sources=[];for(var n=0;n<e.sources.length;++n){if("object"!=typeof e.sources[n])throw TypeError(".SdkIndexFrame.sources: object expected");t.sources[n]=l.SdkStreamDescriptor.fromObject(e.sources[n])}}if(e.pausedAtSourceIds){if(!Array.isArray(e.pausedAtSourceIds))throw TypeError(".SdkIndexFrame.pausedAtSourceIds: array expected");t.pausedAtSourceIds=[];for(n=0;n<e.pausedAtSourceIds.length;++n)t.pausedAtSourceIds[n]=e.pausedAtSourceIds[n]>>>0}return null!=e.numParticipants&&(t.numParticipants=e.numParticipants>>>0),t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.sources=[],n.pausedAtSourceIds=[]),t.defaults&&(n.atCapacity=!1,n.numParticipants=0),null!=e.atCapacity&&e.hasOwnProperty("atCapacity")&&(n.atCapacity=e.atCapacity),e.sources&&e.sources.length){n.sources=[];for(var i=0;i<e.sources.length;++i)n.sources[i]=l.SdkStreamDescriptor.toObject(e.sources[i],t)}if(e.pausedAtSourceIds&&e.pausedAtSourceIds.length){n.pausedAtSourceIds=[];for(i=0;i<e.pausedAtSourceIds.length;++i)n.pausedAtSourceIds[i]=e.pausedAtSourceIds[i]}return null!=e.numParticipants&&e.hasOwnProperty("numParticipants")&&(n.numParticipants=e.numParticipants),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkPauseResumeFrame=function(){function e(e){if(this.streamIds=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.streamIds=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.streamIds&&e.streamIds.length)for(var n=0;n<e.streamIds.length;++n)t.uint32(8).uint32(e.streamIds[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkPauseResumeFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:if(i.streamIds&&i.streamIds.length||(i.streamIds=[]),2==(7&r))for(var s=e.uint32()+e.pos;e.pos<s;)i.streamIds.push(e.uint32());else i.streamIds.push(e.uint32());break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamIds&&e.hasOwnProperty("streamIds")){if(!Array.isArray(e.streamIds))return"streamIds: array expected";for(var t=0;t<e.streamIds.length;++t)if(!c.isInteger(e.streamIds[t]))return"streamIds: integer[] expected"}return null},e.fromObject=function(e){if(e instanceof l.SdkPauseResumeFrame)return e;var t=new l.SdkPauseResumeFrame;if(e.streamIds){if(!Array.isArray(e.streamIds))throw TypeError(".SdkPauseResumeFrame.streamIds: array expected");t.streamIds=[];for(var n=0;n<e.streamIds.length;++n)t.streamIds[n]=e.streamIds[n]>>>0}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.streamIds=[]),e.streamIds&&e.streamIds.length){n.streamIds=[];for(var i=0;i<e.streamIds.length;++i)n.streamIds[i]=e.streamIds[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkBitrateFrame=function(){function e(e){if(this.bitrates=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.bitrates=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.bitrates&&e.bitrates.length)for(var n=0;n<e.bitrates.length;++n)l.SdkBitrate.encode(e.bitrates[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkBitrateFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.bitrates&&i.bitrates.length||(i.bitrates=[]),i.bitrates.push(l.SdkBitrate.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.bitrates&&e.hasOwnProperty("bitrates")){if(!Array.isArray(e.bitrates))return"bitrates: array expected";for(var t=0;t<e.bitrates.length;++t){var n=l.SdkBitrate.verify(e.bitrates[t]);if(n)return"bitrates."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkBitrateFrame)return e;var t=new l.SdkBitrateFrame;if(e.bitrates){if(!Array.isArray(e.bitrates))throw TypeError(".SdkBitrateFrame.bitrates: array expected");t.bitrates=[];for(var n=0;n<e.bitrates.length;++n){if("object"!=typeof e.bitrates[n])throw TypeError(".SdkBitrateFrame.bitrates: object expected");t.bitrates[n]=l.SdkBitrate.fromObject(e.bitrates[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.bitrates=[]),e.bitrates&&e.bitrates.length){n.bitrates=[];for(var i=0;i<e.bitrates.length;++i)n.bitrates[i]=l.SdkBitrate.toObject(e.bitrates[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkStreamDescriptor=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.streamId=0,e.prototype.framerate=0,e.prototype.maxBitrateKbps=0,e.prototype.trackLabel="",e.prototype.groupId=0,e.prototype.avgBitrateBps=0,e.prototype.attendeeId="",e.prototype.mediaType=1,e.prototype.externalUserId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(8).uint32(e.streamId),null!=e.framerate&&e.hasOwnProperty("framerate")&&t.uint32(16).uint32(e.framerate),null!=e.maxBitrateKbps&&e.hasOwnProperty("maxBitrateKbps")&&t.uint32(24).uint32(e.maxBitrateKbps),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&t.uint32(34).string(e.trackLabel),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(48).uint32(e.groupId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&t.uint32(56).uint32(e.avgBitrateBps),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&t.uint32(66).string(e.attendeeId),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&t.uint32(72).int32(e.mediaType),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&t.uint32(82).string(e.externalUserId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkStreamDescriptor;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.streamId=e.uint32();break;case 2:i.framerate=e.uint32();break;case 3:i.maxBitrateKbps=e.uint32();break;case 4:i.trackLabel=e.string();break;case 6:i.groupId=e.uint32();break;case 7:i.avgBitrateBps=e.uint32();break;case 8:i.attendeeId=e.string();break;case 9:i.mediaType=e.int32();break;case 10:i.externalUserId=e.string();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!c.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.framerate&&e.hasOwnProperty("framerate")&&!c.isInteger(e.framerate))return"framerate: integer expected";if(null!=e.maxBitrateKbps&&e.hasOwnProperty("maxBitrateKbps")&&!c.isInteger(e.maxBitrateKbps))return"maxBitrateKbps: integer expected";if(null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!c.isString(e.trackLabel))return"trackLabel: string expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!c.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&!c.isInteger(e.avgBitrateBps))return"avgBitrateBps: integer expected";if(null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!c.isString(e.attendeeId))return"attendeeId: string expected";if(null!=e.mediaType&&e.hasOwnProperty("mediaType"))switch(e.mediaType){default:return"mediaType: enum value expected";case 1:case 2:}return null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&!c.isString(e.externalUserId)?"externalUserId: string expected":null},e.fromObject=function(e){if(e instanceof l.SdkStreamDescriptor)return e;var t=new l.SdkStreamDescriptor;switch(null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.framerate&&(t.framerate=e.framerate>>>0),null!=e.maxBitrateKbps&&(t.maxBitrateKbps=e.maxBitrateKbps>>>0),null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),null!=e.groupId&&(t.groupId=e.groupId>>>0),null!=e.avgBitrateBps&&(t.avgBitrateBps=e.avgBitrateBps>>>0),null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),e.mediaType){case"AUDIO":case 1:t.mediaType=1;break;case"VIDEO":case 2:t.mediaType=2}return null!=e.externalUserId&&(t.externalUserId=String(e.externalUserId)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.streamId=0,n.framerate=0,n.maxBitrateKbps=0,n.trackLabel="",n.groupId=0,n.avgBitrateBps=0,n.attendeeId="",n.mediaType=t.enums===String?"AUDIO":1,n.externalUserId=""),null!=e.streamId&&e.hasOwnProperty("streamId")&&(n.streamId=e.streamId),null!=e.framerate&&e.hasOwnProperty("framerate")&&(n.framerate=e.framerate),null!=e.maxBitrateKbps&&e.hasOwnProperty("maxBitrateKbps")&&(n.maxBitrateKbps=e.maxBitrateKbps),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(n.trackLabel=e.trackLabel),null!=e.groupId&&e.hasOwnProperty("groupId")&&(n.groupId=e.groupId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&(n.avgBitrateBps=e.avgBitrateBps),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(n.attendeeId=e.attendeeId),null!=e.mediaType&&e.hasOwnProperty("mediaType")&&(n.mediaType=t.enums===String?l.SdkStreamMediaType[e.mediaType]:e.mediaType),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&(n.externalUserId=e.externalUserId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkStreamAllocation=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.trackLabel="",e.prototype.streamId=0,e.prototype.groupId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&t.uint32(10).string(e.trackLabel),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(16).uint32(e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(24).uint32(e.groupId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkStreamAllocation;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.trackLabel=e.string();break;case 2:i.streamId=e.uint32();break;case 3:i.groupId=e.uint32();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!c.isString(e.trackLabel)?"trackLabel: string expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!c.isInteger(e.streamId)?"streamId: integer expected":null!=e.groupId&&e.hasOwnProperty("groupId")&&!c.isInteger(e.groupId)?"groupId: integer expected":null},e.fromObject=function(e){if(e instanceof l.SdkStreamAllocation)return e;var t=new l.SdkStreamAllocation;return null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.groupId&&(t.groupId=e.groupId>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.trackLabel="",n.streamId=0,n.groupId=0),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(n.trackLabel=e.trackLabel),null!=e.streamId&&e.hasOwnProperty("streamId")&&(n.streamId=e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&(n.groupId=e.groupId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkTrackMapping=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.streamId=0,e.prototype.ssrc=0,e.prototype.trackLabel="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(8).uint32(e.streamId),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&t.uint32(16).uint32(e.ssrc),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&t.uint32(26).string(e.trackLabel),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkTrackMapping;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.streamId=e.uint32();break;case 2:i.ssrc=e.uint32();break;case 3:i.trackLabel=e.string();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.streamId&&e.hasOwnProperty("streamId")&&!c.isInteger(e.streamId)?"streamId: integer expected":null!=e.ssrc&&e.hasOwnProperty("ssrc")&&!c.isInteger(e.ssrc)?"ssrc: integer expected":null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&!c.isString(e.trackLabel)?"trackLabel: string expected":null},e.fromObject=function(e){if(e instanceof l.SdkTrackMapping)return e;var t=new l.SdkTrackMapping;return null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.ssrc&&(t.ssrc=e.ssrc>>>0),null!=e.trackLabel&&(t.trackLabel=String(e.trackLabel)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.streamId=0,n.ssrc=0,n.trackLabel=""),null!=e.streamId&&e.hasOwnProperty("streamId")&&(n.streamId=e.streamId),null!=e.ssrc&&e.hasOwnProperty("ssrc")&&(n.ssrc=e.ssrc),null!=e.trackLabel&&e.hasOwnProperty("trackLabel")&&(n.trackLabel=e.trackLabel),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkBitrate=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.sourceStreamId=0,e.prototype.avgBitrateBps=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.sourceStreamId&&e.hasOwnProperty("sourceStreamId")&&t.uint32(8).uint32(e.sourceStreamId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&t.uint32(16).uint32(e.avgBitrateBps),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkBitrate;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.sourceStreamId=e.uint32();break;case 2:i.avgBitrateBps=e.uint32();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.sourceStreamId&&e.hasOwnProperty("sourceStreamId")&&!c.isInteger(e.sourceStreamId)?"sourceStreamId: integer expected":null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&!c.isInteger(e.avgBitrateBps)?"avgBitrateBps: integer expected":null},e.fromObject=function(e){if(e instanceof l.SdkBitrate)return e;var t=new l.SdkBitrate;return null!=e.sourceStreamId&&(t.sourceStreamId=e.sourceStreamId>>>0),null!=e.avgBitrateBps&&(t.avgBitrateBps=e.avgBitrateBps>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.sourceStreamId=0,n.avgBitrateBps=0),null!=e.sourceStreamId&&e.hasOwnProperty("sourceStreamId")&&(n.sourceStreamId=e.sourceStreamId),null!=e.avgBitrateBps&&e.hasOwnProperty("avgBitrateBps")&&(n.avgBitrateBps=e.avgBitrateBps),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioControlFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.muted=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.muted&&e.hasOwnProperty("muted")&&t.uint32(8).bool(e.muted),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioControlFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.muted=e.bool();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null},e.fromObject=function(e){if(e instanceof l.SdkAudioControlFrame)return e;var t=new l.SdkAudioControlFrame;return null!=e.muted&&(t.muted=Boolean(e.muted)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.muted=!1),null!=e.muted&&e.hasOwnProperty("muted")&&(n.muted=e.muted),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioMetadataFrame=function(){function e(e){if(this.attendeeStates=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.attendeeStates=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.attendeeStates&&e.attendeeStates.length)for(var n=0;n<e.attendeeStates.length;++n)l.SdkAudioAttendeeState.encode(e.attendeeStates[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioMetadataFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.attendeeStates&&i.attendeeStates.length||(i.attendeeStates=[]),i.attendeeStates.push(l.SdkAudioAttendeeState.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.attendeeStates&&e.hasOwnProperty("attendeeStates")){if(!Array.isArray(e.attendeeStates))return"attendeeStates: array expected";for(var t=0;t<e.attendeeStates.length;++t){var n=l.SdkAudioAttendeeState.verify(e.attendeeStates[t]);if(n)return"attendeeStates."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkAudioMetadataFrame)return e;var t=new l.SdkAudioMetadataFrame;if(e.attendeeStates){if(!Array.isArray(e.attendeeStates))throw TypeError(".SdkAudioMetadataFrame.attendeeStates: array expected");t.attendeeStates=[];for(var n=0;n<e.attendeeStates.length;++n){if("object"!=typeof e.attendeeStates[n])throw TypeError(".SdkAudioMetadataFrame.attendeeStates: object expected");t.attendeeStates[n]=l.SdkAudioAttendeeState.fromObject(e.attendeeStates[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.attendeeStates=[]),e.attendeeStates&&e.attendeeStates.length){n.attendeeStates=[];for(var i=0;i<e.attendeeStates.length;++i)n.attendeeStates[i]=l.SdkAudioAttendeeState.toObject(e.attendeeStates[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioAttendeeState=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.audioStreamId=0,e.prototype.volume=0,e.prototype.muted=!1,e.prototype.signalStrength=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&t.uint32(8).uint32(e.audioStreamId),null!=e.volume&&e.hasOwnProperty("volume")&&t.uint32(16).uint32(e.volume),null!=e.muted&&e.hasOwnProperty("muted")&&t.uint32(24).bool(e.muted),null!=e.signalStrength&&e.hasOwnProperty("signalStrength")&&t.uint32(32).uint32(e.signalStrength),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioAttendeeState;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.audioStreamId=e.uint32();break;case 2:i.volume=e.uint32();break;case 3:i.muted=e.bool();break;case 4:i.signalStrength=e.uint32();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&!c.isInteger(e.audioStreamId)?"audioStreamId: integer expected":null!=e.volume&&e.hasOwnProperty("volume")&&!c.isInteger(e.volume)?"volume: integer expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null!=e.signalStrength&&e.hasOwnProperty("signalStrength")&&!c.isInteger(e.signalStrength)?"signalStrength: integer expected":null},e.fromObject=function(e){if(e instanceof l.SdkAudioAttendeeState)return e;var t=new l.SdkAudioAttendeeState;return null!=e.audioStreamId&&(t.audioStreamId=e.audioStreamId>>>0),null!=e.volume&&(t.volume=e.volume>>>0),null!=e.muted&&(t.muted=Boolean(e.muted)),null!=e.signalStrength&&(t.signalStrength=e.signalStrength>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.audioStreamId=0,n.volume=0,n.muted=!1,n.signalStrength=0),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&(n.audioStreamId=e.audioStreamId),null!=e.volume&&e.hasOwnProperty("volume")&&(n.volume=e.volume),null!=e.muted&&e.hasOwnProperty("muted")&&(n.muted=e.muted),null!=e.signalStrength&&e.hasOwnProperty("signalStrength")&&(n.signalStrength=e.signalStrength),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioStreamIdInfoFrame=function(){function e(e){if(this.streams=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.streams=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.streams&&e.streams.length)for(var n=0;n<e.streams.length;++n)l.SdkAudioStreamIdInfo.encode(e.streams[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioStreamIdInfoFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.streams&&i.streams.length||(i.streams=[]),i.streams.push(l.SdkAudioStreamIdInfo.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streams&&e.hasOwnProperty("streams")){if(!Array.isArray(e.streams))return"streams: array expected";for(var t=0;t<e.streams.length;++t){var n=l.SdkAudioStreamIdInfo.verify(e.streams[t]);if(n)return"streams."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkAudioStreamIdInfoFrame)return e;var t=new l.SdkAudioStreamIdInfoFrame;if(e.streams){if(!Array.isArray(e.streams))throw TypeError(".SdkAudioStreamIdInfoFrame.streams: array expected");t.streams=[];for(var n=0;n<e.streams.length;++n){if("object"!=typeof e.streams[n])throw TypeError(".SdkAudioStreamIdInfoFrame.streams: object expected");t.streams[n]=l.SdkAudioStreamIdInfo.fromObject(e.streams[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.streams=[]),e.streams&&e.streams.length){n.streams=[];for(var i=0;i<e.streams.length;++i)n.streams[i]=l.SdkAudioStreamIdInfo.toObject(e.streams[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioStreamIdInfo=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.audioStreamId=0,e.prototype.attendeeId="",e.prototype.muted=!1,e.prototype.externalUserId="",e.prototype.dropped=!1,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&t.uint32(8).uint32(e.audioStreamId),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&t.uint32(18).string(e.attendeeId),null!=e.muted&&e.hasOwnProperty("muted")&&t.uint32(24).bool(e.muted),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&t.uint32(34).string(e.externalUserId),null!=e.dropped&&e.hasOwnProperty("dropped")&&t.uint32(40).bool(e.dropped),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioStreamIdInfo;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.audioStreamId=e.uint32();break;case 2:i.attendeeId=e.string();break;case 3:i.muted=e.bool();break;case 4:i.externalUserId=e.string();break;case 5:i.dropped=e.bool();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&!c.isInteger(e.audioStreamId)?"audioStreamId: integer expected":null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&!c.isString(e.attendeeId)?"attendeeId: string expected":null!=e.muted&&e.hasOwnProperty("muted")&&"boolean"!=typeof e.muted?"muted: boolean expected":null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&!c.isString(e.externalUserId)?"externalUserId: string expected":null!=e.dropped&&e.hasOwnProperty("dropped")&&"boolean"!=typeof e.dropped?"dropped: boolean expected":null},e.fromObject=function(e){if(e instanceof l.SdkAudioStreamIdInfo)return e;var t=new l.SdkAudioStreamIdInfo;return null!=e.audioStreamId&&(t.audioStreamId=e.audioStreamId>>>0),null!=e.attendeeId&&(t.attendeeId=String(e.attendeeId)),null!=e.muted&&(t.muted=Boolean(e.muted)),null!=e.externalUserId&&(t.externalUserId=String(e.externalUserId)),null!=e.dropped&&(t.dropped=Boolean(e.dropped)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.audioStreamId=0,n.attendeeId="",n.muted=!1,n.externalUserId="",n.dropped=!1),null!=e.audioStreamId&&e.hasOwnProperty("audioStreamId")&&(n.audioStreamId=e.audioStreamId),null!=e.attendeeId&&e.hasOwnProperty("attendeeId")&&(n.attendeeId=e.attendeeId),null!=e.muted&&e.hasOwnProperty("muted")&&(n.muted=e.muted),null!=e.externalUserId&&e.hasOwnProperty("externalUserId")&&(n.externalUserId=e.externalUserId),null!=e.dropped&&e.hasOwnProperty("dropped")&&(n.dropped=e.dropped),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkPingPongType=function(){var e={},t=Object.create(e);return t[e[1]="PING"]=1,t[e[2]="PONG"]=2,t}(),l.SdkPingPongFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.type=1,e.prototype.pingId=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),t.uint32(8).int32(e.type),t.uint32(16).uint32(e.pingId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkPingPongFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.type=e.int32();break;case 2:i.pingId=e.uint32();break;default:e.skipType(7&r)}}if(!i.hasOwnProperty("type"))throw c.ProtocolError("missing required 'type'",{instance:i});if(!i.hasOwnProperty("pingId"))throw c.ProtocolError("missing required 'pingId'",{instance:i});return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";switch(e.type){default:return"type: enum value expected";case 1:case 2:}return c.isInteger(e.pingId)?null:"pingId: integer expected"},e.fromObject=function(e){if(e instanceof l.SdkPingPongFrame)return e;var t=new l.SdkPingPongFrame;switch(e.type){case"PING":case 1:t.type=1;break;case"PONG":case 2:t.type=2}return null!=e.pingId&&(t.pingId=e.pingId>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.type=t.enums===String?"PING":1,n.pingId=0),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?l.SdkPingPongType[e.type]:e.type),null!=e.pingId&&e.hasOwnProperty("pingId")&&(n.pingId=e.pingId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkAudioStatusFrame=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.audioStatus=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&t.uint32(8).uint32(e.audioStatus),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkAudioStatusFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.audioStatus=e.uint32();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&!c.isInteger(e.audioStatus)?"audioStatus: integer expected":null},e.fromObject=function(e){if(e instanceof l.SdkAudioStatusFrame)return e;var t=new l.SdkAudioStatusFrame;return null!=e.audioStatus&&(t.audioStatus=e.audioStatus>>>0),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.audioStatus=0),null!=e.audioStatus&&e.hasOwnProperty("audioStatus")&&(n.audioStatus=e.audioStatus),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkMetric=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.type=1,e.prototype.value=0,e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.type&&e.hasOwnProperty("type")&&t.uint32(8).int32(e.type),null!=e.value&&e.hasOwnProperty("value")&&t.uint32(17).double(e.value),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkMetric;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.type=e.int32();break;case 2:i.value=e.double();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.type&&e.hasOwnProperty("type"))switch(e.type){default:return"type: enum value expected";case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:case 20:case 21:case 22:case 23:case 24:case 25:case 26:case 27:case 28:case 29:case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 48:case 49:case 66:case 72:}return null!=e.value&&e.hasOwnProperty("value")&&"number"!=typeof e.value?"value: number expected":null},e.fromObject=function(e){if(e instanceof l.SdkMetric)return e;var t=new l.SdkMetric;switch(e.type){case"VIDEO_ACTUAL_ENCODER_BITRATE":case 1:t.type=1;break;case"VIDEO_AVAILABLE_SEND_BANDWIDTH":case 2:t.type=2;break;case"VIDEO_RETRANSMIT_BITRATE":case 3:t.type=3;break;case"VIDEO_AVAILABLE_RECEIVE_BANDWIDTH":case 4:t.type=4;break;case"VIDEO_TARGET_ENCODER_BITRATE":case 5:t.type=5;break;case"VIDEO_BUCKET_DELAY_MS":case 6:t.type=6;break;case"STUN_RTT_MS":case 7:t.type=7;break;case"SOCKET_DISCARDED_PPS":case 8:t.type=8;break;case"RTC_MIC_JITTER_MS":case 9:t.type=9;break;case"RTC_MIC_PPS":case 10:t.type=10;break;case"RTC_MIC_FRACTION_PACKET_LOST_PERCENT":case 11:t.type=11;break;case"RTC_MIC_BITRATE":case 12:t.type=12;break;case"RTC_MIC_RTT_MS":case 13:t.type=13;break;case"RTC_SPK_PPS":case 14:t.type=14;break;case"RTC_SPK_FRACTION_PACKET_LOST_PERCENT":case 15:t.type=15;break;case"RTC_SPK_JITTER_MS":case 16:t.type=16;break;case"RTC_SPK_FRACTION_DECODER_LOSS_PERCENT":case 17:t.type=17;break;case"RTC_SPK_BITRATE":case 18:t.type=18;break;case"RTC_SPK_CURRENT_DELAY_MS":case 19:t.type=19;break;case"RTC_SPK_JITTER_BUFFER_MS":case 20:t.type=20;break;case"VIDEO_SENT_RTT_MS":case 21:t.type=21;break;case"VIDEO_ENCODE_USAGE_PERCENT":case 22:t.type=22;break;case"VIDEO_NACKS_RECEIVED":case 23:t.type=23;break;case"VIDEO_PLIS_RECEIVED":case 24:t.type=24;break;case"VIDEO_AVERAGE_ENCODE_MS":case 25:t.type=25;break;case"VIDEO_INPUT_FPS":case 26:t.type=26;break;case"VIDEO_ENCODE_FPS":case 27:t.type=27;break;case"VIDEO_SENT_FPS":case 28:t.type=28;break;case"VIDEO_FIRS_RECEIVED":case 29:t.type=29;break;case"VIDEO_SENT_PPS":case 30:t.type=30;break;case"VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT":case 31:t.type=31;break;case"VIDEO_SENT_BITRATE":case 32:t.type=32;break;case"VIDEO_DROPPED_FPS":case 33:t.type=33;break;case"VIDEO_TARGET_DELAY_MS":case 34:t.type=34;break;case"VIDEO_DECODE_MS":case 35:t.type=35;break;case"VIDEO_OUTPUT_FPS":case 36:t.type=36;break;case"VIDEO_RECEIVED_PPS":case 37:t.type=37;break;case"VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT":case 38:t.type=38;break;case"VIDEO_RENDER_DELAY_MS":case 39:t.type=39;break;case"VIDEO_RECEIVED_FPS":case 40:t.type=40;break;case"VIDEO_DECODE_FPS":case 41:t.type=41;break;case"VIDEO_NACKS_SENT":case 42:t.type=42;break;case"VIDEO_FIRS_SENT":case 43:t.type=43;break;case"VIDEO_RECEIVED_BITRATE":case 44:t.type=44;break;case"VIDEO_CURRENT_DELAY_MS":case 45:t.type=45;break;case"VIDEO_JITTER_BUFFER_MS":case 46:t.type=46;break;case"VIDEO_DISCARDED_PPS":case 47:t.type=47;break;case"VIDEO_PLIS_SENT":case 48:t.type=48;break;case"VIDEO_RECEIVED_JITTER_MS":case 49:t.type=49;break;case"VIDEO_SENT_QP_SUM":case 66:t.type=66;break;case"VIDEO_RECEIVED_QP_SUM":case 72:t.type=72}return null!=e.value&&(t.value=Number(e.value)),t},e.toObject=function(e,t){t||(t={});var n={};return t.defaults&&(n.type=t.enums===String?"VIDEO_ACTUAL_ENCODER_BITRATE":1,n.value=0),null!=e.type&&e.hasOwnProperty("type")&&(n.type=t.enums===String?l.SdkMetric.Type[e.type]:e.type),null!=e.value&&e.hasOwnProperty("value")&&(n.value=t.json&&!isFinite(e.value)?String(e.value):e.value),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e.Type=function(){var e={},t=Object.create(e);return t[e[1]="VIDEO_ACTUAL_ENCODER_BITRATE"]=1,t[e[2]="VIDEO_AVAILABLE_SEND_BANDWIDTH"]=2,t[e[3]="VIDEO_RETRANSMIT_BITRATE"]=3,t[e[4]="VIDEO_AVAILABLE_RECEIVE_BANDWIDTH"]=4,t[e[5]="VIDEO_TARGET_ENCODER_BITRATE"]=5,t[e[6]="VIDEO_BUCKET_DELAY_MS"]=6,t[e[7]="STUN_RTT_MS"]=7,t[e[8]="SOCKET_DISCARDED_PPS"]=8,t[e[9]="RTC_MIC_JITTER_MS"]=9,t[e[10]="RTC_MIC_PPS"]=10,t[e[11]="RTC_MIC_FRACTION_PACKET_LOST_PERCENT"]=11,t[e[12]="RTC_MIC_BITRATE"]=12,t[e[13]="RTC_MIC_RTT_MS"]=13,t[e[14]="RTC_SPK_PPS"]=14,t[e[15]="RTC_SPK_FRACTION_PACKET_LOST_PERCENT"]=15,t[e[16]="RTC_SPK_JITTER_MS"]=16,t[e[17]="RTC_SPK_FRACTION_DECODER_LOSS_PERCENT"]=17,t[e[18]="RTC_SPK_BITRATE"]=18,t[e[19]="RTC_SPK_CURRENT_DELAY_MS"]=19,t[e[20]="RTC_SPK_JITTER_BUFFER_MS"]=20,t[e[21]="VIDEO_SENT_RTT_MS"]=21,t[e[22]="VIDEO_ENCODE_USAGE_PERCENT"]=22,t[e[23]="VIDEO_NACKS_RECEIVED"]=23,t[e[24]="VIDEO_PLIS_RECEIVED"]=24,t[e[25]="VIDEO_AVERAGE_ENCODE_MS"]=25,t[e[26]="VIDEO_INPUT_FPS"]=26,t[e[27]="VIDEO_ENCODE_FPS"]=27,t[e[28]="VIDEO_SENT_FPS"]=28,t[e[29]="VIDEO_FIRS_RECEIVED"]=29,t[e[30]="VIDEO_SENT_PPS"]=30,t[e[31]="VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT"]=31,t[e[32]="VIDEO_SENT_BITRATE"]=32,t[e[33]="VIDEO_DROPPED_FPS"]=33,t[e[34]="VIDEO_TARGET_DELAY_MS"]=34,t[e[35]="VIDEO_DECODE_MS"]=35,t[e[36]="VIDEO_OUTPUT_FPS"]=36,t[e[37]="VIDEO_RECEIVED_PPS"]=37,t[e[38]="VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT"]=38,t[e[39]="VIDEO_RENDER_DELAY_MS"]=39,t[e[40]="VIDEO_RECEIVED_FPS"]=40,t[e[41]="VIDEO_DECODE_FPS"]=41,t[e[42]="VIDEO_NACKS_SENT"]=42,t[e[43]="VIDEO_FIRS_SENT"]=43,t[e[44]="VIDEO_RECEIVED_BITRATE"]=44,t[e[45]="VIDEO_CURRENT_DELAY_MS"]=45,t[e[46]="VIDEO_JITTER_BUFFER_MS"]=46,t[e[47]="VIDEO_DISCARDED_PPS"]=47,t[e[48]="VIDEO_PLIS_SENT"]=48,t[e[49]="VIDEO_RECEIVED_JITTER_MS"]=49,t[e[66]="VIDEO_SENT_QP_SUM"]=66,t[e[72]="VIDEO_RECEIVED_QP_SUM"]=72,t}(),e}(),l.SdkStreamMetricFrame=function(){function e(e){if(this.metrics=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.streamId=0,e.prototype.groupId=0,e.prototype.metrics=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.streamId&&e.hasOwnProperty("streamId")&&t.uint32(24).uint32(e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&t.uint32(32).uint32(e.groupId),null!=e.metrics&&e.metrics.length)for(var n=0;n<e.metrics.length;++n)l.SdkMetric.encode(e.metrics[n],t.uint32(42).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkStreamMetricFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 3:i.streamId=e.uint32();break;case 4:i.groupId=e.uint32();break;case 5:i.metrics&&i.metrics.length||(i.metrics=[]),i.metrics.push(l.SdkMetric.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.streamId&&e.hasOwnProperty("streamId")&&!c.isInteger(e.streamId))return"streamId: integer expected";if(null!=e.groupId&&e.hasOwnProperty("groupId")&&!c.isInteger(e.groupId))return"groupId: integer expected";if(null!=e.metrics&&e.hasOwnProperty("metrics")){if(!Array.isArray(e.metrics))return"metrics: array expected";for(var t=0;t<e.metrics.length;++t){var n=l.SdkMetric.verify(e.metrics[t]);if(n)return"metrics."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkStreamMetricFrame)return e;var t=new l.SdkStreamMetricFrame;if(null!=e.streamId&&(t.streamId=e.streamId>>>0),null!=e.groupId&&(t.groupId=e.groupId>>>0),e.metrics){if(!Array.isArray(e.metrics))throw TypeError(".SdkStreamMetricFrame.metrics: array expected");t.metrics=[];for(var n=0;n<e.metrics.length;++n){if("object"!=typeof e.metrics[n])throw TypeError(".SdkStreamMetricFrame.metrics: object expected");t.metrics[n]=l.SdkMetric.fromObject(e.metrics[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.metrics=[]),t.defaults&&(n.streamId=0,n.groupId=0),null!=e.streamId&&e.hasOwnProperty("streamId")&&(n.streamId=e.streamId),null!=e.groupId&&e.hasOwnProperty("groupId")&&(n.groupId=e.groupId),e.metrics&&e.metrics.length){n.metrics=[];for(var i=0;i<e.metrics.length;++i)n.metrics[i]=l.SdkMetric.toObject(e.metrics[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkClientMetricFrame=function(){function e(e){if(this.globalMetrics=[],this.streamMetricFrames=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.globalMetrics=c.emptyArray,e.prototype.streamMetricFrames=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.globalMetrics&&e.globalMetrics.length)for(var n=0;n<e.globalMetrics.length;++n)l.SdkMetric.encode(e.globalMetrics[n],t.uint32(10).fork()).ldelim();if(null!=e.streamMetricFrames&&e.streamMetricFrames.length)for(n=0;n<e.streamMetricFrames.length;++n)l.SdkStreamMetricFrame.encode(e.streamMetricFrames[n],t.uint32(18).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkClientMetricFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.globalMetrics&&i.globalMetrics.length||(i.globalMetrics=[]),i.globalMetrics.push(l.SdkMetric.decode(e,e.uint32()));break;case 2:i.streamMetricFrames&&i.streamMetricFrames.length||(i.streamMetricFrames=[]),i.streamMetricFrames.push(l.SdkStreamMetricFrame.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.globalMetrics&&e.hasOwnProperty("globalMetrics")){if(!Array.isArray(e.globalMetrics))return"globalMetrics: array expected";for(var t=0;t<e.globalMetrics.length;++t){if(n=l.SdkMetric.verify(e.globalMetrics[t]))return"globalMetrics."+n}}if(null!=e.streamMetricFrames&&e.hasOwnProperty("streamMetricFrames")){if(!Array.isArray(e.streamMetricFrames))return"streamMetricFrames: array expected";for(t=0;t<e.streamMetricFrames.length;++t){var n;if(n=l.SdkStreamMetricFrame.verify(e.streamMetricFrames[t]))return"streamMetricFrames."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkClientMetricFrame)return e;var t=new l.SdkClientMetricFrame;if(e.globalMetrics){if(!Array.isArray(e.globalMetrics))throw TypeError(".SdkClientMetricFrame.globalMetrics: array expected");t.globalMetrics=[];for(var n=0;n<e.globalMetrics.length;++n){if("object"!=typeof e.globalMetrics[n])throw TypeError(".SdkClientMetricFrame.globalMetrics: object expected");t.globalMetrics[n]=l.SdkMetric.fromObject(e.globalMetrics[n])}}if(e.streamMetricFrames){if(!Array.isArray(e.streamMetricFrames))throw TypeError(".SdkClientMetricFrame.streamMetricFrames: array expected");t.streamMetricFrames=[];for(n=0;n<e.streamMetricFrames.length;++n){if("object"!=typeof e.streamMetricFrames[n])throw TypeError(".SdkClientMetricFrame.streamMetricFrames: object expected");t.streamMetricFrames[n]=l.SdkStreamMetricFrame.fromObject(e.streamMetricFrames[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.globalMetrics=[],n.streamMetricFrames=[]),e.globalMetrics&&e.globalMetrics.length){n.globalMetrics=[];for(var i=0;i<e.globalMetrics.length;++i)n.globalMetrics[i]=l.SdkMetric.toObject(e.globalMetrics[i],t)}if(e.streamMetricFrames&&e.streamMetricFrames.length){n.streamMetricFrames=[];for(i=0;i<e.streamMetricFrames.length;++i)n.streamMetricFrames[i]=l.SdkStreamMetricFrame.toObject(e.streamMetricFrames[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkDataMessageFrame=function(){function e(e){if(this.messages=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.messages=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.messages&&e.messages.length)for(var n=0;n<e.messages.length;++n)l.SdkDataMessagePayload.encode(e.messages[n],t.uint32(10).fork()).ldelim();return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkDataMessageFrame;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.messages&&i.messages.length||(i.messages=[]),i.messages.push(l.SdkDataMessagePayload.decode(e,e.uint32()));break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.messages&&e.hasOwnProperty("messages")){if(!Array.isArray(e.messages))return"messages: array expected";for(var t=0;t<e.messages.length;++t){var n=l.SdkDataMessagePayload.verify(e.messages[t]);if(n)return"messages."+n}}return null},e.fromObject=function(e){if(e instanceof l.SdkDataMessageFrame)return e;var t=new l.SdkDataMessageFrame;if(e.messages){if(!Array.isArray(e.messages))throw TypeError(".SdkDataMessageFrame.messages: array expected");t.messages=[];for(var n=0;n<e.messages.length;++n){if("object"!=typeof e.messages[n])throw TypeError(".SdkDataMessageFrame.messages: object expected");t.messages[n]=l.SdkDataMessagePayload.fromObject(e.messages[n])}}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.messages=[]),e.messages&&e.messages.length){n.messages=[];for(var i=0;i<e.messages.length;++i)n.messages[i]=l.SdkDataMessagePayload.toObject(e.messages[i],t)}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkDataMessagePayload=function(){function e(e){if(e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.topic="",e.prototype.data=c.newBuffer([]),e.prototype.lifetimeMs=0,e.prototype.senderAttendeeId="",e.prototype.ingestTimeNs=c.Long?c.Long.fromBits(0,0,!1):0,e.prototype.senderExternalUserId="",e.create=function(t){return new e(t)},e.encode=function(e,t){return t||(t=a.create()),null!=e.topic&&e.hasOwnProperty("topic")&&t.uint32(10).string(e.topic),null!=e.data&&e.hasOwnProperty("data")&&t.uint32(18).bytes(e.data),null!=e.lifetimeMs&&e.hasOwnProperty("lifetimeMs")&&t.uint32(24).uint32(e.lifetimeMs),null!=e.senderAttendeeId&&e.hasOwnProperty("senderAttendeeId")&&t.uint32(34).string(e.senderAttendeeId),null!=e.ingestTimeNs&&e.hasOwnProperty("ingestTimeNs")&&t.uint32(40).int64(e.ingestTimeNs),null!=e.senderExternalUserId&&e.hasOwnProperty("senderExternalUserId")&&t.uint32(50).string(e.senderExternalUserId),t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkDataMessagePayload;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.topic=e.string();break;case 2:i.data=e.bytes();break;case 3:i.lifetimeMs=e.uint32();break;case 4:i.senderAttendeeId=e.string();break;case 5:i.ingestTimeNs=e.int64();break;case 6:i.senderExternalUserId=e.string();break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){return"object"!=typeof e||null===e?"object expected":null!=e.topic&&e.hasOwnProperty("topic")&&!c.isString(e.topic)?"topic: string expected":null!=e.data&&e.hasOwnProperty("data")&&!(e.data&&"number"==typeof e.data.length||c.isString(e.data))?"data: buffer expected":null!=e.lifetimeMs&&e.hasOwnProperty("lifetimeMs")&&!c.isInteger(e.lifetimeMs)?"lifetimeMs: integer expected":null!=e.senderAttendeeId&&e.hasOwnProperty("senderAttendeeId")&&!c.isString(e.senderAttendeeId)?"senderAttendeeId: string expected":null!=e.ingestTimeNs&&e.hasOwnProperty("ingestTimeNs")&&!(c.isInteger(e.ingestTimeNs)||e.ingestTimeNs&&c.isInteger(e.ingestTimeNs.low)&&c.isInteger(e.ingestTimeNs.high))?"ingestTimeNs: integer|Long expected":null!=e.senderExternalUserId&&e.hasOwnProperty("senderExternalUserId")&&!c.isString(e.senderExternalUserId)?"senderExternalUserId: string expected":null},e.fromObject=function(e){if(e instanceof l.SdkDataMessagePayload)return e;var t=new l.SdkDataMessagePayload;return null!=e.topic&&(t.topic=String(e.topic)),null!=e.data&&("string"==typeof e.data?c.base64.decode(e.data,t.data=c.newBuffer(c.base64.length(e.data)),0):e.data.length&&(t.data=e.data)),null!=e.lifetimeMs&&(t.lifetimeMs=e.lifetimeMs>>>0),null!=e.senderAttendeeId&&(t.senderAttendeeId=String(e.senderAttendeeId)),null!=e.ingestTimeNs&&(c.Long?(t.ingestTimeNs=c.Long.fromValue(e.ingestTimeNs)).unsigned=!1:"string"==typeof e.ingestTimeNs?t.ingestTimeNs=parseInt(e.ingestTimeNs,10):"number"==typeof e.ingestTimeNs?t.ingestTimeNs=e.ingestTimeNs:"object"==typeof e.ingestTimeNs&&(t.ingestTimeNs=new c.LongBits(e.ingestTimeNs.low>>>0,e.ingestTimeNs.high>>>0).toNumber())),null!=e.senderExternalUserId&&(t.senderExternalUserId=String(e.senderExternalUserId)),t},e.toObject=function(e,t){t||(t={});var n={};if(t.defaults){if(n.topic="",t.bytes===String?n.data="":(n.data=[],t.bytes!==Array&&(n.data=c.newBuffer(n.data))),n.lifetimeMs=0,n.senderAttendeeId="",c.Long){var i=new c.Long(0,0,!1);n.ingestTimeNs=t.longs===String?i.toString():t.longs===Number?i.toNumber():i}else n.ingestTimeNs=t.longs===String?"0":0;n.senderExternalUserId=""}return null!=e.topic&&e.hasOwnProperty("topic")&&(n.topic=e.topic),null!=e.data&&e.hasOwnProperty("data")&&(n.data=t.bytes===String?c.base64.encode(e.data,0,e.data.length):t.bytes===Array?Array.prototype.slice.call(e.data):e.data),null!=e.lifetimeMs&&e.hasOwnProperty("lifetimeMs")&&(n.lifetimeMs=e.lifetimeMs),null!=e.senderAttendeeId&&e.hasOwnProperty("senderAttendeeId")&&(n.senderAttendeeId=e.senderAttendeeId),null!=e.ingestTimeNs&&e.hasOwnProperty("ingestTimeNs")&&("number"==typeof e.ingestTimeNs?n.ingestTimeNs=t.longs===String?String(e.ingestTimeNs):e.ingestTimeNs:n.ingestTimeNs=t.longs===String?c.Long.prototype.toString.call(e.ingestTimeNs):t.longs===Number?new c.LongBits(e.ingestTimeNs.low>>>0,e.ingestTimeNs.high>>>0).toNumber():e.ingestTimeNs),null!=e.senderExternalUserId&&e.hasOwnProperty("senderExternalUserId")&&(n.senderExternalUserId=e.senderExternalUserId),n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),l.SdkTurnCredentials=function(){function e(e){if(this.uris=[],e)for(var t=Object.keys(e),n=0;n<t.length;++n)null!=e[t[n]]&&(this[t[n]]=e[t[n]])}return e.prototype.username="",e.prototype.password="",e.prototype.ttl=0,e.prototype.uris=c.emptyArray,e.create=function(t){return new e(t)},e.encode=function(e,t){if(t||(t=a.create()),null!=e.username&&e.hasOwnProperty("username")&&t.uint32(10).string(e.username),null!=e.password&&e.hasOwnProperty("password")&&t.uint32(18).string(e.password),null!=e.ttl&&e.hasOwnProperty("ttl")&&t.uint32(24).uint32(e.ttl),null!=e.uris&&e.uris.length)for(var n=0;n<e.uris.length;++n)t.uint32(34).string(e.uris[n]);return t},e.encodeDelimited=function(e,t){return this.encode(e,t).ldelim()},e.decode=function(e,t){e instanceof o||(e=o.create(e));for(var n=void 0===t?e.len:e.pos+t,i=new l.SdkTurnCredentials;e.pos<n;){var r=e.uint32();switch(r>>>3){case 1:i.username=e.string();break;case 2:i.password=e.string();break;case 3:i.ttl=e.uint32();break;case 4:i.uris&&i.uris.length||(i.uris=[]),i.uris.push(e.string());break;default:e.skipType(7&r)}}return i},e.decodeDelimited=function(e){return e instanceof o||(e=new o(e)),this.decode(e,e.uint32())},e.verify=function(e){if("object"!=typeof e||null===e)return"object expected";if(null!=e.username&&e.hasOwnProperty("username")&&!c.isString(e.username))return"username: string expected";if(null!=e.password&&e.hasOwnProperty("password")&&!c.isString(e.password))return"password: string expected";if(null!=e.ttl&&e.hasOwnProperty("ttl")&&!c.isInteger(e.ttl))return"ttl: integer expected";if(null!=e.uris&&e.hasOwnProperty("uris")){if(!Array.isArray(e.uris))return"uris: array expected";for(var t=0;t<e.uris.length;++t)if(!c.isString(e.uris[t]))return"uris: string[] expected"}return null},e.fromObject=function(e){if(e instanceof l.SdkTurnCredentials)return e;var t=new l.SdkTurnCredentials;if(null!=e.username&&(t.username=String(e.username)),null!=e.password&&(t.password=String(e.password)),null!=e.ttl&&(t.ttl=e.ttl>>>0),e.uris){if(!Array.isArray(e.uris))throw TypeError(".SdkTurnCredentials.uris: array expected");t.uris=[];for(var n=0;n<e.uris.length;++n)t.uris[n]=String(e.uris[n])}return t},e.toObject=function(e,t){t||(t={});var n={};if((t.arrays||t.defaults)&&(n.uris=[]),t.defaults&&(n.username="",n.password="",n.ttl=0),null!=e.username&&e.hasOwnProperty("username")&&(n.username=e.username),null!=e.password&&e.hasOwnProperty("password")&&(n.password=e.password),null!=e.ttl&&e.hasOwnProperty("ttl")&&(n.ttl=e.ttl),e.uris&&e.uris.length){n.uris=[];for(var i=0;i<e.uris.length;++i)n.uris[i]=e.uris[i]}return n},e.prototype.toJSON=function(){return this.constructor.toObject(this,s.util.toJSONOptions)},e}(),e.exports=l},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SignalingClientEventType=void 0,function(e){e[e.WebSocketConnecting=0]="WebSocketConnecting",e[e.WebSocketOpen=1]="WebSocketOpen",e[e.WebSocketError=2]="WebSocketError",e[e.WebSocketClosing=3]="WebSocketClosing",e[e.WebSocketClosed=4]="WebSocketClosed",e[e.WebSocketFailed=5]="WebSocketFailed",e[e.WebSocketMessage=6]="WebSocketMessage",e[e.WebSocketSendMessageFailure=7]="WebSocketSendMessageFailure",e[e.WebSocketSentMessage=8]="WebSocketSentMessage",e[e.ProtocolDecodeFailure=9]="ProtocolDecodeFailure",e[e.ReceivedSignalFrame=10]="ReceivedSignalFrame",e[e.WebSocketSkippedMessage=11]="WebSocketSkippedMessage"}(i=t.SignalingClientEventType||(t.SignalingClientEventType={})),t.default=i},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(198);t.default=class{constructor({enableUnifiedPlanForChromiumBasedBrowsers:e=!1}={}){this.browser=r.detect(),this.browserSupport={chrome:78,"edge-chromium":79,electron:7,firefox:60,ios:12,safari:12,opera:66,samsung:12,crios:86,fxios:23},this.browserName={chrome:"Google Chrome","edge-chromium":"Microsoft Edge",electron:"Electron",firefox:"Mozilla Firefox",ios:"Safari iOS",safari:"Safari",opera:"Opera",samsung:"Samsung Internet",crios:"Chrome iOS",fxios:"Firefox iOS"},this.chromeLike=["chrome","edge-chromium","chromium-webview","opera","samsung"],this.webkitBrowsers=["crios","fxios","safari","ios"],this.enableUnifiedPlanForChromiumBasedBrowsers=e}version(){return this.browser.version}majorVersion(){return parseInt(this.version().split(".")[0])}name(){return this.browser.name}hasChromiumWebRTC(){for(const e of this.chromeLike)if(e===this.browser.name)return!0;return!1}hasWebKitWebRTC(){for(const e of this.webkitBrowsers)if(e===this.browser.name)return!0;return!1}hasFirefoxWebRTC(){return this.isFirefox()}supportsCanvasCapturedStreamPlayback(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()}requiresUnifiedPlan(){let e=this.isFirefox()||this.hasWebKitWebRTC()&&this.isUnifiedPlanSupported();return this.enableUnifiedPlanForChromiumBasedBrowsers&&(e=e||this.hasChromiumWebRTC()),e}requiresResolutionAlignment(e,t){return this.isAndroid()&&this.isPixel3()?[64*Math.ceil(e/64),64*Math.ceil(t/64)]:[e,t]}requiresCheckForSdpConnectionAttributes(){return!this.isIOSSafari()&&!this.isIOSChrome()&&!this.isIOSFirefox()}requiresIceCandidateGatheringTimeoutWorkaround(){return this.hasChromiumWebRTC()}requiresUnifiedPlanMunging(){let e=this.hasWebKitWebRTC()&&this.isUnifiedPlanSupported();return this.enableUnifiedPlanForChromiumBasedBrowsers&&(e=e||this.hasChromiumWebRTC()),e}requiresSortCodecPreferencesForSdpAnswer(){return this.isFirefox()&&this.majorVersion()<=68}requiresSimulcastMunging(){return this.isSafari()}requiresBundlePolicy(){return"max-bundle"}requiresPromiseBasedWebRTCGetStats(){return!this.hasChromiumWebRTC()}requiresVideoElementWorkaround(){return this.isSafari()}requiresNoExactMediaStreamConstraints(){return this.isSamsungInternet()||this.isIOSSafari()&&("12.0.0"===this.version()||"12.1.0"===this.version())}requiresGroupIdMediaStreamConstraints(){return this.isSamsungInternet()}requiresContextRecreationForAudioWorklet(){return"chrome"in e&&("Mac OS"===this.browser.os&&!(!this.isChrome()&&!this.isEdge()))}getDisplayMediaAudioCaptureSupport(){return this.isChrome()||this.isEdge()}supportsSenderSideBandwidthEstimation(){return this.hasChromiumWebRTC()||this.isSafari()}screenShareUnsupported(){return console.warn("This function is no longer supported."),!!this.isSafari()}isSupported(){return!(!this.browserSupport[this.browser.name]||this.majorVersion()<this.browserSupport[this.browser.name])&&("firefox"!==this.browser.name||!this.isAndroid())}supportString(){if(this.isAndroid())return`${this.browserName.chrome} ${this.browserSupport.chrome}+, ${this.browserName.samsung} ${this.browserSupport.samsung}+`;const e=[];for(const t in this.browserSupport)e.push(`${this.browserName[t]} ${this.browserSupport[t]}+`);return e.join(", ")}supportedVideoCodecs(){return i(this,void 0,void 0,(function*(){const e=new RTCPeerConnection;return e.addTransceiver("video",{direction:"inactive",streams:[]}),(yield e.createOffer({offerToReceiveVideo:!0})).sdp.split("\r\n").filter(e=>e.includes("a=rtpmap:")).map(e=>e.replace(/.* /,"").replace(/\/.*/,"")).filter((e,t,n)=>n.indexOf(e)===t).filter(e=>"rtx"!==e&&"red"!==e&&"ulpfec"!==e)}))}supportsSetSinkId(){return"setSinkId"in HTMLAudioElement.prototype}isIOSSafari(){return"ios"===this.browser.name}isSafari(){return"safari"===this.browser.name||"ios"===this.browser.name}isFirefox(){return"firefox"===this.browser.name}isIOSFirefox(){return"fxios"===this.browser.name}isIOSChrome(){return"crios"===this.browser.name}isChrome(){return"chrome"===this.browser.name}isEdge(){return"edge-chromium"===this.browser.name}isSamsungInternet(){return"samsung"===this.browser.name}isAndroid(){return/(android)/i.test(navigator.userAgent)}isPixel3(){return/( pixel 3)/i.test(navigator.userAgent)}isUnifiedPlanSupported(){return RTCRtpTransceiver.prototype.hasOwnProperty("currentDirection")}}}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(91),r=n(92);t.default=class{static of(e){return null==e?i.default.of():r.default.of(e)}}},function(e,t,n){"use strict";var i=n(170),r=Object.prototype.toString;function s(e){return"[object Array]"===r.call(e)}function o(e){return void 0===e}function a(e){return null!==e&&"object"==typeof e}function c(e){if("[object Object]"!==r.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function l(e){return"[object Function]"===r.call(e)}function d(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.call(null,e[r],r,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===r.call(e)},isBuffer:function(e){return null!==e&&!o(e)&&null!==e.constructor&&!o(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isPlainObject:c,isUndefined:o,isDate:function(e){return"[object Date]"===r.call(e)},isFile:function(e){return"[object File]"===r.call(e)},isBlob:function(e){return"[object Blob]"===r.call(e)},isFunction:l,isStream:function(e){return a(e)&&l(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:d,merge:function e(){var t={};function n(n,i){c(t[i])&&c(n)?t[i]=e(t[i],n):c(n)?t[i]=e({},n):s(n)?t[i]=n.slice():t[i]=n}for(var i=0,r=arguments.length;i<r;i++)d(arguments[i],n);return t},extend:function(e,t,n){return d(t,(function(t,r){e[r]=n&&"function"==typeof t?i(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")},stripBOM:function(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultPingPong=t.DefaultModality=t.DefaultMessagingSession=t.DefaultMeetingSession=t.DefaultMeetingReadinessChecker=t.DefaultMediaDeviceFactory=t.DefaultEventController=t.DefaultDevicePixelRatioMonitor=t.DefaultDeviceController=t.DefaultContentShareController=t.DefaultClientMetricReport=t.DefaultBrowserBehavior=t.DefaultAudioVideoFacade=t.DefaultAudioVideoController=t.DefaultAudioMixController=t.DefaultActiveSpeakerPolicy=t.DefaultActiveSpeakerDetector=t.DataMessage=t.CreateSDPTask=t.CreatePeerConnectionTask=t.ContentShareMediaStreamBroker=t.ContentShareConstants=t.ConsoleLogger=t.ConnectionHealthPolicyConfiguration=t.ConnectionHealthData=t.ClientVideoStreamReceivingReport=t.ClientMetricReportMediaType=t.ClientMetricReportDirection=t.CleanStoppedSessionTask=t.CleanRestartedSessionTask=t.CheckVideoInputFeedback=t.CheckVideoConnectivityFeedback=t.CheckNetworkUDPConnectivityFeedback=t.CheckNetworkTCPConnectivityFeedback=t.CheckContentShareConnectivityFeedback=t.CheckCameraResolutionFeedback=t.CheckAudioOutputFeedback=t.CheckAudioInputFeedback=t.CheckAudioConnectivityFeedback=t.CanvasVideoFrameBuffer=t.BitrateParameters=t.BaseTask=t.BaseConnectionHealthPolicy=t.AudioVideoControllerState=t.AudioProfile=t.AudioLogEvent=t.Attendee=t.AttachMediaInputTask=t.AsyncScheduler=t.AllHighestVideoBandwidthPolicy=void 0,t.MultiLogger=t.MonitorTask=t.MessagingSessionConfiguration=t.Message=t.MeetingSessionVideoAvailability=t.MeetingSessionURLs=t.MeetingSessionTURNCredentials=t.MeetingSessionStatusCode=t.MeetingSessionStatus=t.MeetingSessionPOSTLogger=t.MeetingSessionLifecycleEventCondition=t.MeetingSessionLifecycleEvent=t.MeetingSessionCredentials=t.MeetingSessionConfiguration=t.MeetingReadinessCheckerConfiguration=t.MediaDeviceProxyHandler=t.Maybe=t.LogLevel=t.Log=t.ListenForVolumeIndicatorsTask=t.LeaveAndReceiveLeaveAckTask=t.JoinAndReceiveIndexTask=t.IntervalScheduler=t.GlobalMetricReport=t.GetUserMediaError=t.FullJitterLimitedBackoff=t.FullJitterBackoffFactory=t.FullJitterBackoff=t.FinishGatheringICECandidatesTask=t.DeviceSelection=t.DevicePixelRatioWindowSource=t.DefaultWebSocketAdapter=t.DefaultVolumeIndicatorAdapter=t.DefaultVideoTransformDevice=t.DefaultVideoTileFactory=t.DefaultVideoTileController=t.DefaultVideoTile=t.DefaultVideoStreamIndex=t.DefaultVideoStreamIdSet=t.DefaultVideoFrameProcessorPipeline=t.DefaultVideoCaptureAndEncodeParameter=t.DefaultTransceiverController=t.DefaultStatsCollector=t.DefaultSimulcastUplinkPolicy=t.DefaultSignalingClient=t.DefaultSigV4=t.DefaultSessionStateController=t.DefaultSDP=t.DefaultReconnectController=t.DefaultRealtimeController=void 0,t.TaskStatus=t.SubscribeAndReceiveSubscribeAckTask=t.StreamMetricReport=t.Some=t.SingleNodeAudioTransformDevice=t.SimulcastVideoStreamIndex=t.SimulcastTransceiverController=t.SimulcastLayers=t.SignalingClientSubscribe=t.SignalingClientJoin=t.SignalingClientEventType=t.SignalingClientEvent=t.SignalingClientConnectionRequest=t.SignalingAndMetricsConnectionMonitor=t.SetRemoteDescriptionTask=t.SetLocalDescriptionTask=t.SessionStateControllerTransitionResult=t.SessionStateControllerState=t.SessionStateControllerDeferPriority=t.SessionStateControllerAction=t.SerialGroupTask=t.SendAndReceiveDataMessagesTask=t.SDPCandidateType=t.RunnableTask=t.ReconnectionHealthPolicy=t.ReceiveVideoStreamIndexTask=t.ReceiveVideoInputTask=t.ReceiveTURNCredentialsTask=t.ReceiveAudioInputTask=t.RealtimeVolumeIndicator=t.RealtimeState=t.RealtimeAttendeePositionInFrame=t.PermissionDeniedError=t.ParallelGroupTask=t.OverconstrainedError=t.OpenSignalingConnectionTask=t.NotReadableError=t.NotFoundError=t.None=t.NoVideoUplinkBandwidthPolicy=t.NoVideoDownlinkBandwidthPolicy=t.NoOpVideoFrameProcessor=t.NoOpVideoElementFactory=t.NoOpTask=t.NoOpMediaStreamBroker=t.NoOpLogger=t.NoOpDeviceController=t.NoOpDebugLogger=t.NoOpAudioVideoController=t.NScaleVideoUplinkBandwidthPolicy=void 0,t.isVideoTransformDevice=t.isDestroyable=t.isAudioTransformDevice=t.WebSocketReadyState=t.WaitForAttendeePresenceTask=t.VoiceFocusTransformDevice=t.VoiceFocusDeviceTransformer=t.VideoTileState=t.VideoStreamDescription=t.VideoSource=t.VideoQualitySettings=t.VideoLogEvent=t.VideoAdaptiveProbePolicy=t.Versioning=t.UnusableAudioWarningConnectionHealthPolicy=t.TypeError=t.TimeoutTask=t.TimeoutScheduler=void 0;const i=n(42);t.AllHighestVideoBandwidthPolicy=i.default;const r=n(11);t.AsyncScheduler=r.default;const s=n(71);t.AttachMediaInputTask=s.default;const o=n(196);t.Attendee=o.default;const a=n(44);t.AudioLogEvent=a.default;const c=n(72);t.AudioProfile=c.default;const l=n(73);t.AudioVideoControllerState=l.default;const d=n(45);t.BaseConnectionHealthPolicy=d.default;const u=n(4);t.BaseTask=u.default;const h=n(74);t.BitrateParameters=h.default;const p=n(75);t.CanvasVideoFrameBuffer=p.default;const f=n(76);t.CheckAudioConnectivityFeedback=f.default;const g=n(77);t.CheckAudioInputFeedback=g.default;const m=n(78);t.CheckAudioOutputFeedback=m.default;const v=n(79);t.CheckCameraResolutionFeedback=v.default;const b=n(80);t.CheckContentShareConnectivityFeedback=b.default;const S=n(81);t.CheckNetworkTCPConnectivityFeedback=S.default;const y=n(82);t.CheckNetworkUDPConnectivityFeedback=y.default;const C=n(83);t.CheckVideoConnectivityFeedback=C.default;const w=n(84);t.CheckVideoInputFeedback=w.default;const _=n(85);t.CleanRestartedSessionTask=_.default;const A=n(86);t.CleanStoppedSessionTask=A.default;const k=n(22);t.ClientMetricReportDirection=k.default;const T=n(32);t.ClientMetricReportMediaType=T.default;const I=n(87);t.ClientVideoStreamReceivingReport=I.default;const O=n(88);t.ConnectionHealthData=O.default;const E=n(89);t.ConnectionHealthPolicyConfiguration=E.default;const x=n(197);t.ConsoleLogger=x.default;const P=n(33);t.ContentShareConstants=P.default;const M=n(90);t.ContentShareMediaStreamBroker=M.default;const D=n(103);t.CreatePeerConnectionTask=D.default;const R=n(104);t.CreateSDPTask=R.default;const F=n(106);t.DataMessage=F.default;const N=n(107);t.DefaultActiveSpeakerDetector=N.default;const L=n(199);t.DefaultActiveSpeakerPolicy=L.default;const j=n(50);t.DefaultAudioMixController=j.default;const V=n(51);t.DefaultAudioVideoController=V.default;const B=n(157);t.DefaultAudioVideoFacade=B.default;const U=n(7);t.DefaultBrowserBehavior=U.default;const W=n(121);t.DefaultClientMetricReport=W.default;const H=n(158);t.DefaultContentShareController=H.default;const q=n(46);t.DefaultDeviceController=q.default;const $=n(151);t.DefaultDevicePixelRatioMonitor=$.default;const G=n(109);t.DefaultEventController=G.default;const K=n(93);t.DefaultMediaDeviceFactory=K.default;const z=n(217);t.DefaultMeetingReadinessChecker=z.default;const Y=n(218);t.DefaultMeetingSession=Y.default;const J=n(219);t.DefaultMessagingSession=J.default;const X=n(23);t.DefaultModality=X.default;const Q=n(112);t.DefaultPingPong=Q.default;const Z=n(113);t.DefaultRealtimeController=Z.default;const ee=n(37);t.DefaultReconnectController=ee.default;const te=n(24);t.DefaultSDP=te.default;const ne=n(116);t.DefaultSessionStateController=ne.default;const ie=n(162);t.DefaultSigV4=ie.default;const re=n(118);t.DefaultSignalingClient=re.default;const se=n(154);t.DefaultSimulcastUplinkPolicy=se.default;const oe=n(120);t.DefaultStatsCollector=oe.default;const ae=n(58);t.DefaultTransceiverController=ae.default;const ce=n(25);t.DefaultVideoCaptureAndEncodeParameter=ce.default;const le=n(163);t.DefaultVideoFrameProcessorPipeline=le.default;const de=n(18);t.DefaultVideoStreamIdSet=de.default;const ue=n(60);t.DefaultVideoStreamIndex=ue.default;const he=n(47);t.DefaultVideoTile=he.default;const pe=n(150);t.DefaultVideoTileController=pe.default;const fe=n(153);t.DefaultVideoTileFactory=fe.default;const ge=n(220);t.DefaultVideoTransformDevice=ge.default;const me=n(156);t.DefaultVolumeIndicatorAdapter=me.default;const ve=n(38);t.DefaultWebSocketAdapter=ve.default;const be=n(152);t.DevicePixelRatioWindowSource=be.default;const Se=n(97);t.DeviceSelection=Se.default;const ye=n(126);t.FinishGatheringICECandidatesTask=ye.default;const Ce=n(21);t.FullJitterBackoff=Ce.default;const we=n(221);t.FullJitterBackoffFactory=we.default;const _e=n(164);t.FullJitterLimitedBackoff=_e.default;const Ae=n(15);t.GetUserMediaError=Ae.default;const ke=n(122);t.GlobalMetricReport=ke.default;const Te=n(14);t.IntervalScheduler=Te.default;const Ie=n(127);t.JoinAndReceiveIndexTask=Ie.default;const Oe=n(129);t.LeaveAndReceiveLeaveAckTask=Oe.default;const Ee=n(130);t.ListenForVolumeIndicatorsTask=Ee.default;const xe=n(165);t.Log=xe.default;const Pe=n(19);t.LogLevel=Pe.default;const Me=n(8);t.Maybe=Me.default;const De=n(94);t.MediaDeviceProxyHandler=De.default;const Re=n(159);t.MeetingReadinessCheckerConfiguration=Re.default;const Fe=n(63);t.MeetingSessionConfiguration=Fe.default;const Ne=n(36);t.MeetingSessionCredentials=Ne.default;const Le=n(124);t.MeetingSessionLifecycleEvent=Le.default;const je=n(125);t.MeetingSessionLifecycleEventCondition=je.default;const Ve=n(222);t.MeetingSessionPOSTLogger=Ve.default;const Be=n(34);t.MeetingSessionStatus=Be.default;const Ue=n(12);t.MeetingSessionStatusCode=Ue.default;const We=n(56);t.MeetingSessionTURNCredentials=We.default;const He=n(64);t.MeetingSessionURLs=He.default;const qe=n(52);t.MeetingSessionVideoAvailability=qe.default;const $e=n(161);t.Message=$e.default;const Ge=n(223);t.MessagingSessionConfiguration=Ge.default;const Ke=n(131);t.MonitorTask=Ke.default;const ze=n(224);t.MultiLogger=ze.default;const Ye=n(62);t.NScaleVideoUplinkBandwidthPolicy=Ye.default;const Je=n(225);t.NoOpAudioVideoController=Je.default;const Xe=n(166);t.NoOpDebugLogger=Xe.default;const Qe=n(226);t.NoOpDeviceController=Qe.default;const Ze=n(167);t.NoOpLogger=Ze.default;const et=n(65);t.NoOpMediaStreamBroker=et.default;const tt=n(227);t.NoOpTask=tt.default;const nt=n(228);t.NoOpVideoElementFactory=nt.default;const it=n(229);t.NoOpVideoFrameProcessor=it.default;const rt=n(230);t.NoVideoDownlinkBandwidthPolicy=rt.default;const st=n(231);t.NoVideoUplinkBandwidthPolicy=st.default;const ot=n(91);t.None=ot.default;const at=n(98);t.NotFoundError=at.default;const ct=n(99);t.NotReadableError=ct.default;const lt=n(134);t.OpenSignalingConnectionTask=lt.default;const dt=n(100);t.OverconstrainedError=dt.default;const ut=n(136);t.ParallelGroupTask=ut.default;const ht=n(48);t.PermissionDeniedError=ht.default;const pt=n(232);t.RealtimeAttendeePositionInFrame=pt.default;const ft=n(114);t.RealtimeState=ft.default;const gt=n(115);t.RealtimeVolumeIndicator=gt.default;const mt=n(137);t.ReceiveAudioInputTask=mt.default;const vt=n(138);t.ReceiveTURNCredentialsTask=vt.default;const bt=n(139);t.ReceiveVideoInputTask=bt.default;const St=n(140);t.ReceiveVideoStreamIndexTask=St.default;const yt=n(132);t.ReconnectionHealthPolicy=yt.default;const Ct=n(233);t.RunnableTask=Ct.default;const wt=n(105);t.SDPCandidateType=wt.default;const _t=n(141);t.SendAndReceiveDataMessagesTask=_t.default;const At=n(142);t.SerialGroupTask=At.default;const kt=n(53);t.SessionStateControllerAction=kt.default;const Tt=n(117);t.SessionStateControllerDeferPriority=Tt.default;const It=n(54);t.SessionStateControllerState=It.default;const Ot=n(55);t.SessionStateControllerTransitionResult=Ot.default;const Et=n(143);t.SetLocalDescriptionTask=Et.default;const xt=n(144);t.SetRemoteDescriptionTask=xt.default;const Pt=n(108);t.SignalingAndMetricsConnectionMonitor=Pt.default;const Mt=n(135);t.SignalingClientConnectionRequest=Mt.default;const Dt=n(119);t.SignalingClientEvent=Dt.default;const Rt=n(6);t.SignalingClientEventType=Rt.default;const Ft=n(128);t.SignalingClientJoin=Ft.default;const Nt=n(146);t.SignalingClientSubscribe=Nt.default;const Lt=n(155);t.SimulcastLayers=Lt.default;const jt=n(59);t.SimulcastTransceiverController=jt.default;const Vt=n(149);t.SimulcastVideoStreamIndex=Vt.default;const Bt=n(234);t.SingleNodeAudioTransformDevice=Bt.default;const Ut=n(92);t.Some=Ut.default;const Wt=n(123);t.StreamMetricReport=Wt.default;const Ht=n(145);t.SubscribeAndReceiveSubscribeAckTask=Ht.default;const qt=n(43);t.TaskStatus=qt.default;const $t=n(30);t.TimeoutScheduler=$t.default;const Gt=n(57);t.TimeoutTask=Gt.default;const Kt=n(101);t.TypeError=Kt.default;const zt=n(133);t.UnusableAudioWarningConnectionHealthPolicy=zt.default;const Yt=n(16);t.Versioning=Yt.default;const Jt=n(148);t.VideoAdaptiveProbePolicy=Jt.default;const Xt=n(31);t.VideoLogEvent=Xt.default;const Qt=n(102);t.VideoQualitySettings=Qt.default;const Zt=n(235);t.VideoSource=Zt.default;const en=n(61);t.VideoStreamDescription=en.default;const tn=n(95);t.VideoTileState=tn.default;const nn=n(236);t.VoiceFocusDeviceTransformer=nn.default;const rn=n(169);t.VoiceFocusTransformDevice=rn.default;const sn=n(147);t.WaitForAttendeePresenceTask=sn.default;const on=n(35);t.WebSocketReadyState=on.default;const an=n(96);Object.defineProperty(t,"isAudioTransformDevice",{enumerable:!0,get:function(){return an.isAudioTransformDevice}});const cn=n(160);Object.defineProperty(t,"isDestroyable",{enumerable:!0,get:function(){return cn.isDestroyable}});const ln=n(49);Object.defineProperty(t,"isVideoTransformDevice",{enumerable:!0,get:function(){return ln.isVideoTransformDevice}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(30);class r extends i.default{constructor(){super(0)}static nextTick(e){setTimeout(e,0)}}t.default=r},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionStatusCode=void 0,function(e){e[e.OK=0]="OK",e[e.Left=1]="Left",e[e.AudioJoinedFromAnotherDevice=2]="AudioJoinedFromAnotherDevice",e[e.AudioDisconnectAudio=3]="AudioDisconnectAudio",e[e.AudioAuthenticationRejected=4]="AudioAuthenticationRejected",e[e.AudioCallAtCapacity=5]="AudioCallAtCapacity",e[e.AudioCallEnded=6]="AudioCallEnded",e[e.TURNMeetingEnded=6]="TURNMeetingEnded",e[e.MeetingEnded=6]="MeetingEnded",e[e.AudioInternalServerError=7]="AudioInternalServerError",e[e.AudioServiceUnavailable=8]="AudioServiceUnavailable",e[e.AudioDisconnected=9]="AudioDisconnected",e[e.VideoCallSwitchToViewOnly=10]="VideoCallSwitchToViewOnly",e[e.VideoCallAtSourceCapacity=11]="VideoCallAtSourceCapacity",e[e.SignalingBadRequest=12]="SignalingBadRequest",e[e.SignalingInternalServerError=13]="SignalingInternalServerError",e[e.SignalingRequestFailed=14]="SignalingRequestFailed",e[e.StateMachineTransitionFailed=15]="StateMachineTransitionFailed",e[e.ICEGatheringTimeoutWorkaround=16]="ICEGatheringTimeoutWorkaround",e[e.ConnectionHealthReconnect=17]="ConnectionHealthReconnect",e[e.RealtimeApiFailed=18]="RealtimeApiFailed",e[e.TaskFailed=19]="TaskFailed",e[e.AudioDeviceSwitched=20]="AudioDeviceSwitched",e[e.IncompatibleSDP=21]="IncompatibleSDP",e[e.TURNCredentialsForbidden=22]="TURNCredentialsForbidden",e[e.NoAttendeePresent=23]="NoAttendeePresent"}(i=t.MeetingSessionStatusCode||(t.MeetingSessionStatusCode={})),t.default=i},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.intervalMs=e}start(e){this.stop(),this.timer=setInterval(e,this.intervalMs)}stop(){void 0!==this.timer&&(clearInterval(this.timer),this.timer=void 0)}running(){return void 0!==this.timer}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i extends Error{constructor(e,t){super(t||"Error fetching device."),this.cause=e}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),r=n(201);class s{static get sdkName(){return"amazon-chime-sdk-js"}static get sdkVersion(){return r.default.semverString}static get buildSHA(){return r.default.hash.substr(1)}static get sdkUserAgentLowResolution(){const e=new i.default;return`${e.name()}-${e.majorVersion()}`}static urlWithVersion(e){const t=new URL(e);return t.searchParams.append(s.X_AMZN_VERSION,s.sdkVersion),t.searchParams.append(s.X_AMZN_USER_AGENT,s.sdkUserAgentLowResolution),t.toString()}}t.default=s,s.X_AMZN_VERSION="X-Amzn-Version",s.X_AMZN_USER_AGENT="X-Amzn-User-Agent"},function(e,t,n){"use strict";(function(e){var i=t;function r(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;++r)void 0!==e[i[r]]&&n||(e[i[r]]=t[i[r]]);return e}function s(e){function t(e,n){if(!(this instanceof t))return new t(e,n);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),n&&r(this,n)}return(t.prototype=Object.create(Error.prototype)).constructor=t,Object.defineProperty(t.prototype,"name",{get:function(){return e}}),t.prototype.toString=function(){return this.name+": "+this.message},t}i.asPromise=n(204),i.base64=n(205),i.EventEmitter=n(206),i.float=n(207),i.inquire=n(208),i.utf8=n(209),i.pool=n(210),i.LongBits=n(211),i.global="undefined"!=typeof window&&window||void 0!==e&&e||"undefined"!=typeof self&&self||this,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isNode=Boolean(i.global.process&&i.global.process.versions&&i.global.process.versions.node),i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var n=e[t];return!(null==n||!e.hasOwnProperty(t))&&("object"!=typeof n||(Array.isArray(n)?n.length:Object.keys(n).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var n=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(n.lo,n.hi,t):n.toNumber(Boolean(t))},i.merge=r,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=s,i.ProtocolError=s("ProtocolError"),i.oneOfGetter=function(e){for(var t={},n=0;n<e.length;++n)t[e[n]]=1;return function(){for(var e=Object.keys(this),n=e.length-1;n>-1;--n)if(1===t[e[n]]&&void 0!==this[e[n]]&&null!==this[e[n]])return e[n]}},i.oneOfSetter=function(e){return function(t){for(var n=0;n<e.length;++n)e[n]!==t&&delete this[e[n]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;e?(i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,n){return new e(t,n)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}):i._Buffer_from=i._Buffer_allocUnsafe=null}}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e){this.ids=new Set(e)}add(e){this.ids.add(e)}array(){return Array.from(this.ids.values()).sort((e,t)=>e-t)}contain(e){return this.ids.has(e)}empty(){return 0===this.ids.size}size(){return this.ids.size}equal(e){if(!e)return 0===this.ids.size;const t=this.array(),n=e.array();if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}clone(){return new i(this.array())}remove(e){this.ids.delete(e)}toJSON(){return this.array()}}t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.LogLevel=void 0,function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e[e.OFF=4]="OFF"}(i=t.LogLevel||(t.LogLevel={})),t.default=i},function(e,t){var n,i,r=e.exports={};function s(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===s||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:s}catch(e){n=s}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(e){i=o}}();var c,l=[],d=!1,u=-1;function h(){d&&c&&(d=!1,c.length?l=c.concat(l):u=-1,l.length&&p())}function p(){if(!d){var e=a(h);d=!0;for(var t=l.length;t;){for(c=l,l=[];++u<t;)c&&c[u].run();u=-1,t=l.length}c=null,d=!1,function(e){if(i===clearTimeout)return clearTimeout(e);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(e);try{i(e)}catch(t){try{return i.call(null,e)}catch(t){return i.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function g(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||d||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=g,r.addListener=g,r.once=g,r.off=g,r.removeListener=g,r.removeAllListeners=g,r.emit=g,r.prependListener=g,r.prependOnceListener=g,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=n,this.currentRetry=0,this.fixedWaitMs<0&&(this.fixedWaitMs=0),this.shortBackoffMs<0&&(this.shortBackoffMs=0),this.longBackoffMs<0&&(this.longBackoffMs=0),this.reset()}reset(){this.currentRetry=0}nextBackoffAmountMs(){const e=Math.random()*Math.min(this.longBackoffMs,this.shortBackoffMs*Math.pow(2,this.currentRetry))+this.fixedWaitMs;return this.currentRetry+=1,e}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportDirection=void 0,function(e){e[e.UPSTREAM=0]="UPSTREAM",e[e.DOWNSTREAM=1]="DOWNSTREAM"}(i=t.ClientMetricReportDirection||(t.ClientMetricReportDirection={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(33);class r{constructor(e){this._id=e}id(){return this._id}base(){return this._id?this._id.split(r.MODALITY_SEPARATOR)[0]:""}modality(){if(!this._id)return"";const e=this._id.split(r.MODALITY_SEPARATOR);return 2===e.length?e[1]:""}hasModality(e){return""!==e&&this.modality()===e}withModality(e){const t=new r(this.base()+r.MODALITY_SEPARATOR+e);return""===e||""===this.base()||new r(t._id).modality()!==e?new r(this.base()):t}}t.default=r,r.MODALITY_SEPARATOR=i.default.Modality[0],r.MODALITY_CONTENT=i.default.Modality.substr(1)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(105);class r{constructor(e){this.sdp=e}clone(){return new r(this.sdp)}static isRTPCandidate(e){const t=/candidate[:](\S+) (\d+)/g.exec(e);return null!==t&&"1"===t[2]}static linesToSDP(e){return new r(e.join(r.CRLF))}static candidateTypeFromString(e){switch(e){case i.default.Host:return i.default.Host;case i.default.ServerReflexive:return i.default.ServerReflexive;case i.default.PeerReflexive:return i.default.PeerReflexive;case i.default.Relay:return i.default.Relay}return null}static candidateType(e){const t=/a[=]candidate[:].* typ ([a-z]+) /g.exec(e);return null===t?null:r.candidateTypeFromString(t[1])}static splitLines(e){return e.trim().split("\n").map(e=>e.trim())}static splitSections(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+r.CRLF)}static findActiveCameraSection(e){let t=0,n=!1;for(const i of e){if(/^m=video/.test(i)&&i.indexOf("sendrecv")>-1){n=!0;break}t++}return!1===n&&(t=-1),t}static parseSSRCMedia(e){const t=e.indexOf(" ");let n=0,i="",s="";n=r.extractSSRCFromAttributeLine(e);const o=e.indexOf(":",t);return o>-1?(i=e.substr(t+1,o-t-1),s=e.substr(o+1)):i=e.substr(t+1),[n,i,s]}static extractSSRCsFromFIDGroupLine(e){return/^a=ssrc-group:FID\s(.+)/.exec(e)[1]}static extractSSRCFromAttributeLine(e){const t=/^a=ssrc:([0-9]+)\s/.exec(e);return null===t?0:parseInt(t[1],10)}static matchPrefix(e,t){return r.splitLines(e).filter(e=>0===e.indexOf(t))}lines(){return this.sdp.split(r.CRLF)}hasVideo(){return null!==/^m=video/gm.exec(this.sdp)}hasCandidates(){return null!==/a[=]candidate[:]/g.exec(this.sdp)}hasCandidatesForAllMLines(){return!(this.sdp.indexOf("c=IN IP4 0.0.0.0")>-1)}withBundleAudioVideo(){const e=this.lines(),t=[];for(const n of e){const e=n.replace(/^a=group:BUNDLE audio$/,"a=group:BUNDLE audio video");e===n?t.push(n):t.push(e)}return r.linesToSDP(t)}copyVideo(e){const t=e.split(r.CRLF),n=r.splitLines(this.sdp);let i=!1;for(const e of t)/^m=video/.test(e)?i=!0:/^m=/.test(e)&&(i=!1),i&&n.push(e);return r.linesToSDP(n)}withoutCandidateType(e){return r.linesToSDP(this.lines().filter(t=>r.candidateType(t)!==e))}withoutServerReflexiveCandidates(){return this.withoutCandidateType(i.default.ServerReflexive)}withBandwidthRestriction(e,t){const n=this.lines(),i=[];for(const r of n)i.push(r),/^m=video/.test(r)&&(t?i.push("b=TIAS:"+1e3*e):i.push("b=AS:"+e));return r.linesToSDP(i)}withAudioMaxAverageBitrate(e){if(!e)return this.clone();e=Math.trunc(Math.min(Math.max(e,r.rfc7587LowestBitrate),r.rfc7587HighestBitrate));const t=this.lines(),n=[],i=/^a=rtpmap:\s*(\d+)\s+opus\/48000/;let s=!1,o=null;for(const r of t){if(r.startsWith("m=audio")&&(s=!0,o=null),r.startsWith("m=video")&&(s=!1,o=null),s){const e=i.exec(r);null!==e&&(o=`a=fmtp:${e[1]} `,s=!1)}if(o&&r.startsWith(o)){const t=r.slice(o.length).split(";"),i=[];for(const e of t)e.startsWith("maxaveragebitrate=")||i.push(e);i.push("maxaveragebitrate="+e),n.push(o+i.join(";"))}else n.push(r)}return r.linesToSDP(n)}withUnifiedPlanFormat(){let e=this.sdp;return e.includes("mozilla")?this.clone():(e=e.replace("o=-","o=mozilla-chrome"),new r(e))}preferH264IfExists(){const e=this.sdp,t=r.splitSections(e);if(t.length<2)return new r(this.sdp);const n=[];for(let e=0;e<t.length;e++){if(/^m=video/.test(t[e])){const n=r.splitLines(t[e]);let i=0,s=0;if(n.forEach(e=>{if(/^a=rtpmap:/.test(e)){const t=/^a=rtpmap:([0-9]+)\s/.exec(e);e.toLowerCase().includes("vp8")?i=parseInt(t[1],10):e.toLowerCase().includes("h264")&&(s=parseInt(t[1],10))}}),0!==i&&0!==s){const e=n[0].split(" ");let t=-1,r=-1;for(let n=3;n<e.length;n++){const o=parseInt(e[n],10);o===i?t=n:o===s&&(r=n)}t<r&&(e[t]=s.toString(),e[r]=i.toString()),n[0]=e.join(" ")}t[e]=n.join(r.CRLF)+r.CRLF}n.push(t[e])}const i=n.join("");return new r(i)}withOldFashionedMungingSimulcast(e){if(e<2)return this.clone();const t=this.sdp,n=r.splitSections(t);if(n.length<2)return new r(this.sdp);const i=r.findActiveCameraSection(n);if(-1===i)return new r(this.sdp);let s="",o="";r.matchPrefix(n[i],"a=ssrc:").forEach(e=>{const t=r.parseSSRCMedia(e);"cname"===t[1]?s=t[2]:"msid"===t[1]&&(o=t[2])});const a=r.matchPrefix(n[i],"a=ssrc-group:FID ");if(""===s||""===o||a.length<1)return new r(this.sdp);const c=r.extractSSRCsFromFIDGroupLine(a[0]),l=n[i].trim().split(r.CRLF).filter(e=>0!==e.indexOf("a=ssrc:")&&0!==e.indexOf("a=ssrc-group:")),d=[],[u,h]=c.split(" ").map(e=>parseInt(e,10));let p=u,f=h;for(let t=0;t<e;t++)l.push("a=ssrc:"+p+" cname:"+s),l.push("a=ssrc:"+p+" msid:"+o),l.push("a=ssrc:"+f+" cname:"+s),l.push("a=ssrc:"+f+" msid:"+o),l.push("a=ssrc-group:FID "+p+" "+f),d.push(p),p+=1,f=p+1;l.push("a=ssrc-group:SIM "+d.join(" ")),n[i]=l.join(r.CRLF)+r.CRLF;const g=n.join("");return new r(g)}ssrcForVideoSendingSection(){const e=this.sdp,t=r.splitSections(e);if(t.length<2)return"";const n=r.findActiveCameraSection(t);if(-1===n)return"";const i=r.matchPrefix(t[n],"a=ssrc-group:FID ");if(i.length<1)return"";const s=r.extractSSRCsFromFIDGroupLine(i[0]),[o]=s.split(" ").map(e=>parseInt(e,10));return o.toString()}videoSendSectionHasDifferentSSRC(e){const t=this.ssrcForVideoSendingSection(),n=e.ssrcForVideoSendingSection();if(""===t||""===n)return!1;return parseInt(t,10)!==parseInt(n,10)}}t.default=r,r.CRLF="\r\n",r.rfc7587LowestBitrate=6e3,r.rfc7587HighestBitrate=51e4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,n,i,r){this.cameraWidth=e,this.cameraHeight=t,this.cameraFrameRate=n,this.maxEncodeBitrateKbps=i,this.isSimulcast=r}equal(e){let t=e.captureWidth()===this.cameraWidth&&e.captureHeight()===this.cameraHeight&&e.captureFrameRate()===this.cameraFrameRate&&e.encodeBitrates().length===this.encodeBitrates().length&&e.encodeWidths().length===this.encodeWidths().length&&e.encodeHeights().length===this.encodeHeights().length;if(t)for(let n=0;n<e.encodeWidths().length;n++)if(e.encodeWidths()[n]!==this.encodeWidths()[n]||e.encodeHeights()[n]!==this.encodeHeights()[n]||e.encodeBitrates()[n]!==this.encodeBitrates()[n])return t=!1,t;return t}clone(){return new i(this.cameraWidth,this.cameraHeight,this.cameraFrameRate,this.maxEncodeBitrateKbps,this.isSimulcast)}captureWidth(){return this.cameraWidth}captureHeight(){return this.cameraHeight}captureFrameRate(){return this.cameraFrameRate}encodeBitrates(){return[this.maxEncodeBitrateKbps]}encodeWidths(){return[this.cameraWidth]}encodeHeights(){return[this.cameraHeight]}}t.default=i},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.isOldChrome=t.supportsWASMStreaming=t.supportsSharedArrayBuffer=t.supportsWASM=t.supportsAudioWorklet=t.supportsWorker=t.supportsVoiceFocusWorker=t.supportsWASMPostMessage=t.isSafari=void 0;const r=n(66);t.isSafari=(e=globalThis)=>{const t=e.navigator.userAgent,n=t.match(/Safari\//),i=t.match(/Chrom(?:e|ium)\//);return!(!n||i)};t.supportsWASMPostMessage=(e=globalThis)=>!t.isSafari(e);t.supportsVoiceFocusWorker=(e=globalThis,n,s)=>i(void 0,void 0,void 0,(function*(){if(!t.supportsWorker(e,s))return!1;const i=n.paths.workers+"worker-v1.js";try{const e=yield r.loadWorker(i,"VoiceFocusTestWorker",n,s);try{e.terminate()}catch(e){null==s||s.debug("Failed to terminate worker.",e)}return!0}catch(e){return null==s||s.info("Failed to fetch and instantiate test worker",e),!1}}));t.supportsWorker=(e=globalThis,t)=>{try{return!!e.Worker}catch(e){return null==t||t.info("Does not support Worker",e),!1}};t.supportsAudioWorklet=(e=globalThis,t)=>{try{return!!e.AudioWorklet&&!!e.AudioWorkletNode}catch(e){return null==t||t.info("Does not support Audio Worklet",e),!1}};t.supportsWASM=(e=globalThis,t)=>{try{return!(!e.WebAssembly||!e.WebAssembly.compile&&!e.WebAssembly.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM",e),!1}};t.supportsSharedArrayBuffer=(e=globalThis,t=globalThis,n)=>{try{return!(!e.SharedArrayBuffer||!t.chrome&&!e.crossOriginIsolated)}catch(e){return null==n||n.info("Does not support SharedArrayBuffer."),!1}};t.supportsWASMStreaming=(e=globalThis,t)=>{var n;try{return!!(null===(n=e.WebAssembly)||void 0===n?void 0:n.compileStreaming)}catch(e){return null==t||t.info("Does not support WASM streaming compilation",e),!1}};t.isOldChrome=(e=globalThis,t)=>{try{if(!e.chrome)return!1}catch(e){}const n=e.navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)/);return n?parseInt(n[1],10)<90&&(null==t||t.debug(`Chrome ${n[1]} has incomplete SIMD support.`),!0):(null==t||t.debug("Unknown Chrome version."),!0)}},function(e,t,n){const i=n(275),r=n(276),s=String.fromCharCode(30);e.exports={protocol:4,encodePacket:i,encodePayload:(e,t)=>{const n=e.length,r=new Array(n);let o=0;e.forEach((e,a)=>{i(e,!1,e=>{r[a]=e,++o===n&&t(r.join(s))})})},decodePacket:r,decodePayload:(e,t)=>{const n=e.split(s),i=[];for(let e=0;e<n.length;e++){const s=r(n[e],t);if(i.push(s),"error"===s.type)break}return i}}},function(e,t,n){function i(e){if(e)return function(e){for(var t in i.prototype)e[t]=i.prototype[t];return e}(e)}e.exports=i,i.prototype.on=i.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},i.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},i.prototype.off=i.prototype.removeListener=i.prototype.removeAllListeners=i.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},i.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t)}return this},i.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},i.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){(function(i){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,r=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(r=i))}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(278)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(20))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.timeoutMs=e,this.timer=null}start(e){this.stop(),this.timer=setTimeout(()=>{clearTimeout(this.timer),e()},this.timeoutMs)}stop(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null)}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.VideoLogEvent=void 0,function(e){e[e.InputAttached=0]="InputAttached",e[e.SendingFailed=1]="SendingFailed",e[e.SendingSuccess=2]="SendingSuccess"}(i=t.VideoLogEvent||(t.VideoLogEvent={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.ClientMetricReportMediaType=void 0,function(e){e[e.AUDIO=0]="AUDIO",e[e.VIDEO=1]="VIDEO"}(i=t.ClientMetricReportMediaType||(t.ClientMetricReportMediaType={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.Modality="#content"}(i||(i={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(12);class s{constructor(e){this._statusCode=e}statusCode(){return this._statusCode}isFailure(){switch(this._statusCode){case r.default.AudioAuthenticationRejected:case r.default.AudioCallAtCapacity:case r.default.AudioInternalServerError:case r.default.AudioServiceUnavailable:case r.default.AudioDisconnected:case r.default.VideoCallAtSourceCapacity:case r.default.SignalingBadRequest:case r.default.SignalingInternalServerError:case r.default.SignalingRequestFailed:case r.default.StateMachineTransitionFailed:case r.default.ICEGatheringTimeoutWorkaround:case r.default.ConnectionHealthReconnect:case r.default.RealtimeApiFailed:case r.default.TaskFailed:case r.default.NoAttendeePresent:return!0;default:return!1}}isTerminal(){switch(this._statusCode){case r.default.Left:case r.default.AudioJoinedFromAnotherDevice:case r.default.AudioAuthenticationRejected:case r.default.AudioCallAtCapacity:case r.default.MeetingEnded:case r.default.AudioDisconnected:case r.default.TURNCredentialsForbidden:case r.default.SignalingBadRequest:case r.default.SignalingRequestFailed:case r.default.VideoCallAtSourceCapacity:case r.default.RealtimeApiFailed:return!0;default:return!1}}isAudioConnectionFailure(){switch(this._statusCode){case r.default.AudioAuthenticationRejected:case r.default.AudioInternalServerError:case r.default.AudioServiceUnavailable:case r.default.StateMachineTransitionFailed:case r.default.ICEGatheringTimeoutWorkaround:case r.default.SignalingBadRequest:case r.default.SignalingInternalServerError:case r.default.SignalingRequestFailed:case r.default.RealtimeApiFailed:case r.default.NoAttendeePresent:return!0;default:return!1}}static fromSignalFrame(e){return e.error&&e.error.status?this.fromSignalingStatus(e.error.status):e.type===i.SdkSignalFrame.Type.AUDIO_STATUS?e.audioStatus?this.fromAudioStatus(e.audioStatus.audioStatus):new s(r.default.SignalingRequestFailed):new s(r.default.OK)}static fromAudioStatus(e){switch(e){case 200:return new s(r.default.OK);case 301:return new s(r.default.AudioJoinedFromAnotherDevice);case 302:return new s(r.default.AudioDisconnectAudio);case 403:return new s(r.default.AudioAuthenticationRejected);case 409:return new s(r.default.AudioCallAtCapacity);case 410:return new s(r.default.MeetingEnded);case 500:return new s(r.default.AudioInternalServerError);case 503:return new s(r.default.AudioServiceUnavailable);default:switch(Math.floor(e/100)){case 2:return new s(r.default.OK);default:return new s(r.default.AudioDisconnected)}}}static fromSignalingStatus(e){switch(e){case 206:return new s(r.default.VideoCallSwitchToViewOnly);case 509:return new s(r.default.VideoCallAtSourceCapacity);default:switch(Math.floor(e/100)){case 2:return new s(r.default.OK);case 4:return new s(r.default.SignalingBadRequest);case 5:return new s(r.default.SignalingInternalServerError);default:return new s(r.default.SignalingRequestFailed)}}}}t.default=s},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.WebSocketReadyState=void 0,function(e){e[e.None=0]="None",e[e.Connecting=1]="Connecting",e[e.Open=2]="Open",e[e.Closing=3]="Closing",e[e.Closed=4]="Closed"}(i=t.WebSocketReadyState||(t.WebSocketReadyState={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.attendeeId=null,this.externalUserId=null,this.joinToken=null}toJSON(){return{attendeeId:this.attendeeId,joinToken:null===this.joinToken?null:"<redacted>"}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(30);class r{constructor(e,t){this.reconnectTimeoutMs=e,this.backoffPolicy=t,this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this._isFirstConnection=!0,this.backoffTimer=null,this.backoffCancel=null,this.reset()}timeSpentReconnectingMs(){return this.firstConnectionAttempted?Date.now()-this.firstConnectionAttemptTimestampMs:0}hasPastReconnectDeadline(){return Date.now()-this.lastActiveTimestampMs>=this.reconnectTimeoutMs||this.timeSpentReconnectingMs()>=this.reconnectTimeoutMs}reset(){this.cancel(),this.shouldReconnect=!0,this.onlyRestartPeerConnection=!1,this.firstConnectionAttempted=!1,this.firstConnectionAttemptTimestampMs=0,this.lastActiveTimestampMs=1/0,this.backoffPolicy.reset()}startedConnectionAttempt(e){this._isFirstConnection=e,this.firstConnectionAttempted||(this.firstConnectionAttempted=!0,this.firstConnectionAttemptTimestampMs=Date.now())}hasStartedConnectionAttempt(){return this.firstConnectionAttempted}isFirstConnection(){return this._isFirstConnection}disableReconnect(){this.shouldReconnect=!1}enableRestartPeerConnection(){this.onlyRestartPeerConnection=!0}cancel(){this.disableReconnect(),this.backoffTimer&&(this.backoffTimer.stop(),this.backoffCancel&&(this.backoffCancel(),this.backoffCancel=null))}retryWithBackoff(e,t){const n=this.shouldReconnect&&!this.hasPastReconnectDeadline();return n&&(this.backoffCancel=t,this.backoffTimer=new i.default(this.backoffPolicy.nextBackoffAmountMs()),this.backoffTimer.start(()=>{this.backoffCancel=null,e()})),n}shouldOnlyRestartPeerConnection(){return this.onlyRestartPeerConnection}clone(){return new r(this.reconnectTimeoutMs,this.backoffPolicy)}setLastActiveTimestampMs(e){this.lastActiveTimestampMs=e}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(16),r=n(35);t.default=class{constructor(e){this.logger=e}create(e,t,n){this.connection=new WebSocket(n?e:i.default.urlWithVersion(e),t),this.connection.binaryType="arraybuffer"}send(e){try{return e instanceof Uint8Array?this.connection.send(e.buffer):this.connection.send(e),!0}catch(e){return this.logger.debug(()=>`send error: ${e.message}, websocket state=${r.default[this.readyState()]}`),!1}}close(e,t){this.connection.close(e,t)}destroy(){this.connection=null}addEventListener(e,t){this.connection.addEventListener(e,t)}readyState(){if(!this.connection)return r.default.None;switch(this.connection.readyState){case WebSocket.CONNECTING:return r.default.Connecting;case WebSocket.OPEN:return r.default.Open;case WebSocket.CLOSING:return r.default.Closing;case WebSocket.CLOSED:return r.default.Closed}}}},function(e,t,n){(function(i){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,r=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(r=i))}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(269)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(20))},function(e,t){e.exports="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")()},function(e,t,n){var i=n(298);i.__esModule&&(i=i.default),"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);(0,n(301).default)("beb57aac",i,!1,{})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18);t.default=class{constructor(e){this.selfAttendeeId=e,this.reset()}reset(){this.optimalReceiveSet=new i.default,this.subscribedReceiveSet=new i.default}updateIndex(e){this.optimalReceiveSet=this.calculateOptimalReceiveSet(e)}updateMetrics(e){}wantsResubscribe(){return!this.subscribedReceiveSet.equal(this.optimalReceiveSet)}chooseSubscriptions(){return this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.subscribedReceiveSet.clone()}calculateOptimalReceiveSet(e){return e.highestQualityStreamFromEachGroupExcludingSelf(this.selfAttendeeId)}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.IDLE="IDLE",e.RUNNING="RUNNING",e.CANCELED="CANCELED",e.FINISHED="FINISHED"}(i||(i={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.AudioLogEvent=void 0,function(e){e[e.DeviceChanged=0]="DeviceChanged",e[e.MutedLocal=1]="MutedLocal",e[e.UnmutedLocal=2]="UnmutedLocal",e[e.Connected=3]="Connected",e[e.ConnectFailed=4]="ConnectFailed",e[e.RedmicStartLoss=5]="RedmicStartLoss",e[e.RedmicEndLoss=6]="RedmicEndLoss"}(i=t.AudioLogEvent||(t.AudioLogEvent={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.minHealth=e.minHealth,this.maxHealth=e.maxHealth,this.currentHealth=e.initialHealth,this.currentData=t.clone()}minimumHealth(){return this.minHealth}maximumHealth(){return this.maxHealth}health(){return this.maximumHealth()}update(e){this.currentData=e}getConnectionHealthData(){return this.currentData.clone()}healthy(){return this.health()>this.minimumHealth()}healthIfChanged(){const e=this.health();return e!==this.currentHealth?(this.currentHealth=e,e):null}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),s=n(8),o=n(93),a=n(11),c=n(14),l=n(47),d=n(96),u=n(97),h=n(15),p=n(98),f=n(99),g=n(100),m=n(48),v=n(101),b=n(102),S=n(49);class y{constructor(e,t,n=new r.default){this.logger=e,this.browserBehavior=n,this.deviceInfoCache=null,this.activeDevices={audio:null,video:null},this.chosenVideoTransformDevice=null,this.audioOutputDeviceId=null,this.deviceChangeObservers=new Set,this.deviceLabelTrigger=()=>navigator.mediaDevices.getUserMedia({audio:!0,video:!0}),this.audioInputDestinationNode=null,this.audioInputSourceNode=null,this.videoInputQualitySettings=null,this.useWebAudio=!1,this.inputDeviceCount=0,this.alreadyHandlingDeviceChange=!1;const{enableWebAudio:i=!1}=t||{};this.useWebAudio=i,this.muteCallback=e=>{var t;null===(t=this.transform)||void 0===t||t.device.mute(e)},this.videoInputQualitySettings=new b.default(y.defaultVideoWidth,y.defaultVideoHeight,y.defaultVideoFrameRate,y.defaultVideoMaxBandwidthKbps);const s=this.browserBehavior.requiresResolutionAlignment(this.videoInputQualitySettings.videoWidth,this.videoInputQualitySettings.videoHeight);this.videoInputQualitySettings.videoWidth=s[0],this.videoInputQualitySettings.videoHeight=s[1],this.logger.info(`DefaultDeviceController video dimension ${this.videoInputQualitySettings.videoWidth} x ${this.videoInputQualitySettings.videoHeight}`);try{this.mediaDeviceWrapper=(new o.default).create();const e=navigator.mediaDevices.getSupportedConstraints();this.logger.info("Supported Constraints in this browser "+JSON.stringify(e))}catch(t){e.error(t.message)}}isWatchingForDeviceChanges(){return!!this.onDeviceChangeCallback}ensureWatchingDeviceChanges(){this.isWatchingForDeviceChanges()||(this.logger.info("Starting devicechange listener."),this.onDeviceChangeCallback=()=>this.handleDeviceChange(),this.mediaDeviceWrapper.addEventListener("devicechange",this.onDeviceChangeCallback))}stopWatchingDeviceChanges(){this.isWatchingForDeviceChanges()&&(this.logger.info("Stopping devicechange listener."),this.mediaDeviceWrapper.removeEventListener("devicechange",this.onDeviceChangeCallback),this.onDeviceChangeCallback=void 0)}shouldObserveDeviceChanges(){if(this.deviceChangeObservers.size)return!0;return this.activeDevices.audio&&null!==this.activeDevices.audio.constraints||this.activeDevices.video&&null!==this.activeDevices.video.constraints||!!this.audioOutputDeviceId}watchForDeviceChangesIfNecessary(){this.shouldObserveDeviceChanges()?this.ensureWatchingDeviceChanges():this.stopWatchingDeviceChanges()}destroy(){var e,t;return i(this,void 0,void 0,(function*(){this.stopWatchingDeviceChanges(),yield this.chooseAudioInputDevice(null),yield this.chooseVideoInputDevice(null),null===(e=this.audioInputSourceNode)||void 0===e||e.disconnect(),null===(t=this.audioInputDestinationNode)||void 0===t||t.disconnect(),this.audioInputSourceNode=void 0,this.audioInputDestinationNode=void 0}))}listAudioInputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.listDevicesOfKind("audioinput");return this.trace("listAudioInputDevices",null,e),e}))}listVideoInputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.listDevicesOfKind("videoinput");return this.trace("listVideoInputDevices",null,e),e}))}listAudioOutputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.listDevicesOfKind("audiooutput");return this.trace("listAudioOutputDevices",null,e),e}))}pushAudioMeetingStateForPermissions(e){var t,n;null===(n=null===(t=this.boundAudioVideoController)||void 0===t?void 0:t.eventController)||void 0===n||n.publishEvent(null===e?"audioInputUnselected":"audioInputSelected")}pushVideoMeetingStateForPermissions(e){var t,n;null===(n=null===(t=this.boundAudioVideoController)||void 0===t?void 0:t.eventController)||void 0===n||n.publishEvent(null===e?"videoInputUnselected":"videoInputSelected")}chooseAudioInputDevice(e){var t;return i(this,void 0,void 0,(function*(){if(void 0!==e){if(d.isAudioTransformDevice(e)){this.logger.info("Choosing transform input device "+e);const n=this.browserBehavior.requiresContextRecreationForAudioWorklet();return n&&(this.logger.info("Recreating audio context when selecting transform device."),this.transform&&(this.transform.nodes&&(this.transform.nodes.end.disconnect(),this.transform.nodes=void 0),this.transform=void 0),this.audioInputSourceNode&&(this.audioInputSourceNode.disconnect(),this.audioInputSourceNode=void 0),this.audioInputDestinationNode&&(this.audioInputDestinationNode.disconnect(),this.audioInputDestinationNode=void 0),y.closeAudioContext()),yield this.chooseAudioTransformInputDevice(e),n&&(null===(t=this.boundAudioVideoController)||void 0===t?void 0:t.rtcPeerConnection)&&this.boundAudioVideoController.restartLocalAudio(()=>{this.logger.info("Local audio restarted.")}),this.pushAudioMeetingStateForPermissions(e)}this.removeTransform(),yield this.chooseInputIntrinsicDevice("audio",e,!1),this.trace("chooseAudioInputDevice",e,"success"),this.pushAudioMeetingStateForPermissions(e)}else this.logger.error("Audio input device cannot be undefined")}))}chooseAudioTransformInputDevice(e){var t;return i(this,void 0,void 0,(function*(){if((null===(t=this.transform)||void 0===t?void 0:t.device)===e)return;if(!this.useWebAudio)throw new Error("Cannot apply transform device without enabling Web Audio.");const n=y.getAudioContext();if(n instanceof OfflineAudioContext);else switch(n.state){case"running":break;case"closed":throw new Error("Cannot choose a transform device with a closed audio context.");case"suspended":yield n.resume()}let i;try{i=yield e.createAudioNode(n)}catch(e){throw this.logger.error(`Unable to create transform device node: ${e}.`),e}const r=yield e.intrinsicDevice();yield this.chooseInputIntrinsicDevice("audio",r,!1),this.logger.debug(`Got inner stream: ${r}.`),this.setTransform(e,i)}))}chooseVideoTransformInputDevice(e){var t,n;return i(this,void 0,void 0,(function*(){if(e===this.chosenVideoTransformDevice)return void this.logger.info("Reselecting same VideoTransformDevice");const i=this.chosenVideoTransformDevice;i&&this.logger.info("Switched from previous VideoTransformDevice");const r=!!i,s=yield e.intrinsicDevice();if(!this.isMediaStreamReusableByDeviceId(null===(t=this.activeDevices.video)||void 0===t?void 0:t.stream,s))return this.logger.info("video transform device needs new intrinsic device"),r&&i.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=e,this.activeDevices.video=null,void(yield this.chooseInputIntrinsicDevice("video",s,!1,!0));this.chosenVideoTransformDevice=e;const o=this.activeDevices.video.stream;if(this.logger.info("video transform device uses previous stream"),!s.id){const e=s;e.width=e.width||this.videoInputQualitySettings.videoWidth,e.height=e.height||this.videoInputQualitySettings.videoHeight,e.frameRate=e.frameRate||this.videoInputQualitySettings.videoFrameRate,yield o.getVideoTracks()[0].applyConstraints(e)}yield e.transformStream(this.activeDevices.video.stream),(null===(n=this.boundAudioVideoController)||void 0===n?void 0:n.videoTileController.hasStartedLocalVideoTile())&&(this.boundAudioVideoController.replaceLocalVideo?this.restartLocalVideoAfterSelection(null,!1,!0):yield this.boundAudioVideoController.update())}))}chooseVideoInputDevice(e){return i(this,void 0,void 0,(function*(){if(void 0!==e){if(S.isVideoTransformDevice(e))return this.logger.info("Choosing video transform device "+e),this.chooseVideoTransformInputDevice(e);this.updateMaxBandwidthKbps(),this.chosenVideoInputIsTransformDevice()&&(this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null),yield this.chooseInputIntrinsicDevice("video",e,!1),this.trace("chooseVideoInputDevice",e),this.pushVideoMeetingStateForPermissions(e)}else this.logger.error("Video input device cannot be undefined")}))}chooseAudioOutputDevice(e){return i(this,void 0,void 0,(function*(){this.audioOutputDeviceId=e,this.watchForDeviceChangesIfNecessary(),yield this.bindAudioOutput(),this.trace("chooseAudioOutputDevice",e,null)}))}addDeviceChangeObserver(e){this.logger.info("adding device change observer"),this.deviceChangeObservers.add(e),this.watchForDeviceChangesIfNecessary(),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.logger.info("removing device change observer"),this.deviceChangeObservers.delete(e),this.watchForDeviceChangesIfNecessary(),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){var e,t;if(!this.activeDevices.audio)return null;const n=null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.end;if(n){const e=n.context.createAnalyser();return e.removeOriginalInputs=()=>{try{n.disconnect(e)}catch(e){}},n.connect(e),e}return this.createAnalyserNodeForRawAudioInput()}createAnalyserNodeForRawAudioInput(){return this.activeDevices.audio?this.createAnalyserNodeForStream(this.activeDevices.audio.stream):null}createAnalyserNodeForStream(e){const t=y.getAudioContext(),n=t.createAnalyser(),i=t.createMediaStreamSource(e);return i.connect(n),this.trace("createAnalyserNodeForAudioInput"),n.removeOriginalInputs=()=>{try{i.disconnect(n)}catch(e){}},n}startVideoPreviewForVideoInput(e){if(!this.activeDevices.video)return this.logger.warn("cannot bind video preview since video input device has not been chosen"),void this.trace("startVideoPreviewForVideoInput",e.id);this.releaseMediaStream(e.srcObject),l.default.disconnectVideoStreamFromVideoElement(e,!1),navigator.mediaDevices.getUserMedia(this.activeDevices.video.constraints).then(t=>{l.default.connectVideoStreamToVideoElement(t,e,!0)}).catch(t=>{this.logger.warn(`Unable to reacquire video stream for preview to element ${e.id}: ${t}`)}),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){const t=e.srcObject,n=this.activeDevices.video;n&&this.releaseActiveDevice(n),t&&(this.releaseMediaStream(t),l.default.disconnectVideoStreamFromVideoElement(e,!1)),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){this.deviceLabelTrigger=e,this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){let t=null;return this.useWebAudio?(t=y.getAudioContext().createMediaStreamSource(e),t.connect(this.getMediaStreamOutputNode())):this.logger.warn("WebAudio is not enabled, mixIntoAudioInput will not work"),this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,n,i){const r=this.browserBehavior.requiresResolutionAlignment(e,t);this.videoInputQualitySettings=new b.default(r[0],r[1],n,i),this.updateMaxBandwidthKbps()}getVideoInputQualitySettings(){return this.videoInputQualitySettings}acquireAudioInputStream(){return this.acquireInputStream("audio")}acquireVideoInputStream(){return this.acquireInputStream("video")}acquireDisplayInputStream(e){return i(this,void 0,void 0,(function*(){return e&&e.video&&e.video.mandatory&&e.video.mandatory.chromeMediaSource&&e.video.mandatory.chromeMediaSourceId?navigator.mediaDevices.getUserMedia(e):navigator.mediaDevices.getDisplayMedia(e)}))}releaseAudioTransformStream(){this.logger.info("Stopping audio track for Web Audio graph"),this.stopTracksAndRemoveCallback("audio"),this.logger.info("Removing audio transform, if there is one."),this.removeTransform(),this.audioInputSourceNode.disconnect(),this.audioInputSourceNode=void 0,this.audioInputDestinationNode.disconnect(),this.audioInputDestinationNode=void 0}releaseVideoTransformStream(){this.logger.info("Stopping video track for transform"),this.stopTracksAndRemoveCallback("video"),this.logger.info("Disconnecting video transform"),this.chosenVideoTransformDevice.onOutputStreamDisconnect(),this.chosenVideoTransformDevice=null}stopTracksAndRemoveCallback(e){const t=this.activeDevices[e],n=null==t?void 0:t.endedCallback;for(const i of t.stream.getTracks())i.stop(),n&&(i.removeEventListener("ended",n),delete t.endedCallback),delete this.activeDevices[e]}releaseOrdinaryStream(e){var t;const n=e.getTracks();if(n.length){for(const e of n)e.stop();for(const i in this.activeDevices){const r=this.activeDevices[i];(null==r?void 0:r.stream)===e&&(r.endedCallback&&(n[0].removeEventListener("ended",r.endedCallback),delete r.endedCallback),delete this.activeDevices[i],"video"===i&&(null===(t=this.boundAudioVideoController)||void 0===t?void 0:t.videoTileController.hasStartedLocalVideoTile())&&this.boundAudioVideoController.videoTileController.stopLocalVideoTile())}}}releaseMediaStream(e){var t,n;if(e)try{if(e===(null===(t=this.audioInputDestinationNode)||void 0===t?void 0:t.stream))return void this.releaseAudioTransformStream();if(e===(null===(n=this.chosenVideoTransformDevice)||void 0===n?void 0:n.outputMediaStream))return void this.releaseVideoTransformStream();this.releaseOrdinaryStream(e)}finally{this.watchForDeviceChangesIfNecessary()}}chosenVideoInputIsTransformDevice(){return!!this.chosenVideoTransformDevice}bindToAudioVideoController(e){this.boundAudioVideoController&&this.unsubscribeFromMuteAndUnmuteLocalAudio(),this.boundAudioVideoController=e,this.subscribeToMuteAndUnmuteLocalAudio(),this.browserBehavior.supportsSetSinkId()&&a.default.nextTick(()=>{this.bindAudioOutput()})}subscribeToMuteAndUnmuteLocalAudio(){this.boundAudioVideoController&&this.boundAudioVideoController.realtimeController&&this.boundAudioVideoController.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(this.muteCallback)}unsubscribeFromMuteAndUnmuteLocalAudio(){this.boundAudioVideoController.realtimeController&&this.boundAudioVideoController.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(this.muteCallback)}static getIntrinsicDeviceId(e){if(void 0===e)return;if(null===e)return null;if("string"==typeof e)return e;if(e.id)return e.id;const t=e.deviceId;if(void 0===t)return;if(null===t)return null;if("string"==typeof t||Array.isArray(t))return t;const n=t;return"string"==typeof n.exact||Array.isArray(n.exact)?n.exact:void 0}static createEmptyAudioDevice(){return y.synthesizeAudioDevice(0)}static createEmptyVideoDevice(){return y.synthesizeVideoDevice("black")}static synthesizeAudioDevice(e){const t=y.getAudioContext(),n=t.createMediaStreamDestination();if(e){const i=t.createGain();i.gain.value=.1,i.connect(n);const r=t.createOscillator();r.frequency.value=e,r.connect(i),r.start()}else{const e=t.createBufferSource();try{e.buffer=t.createBuffer(1,5*t.sampleRate,t.sampleRate)}catch(n){if(!n||"NotSupportedError"!==n.name)throw n;e.buffer=t.createBuffer(1,5*y.defaultSampleRate,y.defaultSampleRate)}e.buffer.getChannelData(0)[0]=3e-4,e.loop=!0,e.connect(n),e.start()}return n.stream}static synthesizeVideoDevice(e){const t=document.createElement("canvas");t.width=480,t.height=t.width/16*9;const n=function(e,t){const n=new c.default(1e3),i=e.getContext("2d"),r=e.captureStream(5)||null;if(!r)return;n.start(()=>{"smpte"===t?function(e,t){const n=e.width,i=e.height,r=2*i/3,s=3*i/4,o=i,a=["#c0c0c0","#c0c000","#00c0c0","#00c000","#c000c0","#c00000","#0000c0"],c=["#0000c0","#000000","#c000c0","#000000","#00c0c0","#000000","#c0c0c0"],l=["#00214c","#ffffff","#32006a","#131313","#090909","#131313","#1d1d1d","#131313"],d=[0*n,1*n/4*(5/7),2*n/4*(5/7),3*n/4*(5/7),n*(5/7),n*(5/7+1/21),n*(5/7+2/21),n*(6/7),1*n],u=n/a.length,h=e.getContext("2d");for(let e=0;e<a.length;e++)h.fillStyle=a[e],h.fillRect(t+e*u,0,u,r),h.fillStyle=c[e],h.fillRect(t+e*u,r,u,s-r);for(let e=0;e<l.length;e++)h.fillStyle=l[e],h.fillRect(t+d[e],s,d[e+1]-d[e],o-s)}(e,0):(i.fillStyle=t,i.fillRect(0,0,e.width,e.height))});const s=()=>{n.stop()};return r.getVideoTracks()[0].addEventListener("ended",s),{listener:s,scheduler:n,stream:r}}(t,e);if(!n)return null;const{stream:i}=n;return i}updateMaxBandwidthKbps(){this.boundAudioVideoController&&this.boundAudioVideoController.setVideoMaxBandwidthKbps(this.videoInputQualitySettings.videoMaxBandwidthKbps)}listDevicesOfKind(e){return i(this,void 0,void 0,(function*(){return null!==this.deviceInfoCache&&this.isWatchingForDeviceChanges()||(yield this.updateDeviceInfoCacheFromBrowser()),this.listCachedDevicesOfKind(e)}))}updateDeviceInfoCacheFromBrowser(){return i(this,void 0,void 0,(function*(){if("undefined"==typeof MediaDeviceInfo)return void(this.deviceInfoCache=[]);let e=yield navigator.mediaDevices.enumerateDevices(),t=!0;for(const n of e)if(!n.label){t=!1;break}if(!t)try{this.logger.info("attempting to trigger media device labels since they are hidden");const t=yield this.deviceLabelTrigger();e=yield navigator.mediaDevices.enumerateDevices();for(const e of t.getTracks())e.stop()}catch(e){this.logger.info("unable to get media device labels")}this.deviceInfoCache=e}))}listCachedDevicesOfKind(e){const t=[];for(const n of this.deviceInfoCache)n.kind===e&&t.push(n);return t}handleDeviceChange(){return i(this,void 0,void 0,(function*(){if(null===this.deviceInfoCache)return;if(this.alreadyHandlingDeviceChange)return void a.default.nextTick(()=>{this.handleDeviceChange()});this.alreadyHandlingDeviceChange=!0;const e=this.listCachedDevicesOfKind("audioinput"),t=this.listCachedDevicesOfKind("videoinput"),n=this.listCachedDevicesOfKind("audiooutput");yield this.updateDeviceInfoCacheFromBrowser();const i=this.listCachedDevicesOfKind("audioinput"),r=this.listCachedDevicesOfKind("videoinput"),o=this.listCachedDevicesOfKind("audiooutput");this.forEachObserver(a=>{this.areDeviceListsEqual(e,i)||s.default.of(a.audioInputsChanged).map(e=>e.bind(a)(i)),this.areDeviceListsEqual(t,r)||s.default.of(a.videoInputsChanged).map(e=>e.bind(a)(r)),this.areDeviceListsEqual(n,o)||s.default.of(a.audioOutputsChanged).map(e=>e.bind(a)(o))}),this.alreadyHandlingDeviceChange=!1}))}handleDeviceStreamEnded(e,t){return i(this,void 0,void 0,(function*(){try{yield this.chooseInputIntrinsicDevice(e,null,!1)}catch(e){this.logger.error("Failed to choose null device after stream ended.")}"audio"===e?this.forEachObserver(e=>{s.default.of(e.audioInputStreamEnded).map(n=>n.bind(e)(t))}):this.forEachObserver(e=>{s.default.of(e.videoInputStreamEnded).map(n=>n.bind(e)(t))})}))}forEachObserver(e){for(const t of this.deviceChangeObservers)a.default.nextTick(()=>{this.deviceChangeObservers.has(t)&&e(t)})}areDeviceListsEqual(e,t){return JSON.stringify(e.map(e=>JSON.stringify(e)).sort())===JSON.stringify(t.map(e=>JSON.stringify(e)).sort())}intrinsicDeviceAsMediaStream(e){return e&&e.id?e:null}hasSameGroupId(e,t,n){if(""===e)return!0;const i=y.getIntrinsicDeviceId(n);return"string"==typeof i&&e===this.getGroupIdFromDeviceId(t,i)}getGroupIdFromDeviceId(e,t){if(null!==this.deviceInfoCache){const n=this.listCachedDevicesOfKind(e+"input").find(e=>e.deviceId===t);if(n&&n.groupId)return n.groupId}return""}getActiveDeviceId(e){if(this.activeDevices[e]&&this.activeDevices[e].constraints){const t=(this.activeDevices[e].constraints.audio||this.activeDevices[e].constraints.video).deviceId;let n;return n="string"==typeof t?t:t.exact,n}return null}restartLocalVideoAfterSelection(e,t,n){return i(this,void 0,void 0,(function*(){!t&&this.boundAudioVideoController&&this.boundAudioVideoController.videoTileController.hasStartedLocalVideoTile()?n?(yield this.boundAudioVideoController.replaceLocalVideo(),this.logger.info("successfully replaced video track"),(null==e?void 0:e.stream.active)&&(this.logger.warn("previous media stream is not stopped during restart video"),this.releaseActiveDevice(e))):(this.logger.info("restarting local video to switch to new device"),this.boundAudioVideoController.restartLocalVideo(()=>{(null==e?void 0:e.stream.active)&&(this.logger.warn("previous media stream is not stopped during restart video"),this.releaseActiveDevice(e))})):this.releaseActiveDevice(e)}))}handleGetUserMediaError(e,t){if(!e)throw new h.default(e);switch(e.name){case"NotReadableError":case"TrackStartError":throw new f.default(e);case"NotFoundError":case"DevicesNotFoundError":throw new p.default(e);case"NotAllowedError":case"PermissionDeniedError":case"SecurityError":throw t&&t<y.permissionDeniedOriginDetectionThresholdMs?new m.default(e,"Permission denied by browser"):new m.default(e,"Permission denied by user");case"OverconstrainedError":case"ConstraintNotSatisfiedError":throw new g.default(e);case"TypeError":throw new v.default(e);case"AbortError":default:throw new h.default(e)}}releaseActiveDevice(e){if(e&&e.stream){if(e.endedCallback){const t=e.stream.getTracks()[0];t&&t.removeEventListener("ended",e.endedCallback)}delete e.endedCallback,this.releaseMediaStream(e.stream),delete e.stream}}chooseInputIntrinsicDevice(e,t,n,r=!1){var s,o,a,c,l;return i(this,void 0,void 0,(function*(){this.inputDeviceCount+=1;const i=this.inputDeviceCount;if(null===t&&"video"===e){this.lastNoVideoInputDeviceCount=this.inputDeviceCount;const t=this.activeDevices[e];return void(t&&(this.releaseActiveDevice(t),delete this.activeDevices[e],this.watchForDeviceChangesIfNecessary()))}const d=this.calculateMediaStreamConstraints(e,t);if(this.activeDevices[e]&&this.activeDevices[e].matchesConstraints(d)&&this.activeDevices[e].stream.active&&null!==this.activeDevices[e].groupId&&this.hasSameGroupId(this.activeDevices[e].groupId,e,t))return void this.logger.info(`reusing existing ${e} device`);"audio"===e&&this.activeDevices[e]&&this.activeDevices[e].stream&&this.releaseActiveDevice(this.activeDevices[e]);const h=Date.now(),p=new u.default;try{this.logger.info(`requesting new ${e} device with constraint ${JSON.stringify(d)}`);const n=this.intrinsicDeviceAsMediaStream(t);if("audio"===e&&null===t)p.stream=y.createEmptyAudioDevice(),p.constraints=null;else if(n)this.logger.info(`using media stream ${n.id} for ${e} device`),p.stream=n,p.constraints=d;else{if(p.stream=yield navigator.mediaDevices.getUserMedia(d),p.constraints=d,"video"===e&&this.lastNoVideoInputDeviceCount>i)return this.logger.warn(`ignored to get video device for constraints ${JSON.stringify(d)} as no device was requested`),void this.releaseMediaStream(p.stream);yield this.handleDeviceChange();const t=p.stream.getTracks()[0];p.endedCallback=()=>{this.activeDevices[e]&&this.activeDevices[e].stream===p.stream&&(this.logger.warn(e+" input device which was active is no longer available, resetting to null device"),this.handleDeviceStreamEnded(e,this.getActiveDeviceId(e)),delete p.endedCallback)},t.addEventListener("ended",p.endedCallback,{once:!0})}p.groupId=(null===(s=this.getMediaTrackSettings(p.stream))||void 0===s?void 0:s.groupId)||""}catch(t){let i;if(i=(null==t?void 0:t.name)&&t.message?`${t.name}: ${t.message}`:(null==t?void 0:t.name)?t.name:(null==t?void 0:t.message)?t.message:"UnknownError","audio"===e?null===(a=null===(o=this.boundAudioVideoController)||void 0===o?void 0:o.eventController)||void 0===a||a.publishEvent("audioInputFailed",{audioInputErrorMessage:i}):null===(l=null===(c=this.boundAudioVideoController)||void 0===c?void 0:c.eventController)||void 0===l||l.publishEvent("videoInputFailed",{videoInputErrorMessage:i}),this.logger.error(`failed to get ${e} device for constraints ${JSON.stringify(d)}: ${i}`),t&&"constraint"in t&&this.logger.error("Over-constrained by constraint: "+t.constraint),"audio"===e){this.logger.info(`choosing null ${e} device instead`);try{p.stream=y.createEmptyAudioDevice(),p.constraints=null,yield this.handleNewInputDevice(e,p,n)}catch(t){this.logger.error(`failed to choose null ${e} device. ${t.name}: ${t.message}`)}}this.handleGetUserMediaError(t,Date.now()-h)}finally{this.watchForDeviceChangesIfNecessary()}this.logger.info(`got ${e} device for constraints ${JSON.stringify(d)}`),yield this.handleNewInputDevice(e,p,n,r)}))}handleNewInputDevice(e,t,n,r=!1){return i(this,void 0,void 0,(function*(){const i=this.activeDevices[e];if(this.activeDevices[e]=t,this.watchForDeviceChangesIfNecessary(),"video"===e)this.chosenVideoInputIsTransformDevice()&&(this.logger.info("apply processors to transform"),yield this.chosenVideoTransformDevice.transformStream(this.activeDevices.video.stream)),yield this.restartLocalVideoAfterSelection(i,n,r);else if(this.releaseActiveDevice(i),this.useWebAudio)this.attachAudioInputStreamToAudioContext(this.activeDevices[e].stream);else if(this.boundAudioVideoController)try{yield this.boundAudioVideoController.restartLocalAudio(()=>{})}catch(e){this.logger.info("cannot replace audio track due to: "+e.message)}else this.logger.info("no audio-video controller is bound to the device controller")}))}bindAudioOutput(){return i(this,void 0,void 0,(function*(){if(!this.boundAudioVideoController)return;const e=this.deviceInfoFromDeviceId("audiooutput",this.audioOutputDeviceId);yield this.boundAudioVideoController.audioMixController.bindAudioDevice(e)}))}calculateMediaStreamConstraints(e,t){let n={};""===t&&(t=null);const i=this.intrinsicDeviceAsMediaStream(t);if(null===t)return null;if("string"==typeof t?this.browserBehavior.requiresNoExactMediaStreamConstraints()&&this.browserBehavior.requiresGroupIdMediaStreamConstraints()?(n.deviceId=t,n.groupId=this.getGroupIdFromDeviceId(e,t)):this.browserBehavior.requiresNoExactMediaStreamConstraints()?n.deviceId=t:n.deviceId={exact:t}:i?n.streamId=i.id:!function(e){return"object"==typeof e&&"deviceId"in e&&"groupId"in e&&"kind"in e&&"label"in e}(t)?n=t:(n.deviceId=t.deviceId,n.groupId=t.groupId),"video"===e&&(n.width=n.width||{ideal:this.videoInputQualitySettings.videoWidth},n.height=n.height||{ideal:this.videoInputQualitySettings.videoHeight},n.frameRate=n.frameRate||{ideal:this.videoInputQualitySettings.videoFrameRate},n.googCpuOveruseDetection=!0,n.googCpuOveruseEncodeUsage=!0,n.googCpuOveruseThreshold=85,n.googCpuUnderuseThreshold=55),"audio"===e&&this.supportSampleRateConstraint()&&(n.sampleRate={ideal:y.defaultSampleRate}),"audio"===e&&this.supportSampleSizeConstraint()&&(n.sampleSize={ideal:y.defaultSampleSize}),"audio"===e&&this.supportChannelCountConstraint()&&(n.channelCount={ideal:y.defaultChannelCount}),"audio"===e){n=Object.assign({echoCancellation:!0,googEchoCancellation:!0,googEchoCancellation2:!0,googAutoGainControl:!0,googAutoGainControl2:!0,googNoiseSuppression:!0,googNoiseSuppression2:!0,googHighpassFilter:!0},n)}return"audio"===e?{audio:n}:{video:n}}deviceInfoFromDeviceId(e,t){if(null===this.deviceInfoCache)return null;for(const n of this.deviceInfoCache)if(n.kind===e&&n.deviceId===t)return n;return null}acquireInputStream(e){return i(this,void 0,void 0,(function*(){if("audio"===e&&this.useWebAudio){return this.getMediaStreamDestinationNode().stream}if("video"===e&&this.chosenVideoInputIsTransformDevice())return this.chosenVideoTransformDevice.outputMediaStream;let t=null;if(this.activeDevices[e]){this.logger.info(`checking whether existing ${e} device can be reused`);const n=this.activeDevices[e];t=n.constraints?n.constraints[e]:null}else{if("audio"!==e)throw this.logger.error(`no ${e} device chosen, stopping local video tile`),this.boundAudioVideoController.videoTileController.stopLocalVideoTile(),new Error(`no ${e} device chosen, stopping local video tile`);this.logger.info(`no ${e} device chosen, creating empty ${e} device`)}try{yield this.chooseInputIntrinsicDevice(e,t,!0)}catch(t){if(this.logger.error(`unable to acquire ${e} device`),t instanceof m.default)throw t;throw new h.default(t,`unable to acquire ${e} device`)}return this.activeDevices[e].stream}))}hasAppliedTransform(){return!!this.transform}isMediaStreamReusableByDeviceId(e,t){if(!e||!e.active||!t)return!1;if(t.id)return e.id===t.id;const n=this.getMediaTrackSettings(e);if(!n.deviceId)return!1;const i=y.getIntrinsicDeviceId(t);return"string"==typeof i&&n.deviceId===i}getMediaTrackSettings(e){var t;return null===(t=e.getTracks()[0])||void 0===t?void 0:t.getSettings()}reconnectAudioInputs(){if(!this.audioInputSourceNode)return;this.audioInputSourceNode.disconnect();const e=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(e)}setTransform(e,t){var n,i;null===(i=null===(n=this.transform)||void 0===n?void 0:n.nodes)||void 0===i||i.end.disconnect(),this.transform={nodes:t,device:e};const r=null==t?void 0:t.end,s=this.getMediaStreamDestinationNode();this.logger.debug(`Connecting transform node ${r} to destination ${s}.`),null==r||r.connect(s),this.reconnectAudioInputs()}removeTransform(){var e;const t=this.transform;if(t)return null===(e=this.transform.nodes)||void 0===e||e.end.disconnect(),this.transform=void 0,this.reconnectAudioInputs(),t}attachAudioInputStreamToAudioContext(e){var t;null===(t=this.audioInputSourceNode)||void 0===t||t.disconnect(),this.audioInputSourceNode=y.getAudioContext().createMediaStreamSource(e);const n=this.getMediaStreamOutputNode();this.audioInputSourceNode.connect(n)}getMediaStreamDestinationNode(){return this.audioInputDestinationNode||(this.audioInputDestinationNode=y.getAudioContext().createMediaStreamDestination()),this.audioInputDestinationNode}getMediaStreamOutputNode(){var e,t;return(null===(t=null===(e=this.transform)||void 0===e?void 0:e.nodes)||void 0===t?void 0:t.start)||this.getMediaStreamDestinationNode()}static getAudioContext(){if(!y.audioContext){const e={};navigator.mediaDevices.getSupportedConstraints().sampleRate&&(e.sampleRate=y.defaultSampleRate),y.audioContext=new(window.AudioContext||window.webkitAudioContext)(e)}return y.audioContext}static closeAudioContext(){if(y.audioContext)try{y.audioContext.close()}catch(e){}y.audioContext=null}supportSampleRateConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleRate}supportSampleSizeConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().sampleSize}supportChannelCountConstraint(){return this.useWebAudio&&!!navigator.mediaDevices.getSupportedConstraints().channelCount}trace(e,t,n){let i="API/DefaultDeviceController/"+e;void 0!==t&&(i+=" "+JSON.stringify(t)),void 0!==n&&(i+=" -> "+JSON.stringify(n)),this.logger.info(i)}}t.default=y,y.permissionDeniedOriginDetectionThresholdMs=500,y.defaultVideoWidth=960,y.defaultVideoHeight=540,y.defaultVideoFrameRate=15,y.defaultVideoMaxBandwidthKbps=1400,y.defaultSampleRate=48e3,y.defaultSampleSize=16,y.defaultChannelCount=1,y.audioContext=null},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),s=n(23),o=n(11),a=n(95);class c{constructor(e,t,n,i){this.tileController=n,this.devicePixelRatioMonitor=i,this.tileState=new a.default,this.tileState.tileId=e,this.tileState.localTile=t,this.devicePixelRatioMonitor.registerObserver(this)}static connectVideoStreamToVideoElement(e,t,n){const s=n&&"environment"!==e.getVideoTracks()[0].getSettings().facingMode?"rotateY(180deg)":"";c.setVideoElementFlag(t,"disablePictureInPicture",n),c.setVideoElementFlag(t,"disableRemotePlayback",n),t.style.transform!==s&&(t.style.transform=s),t.hasAttribute("controls")&&t.removeAttribute("controls"),t.hasAttribute("autoplay")||t.setAttribute("autoplay","true"),t.hasAttribute("playsinline")||t.setAttribute("playsinline","true"),t.hasAttribute("muted")||(t.setAttribute("muted","true"),t.muted=!0),t.srcObject!==e&&(t.srcObject=e),(new r.default).requiresVideoElementWorkaround()&&o.default.nextTick(()=>i(this,void 0,void 0,(function*(){try{yield t.play()}catch(e){}})))}static disconnectVideoStreamFromVideoElement(e,t){if(e)if(t)e.srcObject=null,e.style.transform="";else{if(!e.srcObject)return;e.pause(),e.style.transform="",c.setVideoElementFlag(e,"disablePictureInPicture",!1),c.setVideoElementFlag(e,"disableRemotePlayback",!1);const t=e.srcObject,n=t.getTracks();for(const e of n)e.stop(),t.removeTrack(e);(new r.default).requiresVideoElementWorkaround()?o.default.nextTick(()=>{e.srcObject=null}):e.srcObject=null}}destroy(){this.devicePixelRatioMonitor.removeObserver(this),this.tileState.boundVideoElement&&this.tileState.boundVideoElement.srcObject===this.tileState.boundVideoStream&&c.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,!1),this.tileState=new a.default}devicePixelRatioChanged(e){this.tileState.devicePixelRatio=e,this.sendTileStateUpdate()}id(){return this.tileState.tileId}state(){return this.tileState.clone()}stateRef(){return this.tileState}bindVideoStream(e,t,n,i,r,o,a){let c=!1;this.tileState.boundAttendeeId!==e&&(this.tileState.boundAttendeeId=e,new s.default(e).hasModality(s.default.MODALITY_CONTENT)&&(this.tileState.isContent=!0),c=!0),this.tileState.boundExternalUserId!==a&&(this.tileState.boundExternalUserId=a,c=!0),this.tileState.localTile!==t&&(this.tileState.localTile=t,c=!0),this.tileState.boundVideoStream!==n&&(this.tileState.boundVideoStream=n,c=!0),this.tileState.videoStreamContentWidth!==i&&(this.tileState.videoStreamContentWidth=i,c=!0),this.tileState.videoStreamContentHeight!==r&&(this.tileState.videoStreamContentHeight=r,c=!0),this.tileState.streamId!==o&&(this.tileState.streamId=o,c=!0),c&&this.sendTileStateUpdate()}bindVideoElement(e){let t=!1;this.tileState.boundVideoElement!==e&&(this.tileState.boundVideoElement=e,t=!0),null!==this.tileState.boundVideoElement?(this.tileState.videoElementCSSWidthPixels!==e.clientWidth&&(this.tileState.videoElementCSSWidthPixels=e.clientWidth,t=!0),this.tileState.videoElementCSSHeightPixels!==e.clientHeight&&(this.tileState.videoElementCSSHeightPixels=e.clientHeight,t=!0)):(this.tileState.videoElementCSSWidthPixels=null,this.tileState.videoElementCSSHeightPixels=null),t&&this.sendTileStateUpdate()}pause(){this.tileState.paused||(this.tileState.paused=!0,this.sendTileStateUpdate())}unpause(){this.tileState.paused&&(this.tileState.paused=!1,this.sendTileStateUpdate())}markPoorConnection(){return!this.tileState.poorConnection&&(this.tileState.poorConnection=!0,this.sendTileStateUpdate(),!0)}unmarkPoorConnection(){return!!this.tileState.poorConnection&&(this.tileState.poorConnection=!1,this.sendTileStateUpdate(),!0)}capture(){if(!this.tileState.active)return null;const e=document.createElement("canvas"),t=this.tileState.boundVideoElement;e.width=t.videoWidth||t.width,e.height=t.videoHeight||t.height;const n=e.getContext("2d");return n.drawImage(t,0,0,e.width,e.height),n.getImageData(0,0,e.width,e.height)}sendTileStateUpdate(){this.updateActiveState(),this.updateVideoStreamOnVideoElement(),this.updateVideoElementPhysicalPixels(),this.tileController.sendTileStateUpdate(this.state())}updateActiveState(){this.tileState.active=!(this.tileState.paused||this.tileState.poorConnection||!this.tileState.boundAttendeeId||!this.tileState.boundVideoElement||!this.tileState.boundVideoStream)}updateVideoElementPhysicalPixels(){"number"==typeof this.tileState.videoElementCSSWidthPixels&&"number"==typeof this.tileState.videoElementCSSHeightPixels?(this.tileState.videoElementPhysicalWidthPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSWidthPixels,this.tileState.videoElementPhysicalHeightPixels=this.tileState.devicePixelRatio*this.tileState.videoElementCSSHeightPixels):(this.tileState.videoElementPhysicalWidthPixels=null,this.tileState.videoElementPhysicalHeightPixels=null)}updateVideoStreamOnVideoElement(){this.tileState.active?c.connectVideoStreamToVideoElement(this.tileState.boundVideoStream,this.tileState.boundVideoElement,this.tileState.localTile):c.disconnectVideoStreamFromVideoElement(this.tileState.boundVideoElement,this.tileState.paused)}static setVideoElementFlag(e,t,n){t in e&&(e[t]=n)}}t.default=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15);class r extends i.default{constructor(e,t){super(e,t)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isVideoTransformDevice=void 0,t.isVideoTransformDevice=function(e){return!!e&&"object"==typeof e&&"transformStream"in e&&"stop"in e&&"intrinsicDevice"in e}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7);t.default=class{constructor(e){this.logger=e,this.audioDevice=null,this.audioElement=null,this.audioStream=null,this.browserBehavior=new r.default}bindAudioElement(e){return i(this,void 0,void 0,(function*(){if(!e)throw new Error("Cannot bind audio element: "+e);return this.audioElement=e,this.audioElement.autoplay=!0,this.bindAudioMix()}))}unbindAudioElement(){this.audioElement&&(this.audioElement.srcObject=null,this.audioElement=null)}bindAudioStream(e){return i(this,void 0,void 0,(function*(){if(e){this.audioStream=e;try{yield this.bindAudioMix()}catch(e){this.logger&&this.logger.warn("Failed to bind audio stream: "+e)}}}))}bindAudioDevice(e){return i(this,void 0,void 0,(function*(){if(e&&!this.browserBehavior.supportsSetSinkId())throw new Error("Cannot select audio output device. This browser does not support setSinkId.");return this.audioDevice=e,this.bindAudioMix()}))}bindAudioMix(){var e,t;return i(this,void 0,void 0,(function*(){if(!this.audioElement)return;this.audioStream&&(this.audioElement.srcObject=this.audioStream);const n=(null===(e=this.audioDevice)||void 0===e?void 0:e.deviceId)!==this.audioElement.sinkId;if(n&&void 0===this.audioElement.sinkId)throw new Error("Cannot select audio output device. This browser does not support setSinkId.");const i=this.audioDevice?this.audioDevice.deviceId:"";if(i===this.audioElement.sinkId)return;const r=this.audioElement,s=this.audioStream;if(this.browserBehavior.hasChromiumWebRTC()&&(r.srcObject=null),n)try{yield r.setSinkId(i)}catch(e){throw null===(t=this.logger)||void 0===t||t.error("Failed to set sinkId for audio element: "+e),e}this.browserBehavior.hasChromiumWebRTC()&&(r.srcObject=s)}))}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(107),s=n(50),o=n(72),a=n(7),c=n(88),l=n(108),d=n(109),u=n(8),h=n(34),p=n(12),f=n(52),g=n(112),m=n(113),v=n(11),b=n(116),S=n(53),y=n(54),C=n(55),w=n(118),_=n(5),A=n(120),k=n(71),T=n(85),I=n(86),O=n(103),E=n(104),x=n(126),P=n(127),M=n(129),D=n(130),R=n(131),F=n(134),N=n(136),L=n(137),j=n(138),V=n(139),B=n(140),U=n(141),W=n(142),H=n(143),q=n(144),$=n(145),G=n(57),K=n(147),z=n(58),Y=n(59),J=n(25),X=n(42),Q=n(148),Z=n(18),ee=n(60),te=n(149),ne=n(150),ie=n(153),re=n(154),se=n(62),oe=n(156),ae=n(73);class ce{constructor(e,t,n,i,r){this._audioProfile=new o.default,this.connectionHealthData=new c.default,this.observerQueue=new Set,this.meetingSessionContext=new ae.default,this.enableSimulcast=!1,this.totalRetryCount=0,this.startAudioVideoTimestamp=0,this.destroyed=!1,this._logger=t,this.sessionStateController=new b.default(this._logger),this._configuration=e,this.enableSimulcast=e.enableUnifiedPlanForChromiumBasedBrowsers&&e.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&(new a.default).hasChromiumWebRTC(),this._webSocketAdapter=n,this._realtimeController=new m.default,this._realtimeController.realtimeSetLocalAttendeeId(e.credentials.attendeeId,e.credentials.externalUserId),this._mediaStreamBroker=i,this._reconnectController=r,this._videoTileController=new ne.default(new ie.default,this,this._logger),this._audioMixController=new s.default(this._logger),this.meetingSessionContext.logger=this._logger,this._eventController=new d.default(this)}destroy(){return i(this,void 0,void 0,(function*(){this.observerQueue.clear(),this.destroyed=!0}))}get configuration(){return this._configuration}get realtimeController(){return this._realtimeController}get activeSpeakerDetector(){return this._activeSpeakerDetector||(this._activeSpeakerDetector=new r.default(this._realtimeController,this._configuration.credentials.attendeeId,this.handleHasBandwidthPriority.bind(this))),this._activeSpeakerDetector}get videoTileController(){return this._videoTileController}get audioMixController(){return this._audioMixController}get eventController(){return this._eventController}get logger(){return this._logger}get rtcPeerConnection(){return this.meetingSessionContext&&this.meetingSessionContext.peer||null}get mediaStreamBroker(){return this._mediaStreamBroker}getRTCPeerConnectionStats(e){return this.rtcPeerConnection?this.rtcPeerConnection.getStats(e):null}setAudioProfile(e){this._audioProfile=e}addObserver(e){this.logger.info("adding meeting observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing meeting observer"),this.observerQueue.delete(e)}forEachObserver(e){for(const t of this.observerQueue)v.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}start(){this.activeSpeakerDetector,this.sessionStateController.perform(S.default.Connect,()=>{this.actionConnect(!1)})}actionConnect(e){return i(this,void 0,void 0,(function*(){if(this.connectionHealthData.reset(),this.meetingSessionContext=new ae.default,this.meetingSessionContext.logger=this.logger,this.meetingSessionContext.eventController=this.eventController,this.meetingSessionContext.browserBehavior=new a.default({enableUnifiedPlanForChromiumBasedBrowsers:this.configuration.enableUnifiedPlanForChromiumBasedBrowsers}),this.meetingSessionContext.meetingSessionConfiguration=this.configuration,this.meetingSessionContext.signalingClient=new w.default(this._webSocketAdapter,this.logger),this.meetingSessionContext.mediaStreamBroker=this._mediaStreamBroker,this.meetingSessionContext.realtimeController=this._realtimeController,this.meetingSessionContext.audioMixController=this._audioMixController,this.meetingSessionContext.audioVideoController=this,this.enableSimulcast?this.meetingSessionContext.transceiverController=new Y.default(this.logger,this.meetingSessionContext.browserBehavior):this.meetingSessionContext.transceiverController=new z.default(this.logger,this.meetingSessionContext.browserBehavior),this.meetingSessionContext.volumeIndicatorAdapter=new oe.default(this.logger,this._realtimeController,ce.MIN_VOLUME_DECIBELS,ce.MAX_VOLUME_DECIBELS),this.meetingSessionContext.videoTileController=this._videoTileController,this.meetingSessionContext.videoDownlinkBandwidthPolicy=this.configuration.videoDownlinkBandwidthPolicy,this.meetingSessionContext.videoUplinkBandwidthPolicy=this.configuration.videoUplinkBandwidthPolicy,this.meetingSessionContext.enableSimulcast=this.enableSimulcast,this.enableSimulcast){const e=new re.default(this.configuration.credentials.attendeeId,this.meetingSessionContext.logger);e.addObserver(this),this.meetingSessionContext.videoUplinkBandwidthPolicy=e,this.meetingSessionContext.videoDownlinkBandwidthPolicy=new Q.default(this.logger,this.meetingSessionContext.videoTileController),this.meetingSessionContext.videoStreamIndex=new te.default(this.logger)}else this.meetingSessionContext.enableSimulcast=!1,this.meetingSessionContext.videoStreamIndex=new ee.default(this.logger),this.meetingSessionContext.videoDownlinkBandwidthPolicy||(this.meetingSessionContext.videoDownlinkBandwidthPolicy=new X.default(this.configuration.credentials.attendeeId)),this.meetingSessionContext.videoUplinkBandwidthPolicy||(this.meetingSessionContext.videoUplinkBandwidthPolicy=new se.default(this.configuration.credentials.attendeeId)),this.meetingSessionContext.audioProfile=this._audioProfile;this.meetingSessionContext.lastKnownVideoAvailability=new f.default,this.meetingSessionContext.videoCaptureAndEncodeParameter=new J.default(0,0,0,0,!1),this.meetingSessionContext.videosToReceive=new Z.default,this.meetingSessionContext.videosPaused=new Z.default,this.meetingSessionContext.statsCollector=new A.default(this,this.logger,this.meetingSessionContext.browserBehavior),this.meetingSessionContext.connectionMonitor=new l.default(this,this._realtimeController,this._videoTileController,this.connectionHealthData,new g.default(this.meetingSessionContext.signalingClient,ce.PING_PONG_INTERVAL_MS,this.logger),this.meetingSessionContext.statsCollector),this.meetingSessionContext.reconnectController=this._reconnectController,this.meetingSessionContext.videoDeviceInformation={},e||(this.totalRetryCount=0,this._reconnectController.reset(),this.startAudioVideoTimestamp=Date.now(),this.forEachObserver(e=>{u.default.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!1))}),this.eventController&&this.eventController.publishEvent("meetingStartRequested")),this.meetingSessionContext.startAudioVideoTimestamp=this.startAudioVideoTimestamp,this._reconnectController.hasStartedConnectionAttempt()?this._reconnectController.startedConnectionAttempt(!1):this._reconnectController.startedConnectionAttempt(!0);try{yield new W.default(this.logger,this.wrapTaskName("AudioVideoStart"),[new R.default(this.meetingSessionContext,this.configuration.connectionHealthPolicyConfiguration,this.connectionHealthData),new L.default(this.meetingSessionContext),new G.default(this.logger,new W.default(this.logger,"Media",[new W.default(this.logger,"Signaling",[new F.default(this.meetingSessionContext),new D.default(this.meetingSessionContext),new U.default(this.meetingSessionContext),new P.default(this.meetingSessionContext),new j.default(this.meetingSessionContext),new B.default(this.meetingSessionContext)]),new W.default(this.logger,"Peer",[new O.default(this.meetingSessionContext),new k.default(this.meetingSessionContext),new E.default(this.meetingSessionContext),new H.default(this.meetingSessionContext),new x.default(this.meetingSessionContext),new $.default(this.meetingSessionContext),this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs>0?new G.default(this.logger,new N.default(this.logger,"FinalizeConnection",[new K.default(this.meetingSessionContext),new q.default(this.meetingSessionContext)]),this.meetingSessionContext.meetingSessionConfiguration.attendeePresenceTimeoutMs):new q.default(this.meetingSessionContext)])]),this.configuration.connectionTimeoutMs)]).run(),this.sessionStateController.perform(S.default.FinishConnecting,()=>{this.eventController&&(this.meetingSessionContext.meetingStartDurationMs=Date.now()-this.startAudioVideoTimestamp,this.eventController.publishEvent("meetingStartSucceeded",{maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,poorConnectionCount:this.meetingSessionContext.poorConnectionCount,retryCount:this.totalRetryCount,signalingOpenDurationMs:this.meetingSessionContext.signalingOpenDurationMs,iceGatheringDurationMs:this.meetingSessionContext.iceGatheringDurationMs,meetingStartDurationMs:this.meetingSessionContext.meetingStartDurationMs})),this.meetingSessionContext.startTimeMs=Date.now(),this.actionFinishConnecting()})}catch(e){this.sessionStateController.perform(S.default.Fail,()=>i(this,void 0,void 0,(function*(){const t=new h.default(this.getMeetingStatusCode(e)||p.default.TaskFailed);yield this.actionDisconnect(t,!0,e),this.handleMeetingSessionStatus(t,e)||this.notifyStop(t,e)})))}this.connectionHealthData.setConnectionStartTime()}))}actionFinishConnecting(){this.meetingSessionContext.videoDuplexMode=_.SdkStreamServiceType.RX,this.meetingSessionContext.enableSimulcast||this.enforceBandwidthLimitationForSender(this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0]),this.forEachObserver(e=>{u.default.of(e.audioVideoDidStart).map(t=>t.bind(e)())}),this._reconnectController.reset()}stop(){this.sessionStateController.perform(S.default.Disconnect,()=>{this._reconnectController.disableReconnect(),this.logger.info("attendee left meeting, session will not be reconnected"),this.actionDisconnect(new h.default(p.default.Left),!1,null)})}actionDisconnect(e,t,n){return i(this,void 0,void 0,(function*(){try{yield new W.default(this.logger,this.wrapTaskName("AudioVideoStop"),[new G.default(this.logger,new M.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)]).run()}catch(e){this.logger.info("fail to stop")}try{yield new W.default(this.logger,this.wrapTaskName("AudioVideoClean"),[new G.default(this.logger,new I.default(this.meetingSessionContext),this.configuration.connectionTimeoutMs)]).run()}catch(e){this.logger.info("fail to clean")}this.sessionStateController.perform(S.default.FinishDisconnecting,()=>{t||this.notifyStop(e,n)})}))}update(){const e=this.sessionStateController.perform(S.default.Update,()=>{this.actionUpdate(!0)});return e===C.default.Transitioned||e===C.default.DeferredTransition}restartLocalVideo(e){const t=()=>i(this,void 0,void 0,(function*(){this._videoTileController.hasStartedLocalVideoTile()&&(this.logger.info("stopping local video tile prior to local video restart"),this._videoTileController.stopLocalVideoTile(),this.logger.info("preparing local video restart update"),yield this.actionUpdate(!1),this.logger.info("starting local video tile for local video restart"),this._videoTileController.startLocalVideoTile()),this.logger.info("finalizing local video restart update"),yield this.actionUpdate(!0),e()})),n=this.sessionStateController.perform(S.default.Update,()=>{t()});return n===C.default.Transitioned||n===C.default.DeferredTransition}replaceLocalVideo(){return i(this,void 0,void 0,(function*(){let e=null;try{e=yield this.mediaStreamBroker.acquireVideoInputStream()}catch(e){throw new Error("could not acquire video stream from mediaStreamBroker due to "+e.message)}if(!e||e.getVideoTracks().length<1)throw new Error("could not acquire video track");const t=e.getVideoTracks()[0];if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw new Error("no active meeting and peer connection");if(!this.meetingSessionContext.browserBehavior.requiresUnifiedPlan())throw new Error("cannot replace track on Plan B");yield this.meetingSessionContext.transceiverController.setVideoInput(t);const n=this.meetingSessionContext.videoTileController.getLocalVideoTile();if(n){const t=n.state(),i=e.getVideoTracks()[0].getSettings();n.bindVideoStream(t.boundAttendeeId,!0,e,i.width,i.height,t.streamId,t.boundExternalUserId)}this.meetingSessionContext.activeVideoInput=e}))}restartLocalAudio(e){return i(this,void 0,void 0,(function*(){let t=null;try{t=yield this.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.logger.info("could not acquire audio stream from mediaStreamBroker")}if(!t||t.getAudioTracks().length<1)throw new Error("could not acquire audio track");this.connectionHealthData.reset(),this.connectionHealthData.setConnectionStartTime();const n=t.getAudioTracks()[0];if(!this.meetingSessionContext||!this.meetingSessionContext.peer)throw new Error("no active meeting and peer connection");let i=!1;return i=this.meetingSessionContext.browserBehavior.requiresUnifiedPlan()?yield this.meetingSessionContext.transceiverController.replaceAudioTrack(n):yield z.default.replaceAudioTrackForSender(this.meetingSessionContext.localAudioSender,n),this._realtimeController.realtimeSetLocalAudioInput(t),this.meetingSessionContext.activeAudioInput=t,e(),i?Promise.resolve():Promise.reject()}))}actionUpdate(e){return i(this,void 0,void 0,(function*(){try{yield new W.default(this.logger,this.wrapTaskName("AudioVideoUpdate"),[new V.default(this.meetingSessionContext),new G.default(this.logger,new W.default(this.logger,"UpdateSession",[new k.default(this.meetingSessionContext),new E.default(this.meetingSessionContext),new H.default(this.meetingSessionContext),new x.default(this.meetingSessionContext),new $.default(this.meetingSessionContext),new q.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),e&&this.sessionStateController.perform(S.default.FinishUpdating,()=>{this.actionFinishUpdating()})}catch(e){this.sessionStateController.perform(S.default.FinishUpdating,()=>{const t=new h.default(this.getMeetingStatusCode(e)||p.default.TaskFailed);t.statusCode()!==p.default.IncompatibleSDP&&this.logger.info("failed to update audio-video session"),this.handleMeetingSessionStatus(t,e)})}}))}notifyStop(e,t){if(this.forEachObserver(t=>{u.default.of(t.audioVideoDidStop).map(n=>n.bind(t)(e))}),this.eventController){const{signalingOpenDurationMs:n,poorConnectionCount:i,startTimeMs:r,iceGatheringDurationMs:s,attendeePresenceDurationMs:o,meetingStartDurationMs:a}=this.meetingSessionContext,c={maxVideoTileCount:this.meetingSessionContext.maxVideoTileCount,meetingDurationMs:null===r?0:Math.round(Date.now()-r),meetingStatus:p.default[e.statusCode()],signalingOpenDurationMs:n,iceGatheringDurationMs:s,attendeePresenceDurationMs:o,poorConnectionCount:i,meetingStartDurationMs:a,retryCount:this.totalRetryCount};0===c.meetingDurationMs?(c.meetingErrorMessage=t&&t.message||"",delete c.meetingDurationMs,delete c.attendeePresenceDurationMs,delete c.meetingStartDurationMs,this.eventController.publishEvent("meetingStartFailed",c)):e.isFailure()||e.isAudioConnectionFailure()?(c.meetingErrorMessage=t&&t.message||"",this.eventController.publishEvent("meetingFailed",c)):this.eventController.publishEvent("meetingEnded",c)}}actionFinishUpdating(){if(!this.meetingSessionContext.enableSimulcast){const e=this.meetingSessionContext.videoCaptureAndEncodeParameter.encodeBitrates()[0];this.enforceBandwidthLimitationForSender(e)}this.logger.info("updated audio-video session")}reconnect(e,t){const n=this._reconnectController.retryWithBackoff(()=>i(this,void 0,void 0,(function*(){this.sessionStateController.state()===y.default.NotConnected?this.sessionStateController.perform(S.default.Connect,()=>{this.actionConnect(!0)}):this.sessionStateController.perform(S.default.Reconnect,()=>{this.actionReconnect()}),this.totalRetryCount+=1})),()=>{this.logger.info("canceled retry")});return n||this.sessionStateController.perform(S.default.Fail,()=>{this.actionDisconnect(e,!1,t)}),n}actionReconnect(){return i(this,void 0,void 0,(function*(){this._reconnectController.hasStartedConnectionAttempt()||(this._reconnectController.startedConnectionAttempt(!1),this.forEachObserver(e=>{u.default.of(e.audioVideoDidStartConnecting).map(t=>t.bind(e)(!0))})),this.meetingSessionContext.volumeIndicatorAdapter.onReconnect(),this.connectionHealthData.reset();try{yield new W.default(this.logger,this.wrapTaskName("AudioVideoReconnect"),[new G.default(this.logger,new W.default(this.logger,"Media",[new T.default(this.meetingSessionContext),new W.default(this.logger,"Signaling",[new F.default(this.meetingSessionContext),new P.default(this.meetingSessionContext),new j.default(this.meetingSessionContext)]),new O.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs),new V.default(this.meetingSessionContext),new G.default(this.logger,new W.default(this.logger,"UpdateSession",[new k.default(this.meetingSessionContext),new E.default(this.meetingSessionContext),new H.default(this.meetingSessionContext),new x.default(this.meetingSessionContext),new $.default(this.meetingSessionContext),new q.default(this.meetingSessionContext)]),this.configuration.connectionTimeoutMs)]).run(),this.sessionStateController.perform(S.default.FinishConnecting,()=>{this.eventController&&this.eventController.pushMeetingState("meetingReconnected"),this.actionFinishConnecting()})}catch(e){this.sessionStateController.perform(S.default.FinishConnecting,()=>{this.logger.info("failed to reconnect audio-video session");const t=new h.default(this.getMeetingStatusCode(e)||p.default.TaskFailed);this.handleMeetingSessionStatus(t,e)})}this.connectionHealthData.setConnectionStartTime()}))}wrapTaskName(e){return`${e}/${this.configuration.meetingId}/${this.configuration.credentials.attendeeId}`}getMeetingStatusCode(e){const t=/the meeting status code: (\d+)/.exec(e&&e.message);return t&&t.length>1?Number(t[1]):null}enforceBandwidthLimitationForSender(e){return i(this,void 0,void 0,(function*(){this.meetingSessionContext.browserBehavior.requiresUnifiedPlan()?yield this.meetingSessionContext.transceiverController.setVideoSendingBitrateKbps(e):yield z.default.setVideoSendingBitrateKbpsForSender(this.meetingSessionContext.localVideoSender,e,this.meetingSessionContext.logger)}))}handleMeetingSessionStatus(e,t){if(this.logger.info("handling status: "+p.default[e.statusCode()]),e.isTerminal()||this.meetingSessionContext.statsCollector&&this.meetingSessionContext.statsCollector.logMeetingSessionStatus(e),e.statusCode()===p.default.IncompatibleSDP)return this.restartLocalVideo(()=>{this.logger.info("handled incompatible SDP by attempting to restart video")}),!0;if(e.statusCode()===p.default.VideoCallSwitchToViewOnly)return this._videoTileController.removeLocalVideoTile(),this.forEachObserver(e=>{u.default.of(e.videoSendDidBecomeUnavailable).map(t=>t.bind(e)())}),!1;if(e.isTerminal()&&(this.logger.error("session will not be reconnected"),this.meetingSessionContext.reconnectController&&this.meetingSessionContext.reconnectController.disableReconnect()),(e.isFailure()||e.isTerminal())&&this.meetingSessionContext.reconnectController){const n=this.reconnect(e,t);return n?this.logger.warn(`will retry due to status code ${p.default[e.statusCode()]}${t?" and error: "+t.message:""}`):this.logger.error(`failed with status code ${p.default[e.statusCode()]}${t?" and error: "+t.message:""}`),n}return!1}setVideoMaxBandwidthKbps(e){this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&(this.logger.info(`video send has ideal max bandwidth ${e} kbps`),this.meetingSessionContext.videoUplinkBandwidthPolicy.setIdealMaxBandwidthKbps(e))}handleHasBandwidthPriority(e){return i(this,void 0,void 0,(function*(){if(this.meetingSessionContext&&this.meetingSessionContext.videoUplinkBandwidthPolicy&&!this.meetingSessionContext.enableSimulcast){const t=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();this.meetingSessionContext.videoUplinkBandwidthPolicy.setHasBandwidthPriority(e);const n=this.meetingSessionContext.videoUplinkBandwidthPolicy.maxBandwidthKbps();t!==n&&(this.logger.info(`video send bandwidth priority ${e} max has changed from ${t} kbps to ${n} kbps`),yield this.enforceBandwidthLimitationForSender(n))}}))}pauseReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.pause([e])}resumeReceivingStream(e){this.meetingSessionContext&&this.meetingSessionContext.signalingClient&&this.meetingSessionContext.signalingClient.resume([e])}getRemoteVideoSources(){const{videoStreamIndex:e}=this.meetingSessionContext;if(!e)return this.logger.info("meeting has not started"),[];const t=this.configuration.credentials.attendeeId;return e.allVideoSendingSourcesExcludingSelf(t)}encodingSimulcastLayersDidChange(e){this.forEachObserver(t=>{u.default.of(t.encodingSimulcastLayersDidChange).map(n=>n.bind(t)(e))})}}t.default=ce,ce.MIN_VOLUME_DECIBELS=-42,ce.MAX_VOLUME_DECIBELS=-14,ce.PING_PONG_INTERVAL_MS=1e4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.remoteVideoAvailable=!1,this.canStartLocalVideo=!1}equal(e){return this.remoteVideoAvailable===e.remoteVideoAvailable&&this.canStartLocalVideo===e.canStartLocalVideo}clone(){const e=new i;return e.remoteVideoAvailable=this.remoteVideoAvailable,e.canStartLocalVideo=this.canStartLocalVideo,e}}t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerAction=void 0,function(e){e[e.Connect=0]="Connect",e[e.FinishConnecting=1]="FinishConnecting",e[e.Update=2]="Update",e[e.FinishUpdating=3]="FinishUpdating",e[e.Reconnect=4]="Reconnect",e[e.Disconnect=5]="Disconnect",e[e.Fail=6]="Fail",e[e.FinishDisconnecting=7]="FinishDisconnecting"}(i=t.SessionStateControllerAction||(t.SessionStateControllerAction={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerState=void 0,function(e){e[e.NotConnected=0]="NotConnected",e[e.Connecting=1]="Connecting",e[e.Connected=2]="Connected",e[e.Updating=3]="Updating",e[e.Disconnecting=4]="Disconnecting"}(i=t.SessionStateControllerState||(t.SessionStateControllerState={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerTransitionResult=void 0,function(e){e[e.Transitioned=0]="Transitioned",e[e.NoTransitionAvailable=1]="NoTransitionAvailable",e[e.DeferredTransition=2]="DeferredTransition",e[e.TransitionFailed=3]="TransitionFailed"}(i=t.SessionStateControllerTransitionResult||(t.SessionStateControllerTransitionResult={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.username=null,this.password=null,this.ttl=null,this.uris=null}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(30),s=n(4);class o extends s.default{constructor(e,t,n){super(e),this.taskToRunBeforeTimeout=t,this.timeoutMs=n,this.taskName=`Timeout${this.timeoutMs}ms`,t.setParent(this)}cancel(){this.logger.info(`canceling timeout task ${this.name()} subtask ${this.taskToRunBeforeTimeout}`),this.taskToRunBeforeTimeout.cancel()}run(){return i(this,void 0,void 0,(function*(){const e=new r.default(this.timeoutMs);e.start(()=>{this.logger.info("timeout reached for task "+this.name()),this.taskToRunBeforeTimeout.cancel()});try{yield this.taskToRunBeforeTimeout.run()}finally{e.stop()}this.logger.info(`timeout task ${this.name()} completed`)}))}}t.default=o},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});class r{constructor(e,t){this.logger=e,this.browserBehavior=t,this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null}setEncodingParameters(e){}static setVideoSendingBitrateKbpsForSender(e,t,n){return i(this,void 0,void 0,(function*(){if(!e||t<=0)return;const n=e.getParameters();n.encodings||(n.encodings=[{}]);for(const e of n.encodings)e.maxBitrate=1e3*t;yield e.setParameters(n)}))}static replaceAudioTrackForSender(e,t){return i(this,void 0,void 0,(function*(){return!!e&&(yield e.replaceTrack(t),!0)}))}localAudioTransceiver(){return this._localAudioTransceiver}localVideoTransceiver(){return this._localCameraTransceiver}setVideoSendingBitrateKbps(e){return i(this,void 0,void 0,(function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;const t=this._localCameraTransceiver.sender;yield r.setVideoSendingBitrateKbpsForSender(t,e,this.logger)}))}setPeer(e){this.peer=e}reset(){this._localCameraTransceiver=null,this._localAudioTransceiver=null,this.videoSubscriptions=[],this.defaultMediaStream=null,this.peer=null}useTransceivers(){return!(!this.peer||!this.browserBehavior.requiresUnifiedPlan())&&void 0!==this.peer.getTransceivers}hasVideoInput(){return!(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)}trackIsVideoInput(e){return!!this._localCameraTransceiver&&(e===this._localCameraTransceiver.sender.track||e===this._localCameraTransceiver.receiver.track)}setupLocalTransceivers(){this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),this._localAudioTransceiver||(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]})),this._localCameraTransceiver||(this._localCameraTransceiver=this.peer.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream]})))}replaceAudioTrack(e){return i(this,void 0,void 0,(function*(){return this._localAudioTransceiver&&"sendrecv"===this._localAudioTransceiver.direction?(yield this._localAudioTransceiver.sender.replaceTrack(e),!0):(this.logger.info("audio transceiver direction is not set up or not activated"),!1)}))}setAudioInput(e){return i(this,void 0,void 0,(function*(){yield this.setTransceiverInput(this._localAudioTransceiver,e)}))}setVideoInput(e){return i(this,void 0,void 0,(function*(){yield this.setTransceiverInput(this._localCameraTransceiver,e)}))}updateVideoTransceivers(e,t){if(!this.useTransceivers())return t.array();const n=this.peer.getTransceivers();return this.videoSubscriptions=[0],t=t.clone(),this.updateTransceivers(n,e,t),this.logger.debug(()=>this.debugDumpTransceivers()),this.videoSubscriptions}updateTransceivers(e,t,n){const i=n.array();let r=1;for(const n of e)if(n!==this._localCameraTransceiver&&this.transceiverIsVideo(n)){if(this.videoSubscriptions[r]=0,"inactive"!==n.direction){const e=t.streamIdForTrack("v_"+n.mid);if(void 0!==e)for(const[s,o]of i.entries())if(t.StreamIdsInSameGroup(e,o)){n.direction="recvonly",this.videoSubscriptions[r]=o,i.splice(s,1);break}}r+=1}r=1;for(const t of e)if(t!==this._localCameraTransceiver&&this.transceiverIsVideo(t)){if("inactive"===t.direction&&i.length>0){t.direction="recvonly";const e=i.shift();this.videoSubscriptions[r]=e}else 0===this.videoSubscriptions[r]&&(t.direction="inactive");r+=1}for(const e of i){const t=this.peer.addTransceiver("video",{direction:"recvonly",streams:[this.defaultMediaStream]});this.videoSubscriptions.push(e),this.logger.info(`adding transceiver mid: ${t.mid} subscription: ${e} direction: recvonly`)}}transceiverIsVideo(e){return e.receiver&&e.receiver.track&&"video"===e.receiver.track.kind||e.sender&&e.sender.track&&"video"===e.sender.track.kind}debugDumpTransceivers(){let e="",t=0;for(const n of this.peer.getTransceivers())this.transceiverIsVideo(n)&&(e+=`transceiver index=${t} mid=${n.mid} subscription=${this.videoSubscriptions[t]} direction=${n.direction}\n`,t+=1);return e}setTransceiverInput(e,t){return i(this,void 0,void 0,(function*(){e&&(e.direction=t?"sendrecv":"inactive",yield e.sender.replaceTrack(t))}))}}t.default=r},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(58);class s extends r.default{constructor(e,t){super(e,t),this.videoQualityControlParameterMap=new Map;let n=4;for(let e=0;e<s.NAME_ARR_ASCENDING.length;e++){const t=s.NAME_ARR_ASCENDING[e];this.videoQualityControlParameterMap.set(t,{rid:t,scaleResolutionDownBy:n,maxBitrate:1e3*s.BITRATE_ARR_ASCENDING[e]}),n/=2}}setEncodingParameters(e){return i(this,void 0,void 0,(function*(){if(!this._localCameraTransceiver||"sendrecv"!==this._localCameraTransceiver.direction)return;const t=this._localCameraTransceiver.sender,n=Array.from(e.values());if(n.length<=0)return;const i=t.getParameters();if(i.encodings)for(let t=0;t<i.encodings.length;t++)i.encodings[t].rid===s.LOW_LEVEL_NAME&&(i.encodings[t].maxBitrate=e.get(s.LOW_LEVEL_NAME).maxBitrate,i.encodings[t].active=e.get(s.LOW_LEVEL_NAME).active),i.encodings[t].rid===s.MID_LEVEL_NAME&&(i.encodings[t].maxBitrate=e.get(s.MID_LEVEL_NAME).maxBitrate,i.encodings[t].active=e.get(s.MID_LEVEL_NAME).active),i.encodings[t].rid===s.HIGH_LEVEL_NAME&&(i.encodings[t].maxBitrate=e.get(s.HIGH_LEVEL_NAME).maxBitrate,i.encodings[t].active=e.get(s.HIGH_LEVEL_NAME).active);else i.encodings=n;yield t.setParameters(i),this.logVideoTransceiverParameters()}))}static replaceAudioTrackForSender(e,t){return i(this,void 0,void 0,(function*(){return!!e&&(yield e.replaceTrack(t),!0)}))}setVideoSendingBitrateKbps(e){return i(this,void 0,void 0,(function*(){}))}setupLocalTransceivers(){if(this.useTransceivers()&&(this.defaultMediaStream||"undefined"==typeof MediaStream||(this.defaultMediaStream=new MediaStream),this._localAudioTransceiver||(this._localAudioTransceiver=this.peer.addTransceiver("audio",{direction:"inactive",streams:[this.defaultMediaStream]})),!this._localCameraTransceiver)){const e=Array.from(this.videoQualityControlParameterMap.values());this._localCameraTransceiver=this.peer.addTransceiver("video",{direction:"inactive",streams:[this.defaultMediaStream],sendEncodings:e})}}logVideoTransceiverParameters(){const e=this._localCameraTransceiver.sender.getParameters().encodings;let t="simulcast: current encoding parameters \n";for(const n of e)t+=`rid=${n.rid} maxBitrate=${n.maxBitrate} active=${n.active} \n`;this.logger.info(t)}}t.default=s,s.LOW_LEVEL_NAME="low",s.MID_LEVEL_NAME="mid",s.HIGH_LEVEL_NAME="hi",s.NAME_ARR_ASCENDING=["low","mid","hi"],s.BITRATE_ARR_ASCENDING=[200,400,1100]},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(18),s=n(61);t.default=class{constructor(e){this.logger=e,this.currentIndex=null,this.indexForSubscribe=null,this.currentSubscribeAck=null,this.subscribeTrackToStreamMap=null,this.subscribeStreamToAttendeeMap=null,this.subscribeStreamToExternalUserIdMap=null,this.subscribeSsrcToStreamMap=null,this.streamToAttendeeMap=null,this.streamToExternalUserIdMap=null,this.videoStreamDescription=new s.default,this.videoStreamDescription.trackLabel="AmazonChimeExpressVideo",this.videoStreamDescription.streamId=2,this.videoStreamDescription.groupId=2}localStreamDescriptions(){return[this.videoStreamDescription.clone()]}remoteStreamDescriptions(){if(!this.currentIndex||!this.currentIndex.sources)return[];const e=[];return this.currentIndex.sources.forEach(t=>{const n=new s.default;n.attendeeId=t.attendeeId,n.groupId=t.groupId,n.streamId=t.streamId,n.maxBitrateKbps=t.maxBitrateKbps,n.avgBitrateKbps=Math.floor(t.avgBitrateBps/1e3),e.push(n)}),e}integrateUplinkPolicyDecision(e){if(e&&e.length){const t=e[0];this.videoStreamDescription.maxBitrateKbps=t.maxBitrate/1e3,this.videoStreamDescription.maxFrameRate=t.maxFramerate}}integrateIndexFrame(e){this.currentIndex=e;const t=new Map;let n=!1;for(const i of e.sources){if(!t.has(i.attendeeId)){t.set(i.attendeeId,i.groupId);continue}const e=t.get(i.attendeeId);e<i.groupId&&(this.logger.warn(`Old group ID ${e} found for attendee ID ${i.attendeeId}, replacing with newer group ID ${i.groupId}`),t.set(i.attendeeId,i.groupId)),n=!0}n&&(this.currentIndex.sources=this.currentIndex.sources.filter(e=>t.get(e.attendeeId)===e.groupId)),this.streamToAttendeeMap=null,this.streamToExternalUserIdMap=null}subscribeFrameSent(){this.indexForSubscribe=this.currentIndex}integrateSubscribeAckFrame(e){this.currentSubscribeAck=e,this.subscribeTrackToStreamMap=this.buildTrackToStreamMap(this.currentSubscribeAck),this.subscribeSsrcToStreamMap=this.buildSSRCToStreamMap(this.currentSubscribeAck),this.subscribeStreamToAttendeeMap=this.buildStreamToAttendeeMap(this.indexForSubscribe),this.subscribeStreamToExternalUserIdMap=this.buildStreamExternalUserIdMap(this.indexForSubscribe)}integrateBitratesFrame(e){if(this.currentIndex)for(const t of e.bitrates){const e=this.currentIndex.sources.find(e=>e.streamId===t.sourceStreamId);void 0!==e&&(e.avgBitrateBps=t.avgBitrateBps)}}allStreams(){const e=new r.default;if(this.currentIndex)for(const t of this.currentIndex.sources)e.add(t.streamId);return e}allVideoSendingSourcesExcludingSelf(e){const t=[],n=new Set;if(this.currentIndex&&this.currentIndex.sources&&this.currentIndex.sources.length)for(const r of this.currentIndex.sources){const{attendeeId:s,externalUserId:o,mediaType:a}=r;s!==e&&a===i.SdkStreamMediaType.VIDEO&&(n.has(s)||(t.push({attendee:{attendeeId:s,externalUserId:o}}),n.add(s)))}return t}streamSelectionUnderBandwidthConstraint(e,t,n,s){const o=new Set;if(this.currentIndex)for(const r of this.currentIndex.sources)r.attendeeId!==e&&r.mediaType===i.SdkStreamMediaType.VIDEO&&(t.has(r.attendeeId)||n.has(r.attendeeId)||o.add(r.attendeeId));const a=this.buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e),c=new Map;let l=0;a.forEach((e,t)=>{c.set(t,e[0]),l+=e[0].maxBitrateKbps}),l=this.trySelectHighBitrateForAttendees(a,t,l,s,c),this.trySelectHighBitrateForAttendees(a,o,l,s,c);const d=new r.default;for(const e of c.values())d.add(e.streamId);return d}highestQualityStreamFromEachGroupExcludingSelf(e){const t=new r.default;if(this.currentIndex){const n=new Map;for(const t of this.currentIndex.sources)t.attendeeId!==e&&t.mediaType===i.SdkStreamMediaType.VIDEO&&(!n.has(t.groupId)||t.maxBitrateKbps>n.get(t.groupId).maxBitrateKbps)&&n.set(t.groupId,t);for(const e of n.values())t.add(e.streamId)}return t}numberOfVideoPublishingParticipantsExcludingSelf(e){return this.highestQualityStreamFromEachGroupExcludingSelf(e).array().length}numberOfParticipants(){return this.currentIndex.numParticipants?this.currentIndex.numParticipants:-1}attendeeIdForTrack(e){const t=this.streamIdForTrack(e);if(void 0===t||!this.subscribeStreamToAttendeeMap)return this.logger.warn("no attendee found for track "+e),"";const n=this.subscribeStreamToAttendeeMap.get(t);return n||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known attendee`),"")}externalUserIdForTrack(e){const t=this.streamIdForTrack(e);if(void 0===t||!this.subscribeStreamToExternalUserIdMap)return this.logger.warn("no external user id found for track "+e),"";const n=this.subscribeStreamToExternalUserIdMap.get(t);return n||(this.logger.info(`track ${e} (stream ${t}) does not correspond to a known externalUserId`),"")}attendeeIdForStreamId(e){if(!this.streamToAttendeeMap){if(!this.currentIndex)return"";this.streamToAttendeeMap=this.buildStreamToAttendeeMap(this.currentIndex)}const t=this.streamToAttendeeMap.get(e);return t||(this.logger.info(`stream ${e}) does not correspond to a known attendee`),"")}groupIdForStreamId(e){for(const t of this.currentIndex.sources)if(t.streamId===e)return t.groupId;if(this.indexForSubscribe)for(const t of this.indexForSubscribe.sources)if(t.streamId===e)return t.groupId}StreamIdsInSameGroup(e,t){return this.groupIdForStreamId(e)===this.groupIdForStreamId(t)}streamIdForTrack(e){if(this.subscribeTrackToStreamMap)return this.subscribeTrackToStreamMap.get(e)}streamIdForSSRC(e){if(this.subscribeSsrcToStreamMap)return this.subscribeSsrcToStreamMap.get(e)}streamsPausedAtSource(){const e=new r.default;if(this.currentIndex)for(const t of this.currentIndex.pausedAtSourceIds)e.add(t);return e}buildTrackToStreamMap(e){const t=new Map;this.logger.debug(()=>"trackMap "+JSON.stringify(e.tracks));for(const n of e.tracks)n.trackLabel.length>0&&n.streamId>0&&t.set(n.trackLabel,n.streamId);return t}buildSSRCToStreamMap(e){const t=new Map;this.logger.debug(()=>"ssrcMap "+JSON.stringify(e.tracks));for(const n of e.tracks)n.trackLabel.length>0&&n.streamId>0&&t.set(n.ssrc,n.streamId);return t}buildStreamToAttendeeMap(e){const t=new Map;if(e)for(const n of e.sources)t.set(n.streamId,n.attendeeId);return t}buildStreamExternalUserIdMap(e){const t=new Map;if(e)for(const n of e.sources)n.externalUserId&&t.set(n.streamId,n.externalUserId);return t}trySelectHighBitrateForAttendees(e,t,n,i,r){for(const s of t){if(n>=i)break;if(e.has(s)){const t=e.get(s);for(const e of t.reverse())if(n-r.get(s).maxBitrateKbps+e.maxBitrateKbps<i){n=n-r.get(s).maxBitrateKbps+e.maxBitrateKbps,r.set(s,e);break}}}return n}buildAttendeeToSortedStreamDescriptorMapExcludingSelf(e){const t=new Map;if(this.currentIndex)for(const n of this.currentIndex.sources)n.attendeeId!==e&&n.mediaType===i.SdkStreamMediaType.VIDEO&&(t.has(n.attendeeId)?t.get(n.attendeeId).push(n):t.set(n.attendeeId,[n]));return t.forEach((e,t)=>{e.sort((e,t)=>e.maxBitrateKbps>t.maxBitrateKbps?1:e.maxBitrateKbps<t.maxBitrateKbps?-1:0)}),t}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5);class r{constructor(e,t,n,i,r){this.attendeeId="",this.groupId=0,this.streamId=0,this.ssrc=0,this.trackLabel="",this.maxBitrateKbps=0,this.avgBitrateKbps=0,this.maxFrameRate=0,this.timeEnabled=0,this.disabledByWebRTC=!1,this.disabledByUplinkPolicy=!1,this.attendeeId=e,this.groupId=t,this.streamId=n,this.maxBitrateKbps=i,this.avgBitrateKbps=r}clone(){const e=new r;return e.attendeeId=this.attendeeId,e.groupId=this.groupId,e.streamId=this.streamId,e.ssrc=this.ssrc,e.trackLabel=this.trackLabel,e.maxBitrateKbps=this.maxBitrateKbps,e.avgBitrateKbps=this.avgBitrateKbps,e.maxFrameRate=this.maxFrameRate,e.timeEnabled=this.timeEnabled,e.disabledByWebRTC=this.disabledByWebRTC,e.disabledByUplinkPolicy=this.disabledByUplinkPolicy,e}toStreamDescriptor(){const e=i.SdkStreamDescriptor.create();return e.mediaType=i.SdkStreamMediaType.VIDEO,e.trackLabel=this.trackLabel,e.attendeeId=this.attendeeId,e.streamId=this.streamId,e.groupId=this.groupId,e.framerate=this.maxFrameRate,e.maxBitrateKbps=this.disabledByUplinkPolicy||this.disabledByWebRTC?0:this.maxBitrateKbps,e.avgBitrateBps=this.avgBitrateKbps,e}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(25);t.default=class{constructor(e){this.selfAttendeeId=e,this.numParticipants=0,this.idealMaxBandwidthKbps=1400,this.hasBandwidthPriority=!1,this.optimalParameters=new i.default(0,0,0,0,!1),this.parametersInEffect=new i.default(0,0,0,0,!1)}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){this.numParticipants=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+1,this.optimalParameters=new i.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1)}wantsResubscribe(){return!this.parametersInEffect.equal(this.optimalParameters)}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}captureWidth(){let e=640;return this.numParticipants>4&&(e=320),e}captureHeight(){let e=384;return this.numParticipants>4&&(e=192),e}captureFrameRate(){return 15}maxBandwidthKbps(){if(this.hasBandwidthPriority)return Math.trunc(this.idealMaxBandwidthKbps);let e=0;return e=this.numParticipants<=2?this.idealMaxBandwidthKbps:this.numParticipants<=4?2*this.idealMaxBandwidthKbps/3:(544/11+14880/(11*this.numParticipants))/600*this.idealMaxBandwidthKbps,Math.trunc(e)}setIdealMaxBandwidthKbps(e){this.idealMaxBandwidthKbps=e}setHasBandwidthPriority(e){this.hasBandwidthPriority=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(89),r=n(42),s=n(62),o=n(36),a=n(64);t.default=class{constructor(e,t){this.meetingId=null,this.externalMeetingId=null,this.credentials=null,this.urls=null,this.connectionTimeoutMs=15e3,this.screenSharingTimeoutMs=5e3,this.screenViewingTimeoutMs=5e3,this.attendeePresenceTimeoutMs=0,this.connectionHealthPolicyConfiguration=new i.default,this.enableUnifiedPlanForChromiumBasedBrowsers=!0,this.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,e&&((e=this.toLowerCasePropertyNames(e)).meeting&&(e=e.meeting),this.meetingId=e.meetingid,this.externalMeetingId=e.externalmeetingid,this.urls=new a.default,this.urls.audioHostURL=e.mediaplacement.audiohosturl,this.urls.screenDataURL=e.mediaplacement.screendataurl,this.urls.screenSharingURL=e.mediaplacement.screensharingurl,this.urls.screenViewingURL=e.mediaplacement.screenviewingurl,this.urls.signalingURL=e.mediaplacement.signalingurl,this.urls.turnControlURL=e.mediaplacement.turncontrolurl),t&&((t=this.toLowerCasePropertyNames(t)).attendee&&(t=t.attendee),this.credentials=new o.default,this.credentials.attendeeId=t.attendeeid,this.credentials.externalUserId=t.externaluserid,this.credentials.joinToken=t.jointoken),this.videoDownlinkBandwidthPolicy=new r.default(this.credentials?this.credentials.attendeeId:null),this.videoUplinkBandwidthPolicy=new s.default(this.credentials?this.credentials.attendeeId:null)}toLowerCasePropertyNames(e){return null===e?null:"object"!=typeof e?e:Array.isArray(e)?e.map(this.toLowerCasePropertyNames):Object.keys(e).reduce((t,n)=>{const i=e[n],r="object"==typeof i?this.toLowerCasePropertyNames(i):i;return t[n.toLowerCase()]=r,t},{})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this._audioHostURL=null,this._screenDataURL=null,this._screenSharingURL=null,this._screenViewingURL=null,this._signalingURL=null,this._turnControlURL=null,this.urlRewriter=e=>e}get audioHostURL(){return this.urlRewriter(this._audioHostURL)}set audioHostURL(e){this._audioHostURL=e}get screenDataURL(){return this.urlRewriter(this._screenDataURL)}set screenDataURL(e){this._screenDataURL=e}get screenSharingURL(){return this.urlRewriter(this._screenSharingURL)}set screenSharingURL(e){this._screenSharingURL=e}get screenViewingURL(){return this.urlRewriter(this._screenViewingURL)}set screenViewingURL(e){this._screenViewingURL=e}get signalingURL(){return this.urlRewriter(this._signalingURL)}set signalingURL(e){this._signalingURL=e}get turnControlURL(){return this.urlRewriter(this._turnControlURL)}set turnControlURL(e){this._turnControlURL=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{acquireAudioInputStream(){return Promise.reject()}acquireVideoInputStream(){return Promise.reject()}acquireDisplayInputStream(e){return Promise.reject()}releaseMediaStream(e){}bindToAudioVideoController(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadWorker=void 0;const i=n(168),r={method:"GET",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"no-referrer"};t.loadWorker=(e,t,n,s)=>{null==s||s.debug(`Loading ${t} worker from ${e}.`);let o=!1;try{o=self.origin===new URL(e).origin}catch(e){null==s||s.error("Could not compare origins.",e)}if(o){const r=i.withQueryString(e,n);return Promise.resolve(new Worker(r,{name:t}))}return i.fetchWithBehavior(e,r,n).then(e=>{if(e.ok)return e.blob().then(e=>new Worker(window.URL.createObjectURL(e)));throw new Error("Fetch failed.")})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusAudioWorkletNode=void 0;class i extends("undefined"!=typeof globalThis&&globalThis.AudioWorkletNode||class{}){}t.VoiceFocusAudioWorkletNode=i},function(e,t,n){const i=n(27),r=n(28),s=n(29)("engine.io-client:transport");e.exports=class extends r{constructor(e){super(),this.opts=e,this.query=e.query,this.readyState="",this.socket=e.socket}onError(e,t){const n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState?this.write(e):s("transport is not open, discarding packets")}onOpen(){this.readyState="open",this.writable=!0,this.emit("open")}onData(e){const t=i.decodePacket(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){this.emit("packet",e)}onClose(){this.readyState="closed",this.emit("close")}}},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),i=0,r=n.length;i<r;i++){var s=n[i].split("=");t[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Decoder=t.Encoder=t.PacketType=t.protocol=void 0;const i=n(28),r=n(286),s=n(188),o=n(287)("socket.io-parser");var a;t.protocol=5,function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(a=t.PacketType||(t.PacketType={}));t.Encoder=class{encode(e){return o("encoding packet %j",e),e.type!==a.EVENT&&e.type!==a.ACK||!s.hasBinary(e)?[this.encodeAsString(e)]:(e.type=e.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,this.encodeAsBinary(e))}encodeAsString(e){let t=""+e.type;return e.type!==a.BINARY_EVENT&&e.type!==a.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data)),o("encoded %j as %s",e,t),t}encodeAsBinary(e){const t=r.deconstructPacket(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}};class c extends i{constructor(){super()}add(e){let t;if("string"==typeof e)t=this.decodeString(e),t.type===a.BINARY_EVENT||t.type===a.BINARY_ACK?(this.reconstructor=new l(t),0===t.attachments&&super.emit("decoded",t)):super.emit("decoded",t);else{if(!s.isBinary(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emit("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===a[n.type])throw new Error("unknown packet type "+n.type);if(n.type===a.BINARY_EVENT||n.type===a.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const r=e.substring(i,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(i,t)}else n.nsp="/";const i=e.charAt(t+1);if(""!==i&&Number(i)==i){const i=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t));if(!c.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return o("decoded %s as %j",e,n),n}static isPayloadValid(e,t){switch(e){case a.CONNECT:return"object"==typeof t;case a.DISCONNECT:return void 0===t;case a.CONNECT_ERROR:return"string"==typeof t||"object"==typeof t;case a.EVENT:case a.BINARY_EVENT:return Array.isArray(t)&&t.length>0;case a.ACK:case a.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}t.Decoder=c;class l{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=r.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(31),s=n(4);class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="AttachMediaInputTask"}run(){return i(this,void 0,void 0,(function*(){const e=this.context.transceiverController;e.setPeer(this.context.peer),e.setupLocalTransceivers();const t=this.context.activeAudioInput;if(t){const n=t.getAudioTracks();if(this.context.browserBehavior.requiresUnifiedPlan())this.context.logger.info("attaching audio track to peer connection (unified-plan)"),yield e.setAudioInput(n.length?n[0]:null);else{this.context.logger.info("attaching audio track to peer connection (plan-b)");const e=this.context.peer.getSenders();t.getAudioTracks().forEach(n=>{e.find(e=>e.track.id===n.id)||(this.context.localAudioSender=this.context.peer.addTrack(n,t))})}}else yield e.setAudioInput(null),this.context.logger.warn("no audio track");const n=this.context.activeVideoInput;if(n){const t=n.getVideoTracks(),i=t.length?t[0]:null;if(this.context.browserBehavior.requiresUnifiedPlan()){if(this.context.logger.info("attaching video track to peer connection (unified-plan)"),yield e.setVideoInput(i),this.context.enableSimulcast&&this.context.videoUplinkBandwidthPolicy){const t=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();e.setEncodingParameters(t)}}else{this.context.logger.info("attaching video track to peer connection (plan-b)");this.context.peer.getSenders().find(e=>e.track&&e.track.id===t[0].id)||(this.context.localVideoSender&&(this.context.peer.removeTrack(this.context.localVideoSender),this.context.localVideoSender=null),this.context.localVideoSender=this.context.peer.addTrack(t[0],n))}i&&(this.context.statsCollector.logVideoEvent(r.default.InputAttached,this.context.videoDeviceInformation),this.context.videoInputAttachedTimestampMs=Date.now())}else yield e.setVideoInput(null),this.context.logger.info("no video track"),this.context.localVideoSender&&(this.context.logger.info("removing track from peer"),this.context.peer.removeTrack(this.context.localVideoSender),this.context.localVideoSender=null);this.context.videoSubscriptions=e.updateVideoTransceivers(this.context.videoStreamIndex,this.context.videosToReceive)}))}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e=null){this.audioBitrateBps=e}static fullbandSpeechMono(){return new i(4e4)}static fullbandMusicMono(){return new i(64e3)}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.logger=null,this.browserBehavior=null,this.signalingClient=null,this.meetingSessionConfiguration=null,this.peer=null,this.previousSdpOffer=null,this.sdpOfferInit=null,this.audioVideoController=null,this.realtimeController=null,this.videoTileController=null,this.mediaStreamBroker=null,this.audioMixController=null,this.activeAudioInput=null,this.activeVideoInput=null,this.transceiverController=null,this.indexFrame=null,this.iceCandidates=[],this.iceCandidateHandler=null,this.iceGatheringStateEventHandler=null,this.sdpAnswer=null,this.turnCredentials=null,this.reconnectController=null,this.removableObservers=[],this.audioProfile=null,this.videoStreamIndex=null,this.videoDownlinkBandwidthPolicy=null,this.videoUplinkBandwidthPolicy=null,this.lastKnownVideoAvailability=null,this.localVideoSender=null,this.localAudioSender=null,this.videoCaptureAndEncodeParameter=null,this.videosToReceive=null,this.videoSubscriptions=null,this.videosPaused=null,this.videoDuplexMode=null,this.volumeIndicatorAdapter=null,this.statsCollector=null,this.connectionMonitor=null,this.videoInputAttachedTimestampMs=0,this.audioDeviceInformation={},this.videoDeviceInformation={},this.enableSimulcast=!1,this.eventController=null,this.signalingOpenDurationMs=null,this.iceGatheringDurationMs=null,this.startAudioVideoTimestamp=null,this.attendeePresenceDurationMs=null,this.meetingStartDurationMs=null,this.poorConnectionCount=0,this.maxVideoTileCount=0,this.startTimeMs=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.canvas=e,this.destroyed=!1}destroy(){this.canvas=null,this.destroyed=!0}asCanvasImageSource(){return i(this,void 0,void 0,(function*(){return this.destroyed?Promise.reject("canvas buffer is destroyed"):Promise.resolve(this.canvas)}))}asCanvasElement(){return this.canvas}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.AudioInputRequestFailed=1]="AudioInputRequestFailed",e[e.AudioInputPermissionDenied=2]="AudioInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.AudioNotReceived=4]="AudioNotReceived"}(i=t.CheckAudioConnectivityFeedback||(t.CheckAudioConnectivityFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckAudioInputFeedback||(t.CheckAudioInputFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckAudioOutputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed"}(i=t.CheckAudioOutputFeedback||(t.CheckAudioOutputFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckCameraResolutionFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.ResolutionNotSupported=2]="ResolutionNotSupported",e[e.PermissionDenied=3]="PermissionDenied"}(i=t.CheckCameraResolutionFeedback||(t.CheckCameraResolutionFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckContentShareConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied",e[e.TimedOut=3]="TimedOut",e[e.ConnectionFailed=4]="ConnectionFailed"}(i=t.CheckContentShareConnectivityFeedback||(t.CheckContentShareConnectivityFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkTCPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkTCPConnectivityFeedback||(t.CheckNetworkTCPConnectivityFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckNetworkUDPConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.MeetingSessionURLsNotInitialized=1]="MeetingSessionURLsNotInitialized",e[e.ConnectionFailed=2]="ConnectionFailed",e[e.ICENegotiationFailed=3]="ICENegotiationFailed"}(i=t.CheckNetworkUDPConnectivityFeedback||(t.CheckNetworkUDPConnectivityFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoConnectivityFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.VideoInputRequestFailed=1]="VideoInputRequestFailed",e[e.VideoInputPermissionDenied=2]="VideoInputPermissionDenied",e[e.ConnectionFailed=3]="ConnectionFailed",e[e.VideoNotSent=4]="VideoNotSent"}(i=t.CheckVideoConnectivityFeedback||(t.CheckVideoConnectivityFeedback={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.CheckVideoInputFeedback=void 0,function(e){e[e.Succeeded=0]="Succeeded",e[e.Failed=1]="Failed",e[e.PermissionDenied=2]="PermissionDenied"}(i=t.CheckVideoInputFeedback||(t.CheckVideoInputFeedback={})),t.default=i},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);class s extends r.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanRestartedSessionTask"}run(){return i(this,void 0,void 0,(function*(){this.context.peer&&this.context.peer.close(),this.context.transceiverController.reset(),this.context.localVideoSender=null,this.context.peer=null,this.context.videoDownlinkBandwidthPolicy.reset(),this.context.iceCandidateHandler=null,this.context.iceCandidates=[],this.context.previousSdpOffer=null}))}}t.default=s},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),s=n(4);class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="CleanStoppedSessionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return i(this,void 0,void 0,(function*(){try{this.context.signalingClient.ready()&&(this.context.signalingClient.closeConnection(),yield this.receiveWebSocketClosedEvent())}catch(e){throw e}finally{for(const e of this.context.removableObservers)e.removeObserver();this.context.statsCollector.stop(),this.context.statsCollector=null,this.context.connectionMonitor.stop(),this.context.connectionMonitor=null,this.context.peer&&this.context.peer.close(),this.context.peer=null,this.context.localVideoSender=null,this.context.sdpAnswer=null,this.context.sdpOfferInit=null,this.context.indexFrame=null,this.context.videoDownlinkBandwidthPolicy.reset(),this.context.iceCandidateHandler=null,this.context.iceCandidates=[],this.context.turnCredentials=null,this.context.videoSubscriptions=null,this.context.transceiverController.reset(),this.context.mediaStreamBroker.releaseMediaStream(this.context.activeAudioInput),this.context.activeAudioInput=null,this.context.mediaStreamBroker.releaseMediaStream(this.context.activeVideoInput),this.context.activeVideoInput=null,this.context.realtimeController.realtimeSetLocalAudioInput(null);const e=this.context.videoTileController.getLocalVideoTile();e&&e.bindVideoStream("",!0,null,null,null,null),this.context.videoTileController.removeAllVideoTiles()}}))}receiveWebSocketClosedEvent(){return new Promise((e,t)=>{const n=new class{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(new Error("CleanStoppedSessionTask got canceled while waiting for the WebSocket closed event"))}handleSignalingClientEvent(t){t.type===r.default.WebSocketClosed&&(this.signalingClient.removeObserver(this),e())}}(this.context.signalingClient);this.taskCanceler=n,this.context.signalingClient.registerObserver(n)})}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}static isTimestampRecent(e,t){return Date.now()<e+t}setConnectionStartTime(){this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}reset(){this.connectionStartTimestampMs=0,this.consecutiveStatsWithNoPackets=0,this.lastPacketLossInboundTimestampMs=0,this.lastGoodSignalTimestampMs=0,this.lastWeakSignalTimestampMs=0,this.lastNoSignalTimestampMs=0,this.consecutiveMissedPongs=0,this.packetsReceivedInLastMinute=[],this.fractionPacketsLostInboundInLastMinute=[],this.audioSpeakerDelayMs=0,this.connectionStartTimestampMs=Date.now(),this.lastGoodSignalTimestampMs=Date.now()}isConnectionStartRecent(e){return i.isTimestampRecent(this.connectionStartTimestampMs,e)}isLastPacketLossRecent(e){return i.isTimestampRecent(this.lastPacketLossInboundTimestampMs,e)}isGoodSignalRecent(e){return i.isTimestampRecent(this.lastGoodSignalTimestampMs,e)}isWeakSignalRecent(e){return i.isTimestampRecent(this.lastWeakSignalTimestampMs,e)}isNoSignalRecent(e){return i.isTimestampRecent(this.lastNoSignalTimestampMs,e)}clone(){const e=new i;return e.connectionStartTimestampMs=this.connectionStartTimestampMs,e.consecutiveStatsWithNoPackets=this.consecutiveStatsWithNoPackets,e.lastPacketLossInboundTimestampMs=this.lastPacketLossInboundTimestampMs,e.lastGoodSignalTimestampMs=this.lastGoodSignalTimestampMs,e.lastWeakSignalTimestampMs=this.lastWeakSignalTimestampMs,e.lastNoSignalTimestampMs=this.lastNoSignalTimestampMs,e.consecutiveMissedPongs=this.consecutiveMissedPongs,e.packetsReceivedInLastMinute=this.packetsReceivedInLastMinute.slice(0),e.fractionPacketsLostInboundInLastMinute=this.fractionPacketsLostInboundInLastMinute.slice(0),e.audioSpeakerDelayMs=this.audioSpeakerDelayMs,e}setConsecutiveMissedPongs(e){this.consecutiveMissedPongs=e}setConsecutiveStatsWithNoPackets(e){this.consecutiveStatsWithNoPackets=e}setLastPacketLossInboundTimestampMs(e){this.lastPacketLossInboundTimestampMs=e}setLastNoSignalTimestampMs(e){this.lastNoSignalTimestampMs=e}setLastWeakSignalTimestampMs(e){this.lastWeakSignalTimestampMs=e}setLastGoodSignalTimestampMs(e){this.lastGoodSignalTimestampMs=e}setAudioSpeakerDelayMs(e){this.audioSpeakerDelayMs=e}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.minHealth=0,this.maxHealth=1,this.initialHealth=1,this.connectionUnhealthyThreshold=25,this.noSignalThresholdTimeMs=1e4,this.connectionWaitTimeMs=1e4,this.zeroBarsNoSignalTimeMs=5e3,this.oneBarWeakSignalTimeMs=5e3,this.twoBarsTimeMs=5e3,this.threeBarsTimeMs=1e4,this.fourBarsTimeMs=2e4,this.fiveBarsTimeMs=6e4,this.cooldownTimeMs=6e4,this.pastSamplesToConsider=15,this.goodSignalTimeMs=15e3,this.fractionalLoss=.5,this.packetsExpected=50,this.maximumTimesToWarn=2,this.missedPongsLowerThreshold=1,this.missedPongsUpperThreshold=4,this.maximumAudioDelayMs=6e4,this.maximumAudioDelayDataPoints=10}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),s=n(46);class o{constructor(e){this.logger=e}get mediaStream(){return this._mediaStream}set mediaStream(e){this._mediaStream=e}acquireAudioInputStream(){return i(this,void 0,void 0,(function*(){return 0===this._mediaStream.getAudioTracks().length?s.default.synthesizeAudioDevice(0):this._mediaStream}))}acquireVideoInputStream(){return i(this,void 0,void 0,(function*(){return this._mediaStream}))}releaseMediaStream(e){this.logger.warn("release media stream called")}acquireDisplayInputStream(e){return i(this,void 0,void 0,(function*(){return e&&e.video&&e.video.mandatory&&e.video.mandatory.chromeMediaSource&&e.video.mandatory.chromeMediaSourceId?navigator.mediaDevices.getUserMedia(e):navigator.mediaDevices.getDisplayMedia(e)}))}bindToAudioVideoController(e){throw new Error("unsupported")}acquireScreenCaptureDisplayInputStream(e,t){return i(this,void 0,void 0,(function*(){return this.acquireDisplayInputStream(this.screenCaptureDisplayMediaConstraints(e,t))}))}screenCaptureDisplayMediaConstraints(e,t){return{audio:!(e||!(new r.default).getDisplayMediaAudioCaptureSupport()),video:Object.assign(Object.assign({},!e&&{frameRate:{max:t||o.defaultFrameRate}}),e&&{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:e,maxFrameRate:t||o.defaultFrameRate}})}}toggleMediaStream(e){let t=!1;if(this.mediaStream)for(let n=0;n<this.mediaStream.getTracks().length;n++)this.mediaStream.getTracks()[n].enabled!==e&&(this.mediaStream.getTracks()[n].enabled=e,t=!0);return t}cleanup(){if(this.mediaStream)for(let e=0;e<this.mediaStream.getTracks().length;e++){this.mediaStream.getTracks()[e].stop()}this.mediaStream=null}}t.default=o,o.defaultFrameRate=15},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8);class r{constructor(){this.isSome=!1,this.isNone=!0}get(){throw new Error("value is null")}getOrElse(e){return e}map(e){return new r}flatMap(e){return new r}defaulting(e){return i.default.of(this.getOrElse(e))}static of(){return new r}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8);class r{constructor(e){this.value=e,this.isSome=!0,this.isNone=!1}map(e){return i.default.of(e(this.value))}flatMap(e){return e(this.value)}get(){return this.value}getOrElse(e){return this.value}defaulting(e){return i.default.of(this.getOrElse(e))}static of(e){if(null==e)throw new Error("value is ${value}");return new r(e)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(94);t.default=class{constructor(){this.isMediaDevicesSupported="undefined"!=typeof navigator&&!!navigator.mediaDevices}create(){if(this.isMediaDevicesSupported)return new Proxy(navigator.mediaDevices,new i.default);throw new Error("navigator.mediaDevices is not supported")}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(11),s=n(14);class o{constructor(){this.scheduler=null,this.devices=null,this.deviceChangeListeners=new Set,this.get=(e,t,n)=>{if(!Reflect.has(e,t))return;if(!("ondevicechange"in navigator.mediaDevices)){if("addEventListener"===t)return this.patchAddEventListener(e,t,n);if("removeEventListener"===t)return this.patchRemoveEventListener(e,t,n)}const i=Reflect.get(e,t,n);return"function"==typeof i?i.bind(e):i},this.patchAddEventListener=(e,t,n)=>{const i=Reflect.get(e,t,n);return(t,n,r)=>{if("devicechange"!==t)return Reflect.apply(i,e,[t,n,r]);this.deviceChangeListeners.add(n),this.scheduler||(this.scheduler=new s.default(o.INTERVAL_MS),this.scheduler.start(this.pollDeviceLists))}},this.patchRemoveEventListener=(e,t,n)=>{const i=Reflect.get(e,t,n);return(t,n,r)=>{if("devicechange"!==t)return Reflect.apply(i,e,[t,n,r]);this.deviceChangeListeners.delete(n),0===this.deviceChangeListeners.size&&this.scheduler&&(this.scheduler.stop(),this.scheduler=null)}},this.pollDeviceLists=()=>i(this,void 0,void 0,(function*(){const e=yield this.sortedDeviceList();if(this.devices){(e.length!==this.devices.length||e.some((e,t)=>e.deviceId!==this.devices[t].deviceId))&&this.handleDeviceChangeEvent()}this.devices=e}))}sortedDeviceList(){return i(this,void 0,void 0,(function*(){return(yield navigator.mediaDevices.enumerateDevices()).sort((e,t)=>e.deviceId<t.deviceId?1:e.deviceId>t.deviceId?-1:0)}))}handleDeviceChangeEvent(){for(const e of this.deviceChangeListeners)r.default.nextTick(()=>{if(this.deviceChangeListeners.has(e)){const t=new Event("devicechange");"function"==typeof e?e(t):e.handleEvent(t)}})}}t.default=o,o.INTERVAL_MS=1e3},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(){this.tileId=null,this.localTile=!1,this.localTileStarted=!1,this.isContent=!1,this.active=!1,this.paused=!1,this.poorConnection=!1,this.boundAttendeeId=null,this.boundExternalUserId=null,this.boundVideoStream=null,this.boundVideoElement=null,this.nameplate=null,this.videoStreamContentWidth=null,this.videoStreamContentHeight=null,this.videoElementCSSWidthPixels=null,this.videoElementCSSHeightPixels=null,this.devicePixelRatio=0,this.videoElementPhysicalWidthPixels=null,this.videoElementPhysicalHeightPixels=null,this.streamId=null}clone(){const e=new i;return e.tileId=this.tileId,e.localTile=this.localTile,e.isContent=this.isContent,e.active=this.active,e.paused=this.paused,e.poorConnection=this.poorConnection,e.boundAttendeeId=this.boundAttendeeId,e.boundExternalUserId=this.boundExternalUserId,e.boundVideoStream=this.boundVideoStream,e.boundVideoElement=this.boundVideoElement,e.nameplate=this.nameplate,e.videoStreamContentWidth=this.videoStreamContentWidth,e.videoStreamContentHeight=this.videoStreamContentHeight,e.videoElementCSSWidthPixels=this.videoElementCSSWidthPixels,e.videoElementCSSHeightPixels=this.videoElementCSSHeightPixels,e.devicePixelRatio=this.devicePixelRatio,e.videoElementPhysicalWidthPixels=this.videoElementPhysicalWidthPixels,e.videoElementPhysicalHeightPixels=this.videoElementPhysicalHeightPixels,e.streamId=this.streamId,e}}t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isAudioTransformDevice=void 0,t.isAudioTransformDevice=function(e){return!!e&&"object"==typeof e&&"mute"in e&&"stop"in e&&"intrinsicDevice"in e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.groupId=""}matchesConstraints(e){return JSON.stringify(this.constraints)===JSON.stringify(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15);class r extends i.default{constructor(e){super(e)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15);class r extends i.default{constructor(e){super(e)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15);class r extends i.default{constructor(e,t){super(e),this.constraint=t}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(15);class r extends i.default{constructor(e){super(e)}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,i){this.videoWidth=e,this.videoHeight=t,this.videoFrameRate=n,this.videoMaxBandwidthKbps=i}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);class s extends r.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreatePeerConnectionTask",this.removeTrackAddedEventListener=null,this.removeTrackRemovedEventListeners={},this.trackEvents=["ended","mute","unmute","isolationchange","overconstrained"],this.removeVideoTrackEventListeners={},this.trackAddedHandler=e=>{const t=e.track;if(this.context.logger.info(`received track event: kind=${t.kind} id=${t.id} label=${t.label}`),e.transceiver&&"inactive"===e.transceiver.currentDirection)return;if(0===e.streams.length)return void this.context.logger.warn("Track event but no stream");const n=e.streams[0];"audio"===t.kind?this.context.audioMixController.bindAudioStream(n):"video"!==t.kind||this.trackIsVideoInput(t)||this.addRemoteVideoTrack(t,n)}}removeObserver(){this.removeTrackAddedEventListener&&this.removeTrackAddedEventListener();for(const e in this.removeTrackRemovedEventListeners)this.removeTrackRemovedEventListeners[e]()}addPeerConnectionEventLogger(){const e=this.context.peer;e.addEventListener("connectionstatechange",()=>{this.context.logger.info("peer connection state changed: "+e.connectionState)}),e.addEventListener("negotiationneeded",()=>{this.context.logger.info("peer connection negotiation is needed")}),e.addEventListener("icegatheringstatechange",()=>{this.context.logger.info("peer connection ice gathering state changed: "+e.iceGatheringState)}),e.addEventListener("icecandidate",e=>{this.context.logger.info("peer connection ice candidate: "+(e.candidate?e.candidate.candidate:"(null)"))}),e.addEventListener("iceconnectionstatechange",()=>{this.context.logger.info("peer connection ice connection state changed: "+e.iceConnectionState)})}run(){return i(this,void 0,void 0,(function*(){this.context.removableObservers.push(this);const e=this.context.turnCredentials&&this.context.turnCredentials.uris.length>0?{iceServers:[{urls:this.context.turnCredentials.uris,username:this.context.turnCredentials.username,credential:this.context.turnCredentials.password,credentialType:"password"}],iceTransportPolicy:"relay"}:{};e.bundlePolicy=this.context.browserBehavior.requiresBundlePolicy(),e.sdpSemantics=this.context.browserBehavior.requiresUnifiedPlan()?"unified-plan":"plan-b",this.logger.info("SDP semantics are "+e.sdpSemantics);const t={optional:[{googHighStartBitrate:0},{googCpuOveruseDetection:!1},{googCpuOveruseEncodeUsage:!1},{googCpuUnderuseThreshold:55},{googCpuOveruseThreshold:150},{googCombinedAudioVideoBwe:!0}]};this.context.peer?this.context.logger.info("reusing peer connection"):(this.context.logger.info("creating new peer connection"),this.context.peer=new RTCPeerConnection(e,t),this.addPeerConnectionEventLogger()),this.removeTrackAddedEventListener=()=>{this.context.peer&&this.context.peer.removeEventListener("track",this.trackAddedHandler),this.removeTrackAddedEventListener=null},this.context.peer.addEventListener("track",this.trackAddedHandler)}))}trackIsVideoInput(e){if(this.context.transceiverController.useTransceivers())return this.logger.debug(()=>"getting video track type (unified-plan)"),this.context.transceiverController.trackIsVideoInput(e);if(this.logger.debug(()=>"getting video track type (plan-b)"),this.context.activeVideoInput){const t=this.context.activeVideoInput.getVideoTracks();if(t&&t.length>0&&t[0].id===e.id)return!0}return!1}addRemoteVideoTrack(e,t){let n=t.id;this.context.browserBehavior.requiresUnifiedPlan()||(t=new MediaStream([e]),n=e.id);const i=this.context.videoStreamIndex.attendeeIdForTrack(n);if(this.context.videoTileController.haveVideoTileForAttendeeId(i))return void this.context.logger.info("Not adding remote track. Already have tile for attendeeId:  "+i);const r=this.context.videoTileController.addVideoTile();let s,o,a=this.context.videoStreamIndex.streamIdForTrack(n);void 0===a&&(this.logger.warn(`stream not found for tile=${r.id()} track=${n}`),a=null);for(let n=0;n<this.trackEvents.length;n++){const i=this.trackEvents[n],s=t.getVideoTracks();if(s&&s.length){const t=s[0],n=()=>{this.context.logger.info(`received the ${i} event for tile=${r.id()} id=${e.id} streamId=${a}`),"ended"===i&&this.context.browserBehavior.requiresUnifiedPlan()&&this.removeRemoteVideoTrack(e,r.state())};t.addEventListener(i,n),this.removeVideoTrackEventListeners[e.id]||(this.removeVideoTrackEventListeners[e.id]=[]),this.removeVideoTrackEventListeners[e.id].push(()=>{t.removeEventListener(i,n)})}}if(e.getSettings){const t=e.getSettings();s=t.width,o=t.height}else{const t=e.getCapabilities();s=t.width,o=t.height}const c=this.context.videoStreamIndex.externalUserIdForTrack(n);r.bindVideoStream(i,!1,t,s,o,a,c),this.logger.info(`video track added, created tile=${r.id()} track=${n} streamId=${a}`);let l="removetrack",d=t;this.context.browserBehavior.requiresUnifiedPlan()||(this.logger.debug(()=>"updating end event and target track (plan-b)"),l="ended",d=e);const u=()=>this.removeRemoteVideoTrack(e,r.state());this.removeTrackRemovedEventListeners[e.id]=()=>{d.removeEventListener(l,u),delete this.removeTrackRemovedEventListeners[e.id]},d.addEventListener(l,u)}removeRemoteVideoTrack(e,t){if(this.removeTrackRemovedEventListeners.hasOwnProperty(e.id)){this.removeTrackRemovedEventListeners[e.id]();for(const t of this.removeVideoTrackEventListeners[e.id])t();delete this.removeVideoTrackEventListeners[e.id]}this.logger.info(`video track ended, removing tile=${t.tileId} id=${e.id} stream=${t.streamId}`),t.streamId?this.context.videosPaused.remove(t.streamId):this.logger.warn("no stream found for tile="+t.tileId),this.context.videoTileController.removeVideoTile(t.tileId)}}t.default=s,s.REMOVE_HANDLER_INTERVAL_MS=1e4},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),s=n(24),o=n(4);class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="CreateSDPTask"}cancel(){if(this.cancelPromise){const e=new Error("canceling "+this.name());this.cancelPromise(e),delete this.cancelPromise}}sessionUsesAudio(){return!0}sessionUsesVideo(){let e;e=this.context.transceiverController.useTransceivers()?this.context.transceiverController.hasVideoInput():this.context.videoTileController.hasStartedLocalVideoTile();const t=!!this.context.videosToReceive&&!this.context.videosToReceive.empty(),n=e||t;return this.context.logger.info(`uses video: ${n} (enabled: true, sending: ${e}, receiving: ${t})`),n}run(){return i(this,void 0,void 0,(function*(){const e={offerToReceiveAudio:this.sessionUsesAudio(),offerToReceiveVideo:this.sessionUsesVideo()};this.logger.info("peer connection offerOptions: "+JSON.stringify(e)),yield new Promise((t,n)=>i(this,void 0,void 0,(function*(){this.cancelPromise=e=>{n(e)};try{if(this.context.sdpOfferInit=yield this.context.peer.createOffer(e),this.context.logger.info("peer connection created offer"),this.context.previousSdpOffer&&new s.default(this.context.sdpOfferInit.sdp).videoSendSectionHasDifferentSSRC(this.context.previousSdpOffer)){const e=new Error(`canceling ${this.name()} due to the meeting status code: ${r.default.IncompatibleSDP}`);return this.context.previousSdpOffer=null,void n(e)}t()}catch(e){n(e)}finally{delete this.cancelPromise}})))}))}}t.default=a},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SDPCandidateType=void 0,function(e){e.Host="host",e.ServerReflexive="srflx",e.PeerReflexive="prflx",e.Relay="relay"}(i=t.SDPCandidateType||(t.SDPCandidateType={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,i,r,s){this.timestampMs=e,this.topic=t,this.data=n,this.senderAttendeeId=i,this.senderExternalUserId=r,this.throttled=!!s}text(){return(new TextDecoder).decode(this.data)}json(){return JSON.parse((new TextDecoder).decode(this.data))}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(14);t.default=class{constructor(e,t,n,i=1e3,r=200){this.realtimeController=e,this.selfAttendeeId=t,this.hasBandwidthPriorityCallback=n,this.waitIntervalMs=i,this.updateIntervalMs=r,this.speakerScores={},this.speakerMuteState={},this.detectorCallbackToHandler=new Map,this.detectorCallbackToScoresTimer=new Map,this.detectorCallbackToActivityTimer=new Map,this.hasBandwidthPriority=!1,this.mostRecentUpdateTimestamp={}}needUpdate(e){return!this.activeSpeakers||(0===this.speakerScores[e]&&this.activeSpeakers.includes(e)||this.speakerScores[e]>0&&!this.activeSpeakers.includes(e))}updateActiveSpeakers(e,t,n){if(!this.needUpdate(n))return;const i=[],r=Object.keys(this.speakerScores);for(let e=0;e<r.length;e++){const t=r[e];i.push({attendeeId:t,activeScore:this.speakerScores[t]})}const s=i.sort((e,t)=>t.activeScore-e.activeScore).filter((function(e){return e.activeScore>0})).map((function(e){return e.attendeeId}));this.activeSpeakers=s,t(s);const o=s.length>0&&s[0]===this.selfAttendeeId&&e.prioritizeVideoSendBandwidthForActiveSpeaker();this.hasBandwidthPriority!==o&&(this.hasBandwidthPriority=o,this.hasBandwidthPriorityCallback(o))}updateScore(e,t,n,i,r){const s=e.calculateScore(n,i,r);this.speakerScores[n]!==s&&(this.speakerScores[n]=s,this.mostRecentUpdateTimestamp[n]=Date.now(),this.updateActiveSpeakers(e,t,n))}subscribe(e,t,n,i){const s=(n,i)=>{if(!i)return this.speakerScores[n]=0,this.mostRecentUpdateTimestamp[n]=Date.now(),void this.updateActiveSpeakers(e,t,n);this.realtimeController.realtimeSubscribeToVolumeIndicator(n,(n,i,r,s)=>{this.mostRecentUpdateTimestamp[n]=Date.now(),null!==r&&(this.speakerMuteState[n]=r),this.updateScore(e,t,n,i,r)})};this.detectorCallbackToHandler.set(t,s);const o=new r.default(this.updateIntervalMs);if(o.start(()=>{for(const n in this.speakerScores)Date.now()-this.mostRecentUpdateTimestamp[n]>this.waitIntervalMs&&this.updateScore(e,t,n,0,this.speakerMuteState[n])}),this.detectorCallbackToActivityTimer.set(t,o),n&&i){const e=new r.default(i);e.start(()=>{n(this.speakerScores)}),this.detectorCallbackToScoresTimer.set(t,e)}this.realtimeController.realtimeSubscribeToAttendeeIdPresence(s)}unsubscribe(e){const t=this.detectorCallbackToHandler.get(e);this.detectorCallbackToHandler.delete(e),t&&this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(t);const n=this.detectorCallbackToActivityTimer.get(e);n&&(n.stop(),this.detectorCallbackToActivityTimer.delete(e));const i=this.detectorCallbackToScoresTimer.get(e);i&&(i.stop(),this.detectorCallbackToHandler.delete(e))}destroy(){return i(this,void 0,void 0,(function*(){for(const e of this.detectorCallbackToHandler.values())this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e);for(const e of this.detectorCallbackToActivityTimer.values())e.stop();for(const e of this.detectorCallbackToScoresTimer.values())e.stop();this.detectorCallbackToHandler.clear(),this.detectorCallbackToActivityTimer.clear(),this.detectorCallbackToScoresTimer.clear()}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8);t.default=class{constructor(e,t,n,i,r,s){this.audioVideoController=e,this.realtimeController=t,this.videoTileController=n,this.connectionHealthData=i,this.pingPong=r,this.statsCollector=s,this.isActive=!1,this.hasSeenValidPacketMetricsBefore=!1,this.lastAvailableSendBandwidthKbps=0,this.lastAvailableRecvBandwidthKbps=0,this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e=>{this.isActive&&this.receiveSignalStrengthChange(e)})}start(){this.isActive=!0,this.pingPong.addObserver(this),this.pingPong.start(),this.audioVideoController.addObserver(this)}stop(){this.isActive=!1,this.pingPong.removeObserver(this),this.pingPong.stop(),this.audioVideoController.removeObserver(this)}receiveSignalStrengthChange(e){0===e?this.connectionHealthData.setLastNoSignalTimestampMs(Date.now()):e<=.5?this.connectionHealthData.setLastWeakSignalTimestampMs(Date.now()):this.connectionHealthData.setLastGoodSignalTimestampMs(Date.now()),this.updateConnectionHealth()}didReceivePong(e,t,n){this.connectionHealthData.setConsecutiveMissedPongs(0),this.statsCollector.logLatency("ping_pong",t),this.statsCollector.logLatency("ping_pong_clock_skew",n),this.updateConnectionHealth()}didMissPongs(){this.connectionHealthData.setConsecutiveMissedPongs(this.connectionHealthData.consecutiveMissedPongs+1),this.updateConnectionHealth()}metricsDidReceive(e){let t=0,n=0;const i=e.getObservableMetrics(),r=i.audioPacketsReceived,s=i.audioPacketsReceivedFractionLoss;let o=0;const a=i.videoPacketSentPerSecond,c=i.videoUpstreamBitrate,l=i.availableSendBandwidth||i.availableOutgoingBitrate,d=i.availableReceiveBandwidth||i.availableIncomingBitrate,u=i.audioSpeakerDelayMs,h=i.nackCountReceivedPerSecond||i.googNackCountReceivedPerSecond;"number"!=typeof l||isNaN(l)||this.updateAvailableSendBandwidth(l/1e3,h),"number"!=typeof d||isNaN(d)||this.updateAvailableReceiveBandwidth(d/1e3),"number"!=typeof c||isNaN(c)||(o=c/1e3),"number"!=typeof u||isNaN(u)||this.connectionHealthData.setAudioSpeakerDelayMs(u),this.monitorVideoUplinkHealth(o,a),"number"==typeof r&&"number"==typeof s&&(t=r,n=s,t<0||n<0||(this.addToMinuteWindow(this.connectionHealthData.packetsReceivedInLastMinute,t),this.addToMinuteWindow(this.connectionHealthData.fractionPacketsLostInboundInLastMinute,n),t>0?(this.hasSeenValidPacketMetricsBefore=!0,this.connectionHealthData.setConsecutiveStatsWithNoPackets(0)):this.hasSeenValidPacketMetricsBefore&&this.connectionHealthData.setConsecutiveStatsWithNoPackets(this.connectionHealthData.consecutiveStatsWithNoPackets+1),(0===t||n>0)&&this.connectionHealthData.setLastPacketLossInboundTimestampMs(Date.now()),this.updateConnectionHealth()))}addToMinuteWindow(e,t){e.unshift(t),e.length>60&&e.pop()}updateAvailableSendBandwidth(e,t){if(e!==this.lastAvailableSendBandwidthKbps){if(0===this.lastAvailableSendBandwidthKbps)return void(this.lastAvailableSendBandwidthKbps=e);const n=this.lastAvailableSendBandwidthKbps;this.lastAvailableSendBandwidthKbps=e,this.audioVideoController.forEachObserver(r=>{i.default.of(r.videoSendBandwidthDidChange).map(i=>i.bind(r)(e,n,t))})}}updateAvailableReceiveBandwidth(e){if(e!==this.lastAvailableRecvBandwidthKbps){if(0===this.lastAvailableRecvBandwidthKbps)return void(this.lastAvailableRecvBandwidthKbps=e);const t=this.lastAvailableRecvBandwidthKbps;this.lastAvailableRecvBandwidthKbps=e,this.audioVideoController.forEachObserver(n=>{i.default.of(n.videoReceiveBandwidthDidChange).map(i=>i.bind(n)(e,t))})}}updateConnectionHealth(){this.audioVideoController.forEachObserver(e=>{i.default.of(e.connectionHealthDidChange).map(t=>t.bind(e)(this.connectionHealthData.clone()))})}monitorVideoUplinkHealth(e,t){this.videoTileController.hasStartedLocalVideoTile()&&this.audioVideoController.forEachObserver(n=>{i.default.of(n.videoSendHealthDidChange).map(i=>i.bind(n)(e,t))})}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(200),s=n(16);class o{constructor(e){var t,n,i,s,a,c,l;this.audioVideoController=e,this.meetingHistoryStates=[];try{this.parserResult=navigator&&navigator.userAgent?new r.UAParser(navigator.userAgent).getResult():null}catch(t){e.logger.error(t.message)}this.browserMajorVersion=(null===(i=null===(n=null===(t=this.parserResult)||void 0===t?void 0:t.browser)||void 0===n?void 0:n.version)||void 0===i?void 0:i.split(".")[0])||o.UNAVAILABLE,this.browserName=(null===(s=this.parserResult)||void 0===s?void 0:s.browser.name)||o.UNAVAILABLE,this.browserVersion=(null===(a=this.parserResult)||void 0===a?void 0:a.browser.version)||o.UNAVAILABLE,this.deviceName=[(null===(c=this.parserResult)||void 0===c?void 0:c.device.vendor)||"",(null===(l=this.parserResult)||void 0===l?void 0:l.device.model)||""].join(" ").trim()||o.UNAVAILABLE}publishEvent(e,t){return i(this,void 0,void 0,(function*(){const n=Date.now();yield this.pushMeetingState(e,n);const i=Object.freeze(Object.assign(this.getAttributes(n),t));this.audioVideoController.forEachObserver(t=>{t.eventDidReceive&&t.eventDidReceive(e,i)})}))}pushMeetingState(e,t=Date.now()){return i(this,void 0,void 0,(function*(){this.meetingHistoryStates.push({name:e,timestampMs:t})}))}getAttributes(e){var t,n;return{attendeeId:this.audioVideoController.configuration.credentials.attendeeId,browserMajorVersion:this.browserMajorVersion,browserName:this.browserName,browserVersion:this.browserVersion,deviceName:this.deviceName,externalMeetingId:"string"==typeof this.audioVideoController.configuration.externalMeetingId?this.audioVideoController.configuration.externalMeetingId:"",externalUserId:this.audioVideoController.configuration.credentials.externalUserId,meetingHistory:this.meetingHistoryStates,meetingId:this.audioVideoController.configuration.meetingId,osName:(null===(t=this.parserResult)||void 0===t?void 0:t.os.name)||o.UNAVAILABLE,osVersion:(null===(n=this.parserResult)||void 0===n?void 0:n.os.version)||o.UNAVAILABLE,sdkVersion:s.default.sdkVersion,sdkName:s.default.sdkName,timestampMs:e}}}t.default=o,o.UNAVAILABLE="Unavailable"},function(e,t,n){"use strict";e.exports=u;var i,r=n(17),s=r.LongBits,o=r.base64,a=r.utf8;function c(e,t,n){this.fn=e,this.len=t,this.next=void 0,this.val=n}function l(){}function d(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function u(){this.len=0,this.head=new c(l,0,0),this.tail=this.head,this.states=null}function h(e,t,n){t[n]=255&e}function p(e,t){this.len=e,this.next=void 0,this.val=t}function f(e,t,n){for(;e.hi;)t[n++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[n++]=127&e.lo|128,e.lo=e.lo>>>7;t[n++]=e.lo}function g(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}u.create=r.Buffer?function(){return(u.create=function(){return new i})()}:function(){return new u},u.alloc=function(e){return new r.Array(e)},r.Array!==Array&&(u.alloc=r.pool(u.alloc,r.Array.prototype.subarray)),u.prototype._push=function(e,t,n){return this.tail=this.tail.next=new c(e,t,n),this.len+=t,this},p.prototype=Object.create(c.prototype),p.prototype.fn=function(e,t,n){for(;e>127;)t[n++]=127&e|128,e>>>=7;t[n]=e},u.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new p((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this},u.prototype.int32=function(e){return e<0?this._push(f,10,s.fromNumber(e)):this.uint32(e)},u.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},u.prototype.uint64=function(e){var t=s.from(e);return this._push(f,t.length(),t)},u.prototype.int64=u.prototype.uint64,u.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(f,t.length(),t)},u.prototype.bool=function(e){return this._push(h,1,e?1:0)},u.prototype.fixed32=function(e){return this._push(g,4,e>>>0)},u.prototype.sfixed32=u.prototype.fixed32,u.prototype.fixed64=function(e){var t=s.from(e);return this._push(g,4,t.lo)._push(g,4,t.hi)},u.prototype.sfixed64=u.prototype.fixed64,u.prototype.float=function(e){return this._push(r.float.writeFloatLE,4,e)},u.prototype.double=function(e){return this._push(r.float.writeDoubleLE,8,e)};var m=r.Array.prototype.set?function(e,t,n){t.set(e,n)}:function(e,t,n){for(var i=0;i<e.length;++i)t[n+i]=e[i]};u.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(h,1,0);if(r.isString(e)){var n=u.alloc(t=o.length(e));o.decode(e,n,0),e=n}return this.uint32(t)._push(m,t,e)},u.prototype.string=function(e){var t=a.length(e);return t?this.uint32(t)._push(a.write,t,e):this._push(h,1,0)},u.prototype.fork=function(){return this.states=new d(this),this.head=this.tail=new c(l,0,0),this.len=0,this},u.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new c(l,0,0),this.len=0),this},u.prototype.ldelim=function(){var e=this.head,t=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=t,this.len+=n),this},u.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,t,n),n+=e.len,e=e.next;return t},u._configure=function(e){i=e}},function(e,t,n){"use strict";e.exports=c;var i,r=n(17),s=r.LongBits,o=r.utf8;function a(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function c(e){this.buf=e,this.pos=0,this.len=e.length}var l,d="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new c(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new c(e);throw Error("illegal buffer")};function u(){var e=new s(0,0),t=0;if(!(this.len-this.pos>4)){for(;t<3;++t){if(this.pos>=this.len)throw a(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;if(t=0,this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw a(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function h(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function p(){if(this.pos+8>this.len)throw a(this,8);return new s(h(this.buf,this.pos+=4),h(this.buf,this.pos+=4))}c.create=r.Buffer?function(e){return(c.create=function(e){return r.Buffer.isBuffer(e)?new i(e):d(e)})(e)}:d,c.prototype._slice=r.Array.prototype.subarray||r.Array.prototype.slice,c.prototype.uint32=(l=4294967295,function(){if(l=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return l;if(l=(l|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return l;if((this.pos+=5)>this.len)throw this.pos=this.len,a(this,10);return l}),c.prototype.int32=function(){return 0|this.uint32()},c.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)|0},c.prototype.bool=function(){return 0!==this.uint32()},c.prototype.fixed32=function(){if(this.pos+4>this.len)throw a(this,4);return h(this.buf,this.pos+=4)},c.prototype.sfixed32=function(){if(this.pos+4>this.len)throw a(this,4);return 0|h(this.buf,this.pos+=4)},c.prototype.float=function(){if(this.pos+4>this.len)throw a(this,4);var e=r.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},c.prototype.double=function(){if(this.pos+8>this.len)throw a(this,4);var e=r.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},c.prototype.bytes=function(){var e=this.uint32(),t=this.pos,n=this.pos+e;if(n>this.len)throw a(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(t,n):t===n?new this.buf.constructor(0):this._slice.call(this.buf,t,n)},c.prototype.string=function(){var e=this.bytes();return o.read(e,0,e.length)},c.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw a(this,e);this.pos+=e}else do{if(this.pos>=this.len)throw a(this)}while(128&this.buf[this.pos++]);return this},c.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},c._configure=function(e){i=e;var t=r.Long?"toLong":"toNumber";r.merge(c.prototype,{int64:function(){return u.call(this)[t](!1)},uint64:function(){return u.call(this)[t](!0)},sint64:function(){return u.call(this).zzDecode()[t](!1)},fixed64:function(){return p.call(this)[t](!0)},sfixed64:function(){return p.call(this)[t](!1)}})}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),r=n(11),s=n(14),o=n(6),a=n(5);t.default=class{constructor(e,t,n){this.signalingClient=e,this.intervalMs=t,this.logger=n,this.observerQueue=new Set,this.consecutivePongsUnaccountedFor=0,this.intervalScheduler=new s.default(this.intervalMs),this.pingId=0}addObserver(e){this.logger.info("adding a ping-pong observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing a ping-pong observer"),this.observerQueue.delete(e)}forEachObserver(e){for(const t of this.observerQueue)r.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}start(){this.stop(),this.signalingClient.registerObserver(this),this.signalingClient.ready()&&this.startPingInterval()}stop(){this.stopPingInterval(),this.signalingClient.removeObserver(this)}startPingInterval(){this.intervalScheduler.start(()=>{this.ping()}),this.ping()}stopPingInterval(){this.intervalScheduler.stop(),this.pingId=0,this.consecutivePongsUnaccountedFor=0}ping(){this.consecutivePongsUnaccountedFor>0&&(this.logger.warn(`missed pong ${this.consecutivePongsUnaccountedFor} time(s)`),this.forEachObserver(e=>{i.default.of(e.didMissPongs).map(t=>t.bind(e)(this.consecutivePongsUnaccountedFor))})),this.consecutivePongsUnaccountedFor+=1,this.pingId=this.pingId+1&4294967295;const e=a.SdkPingPongFrame.create();e.pingId=this.pingId,e.type=a.SdkPingPongType.PING,this.pingTimestampLocalMs=this.signalingClient.pingPong(e),this.logger.debug(()=>"sent ping "+this.pingId)}pong(e){const t=a.SdkPingPongFrame.create();t.pingId=e,t.type=a.SdkPingPongType.PONG,this.signalingClient.pingPong(t)}handleSignalingClientEvent(e){switch(e.type){case o.default.WebSocketOpen:this.startPingInterval();break;case o.default.WebSocketFailed:case o.default.WebSocketError:this.logger.warn(`stopped pinging (${o.default[e.type]})`),this.stopPingInterval();break;case o.default.WebSocketClosing:case o.default.WebSocketClosed:this.logger.info(`stopped pinging (${o.default[e.type]})`),this.stopPingInterval();break;case o.default.ReceivedSignalFrame:if(e.message.type!==a.SdkSignalFrame.Type.PING_PONG)break;if(e.message.pingPong.type===a.SdkPingPongType.PONG){const t=e.message.pingPong.pingId;if(t!==this.pingId){this.logger.warn(`unexpected ping id ${t} (expected ${this.pingId})`);break}let n;if(this.consecutivePongsUnaccountedFor=0,"number"!=typeof e.message.timestampMs)break;n=e.message.timestampMs,this.logger.debug(()=>`received pong ${t} with timestamp ${n}`);const r=e.timestampMs-this.pingTimestampLocalMs,s=Math.round(n-r/2),o=this.pingTimestampLocalMs-s;this.logger.info(`local clock skew estimate=${o}ms from ping-pong time=${r}ms`),this.forEachObserver(e=>{i.default.of(e.didReceivePong).map(n=>n.bind(e)(t,o,r))})}else this.pong(e.message.pingPong.pingId)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(114),r=n(115);t.default=class{constructor(){this.state=new i.default}realtimeSetLocalAttendeeId(e,t){this.state.localAttendeeId=e,this.state.localExternalUserId=t}realtimeSetAttendeeIdPresence(e,t,n,i,r){try{t&&(this.state.attendeeIdToExternalUserId[e]=n);for(const s of this.state.attendeeIdChangesCallbacks)s(e,t,n,i,r)}catch(e){this.onError(e)}}realtimeSubscribeToAttendeeIdPresence(e){try{this.state.attendeeIdChangesCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToAttendeeIdPresence(e){try{const t=this.state.attendeeIdChangesCallbacks.indexOf(e);-1!==t&&this.state.attendeeIdChangesCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSetLocalAudioInput(e){try{if(this.state.audioInput===e)return;this.setAudioInputEnabled(!1),this.state.audioInput=e,this.setAudioInputEnabled(!this.state.muted)}catch(e){this.onError(e)}}realtimeSetCanUnmuteLocalAudio(e){try{if(this.state.canUnmute===e)return;this.state.canUnmute=e;for(const t of this.state.setCanUnmuteLocalAudioCallbacks)t(e)}catch(e){this.onError(e)}}realtimeSubscribeToSetCanUnmuteLocalAudio(e){try{this.state.setCanUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){try{const t=this.state.setCanUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.setCanUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeCanUnmuteLocalAudio(){return this.state.canUnmute}realtimeMuteLocalAudio(){if(!this.state.muted)try{this.setAudioInputEnabled(!1),this.state.muted=!0,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId);for(const e of this.state.muteAndUnmuteLocalAudioCallbacks)e(!0)}catch(e){this.onError(e)}}realtimeUnmuteLocalAudio(){if(!this.state.muted)return!0;if(!this.state.canUnmute)return!1;try{this.setAudioInputEnabled(!0),this.state.muted=!1,this.realtimeUpdateVolumeIndicator(this.state.localAttendeeId,null,null,null,this.state.localExternalUserId);for(const e of this.state.muteAndUnmuteLocalAudioCallbacks)e(!1);return!0}catch(e){return this.onError(e),!1}}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){try{this.state.muteAndUnmuteLocalAudioCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){try{const t=this.state.muteAndUnmuteLocalAudioCallbacks.indexOf(e);-1!==t&&this.state.muteAndUnmuteLocalAudioCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeIsLocalAudioMuted(){return this.state.muted}realtimeSubscribeToVolumeIndicator(e,t){try{this.state.volumeIndicatorCallbacks.hasOwnProperty(e)||(this.state.volumeIndicatorCallbacks[e]=[]),this.state.volumeIndicatorCallbacks[e].push(t),this.sendVolumeIndicatorChange(e,!0,!0,!0,this.state.attendeeIdToExternalUserId[e])}catch(e){this.onError(e)}}realtimeUnsubscribeFromVolumeIndicator(e,t){try{if(t){const n=this.state.volumeIndicatorCallbacks[e].indexOf(t);-1!==n&&this.state.volumeIndicatorCallbacks[e].splice(n,1)}else delete this.state.volumeIndicatorCallbacks[e]}catch(e){this.onError(e)}}realtimeUpdateVolumeIndicator(e,t,n,i,r){try{n=this.applyLocalMuteOverride(e,n);const s=this.getVolumeIndicatorState(e);let o=!1,a=!1,c=!1;null!==n&&s.muted!==n&&(s.muted=n,a=!0,s.muted&&0!==s.volume&&(s.volume=0,o=!0)),s.muted||null===t||(s.volume!==t&&(s.volume=t,o=!0),null===s.muted&&(s.muted=!1,a=!0)),null!==i&&s.signalStrength!==i&&(s.signalStrength=i,c=!0),this.sendVolumeIndicatorChange(e,o,a,c,r)}catch(e){this.onError(e)}}realtimeSubscribeToLocalSignalStrengthChange(e){try{if(this.state.localSignalStrengthChangeCallbacks.push(e),null===this.state.localAttendeeId)return;this.sendLocalSignalStrengthChange(this.state.localAttendeeId,!0)}catch(e){this.onError(e)}}realtimeUnsubscribeToLocalSignalStrengthChange(e){try{const t=this.state.localSignalStrengthChangeCallbacks.indexOf(e);-1!==t&&this.state.localSignalStrengthChangeCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSubscribeToSendDataMessage(e){try{this.state.sendDataMessageCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeFromSendDataMessage(e){try{const t=this.state.sendDataMessageCallbacks.indexOf(e);-1!==t&&this.state.sendDataMessageCallbacks.splice(t,1)}catch(e){this.onError(e)}}realtimeSendDataMessage(e,t,n){try{for(const i of this.state.sendDataMessageCallbacks)i(e,t,n)}catch(e){this.onError(e)}}realtimeSubscribeToReceiveDataMessage(e,t){try{this.state.receiveDataMessageCallbacks.has(e)?this.state.receiveDataMessageCallbacks.get(e).push(t):this.state.receiveDataMessageCallbacks.set(e,[t])}catch(e){this.onError(e)}}realtimeUnsubscribeFromReceiveDataMessage(e){try{this.state.receiveDataMessageCallbacks.delete(e)}catch(e){this.onError(e)}}realtimeReceiveDataMessage(e){try{if(this.state.receiveDataMessageCallbacks.has(e.topic))for(const t of this.state.receiveDataMessageCallbacks.get(e.topic))t(e)}catch(e){this.onError(e)}}realtimeSubscribeToFatalError(e){try{this.state.fatalErrorCallbacks.push(e)}catch(e){this.onError(e)}}realtimeUnsubscribeToFatalError(e){try{const t=this.state.fatalErrorCallbacks.indexOf(e);-1!==t&&this.state.fatalErrorCallbacks.splice(t,1)}catch(e){this.onError(e)}}setAudioInputEnabled(e){if(this.state.audioInput)for(const t of this.state.audioInput.getTracks())t.enabled!==e&&(t.enabled=e)}applyLocalMuteOverride(e,t){const n=this.state.localAttendeeId,i=this.state.muted;return e!==n||null===this.state.audioInput?t:i}sendVolumeIndicatorChange(e,t,n,i,s){if(this.sendLocalSignalStrengthChange(e,i),!this.state.volumeIndicatorCallbacks.hasOwnProperty(e))return;const o=this.getVolumeIndicatorState(e),a=new r.default;if(t&&(a.volume=o.volume),n&&(a.muted=o.muted),i&&(a.signalStrength=o.signalStrength),!this.stateIsEmpty(a))for(const t of this.state.volumeIndicatorCallbacks[e])t(e,a.volume,a.muted,a.signalStrength,s)}sendLocalSignalStrengthChange(e,t){if(!t)return;if(e!==this.state.localAttendeeId)return;const n=this.getVolumeIndicatorState(e).signalStrength;if(null!==n)for(const e of this.state.localSignalStrengthChangeCallbacks)e(n)}getVolumeIndicatorState(e){return this.state.volumeIndicatorState.hasOwnProperty(e)||(this.state.volumeIndicatorState[e]=new r.default),this.state.volumeIndicatorState[e]}stateIsEmpty(e){return null===e.volume&&null===e.muted&&null===e.signalStrength}onError(e){try{for(const t of this.state.fatalErrorCallbacks)t(e)}catch(t){try{console.error(e),console.error(t)}catch(e){}}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.localAttendeeId=null,this.localExternalUserId=null,this.attendeeIdChangesCallbacks=[],this.canUnmute=!0,this.setCanUnmuteLocalAudioCallbacks=[],this.muted=!1,this.muteAndUnmuteLocalAudioCallbacks=[],this.audioInput=null,this.volumeIndicatorState={},this.attendeeIdToExternalUserId={},this.volumeIndicatorCallbacks={},this.localSignalStrengthChangeCallbacks=[],this.fatalErrorCallbacks=[],this.sendDataMessageCallbacks=[],this.receiveDataMessageCallbacks=new Map}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.volume=null,this.muted=null,this.signalStrength=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(53),r=n(117),s=n(54),o=n(55);t.default=class{constructor(e){this.logger=e,this.currentState=s.SessionStateControllerState.NotConnected,this.deferredAction=null,this.deferredWork=null}perform(e,t){const n=this.currentState;if(n===s.SessionStateControllerState.NotConnected&&e===i.SessionStateControllerAction.Connect)this.transition(s.SessionStateControllerState.Connecting,e);else if(n===s.SessionStateControllerState.Connecting&&e===i.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(n===s.SessionStateControllerState.Connecting&&e===i.SessionStateControllerAction.FinishConnecting)this.transition(s.SessionStateControllerState.Connected,e);else if(n===s.SessionStateControllerState.Connected&&e===i.SessionStateControllerAction.Disconnect)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(n===s.SessionStateControllerState.Connected&&e===i.SessionStateControllerAction.Reconnect)this.transition(s.SessionStateControllerState.Connecting,e);else if(n===s.SessionStateControllerState.Connected&&e===i.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(n===s.SessionStateControllerState.Connected&&e===i.SessionStateControllerAction.Update)this.transition(s.SessionStateControllerState.Updating,e);else if(n===s.SessionStateControllerState.Updating&&e===i.SessionStateControllerAction.Fail)this.transition(s.SessionStateControllerState.Disconnecting,e);else if(n===s.SessionStateControllerState.Updating&&e===i.SessionStateControllerAction.FinishUpdating)this.transition(s.SessionStateControllerState.Connected,e);else{if(n!==s.SessionStateControllerState.Disconnecting||e!==i.SessionStateControllerAction.FinishDisconnecting)return this.canDefer(e)?(this.logger.info(`deferring transition from ${s.SessionStateControllerState[this.currentState]} with ${i.SessionStateControllerAction[e]}`),this.deferAction(e,t),o.SessionStateControllerTransitionResult.DeferredTransition):(this.logger.warn(`no transition found from ${s.SessionStateControllerState[this.currentState]} with ${i.SessionStateControllerAction[e]}`),o.SessionStateControllerTransitionResult.NoTransitionAvailable);this.transition(s.SessionStateControllerState.NotConnected,e)}try{t()}catch(t){return this.logger.error(`error during state ${s.SessionStateControllerState[this.currentState]} with action ${i.SessionStateControllerAction[e]}: ${t}`),this.logger.info("rolling back transition to "+s.SessionStateControllerState[n]),this.currentState=n,o.SessionStateControllerTransitionResult.TransitionFailed}return this.performDeferredAction(),o.SessionStateControllerTransitionResult.Transitioned}state(){return this.currentState}transition(e,t){this.logger.info(`transitioning from ${s.SessionStateControllerState[this.currentState]} to ${s.SessionStateControllerState[e]} with ${i.SessionStateControllerAction[t]}`),this.currentState=e}deferPriority(e){switch(e){case i.SessionStateControllerAction.Disconnect:return r.SessionStateControllerDeferPriority.VeryHigh;case i.SessionStateControllerAction.Fail:return r.SessionStateControllerDeferPriority.High;case i.SessionStateControllerAction.Reconnect:return r.SessionStateControllerDeferPriority.Medium;case i.SessionStateControllerAction.Update:return r.SessionStateControllerDeferPriority.Low;default:return r.SessionStateControllerDeferPriority.DoNotDefer}}deferAction(e,t){null!==this.deferredAction&&this.deferPriority(this.deferredAction)>this.deferPriority(e)||(this.deferredAction=e,this.deferredWork=t)}canDefer(e){return this.deferPriority(e)!==r.SessionStateControllerDeferPriority.DoNotDefer&&(this.currentState===s.SessionStateControllerState.Connecting||this.currentState===s.SessionStateControllerState.Updating)}performDeferredAction(){if(!this.deferredAction)return;const e=this.deferredAction,t=this.deferredWork;this.deferredAction=null,this.deferredWork=null,this.logger.info("performing deferred action "+i.SessionStateControllerAction[e]),this.perform(e,t)!==o.SessionStateControllerTransitionResult.Transitioned&&this.logger.info(`unable to perform deferred action ${i.SessionStateControllerAction[e]} in state ${s.SessionStateControllerState[this.currentState]}`)}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SessionStateControllerDeferPriority=void 0,function(e){e[e.DoNotDefer=0]="DoNotDefer",e[e.Low=1]="Low",e[e.Medium=2]="Medium",e[e.High=3]="High",e[e.VeryHigh=4]="VeryHigh"}(i=t.SessionStateControllerDeferPriority||(t.SessionStateControllerDeferPriority={})),t.default=i},function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0});const i=n(7),r=n(5),s=n(16),o=n(35),a=n(119),c=n(6);class l{constructor(e,t){this.webSocket=e,this.logger=t,this.unloadHandler=null,this.observerQueue=new Set,this.connectionRequestQueue=[],this.resetConnection(),this.logger.debug(()=>"signaling client init"),this.audioSessionId=this.generateNewAudioSessionId()}registerObserver(e){this.logger.debug(()=>"registering signaling client observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.debug(()=>"removing signaling client observer"),this.observerQueue.delete(e)}openConnection(e){this.logger.info("adding connection request to queue: "+e.url()),this.connectionRequestQueue.push(e),this.closeConnection()}pingPong(e){this.logger.debug(()=>"sending ping");const t=r.SdkSignalFrame.create();return t.type=r.SdkSignalFrame.Type.PING_PONG,t.pingPong=e,this.sendMessage(t),t.timestampMs}join(e){this.logger.info("sending join");const t=r.SdkJoinFrame.create();t.protocolVersion=2,t.maxNumOfVideos=e.maxVideos,t.flags=r.SdkJoinFlags.HAS_STREAM_UPDATE;const n=new i.default;n.supportsSenderSideBandwidthEstimation()&&(t.flags|=r.SdkJoinFlags.USE_SEND_SIDE_BWE),t.flags|=e.sendBitrates?r.SdkJoinFlags.SEND_BITRATES:0,t.clientDetails=r.SdkClientDetails.create({platformName:n.name(),platformVersion:n.version(),clientSource:s.default.sdkName,chimeSdkVersion:s.default.sdkVersion}),t.audioSessionId=this.audioSessionId;const o=r.SdkSignalFrame.create();o.type=r.SdkSignalFrame.Type.JOIN,o.join=t,this.sendMessage(o)}subscribe(e){const t=r.SdkSubscribeFrame.create();if(t.sendStreams=[],t.sdpOffer=e.sdpOffer,t.audioCheckin=e.audioCheckin,t.audioHost=e.audioHost,t.audioMuted=e.audioMuted,e.connectionTypeHasVideo&&(t.receiveStreamIds=e.receiveStreamIds),t.duplex=r.SdkStreamServiceType.RX,!e.audioCheckin){const n=r.SdkStreamDescriptor.create();n.mediaType=r.SdkStreamMediaType.AUDIO,n.trackLabel="AmazonChimeExpressAudio",n.attendeeId=e.attendeeId,n.streamId=1,n.groupId=1,n.framerate=15,n.maxBitrateKbps=600,n.avgBitrateBps=4e5,t.sendStreams.push(n)}if(e.localVideoEnabled){t.duplex=r.SdkStreamServiceType.DUPLEX;for(let n=0;n<e.videoStreamDescriptions.length;n++){const i=e.videoStreamDescriptions[n].clone();i.attendeeId=e.attendeeId,t.sendStreams.push(i.toStreamDescriptor())}}const n=r.SdkSignalFrame.create();n.type=r.SdkSignalFrame.Type.SUBSCRIBE,n.sub=t,this.sendMessage(n)}leave(){const e=r.SdkSignalFrame.create();e.type=r.SdkSignalFrame.Type.LEAVE,e.leave=r.SdkLeaveFrame.create(),this.sendMessage(e),this.logger.debug(()=>"sent leave")}sendClientMetrics(e){const t=r.SdkSignalFrame.create();t.type=r.SdkSignalFrame.Type.CLIENT_METRIC,t.clientMetric=e,this.sendMessage(t)}sendDataMessage(e){const t=r.SdkSignalFrame.create();t.type=r.SdkSignalFrame.Type.DATA_MESSAGE,t.dataMessage=e,this.sendMessage(t)}closeConnection(){this.webSocket.readyState()!==o.default.None&&this.webSocket.readyState()!==o.default.Closed?(this.isClosing=!0,this.sendEvent(new a.default(this,c.default.WebSocketClosing,null)),this.webSocket.close(),this.deactivatePageUnloadHandler()):(this.logger.info("no existing connection needs closing"),this.serviceConnectionRequestQueue())}ready(){return this.webSocket.readyState()===o.default.Open&&!this.isClosing&&this.wasOpened}mute(e){const t=r.SdkSignalFrame.create();t.type=r.SdkSignalFrame.Type.AUDIO_CONTROL;const n=r.SdkAudioControlFrame.create();n.muted=e,t.audioControl=n,this.sendMessage(t)}pause(e){const t=r.SdkSignalFrame.create();t.type=r.SdkSignalFrame.Type.PAUSE,t.pause=r.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resume(e){const t=r.SdkSignalFrame.create();t.type=r.SdkSignalFrame.Type.RESUME,t.pause=r.SdkPauseResumeFrame.create(),t.pause.streamIds=e,this.sendMessage(t)}resetConnection(){this.webSocket.destroy(),this.wasOpened=!1}sendMessage(e){e.timestampMs=Date.now(),this.logger.debug(()=>"sending: "+JSON.stringify(e));const t=this.prependWithFrameTypeRTC(r.SdkSignalFrame.encode(e).finish());if(this.ready()){if(!this.webSocket.send(t))return void this.sendEvent(new a.default(this,c.default.WebSocketSendMessageFailure,null));this.sendEvent(new a.default(this,c.default.WebSocketSentMessage,null))}else this.sendEvent(new a.default(this,c.default.WebSocketSkippedMessage,null))}receiveMessage(e){let t;try{t=r.SdkSignalFrame.decode(e)}catch(t){return this.logger.info("failed to decode: "+e),void this.sendEvent(new a.default(this,c.default.ProtocolDecodeFailure,null))}this.logger.debug(()=>"received: "+JSON.stringify(t)),this.webSocket.readyState()===o.default.Open?this.sendEvent(new a.default(this,c.default.ReceivedSignalFrame,t)):this.logger.info("skipping notification of message since WebSocket is not open: "+JSON.stringify(t))}stripFrameTypeRTC(e){const t=e[0];return t!==l.FRAME_TYPE_RTC&&2!==t&&this.logger.warn("expected FrameTypeRTC for message but got "+t),e.slice(1)}prependWithFrameTypeRTC(e){const t=new Uint8Array(e.length+1);return t[0]=l.FRAME_TYPE_RTC,t.set(e,1),t}serviceConnectionRequestQueue(){if(0===this.connectionRequestQueue.length)return void this.logger.info("no connection requests to service");const e=this.connectionRequestQueue.shift();this.logger.info("opening connection to "+e.url()),this.isClosing=!1,this.webSocket.create(e.url(),e.protocols()),this.setUpEventListeners(),this.sendEvent(new a.default(this,c.default.WebSocketConnecting,null))}sendEvent(e){switch(e.type){case c.default.WebSocketMessage:case c.default.ReceivedSignalFrame:case c.default.WebSocketSentMessage:this.logger.debug(()=>"notifying event: "+c.default[e.type]);break;case c.default.WebSocketSkippedMessage:this.logger.debug(()=>`notifying event: ${c.default[e.type]}, websocket state=${o.default[this.webSocket.readyState()]}`);break;default:this.logger.info("notifying event: "+c.default[e.type])}for(const t of this.observerQueue)t.handleSignalingClientEvent(e)}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.activatePageUnloadHandler(),this.wasOpened=!0,this.sendEvent(new a.default(this,c.default.WebSocketOpen,null))}),this.webSocket.addEventListener("message",e=>{this.sendEvent(new a.default(this,c.default.WebSocketMessage,null)),this.receiveMessage(this.stripFrameTypeRTC(new Uint8Array(e.data)))}),this.webSocket.addEventListener("close",e=>{this.deactivatePageUnloadHandler(),this.resetConnection(),this.sendEvent(new a.default(this,c.default.WebSocketClosed,null,e.code,e.reason)),this.serviceConnectionRequestQueue()}),this.webSocket.addEventListener("error",()=>{!this.isClosing||this.wasOpened?this.wasOpened?(this.logger.error("received error while connected"),this.sendEvent(new a.default(this,c.default.WebSocketError,null))):(this.logger.error("failed to connect"),this.sendEvent(new a.default(this,c.default.WebSocketFailed,null))):this.logger.info("ignoring error closing signaling while connecting")})}activatePageUnloadHandler(){this.unloadHandler=()=>{this.leave()};const t=e;t.window&&t.window.addEventListener&&window.addEventListener("unload",this.unloadHandler)}deactivatePageUnloadHandler(){const t=e;t.window&&t.window.addEventListener&&window.removeEventListener("unload",this.unloadHandler),this.unloadHandler=null}generateNewAudioSessionId(){const e=new Uint32Array(1);return window.crypto.getRandomValues(e)[0]}}t.default=l,l.FRAME_TYPE_RTC=5}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(6);t.default=class{constructor(e,t,n,i,r){this.client=e,this.type=t,this.message=n,this.closeCode=i,this.closeReason=r,this.timestampMs=Date.now()}isConnectionTerminated(){switch(this.type){case i.default.WebSocketFailed:case i.default.WebSocketError:case i.default.WebSocketClosing:case i.default.WebSocketClosed:return!0;default:return!1}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(22),r=n(32),s=n(121),o=n(123),a=n(8),c=n(124),l=n(125),d=n(14),u=n(5),h=n(44),p=n(31);class f{constructor(e,t,n,i=f.INTERVAL_MS){this.audioVideoController=e,this.logger=t,this.browserBehavior=n,this.interval=i,this.intervalScheduler=null,this.metricsAddTime=(e,t,n)=>{},this.metricsLogEvent=(e,t)=>{}}toAttribute(e){return this.toSuffix(e).substring(1)}toSuffix(e){return e.toLowerCase()===e?"_"+e:e.toUpperCase()===e?"_"+e.toLowerCase():e.replace(/([A-Z][a-z]+)/g,(function(e){return"_"+e})).replace(/([A-Z][A-Z]+)/g,(function(e){return"_"+e})).toLowerCase()}logLatency(e,t,n){const i=this.toSuffix(e);this.logEventTime("meeting"+i,t,n)}logStateTimeout(e,t){const n=this.toSuffix(e);this.logEvent("meeting_session_state_timeout",Object.assign(Object.assign({},t),{state:"state"+n}))}logAudioEvent(e,t){const n="audio"+this.toSuffix(h.default[e]);this.logEvent(n,t)}logVideoEvent(e,t){const n="video"+this.toSuffix(p.default[e]);this.logEvent(n,t)}logEventTime(e,t,n={}){const i=Object.assign(Object.assign({},n),{call_id:this.audioVideoController.configuration.meetingId,client_type:f.CLIENT_TYPE,metric_type:"latency"});this.logger.debug(()=>`[DefaultStatsCollector] ${e}: ${JSON.stringify(i)}`),this.metricsAddTime(e,t,i)}logMeetingSessionStatus(e){const t=""+e.statusCode();this.logEvent(t);const n={status:t,status_code:""+e.statusCode()};this.logEvent("meeting_session_status",n),e.isTerminal()&&this.logEvent("meeting_session_stopped",n),e.isAudioConnectionFailure()&&this.logEvent("meeting_session_audio_failed",n),e.isFailure()&&this.logEvent("meeting_session_failed",n)}logLifecycleEvent(e,t){const n={lifecycle_event:"lifecycle"+this.toSuffix(c.default[e]),lifecycle_event_code:""+e,lifecycle_event_condition:"condition"+this.toSuffix(l.default[t]),lifecycle_event_condition_code:""+t};this.logEvent("meeting_session_lifecycle",n)}logEvent(e,t={}){const n=Object.assign(Object.assign({},t),{call_id:this.audioVideoController.configuration.meetingId,client_type:f.CLIENT_TYPE});this.logger.debug(()=>`[DefaultStatsCollector] ${e}: ${JSON.stringify(n)}`),this.metricsLogEvent(e,n)}start(e,t,n){return!this.intervalScheduler&&(this.logger.info("Starting DefaultStatsCollector"),this.signalingClient=e,this.videoStreamIndex=t,this.clientMetricReport=n||new s.default(this.logger),this.intervalScheduler=new d.default(this.interval),this.intervalScheduler.start(()=>{this.getStatsWrapper()}),!0)}stop(){this.logger.info("Stopping DefaultStatsCollector"),this.intervalScheduler&&this.intervalScheduler.stop(),this.intervalScheduler=null}updateMetricValues(e,t){const n=t?this.clientMetricReport.streamMetricReports[Number(e.ssrc)]:this.clientMetricReport.globalMetricReport;let i;i=t?this.clientMetricReport.getMetricMap(n.mediaType,n.direction):this.clientMetricReport.getMetricMap();for(const t in e)t in i&&(n.previousMetrics[t]=n.currentMetrics[t],n.currentMetrics[t]=e[t])}processRawMetricReports(e){this.clientMetricReport.currentSsrcs={};const t=Date.now();for(const t of e){const e=this.isStreamRawMetricReport(t.type);if(e){if(!this.clientMetricReport.streamMetricReports[Number(t.ssrc)]){const e=new o.default;e.mediaType=this.getMediaType(t),e.direction=this.getDirectionType(t),this.videoStreamIndex.allStreams().empty()||(e.streamId=this.videoStreamIndex.streamIdForSSRC(Number(t.ssrc))),this.clientMetricReport.streamMetricReports[Number(t.ssrc)]=e}this.clientMetricReport.currentSsrcs[Number(t.ssrc)]=1}this.updateMetricValues(t,e)}this.clientMetricReport.removeDestroyedSsrcs(),this.clientMetricReport.previousTimestampMs=this.clientMetricReport.currentTimestampMs,this.clientMetricReport.currentTimestampMs=t,this.clientMetricReport.print()}addMetricFrame(e,t,n,i){const r=n.type,s=n.transform,o=n.source,a=t.streamMetricFrames.length,c=t.streamMetricFrames[a-1];if(r){const n=u.SdkMetric.create();n.type=r,n.value=s(o||e,i),i?c.metrics.push(n):t.globalMetrics.push(n)}}addGlobalMetricsToProtobuf(e){const t=this.clientMetricReport.getMetricMap();for(const n in this.clientMetricReport.globalMetricReport.currentMetrics)this.addMetricFrame(n,e,t[n])}addStreamMetricsToProtobuf(e){for(const t in this.clientMetricReport.streamMetricReports){const n=this.clientMetricReport.streamMetricReports[t],i=u.SdkStreamMetricFrame.create();i.streamId=n.streamId,i.metrics=[],e.streamMetricFrames.push(i);const r=this.clientMetricReport.getMetricMap(n.mediaType,n.direction);for(const i in n.currentMetrics)this.addMetricFrame(i,e,r[i],Number(t))}}makeClientMetricProtobuf(){const e=u.SdkClientMetricFrame.create();return e.globalMetrics=[],e.streamMetricFrames=[],this.addGlobalMetricsToProtobuf(e),this.addStreamMetricsToProtobuf(e),e}sendClientMetricProtobuf(e){this.signalingClient.sendClientMetrics(e)}isStreamRawMetricReport(e){return"ssrc"===e||"inbound-rtp"===e||"outbound-rtp"===e}getMediaType(e){return"audio"===e.mediaType?r.default.AUDIO:r.default.VIDEO}getDirectionType(e){return-1!==e.id.toLowerCase().indexOf("send")||-1!==e.id.toLowerCase().indexOf("outbound")?i.default.UPSTREAM:i.default.DOWNSTREAM}isValidChromeRawMetric(e){return this.browserBehavior.hasChromiumWebRTC()&&("ssrc"===e.type||"VideoBwe"===e.type||"googCandidatePair"===e.type&&"true"===e.googWritable&&"true"===e.googReadable)}isValidStandardRawMetric(e){const t="inbound-rtp"===e.type||"outbound-rtp"===e.type||"candidate-pair"===e.type&&"succeeded"===e.state;return this.browserBehavior.hasFirefoxWebRTC()?-1===this.compareMajorVersion(f.FIREFOX_UPDATED_GET_STATS_VERSION)?t:t&&!1===e.isRemote:t}isValidSsrc(e){let t=!0;return this.isStreamRawMetricReport(e.type)&&this.getDirectionType(e)===i.default.DOWNSTREAM&&this.getMediaType(e)===r.default.VIDEO&&(t=this.videoStreamIndex.streamIdForSSRC(Number(e.ssrc))>0),t}isValidRawMetricReport(e){return(this.isValidChromeRawMetric(e)||this.isValidStandardRawMetric(e))&&this.isValidSsrc(e)}filterRawMetricReports(e){const t=[];for(const n of e)this.isValidRawMetricReport(n)&&t.push(n);return t}handleRawMetricReports(e){const t=this.filterRawMetricReports(e);this.logger.debug(()=>"Filtered raw metrics : "+JSON.stringify(t)),this.processRawMetricReports(t);const n=this.makeClientMetricProtobuf();this.sendClientMetricProtobuf(n),this.audioVideoController.forEachObserver(e=>{a.default.of(e.metricsDidReceive).map(t=>t.bind(e)(this.clientMetricReport.clone()))})}getStatsWrapper(){if(!this.audioVideoController.rtcPeerConnection)return;const e=[];this.browserBehavior.requiresPromiseBasedWebRTCGetStats()?this.audioVideoController.rtcPeerConnection.getStats().then(t=>{t.forEach(t=>{e.push(t)}),this.handleRawMetricReports(e)}).catch(e=>{this.logger.error(e.message)}):this.audioVideoController.rtcPeerConnection.getStats(t=>{t.result().forEach(t=>{const n={};t.names().forEach(e=>{n[e]=t.stat(e)}),n.id=t.id,n.type=t.type,n.timestamp=t.timestamp,e.push(n)}),this.handleRawMetricReports(e)},e=>{this.logger.error(e.message)})}compareMajorVersion(e){const t=parseInt(this.browserBehavior.version().split(".")[0]),n=parseInt(e.split(".")[0]);return n===t?0:n>t?1:-1}}t.default=f,f.INTERVAL_MS=1e3,f.FIREFOX_UPDATED_GET_STATS_VERSION="66.0.0",f.CLIENT_TYPE="amazon-chime-sdk-js"},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(22),s=n(32),o=n(122);class a{constructor(e){this.logger=e,this.globalMetricReport=new o.default,this.streamMetricReports={},this.currentTimestampMs=0,this.previousTimestampMs=0,this.currentSsrcs={},this.identityValue=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport;return Number(n.currentMetrics[e])},this.decoderLossPercent=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport,i=n.currentMetrics.googDecodingNormal-(n.previousMetrics.googDecodingNormal||0),r=n.currentMetrics.googDecodingCTN-(n.previousMetrics.googDecodingCTN||0);if(r<=0)return 0;const s=r-i;return s<=0?0:100*s/r},this.packetLossPercent=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport,i=n.currentMetrics[e]-(n.previousMetrics[e]||0),r=n.currentMetrics.packetsLost-(n.previousMetrics.packetsLost||0),s=i+r;return s<=0||r<=0?0:100*r/s},this.countPerSecond=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport;let i=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(i<=0)return 0;this.previousTimestampMs<=0&&(i=1);const r=n.currentMetrics[e]-(n.previousMetrics[e]||0);return r<=0?0:Math.trunc(r/i)},this.bitsPerSecond=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport;let i=(this.currentTimestampMs-this.previousTimestampMs)/1e3;if(i<=0)return 0;this.previousTimestampMs<=0&&(i=1);const r=8*(n.currentMetrics[e]-(n.previousMetrics[e]||0));return r<=0?0:Math.trunc(r/i)},this.secondsToMilliseconds=(e,t)=>{const n=t?this.streamMetricReports[t]:this.globalMetricReport;return Number(1e3*n.currentMetrics[e])},this.globalMetricMap={googActualEncBitrate:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_ACTUAL_ENCODER_BITRATE},googAvailableSendBandwidth:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_AVAILABLE_SEND_BANDWIDTH},googRetransmitBitrate:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_RETRANSMIT_BITRATE},googAvailableReceiveBandwidth:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_AVAILABLE_RECEIVE_BANDWIDTH},googTargetEncBitrate:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_TARGET_ENCODER_BITRATE},googBucketDelay:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_BUCKET_DELAY_MS},googRtt:{transform:this.identityValue,type:i.SdkMetric.Type.STUN_RTT_MS},packetsDiscardedOnSend:{transform:this.countPerSecond,type:i.SdkMetric.Type.SOCKET_DISCARDED_PPS},availableIncomingBitrate:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_AVAILABLE_RECEIVE_BANDWIDTH},availableOutgoingBitrate:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_AVAILABLE_SEND_BANDWIDTH},currentRoundTripTime:{transform:this.identityValue,type:i.SdkMetric.Type.STUN_RTT_MS}},this.audioUpstreamMetricMap={googJitterReceived:{transform:this.identityValue,type:i.SdkMetric.Type.RTC_MIC_JITTER_MS},jitter:{transform:this.secondsToMilliseconds,type:i.SdkMetric.Type.RTC_MIC_JITTER_MS},packetsSent:{transform:this.countPerSecond,type:i.SdkMetric.Type.RTC_MIC_PPS},bytesSent:{transform:this.bitsPerSecond,type:i.SdkMetric.Type.RTC_MIC_BITRATE},googRtt:{transform:this.identityValue,type:i.SdkMetric.Type.RTC_MIC_RTT_MS},packetsLost:{transform:this.packetLossPercent,type:i.SdkMetric.Type.RTC_MIC_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"}},this.audioDownstreamMetricMap={packetsReceived:{transform:this.countPerSecond,type:i.SdkMetric.Type.RTC_SPK_PPS},packetsLost:{transform:this.packetLossPercent,type:i.SdkMetric.Type.RTC_SPK_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},googJitterReceived:{transform:this.identityValue,type:i.SdkMetric.Type.RTC_SPK_JITTER_MS},jitter:{transform:this.secondsToMilliseconds,type:i.SdkMetric.Type.RTC_SPK_JITTER_MS},googDecodingCTN:{transform:this.countPerSecond},googDecodingNormal:{transform:this.decoderLossPercent,type:i.SdkMetric.Type.RTC_SPK_FRACTION_DECODER_LOSS_PERCENT,source:"googDecodingCTN"},bytesReceived:{transform:this.bitsPerSecond,type:i.SdkMetric.Type.RTC_SPK_BITRATE},googCurrentDelayMs:{transform:this.identityValue,type:i.SdkMetric.Type.RTC_SPK_CURRENT_DELAY_MS},googJitterBufferMs:{transform:this.identityValue,type:i.SdkMetric.Type.RTC_SPK_JITTER_BUFFER_MS}},this.videoUpstreamMetricMap={googRtt:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_SENT_RTT_MS},googEncodeUsagePercent:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_ENCODE_USAGE_PERCENT},googNacksReceived:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_NACKS_RECEIVED},nackCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_NACKS_RECEIVED},googPlisReceived:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_PLIS_RECEIVED},pliCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_PLIS_RECEIVED},googFirsReceived:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_FIRS_RECEIVED},firCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_FIRS_RECEIVED},googAvgEncodeMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_AVERAGE_ENCODE_MS},googFrameRateInput:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_INPUT_FPS},framesEncoded:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_ENCODE_FPS},googFrameRateSent:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_SENT_FPS},framerateMean:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_SENT_FPS},packetsSent:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_SENT_PPS},packetsLost:{transform:this.packetLossPercent,type:i.SdkMetric.Type.VIDEO_SENT_FRACTION_PACKET_LOST_PERCENT,source:"packetsSent"},bytesSent:{transform:this.bitsPerSecond,type:i.SdkMetric.Type.VIDEO_SENT_BITRATE},droppedFrames:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_DROPPED_FPS},qpSum:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_SENT_QP_SUM}},this.videoDownstreamMetricMap={googTargetDelayMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_TARGET_DELAY_MS},googDecodeMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_DECODE_MS},googFrameRateOutput:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_OUTPUT_FPS},packetsReceived:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_RECEIVED_PPS},packetsLost:{transform:this.packetLossPercent,type:i.SdkMetric.Type.VIDEO_RECEIVED_FRACTION_PACKET_LOST_PERCENT,source:"packetsReceived"},googRenderDelayMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_RENDER_DELAY_MS},googFrameRateReceived:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_RECEIVED_FPS},framerateMean:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_RECEIVED_FPS},framesDecoded:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_DECODE_FPS},googNacksSent:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_NACKS_SENT},nackCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_NACKS_SENT},googFirsSent:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_FIRS_SENT},firCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_FIRS_SENT},googPlisSent:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_PLIS_SENT},pliCount:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_PLIS_SENT},bytesReceived:{transform:this.bitsPerSecond,type:i.SdkMetric.Type.VIDEO_RECEIVED_BITRATE},googCurrentDelayMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_CURRENT_DELAY_MS},googJitterBufferMs:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_JITTER_BUFFER_MS},discardedPackets:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_DISCARDED_PPS},googJitterReceived:{transform:this.identityValue,type:i.SdkMetric.Type.VIDEO_RECEIVED_JITTER_MS},jitter:{transform:this.secondsToMilliseconds,type:i.SdkMetric.Type.VIDEO_RECEIVED_JITTER_MS},qpSum:{transform:this.countPerSecond,type:i.SdkMetric.Type.VIDEO_RECEIVED_QP_SUM}},this.observableMetricSpec={audioPacketsReceived:{source:"packetsReceived",media:s.default.AUDIO,dir:r.default.DOWNSTREAM},audioPacketsReceivedFractionLoss:{source:"packetsLost",media:s.default.AUDIO,dir:r.default.DOWNSTREAM},audioDecoderLoss:{source:"googDecodingNormal",media:s.default.AUDIO,dir:r.default.DOWNSTREAM},videoUpstreamBitrate:{source:"bytesSent",media:s.default.VIDEO,dir:r.default.UPSTREAM},videoPacketSentPerSecond:{source:"packetsSent",media:s.default.VIDEO,dir:r.default.UPSTREAM},availableSendBandwidth:{source:"googAvailableSendBandwidth"},availableReceiveBandwidth:{source:"googAvailableReceiveBandwidth"},audioSpeakerDelayMs:{source:"googCurrentDelayMs",media:s.default.AUDIO,dir:r.default.DOWNSTREAM},availableIncomingBitrate:{source:"availableIncomingBitrate"},availableOutgoingBitrate:{source:"availableOutgoingBitrate"},nackCountReceivedPerSecond:{source:"nackCount",media:s.default.VIDEO,dir:r.default.UPSTREAM},googNackCountReceivedPerSecond:{source:"googNacksReceived",media:s.default.VIDEO,dir:r.default.UPSTREAM}}}getMetricMap(e,t){switch(e){case s.default.AUDIO:switch(t){case r.default.UPSTREAM:return this.audioUpstreamMetricMap;case r.default.DOWNSTREAM:return this.audioDownstreamMetricMap}case s.default.VIDEO:switch(t){case r.default.UPSTREAM:return this.videoUpstreamMetricMap;case r.default.DOWNSTREAM:return this.videoDownstreamMetricMap}default:return this.globalMetricMap}}getObservableMetricValue(e){const t=this.observableMetricSpec[e],n=this.getMetricMap(t.media,t.dir)[t.source],i=n.transform,r=n.source;if(!t.hasOwnProperty("media"))return i(r||t.source);for(const e in this.streamMetricReports){const n=this.streamMetricReports[e];if(t.source in n.currentMetrics&&n.direction===t.dir&&n.mediaType===t.media)return i(r||t.source,Number(e))}return 0}getObservableMetrics(){const e={};for(const t in this.observableMetricSpec)e[t]=this.getObservableMetricValue(t);return e}clone(){const e=new a(this.logger);return e.globalMetricReport=this.globalMetricReport,e.streamMetricReports=this.streamMetricReports,e.currentTimestampMs=this.currentTimestampMs,e.previousTimestampMs=this.previousTimestampMs,e}print(){const e={globalMetricReport:this.globalMetricReport,streamMetricReports:this.streamMetricReports,currentTimestampMs:this.currentTimestampMs,previousTimestampMs:this.previousTimestampMs};this.logger.debug(()=>"Client Metric Report: "+JSON.stringify(e))}removeDestroyedSsrcs(){for(const e in this.streamMetricReports)this.currentSsrcs[e]||delete this.streamMetricReports[e]}}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.previousMetrics={},this.currentMetrics={}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.previousMetrics={},this.currentMetrics={}}}},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEvent=void 0,function(e){e[e.Connecting=0]="Connecting",e[e.Started=1]="Started",e[e.Stopped=2]="Stopped"}(i=t.MeetingSessionLifecycleEvent||(t.MeetingSessionLifecycleEvent={})),t.default=i},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.MeetingSessionLifecycleEventCondition=void 0,function(e){e[e.ConnectingNew=0]="ConnectingNew",e[e.ReconnectingExisting=1]="ReconnectingExisting",e[e.StartedNew=2]="StartedNew",e[e.StartedExisting=3]="StartedExisting",e[e.StartedAfterReconnect=4]="StartedAfterReconnect",e[e.StoppedCleanly=5]="StoppedCleanly",e[e.StoppedWithFailure=6]="StoppedWithFailure"}(i=t.MeetingSessionLifecycleEventCondition||(t.MeetingSessionLifecycleEventCondition={})),t.default=i},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),s=n(24),o=n(4);class a extends o.default{constructor(e,t=a.CHROME_VPN_TIMEOUT_MS){super(e.logger),this.context=e,this.chromeVpnTimeoutMs=t,this.taskName="FinishGatheringICECandidatesTask"}removeEventListener(){this.context.peer&&(this.context.peer.removeEventListener("icecandidate",this.context.iceCandidateHandler),this.context.turnCredentials||this.context.peer.removeEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler))}cancel(){let e;if(this.context.browserBehavior.requiresIceCandidateGatheringTimeoutWorkaround()&&this.chromeVpnTimeoutMs<this.context.meetingSessionConfiguration.connectionTimeoutMs){Date.now()-this.startTimestampMs>this.chromeVpnTimeoutMs&&(e=new Error(`canceling ${this.name()} due to the meeting status code: ${r.default.ICEGatheringTimeoutWorkaround}`))}this.cancelPromise&&(e=e||new Error("canceling "+this.name()),this.cancelPromise(e),delete this.cancelPromise)}run(){return i(this,void 0,void 0,(function*(){if(this.context.peer||this.logAndThrow("session does not have peer connection; bypass ice gathering"),this.context.browserBehavior.requiresCheckForSdpConnectionAttributes()){if(new s.default(this.context.peer.localDescription.sdp).hasCandidatesForAllMLines())return void this.context.logger.info("ice gathering already complete; bypass gathering, current local description "+this.context.peer.localDescription.sdp)}else this.context.logger.info("iOS device does not require checking for connection attributes in SDP, current local description "+this.context.peer.localDescription.sdp);if(!this.context.browserBehavior.hasFirefoxWebRTC()&&"complete"!==this.context.peer.iceGatheringState||!new s.default(this.context.peer.localDescription.sdp).hasCandidates())try{yield new Promise((e,t)=>{this.cancelPromise=e=>{this.removeEventListener(),t(e)},this.context.turnCredentials||(this.context.iceGatheringStateEventHandler=()=>{if("complete"===this.context.peer.iceGatheringState)return this.removeEventListener(),e(),void delete this.cancelPromise},this.context.peer.addEventListener("icegatheringstatechange",this.context.iceGatheringStateEventHandler)),this.context.iceCandidateHandler=n=>{if(this.context.logger.info(`ice candidate: ${n.candidate?n.candidate.candidate:"(null)"} state: ${this.context.peer.iceGatheringState}`),n.candidate&&(s.default.isRTPCandidate(n.candidate.candidate)&&this.context.iceCandidates.push(n.candidate),this.context.turnCredentials&&this.context.iceCandidates.length>=1))return this.context.logger.info("gathered at least one relay candidate"),this.removeEventListener(),e(),void delete this.cancelPromise;"complete"===this.context.peer.iceGatheringState&&(this.context.logger.info("done gathering ice candidates"),this.removeEventListener(),new s.default(this.context.peer.localDescription.sdp).hasCandidates()&&0!==this.context.iceCandidates.length?(e(),delete this.cancelPromise):(t(new Error("no ice candidates were gathered")),delete this.cancelPromise))},this.context.peer.addEventListener("icecandidate",this.context.iceCandidateHandler),this.startTimestampMs=Date.now()})}catch(e){throw e}finally{this.startTimestampMs&&(this.context.iceGatheringDurationMs=Math.round(Date.now()-this.startTimestampMs))}else this.context.logger.info("ice gathering state is complete and candidates are in SDP; bypass gathering")}))}}t.default=a,a.CHROME_VPN_TIMEOUT_MS=5e3},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(34),s=n(12),o=n(56),a=n(6),c=n(128),l=n(5),d=n(4);class u extends d.default{constructor(e){super(e.logger),this.context=e,this.taskName="JoinAndReceiveIndexTask",this.taskCanceler=null,this.maxVideos=16}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return i(this,void 0,void 0,(function*(){const e=yield new Promise((e,t)=>{const n=this.context;n.turnCredentials=null;const i=new class{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(new Error("JoinAndReceiveIndexTask got canceled while waiting for SdkIndexFrame"))}handleSignalingClientEvent(t){if(t.type===a.default.WebSocketClosed){n.logger.warn(`signaling connection closed by server with code ${t.closeCode} and reason: ${t.closeReason}`);let e=s.default.SignalingBadRequest;return 4410===t.closeCode?(n.logger.warn("the meeting cannot be joined because it is has been ended"),e=s.default.MeetingEnded):t.closeCode>=4500&&t.closeCode<4600&&(e=s.default.SignalingInternalServerError),void n.audioVideoController.handleMeetingSessionStatus(new r.default(e),null)}if(t.type!==a.default.ReceivedSignalFrame)return;if(t.message.type===l.SdkSignalFrame.Type.JOIN_ACK){const e=t.message.joinack;return void(e&&e.turnCredentials?(n.turnCredentials=new o.default,n.turnCredentials.username=e.turnCredentials.username,n.turnCredentials.password=e.turnCredentials.password,n.turnCredentials.ttl=e.turnCredentials.ttl,n.turnCredentials.uris=e.turnCredentials.uris.map(e=>n.meetingSessionConfiguration.urls.urlRewriter(e)).filter(e=>!!e)):n.logger.error("missing TURN credentials in JoinAckFrame"))}if(t.message.type!==l.SdkSignalFrame.Type.INDEX)return;this.signalingClient.removeObserver(this);const i=t.message.index;e(i)}}(this.context.signalingClient);this.context.signalingClient.registerObserver(i),this.taskCanceler=i,this.context.signalingClient.join(new c.default(this.maxVideos,!0))});this.context.logger.info("received first index "+JSON.stringify(e)),this.context.indexFrame=e}))}}t.default=u},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.maxVideos=e,this.sendBitrates=t}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),s=n(5),o=n(4);class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="LeaveAndReceiveLeaveAckTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return i(this,void 0,void 0,(function*(){this.context.signalingClient.ready()&&(this.context.signalingClient.leave(),this.context.logger.info("sent leave"),yield this.receiveLeaveAck())}))}receiveLeaveAck(){return new Promise((e,t)=>{const n=new class{constructor(e,t){this.signalingClient=e,this.logger=t}cancel(){this.signalingClient.removeObserver(this),t(new Error("LeaveAndReceiveLeaveAckTask got canceled while waiting for IndexFrame"))}handleSignalingClientEvent(t){if(t.isConnectionTerminated())return this.signalingClient.removeObserver(this),this.logger.info("LeaveAndReceiveLeaveAckTask connection terminated"),void e();t.type===r.default.ReceivedSignalFrame&&t.message.type===s.SdkSignalFrame.Type.LEAVE_ACK&&(this.signalingClient.removeObserver(this),this.logger.info("got leave ack"),e())}}(this.context.signalingClient,this.context.logger);this.taskCanceler=n,this.context.signalingClient.registerObserver(n)})}}t.default=a},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(6),s=n(5),o=n(4);class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="ListenForVolumeIndicatorsTask",this.realtimeMuteAndUnmuteHandler=e=>{this.context.signalingClient.mute(e)}}run(){return i(this,void 0,void 0,(function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler)}))}removeObserver(){this.context.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(this.realtimeMuteAndUnmuteHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===r.default.ReceivedSignalFrame)if(e.message.type===s.SdkSignalFrame.Type.AUDIO_STREAM_ID_INFO){const t=e.message.audioStreamIdInfo;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioStreamIdInfo(t)}else if(e.message.type===s.SdkSignalFrame.Type.AUDIO_METADATA){const t=e.message.audioMetadata;this.context.volumeIndicatorAdapter.sendRealtimeUpdatesForAudioMetadata(t)}}}t.default=a},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(22),s=n(32),o=n(87),a=n(132),c=n(133),l=n(8),d=n(34),u=n(12),h=n(6),p=n(44),f=n(31),g=n(4);class m extends g.default{constructor(e,t,n){super(e.logger),this.context=e,this.initialConnectionHealthData=n,this.taskName="MonitorTask",this.prevSignalStrength=1,this.currentVideoDownlinkBandwidthEstimationKbps=1e4,this.currentAvailableStreamAvgBitrates=null,this.hasSignalingError=!1,this.presenceHandlerCalled=!1,this.checkAndSendWeakSignalEvent=e=>{const t=e<1,n=this.prevSignalStrength<1,i=t?n?null:p.default.RedmicStartLoss:n?p.default.RedmicEndLoss:null;i&&this.context.statsCollector.logAudioEvent(i),this.prevSignalStrength=e},this.realtimeFatalErrorCallback=e=>{this.logger.error(`realtime error: ${e}: ${e.stack}`),this.context.audioVideoController.handleMeetingSessionStatus(new d.default(u.default.RealtimeApiFailed),e)},this.realtimeAttendeeIdPresenceHandler=(e,t)=>{this.context.meetingSessionConfiguration.credentials.attendeeId===e&&t&&!this.presenceHandlerCalled&&(this.presenceHandlerCalled=!0,this.context.attendeePresenceDurationMs=Date.now()-this.context.startAudioVideoTimestamp,this.context.eventController&&this.context.eventController.publishEvent("attendeePresenceReceived",{attendeePresenceDurationMs:this.context.attendeePresenceDurationMs}))},this.reconnectionHealthPolicy=new a.default(e.logger,Object.assign({},t),this.initialConnectionHealthData.clone()),this.unusableAudioWarningHealthPolicy=new c.default(Object.assign({},t),this.initialConnectionHealthData.clone())}removeObserver(){this.context.audioVideoController.removeObserver(this),this.context.realtimeController.realtimeUnsubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.signalingClient.removeObserver(this)}run(){return i(this,void 0,void 0,(function*(){this.context.removableObservers.push(this),this.context.audioVideoController.addObserver(this),this.context.realtimeController.realtimeSubscribeToFatalError(this.realtimeFatalErrorCallback),this.context.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(this.checkAndSendWeakSignalEvent),this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(this.realtimeAttendeeIdPresenceHandler),this.context.connectionMonitor.start(),this.context.statsCollector.start(this.context.signalingClient,this.context.videoStreamIndex),this.context.signalingClient.registerObserver(this)}))}videoTileDidUpdate(e){this.context.maxVideoTileCount=Math.max(this.context.maxVideoTileCount,this.context.videoTileController.getAllVideoTiles().length)}videoSendHealthDidChange(e,t){if(0===this.context.videoInputAttachedTimestampMs||!this.context.videoTileController.hasStartedLocalVideoTile()||!this.context.lastKnownVideoAvailability.canStartLocalVideo)return;const n=null!==this.context.activeVideoInput?this.context.activeVideoInput.getTracks():null;if(!n||!n[0])return;const i=Date.now()-this.context.videoInputAttachedTimestampMs;t>0||e>0?(this.context.statsCollector.logVideoEvent(f.default.SendingSuccess,this.context.videoDeviceInformation),this.context.statsCollector.logLatency("video_start_sending",i,this.context.videoDeviceInformation),this.context.videoInputAttachedTimestampMs=0):i>m.DEFAULT_TIMEOUT_FOR_START_SENDING_VIDEO_MS&&(this.context.statsCollector.logVideoEvent(f.default.SendingFailed,this.context.videoDeviceInformation),this.context.videoInputAttachedTimestampMs=0)}videoReceiveBandwidthDidChange(e,t){this.logger.debug(()=>`receiving bandwidth changed from prev=${t} Kbps to curr=${e} Kbps`),this.currentVideoDownlinkBandwidthEstimationKbps=e}checkResubscribe(e){const t=e.getObservableMetrics();if(!t)return!1;const n=t.availableSendBandwidth||t.availableOutgoingBitrate,i=t.nackCountReceivedPerSecond||t.googNackCountReceivedPerSecond;let r=!1;this.context.videoDownlinkBandwidthPolicy.updateMetrics(e);const s=this.context.videoDownlinkBandwidthPolicy.wantsResubscribe();if(r=r||s,s&&(this.context.videosToReceive=this.context.videoDownlinkBandwidthPolicy.chooseSubscriptions(),this.logger.info(`trigger resubscribe for down=${s}; videosToReceive=[${this.context.videosToReceive.array()}]`)),this.context.videoTileController.hasStartedLocalVideoTile()){this.context.videoUplinkBandwidthPolicy.updateConnectionMetric({uplinkKbps:n/1e3,nackCountPerSecond:i});const e=this.context.videoUplinkBandwidthPolicy.wantsResubscribe();r=r||e,e&&(this.logger.info(`trigger resubscribe for up=${e}; videosToReceive=[${this.context.videosToReceive.array()}]`),this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters(),this.context.videoUplinkBandwidthPolicy.chooseMediaTrackConstraints())}return r}metricsDidReceive(e){const t=e;if(!t)return;if(this.checkResubscribe(e)&&this.context.audioVideoController.update(),!this.currentAvailableStreamAvgBitrates)return;const n=t.streamMetricReports;if(!n)return;const i=new Map,a=new Map;for(const e in n)n[e].mediaType===s.default.VIDEO&&n[e].direction===r.default.DOWNSTREAM&&i.set(n[e].streamId,n[e]);let c=!1;for(const e of this.currentAvailableStreamAvgBitrates.bitrates)if(i.has(e.sourceStreamId)){const t=i.get(e.sourceStreamId),n=this.context.videoStreamIndex.attendeeIdForStreamId(e.sourceStreamId);if(!n)continue;const r=new o.default,s=t.previousMetrics.bytesReceived,l=t.currentMetrics.bytesReceived;if(!s||!l)continue;const d=8*(l-s)/1e3;r.expectedAverageBitrateKbps=e.avgBitrateBps/1e3,r.receivedAverageBitrateKbps=d,r.attendeeId=n,d<e.avgBitrateBps/1e3*m.DEFAULT_DOWNLINK_CALLRATE_UNDERSHOOT_FACTOR&&(c=!0),a.set(n,r)}c&&(this.logger.debug(()=>"Downlink video streams are not receiving enough data"),this.context.audioVideoController.forEachObserver(e=>{l.default.of(e.videoNotReceivingEnoughData).map(t=>t.bind(e)(Array.from(a.values())))}))}connectionHealthDidChange(e){var t;0===e.consecutiveMissedPongs&&this.context.reconnectController&&this.context.reconnectController.setLastActiveTimestampMs(Date.now()),this.reconnectionHealthPolicy.update(e);const n=this.reconnectionHealthPolicy.healthIfChanged();null!==n&&(this.logger.info("reconnection health is now: "+n),0===n&&this.context.audioVideoController.handleMeetingSessionStatus(new d.default(u.default.ConnectionHealthReconnect),null)),this.unusableAudioWarningHealthPolicy.update(e);const i=this.unusableAudioWarningHealthPolicy.healthIfChanged();null!==i&&(this.logger.info("unusable audio warning is now: "+i),0===i?(this.context.poorConnectionCount+=1,null===(t=this.context.eventController)||void 0===t||t.pushMeetingState("receivingAudioDropped"),this.context.videoTileController.haveVideoTilesWithStreams()?this.context.audioVideoController.forEachObserver(e=>{l.default.of(e.connectionDidSuggestStopVideo).map(t=>t.bind(e)())}):this.context.audioVideoController.forEachObserver(e=>{l.default.of(e.connectionDidBecomePoor).map(t=>t.bind(e)())})):this.context.audioVideoController.forEachObserver(e=>{l.default.of(e.connectionDidBecomeGood).map(t=>t.bind(e)())}))}handleBitrateFrame(e){const t=this.context.videoSubscriptions||[];let n=0;this.currentAvailableStreamAvgBitrates=e,this.logger.debug(()=>"simulcast: bitrates from server "+JSON.stringify(e));for(const i of e.bitrates)-1!==t.indexOf(i.sourceStreamId)&&(n+=i.avgBitrateBps);n/=1e3,this.currentVideoDownlinkBandwidthEstimationKbps*m.DEFAULT_DOWNLINK_CALLRATE_OVERSHOOT_FACTOR<n&&(this.logger.info(`Downlink bandwidth pressure is high: estimated bandwidth ${this.currentVideoDownlinkBandwidthEstimationKbps}Kbps, required bandwidth ${n}Kbps`),this.context.audioVideoController.forEachObserver(e=>{l.default.of(e.estimatedDownlinkBandwidthLessThanRequired).map(t=>t.bind(e)(this.currentVideoDownlinkBandwidthEstimationKbps,n))}))}handleSignalingClientEvent(e){var t;if(e.type===h.default.WebSocketClosed&&(4410===e.closeCode||e.closeCode>=4500&&e.closeCode<4600)||e.type===h.default.WebSocketError||e.type===h.default.WebSocketFailed?this.hasSignalingError||(null===(t=this.context.eventController)||void 0===t||t.pushMeetingState("signalingDropped"),this.hasSignalingError=!0):e.type===h.default.WebSocketOpen&&(this.hasSignalingError=!1),e.type===h.default.ReceivedSignalFrame){if(e.message.bitrates){const t=e.message.bitrates;this.context.videoStreamIndex.integrateBitratesFrame(t),this.context.videoDownlinkBandwidthPolicy.updateIndex(this.context.videoStreamIndex),this.handleBitrateFrame(e.message.bitrates)}const t=d.default.fromSignalFrame(e.message);t.statusCode()!==u.default.OK&&this.context.audioVideoController.handleMeetingSessionStatus(t,null)}}}t.default=m,m.DEFAULT_TIMEOUT_FOR_START_SENDING_VIDEO_MS=3e4,m.DEFAULT_DOWNLINK_CALLRATE_OVERSHOOT_FACTOR=1.5,m.DEFAULT_DOWNLINK_CALLRATE_UNDERSHOOT_FACTOR=.5},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(45);class r extends i.default{constructor(e,t,n){super(t,n),this.logger=e,this.audioDelayPointsOverMaximum=0,r.CONNECTION_UNHEALTHY_THRESHOLD=t.connectionUnhealthyThreshold,r.CONNECTION_WAIT_TIME_MS=t.connectionWaitTimeMs,r.MISSED_PONGS_THRESHOLD=t.missedPongsUpperThreshold,r.MAXIMUM_AUDIO_DELAY_MS=t.maximumAudioDelayMs,r.MAXIMUM_AUDIO_DELAY_DATA_POINTS=t.maximumAudioDelayDataPoints}health(){if(this.currentData.isConnectionStartRecent(r.CONNECTION_WAIT_TIME_MS))return 1;const e=this.currentData.consecutiveStatsWithNoPackets>=r.CONNECTION_UNHEALTHY_THRESHOLD,t=this.currentData.consecutiveMissedPongs>=r.MISSED_PONGS_THRESHOLD;this.currentData.audioSpeakerDelayMs>r.MAXIMUM_AUDIO_DELAY_MS?this.audioDelayPointsOverMaximum+=1:this.audioDelayPointsOverMaximum=0;const n=this.audioDelayPointsOverMaximum>r.MAXIMUM_AUDIO_DELAY_DATA_POINTS;n&&(this.audioDelayPointsOverMaximum=0);return e||t||n?(this.logger.warn(`reconnection recommended due to: no packets received: ${e}, missed pongs: ${t}, bad audio delay: ${n}`),0):1}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(45);class r extends i.default{constructor(e,t){super(e,t),this.coolDownTimeMs=e.cooldownTimeMs,this.pastSamplesToConsider=e.pastSamplesToConsider,this.fractionalLoss=e.fractionalLoss,this.packetsExpected=e.packetsExpected,this.maximumTimesToWarn=e.maximumTimesToWarn,this.lastWarnTimestampMs=0,this.warnCount=0}calculateFractionalLoss(){if(this.currentData.packetsReceivedInLastMinute.length<this.pastSamplesToConsider)return 0;const e=this.pastSamplesToConsider,t=e*this.packetsExpected;let n=0;for(let t=0;t<e;t++)n+=this.currentData.packetsReceivedInLastMinute[t];return Math.min(Math.max(1-n/t,0),1)}health(){if(Date.now()-this.lastWarnTimestampMs<this.coolDownTimeMs)return this.currentHealth;return this.calculateFractionalLoss()>=this.fractionalLoss?0!==this.currentHealth&&(this.lastWarnTimestampMs=Date.now(),this.warnCount++,this.warnCount>this.maximumTimesToWarn)?1:0:1}}t.default=r},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(135),s=n(6),o=n(4);class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="OpenSignalingConnectionTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return i(this,void 0,void 0,(function*(){const e=this.context.meetingSessionConfiguration;this.context.signalingClient.openConnection(new r.default(e.urls.signalingURL,e.credentials.joinToken));const t=Date.now();try{yield new Promise((e,t)=>{const n=new class{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(new Error("OpenSignalingConnectionTask got canceled while waiting to open signaling connection"))}handleSignalingClientEvent(n){switch(n.type){case s.default.WebSocketOpen:this.signalingClient.removeObserver(this),e();break;case s.default.WebSocketFailed:this.signalingClient.removeObserver(this),t(new Error("WebSocket connection failed"))}}}(this.context.signalingClient);this.context.signalingClient.registerObserver(n),this.taskCanceler=n})}catch(e){throw e}finally{this.context.signalingOpenDurationMs=Math.round(Date.now()-t)}}))}}t.default=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){this.signalingURL=e,this.joinToken=t}url(){return this.signalingURL+"?X-Chime-Control-Protocol-Version=3&X-Amzn-Chime-Send-Close-On-Error=1"}protocols(){return["_aws_wt_session",this.joinToken]}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);class s extends r.default{constructor(e,t,n){super(e),this.taskName=t,this.tasksToRunParallel=n;for(const e of n)e.setParent(this)}cancel(){for(const e of this.tasksToRunParallel)this.logger.info(`canceling parallel group task ${this.name()} subtask ${e.name()}`),e.cancel()}run(){return i(this,void 0,void 0,(function*(){const e=[];for(const t of this.tasksToRunParallel)this.logger.info(`parallel group task ${this.name()} running subtask ${t.name()}`),e.push(t.run());const t=[];for(let n=0;n<e.length;n++){try{yield e[n]}catch(e){t.push(`task ${this.tasksToRunParallel[n].name()} failed: ${e.message}`)}this.logger.info(`parallel group task ${this.name()} completed subtask ${this.tasksToRunParallel[n].name()}`)}if(t.length>0){const e=t.join(", ");this.logAndThrow(`parallel group task ${this.name()} failed for tasks: ${e}`)}this.logger.info(`parallel group task ${this.name()} completed`)}))}}t.default=s},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);class s extends r.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveAudioInputTask"}run(){return i(this,void 0,void 0,(function*(){if(this.context.activeAudioInput)return void this.context.logger.info("an active audio input exists");let e=null;try{e=yield this.context.mediaStreamBroker.acquireAudioInputStream()}catch(e){this.context.logger.warn("could not acquire audio input from current device")}e?(this.context.activeAudioInput=e,this.context.realtimeController.realtimeSetLocalAudioInput(e)):this.context.logger.warn("an audio input is not available")}))}}t.default=s},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),s=n(56),o=n(23),a=n(16),c=n(4);class l extends c.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveTURNCredentialsTask",this.url=e.meetingSessionConfiguration.urls.turnControlURL,this.meetingId=e.meetingSessionConfiguration.meetingId,this.joinToken=e.meetingSessionConfiguration.credentials.joinToken}cancel(){if(this.cancelPromise){const e=new Error("canceling "+this.name());this.cancelPromise(e),delete this.cancelPromise}}run(){return i(this,void 0,void 0,(function*(){if(this.context.turnCredentials)return void this.context.logger.info("TURN credentials available, skipping credentials fetch");if(this.context.logger.error("missing TURN credentials - falling back to fetch"),!this.url)return void this.context.logger.info("TURN control url not supplied, skipping credentials fetch");const e={method:"POST",mode:"cors",cache:"no-cache",credentials:"omit",headers:{"Content-Type":"application/json","X-Chime-Auth-Token":"_aws_wt_session="+new o.default(this.joinToken).base()},redirect:"follow",referrer:"no-referrer",body:JSON.stringify({meetingId:this.meetingId})};this.context.logger.info("requesting TURN credentials from "+this.url);const t=yield new Promise((t,n)=>i(this,void 0,void 0,(function*(){this.cancelPromise=e=>{n(e)};try{const i=yield fetch(a.default.urlWithVersion(this.url),e);if(this.context.logger.info("received TURN credentials"),i.status&&403===i.status)return void n(new Error(`canceling ${this.name()} due to the meeting status code: ${r.default.TURNCredentialsForbidden}`));if(i.status&&404===i.status)return void n(new Error(`canceling ${this.name()} due to the meeting status code: ${r.default.MeetingEnded}`));t(yield i.json())}catch(e){n(e)}finally{delete this.cancelPromise}})));this.context.turnCredentials=new s.default,this.context.turnCredentials.password=t.password,this.context.turnCredentials.ttl=t.ttl,this.context.turnCredentials.uris=t.uris.map(e=>this.context.meetingSessionConfiguration.urls.urlRewriter(e)).filter(e=>!!e),this.context.turnCredentials.username=t.username}))}}t.default=l},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(5),s=n(4);class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoInputTask"}run(){return i(this,void 0,void 0,(function*(){const e=this.context.videoDuplexMode===r.SdkStreamServiceType.RX||this.context.videoDuplexMode===r.SdkStreamServiceType.DUPLEX;if(this.context.videoTileController.hasStartedLocalVideoTile()?this.context.videoDuplexMode=e?r.SdkStreamServiceType.DUPLEX:r.SdkStreamServiceType.TX:this.context.videoDuplexMode=e?r.SdkStreamServiceType.RX:0,this.context.videoCaptureAndEncodeParameter=this.context.videoUplinkBandwidthPolicy.chooseCaptureAndEncodeParameters(),!this.context.videoTileController.hasStartedLocalVideoTile())return this.context.logger.info("has not started local video tile"),void(this.context.activeVideoInput&&this.stopVideoInput());const t=this.context.videoTileController.getLocalVideoTile();let n=null;try{n=yield this.context.mediaStreamBroker.acquireVideoInputStream()}catch(e){this.context.logger.warn("could not acquire video input from current device")}if(this.context.enableSimulcast){const e=this.context.videoUplinkBandwidthPolicy.chooseEncodingParameters();this.context.videoStreamIndex.integrateUplinkPolicyDecision(Array.from(e.values()))}if(this.context.activeVideoInput=n,n){const e=n.getVideoTracks(),i=this.context.meetingSessionConfiguration.credentials.attendeeId,r=e[0].getSettings();if(this.context.enableSimulcast){const t=this.context.videoUplinkBandwidthPolicy.chooseMediaTrackConstraints();this.context.logger.info("simulcast: choose constraint "+JSON.stringify(t));try{yield e[0].applyConstraints(t)}catch(e){this.context.logger.info("simulcast: pass video without more constraint")}}const s=this.context.audioVideoController.configuration.credentials.externalUserId;t.bindVideoStream(i,!0,n,r.width,r.height,null,s);for(let t=0;t<e.length;t++){const n=e[t];this.logger.info(`using video device label=${n.label} id=${n.id}`),this.context.videoDeviceInformation.current_camera_name=n.label,this.context.videoDeviceInformation.current_camera_id=n.id}}}))}stopVideoInput(){this.context.mediaStreamBroker.releaseMediaStream(this.context.activeVideoInput),this.context.activeVideoInput=null}}t.default=o},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),s=n(52),o=n(23),a=n(6),c=n(5),l=n(4);class d extends l.default{constructor(e){super(e.logger),this.context=e,this.taskName="ReceiveVideoStreamIndexTask"}removeObserver(){this.context.signalingClient.removeObserver(this)}run(){return i(this,void 0,void 0,(function*(){this.handleIndexFrame(this.context.indexFrame),this.context.signalingClient.registerObserver(this),this.context.removableObservers.push(this)}))}handleSignalingClientEvent(e){if(e.type!==a.default.ReceivedSignalFrame||e.message.type!==c.SdkSignalFrame.Type.INDEX)return;const t=e.message.index;this.context.logger.info("received new index "+JSON.stringify(t)),this.handleIndexFrame(t)}handleIndexFrame(e){if(!e)return;const t=this.context.audioVideoController.configuration.credentials.attendeeId;e.sources=e.sources.filter(e=>{const n=new o.default(e.attendeeId);return!(n.base()===t&&n.hasModality(o.default.MODALITY_CONTENT))});const{videoStreamIndex:n,videoDownlinkBandwidthPolicy:i,videoUplinkBandwidthPolicy:s}=this.context,a=n.allVideoSendingSourcesExcludingSelf(t);n.integrateIndexFrame(e),i.updateIndex(n),s.updateIndex(n),this.resubscribe(i,s),this.updateVideoAvailability(e),this.handleIndexVideosPausedAtSource();const c=n.allVideoSendingSourcesExcludingSelf(t);this.areVideoSourcesEqual(a,c)||this.context.audioVideoController.forEachObserver(e=>{r.default.of(e.remoteVideoSourcesDidChange).map(t=>t.bind(e)(c))})}areVideoSourcesEqual(e,t){if(e.length!==t.length)return!1;const n=(e,t)=>e.attendee.attendeeId.localeCompare(t.attendee.attendeeId),i=[...e].sort(n),r=[...t].sort(n);for(let e=0;e<i.length;e++)if(i[e].attendee.attendeeId!==r[e].attendee.attendeeId)return!1;return!0}resubscribe(e,t){const n=e.wantsResubscribe(),i=(this.context.videoDuplexMode===c.SdkStreamServiceType.TX||this.context.videoDuplexMode===c.SdkStreamServiceType.DUPLEX)&&t.wantsResubscribe(),r=n||i;this.logger.info(`should resubscribe: ${r} (downlink: ${n} uplink: ${i})`),r&&(this.context.videosToReceive=e.chooseSubscriptions(),this.context.videoCaptureAndEncodeParameter=t.chooseCaptureAndEncodeParameters(),this.logger.info(`trigger resubscribe for up=${i} down=${n}; videosToReceive=[${this.context.videosToReceive.array()}] captureParams=${JSON.stringify(this.context.videoCaptureAndEncodeParameter)}`),this.context.audioVideoController.update())}updateVideoAvailability(e){if(!this.context.videosToReceive)return void this.logger.error("videosToReceive must be set in the meeting context.");const t=new s.default;t.remoteVideoAvailable=!this.context.videosToReceive.empty(),t.canStartLocalVideo=!e.atCapacity,this.context.lastKnownVideoAvailability&&this.context.lastKnownVideoAvailability.equal(t)||(this.context.lastKnownVideoAvailability=t.clone(),this.context.audioVideoController.forEachObserver(e=>{r.default.of(e.videoAvailabilityDidChange).map(n=>n.bind(e)(t.clone()))}))}handleIndexVideosPausedAtSource(){const e=this.context.videoStreamIndex.streamsPausedAtSource();for(const t of this.context.videoTileController.getAllVideoTiles()){const n=t.state();e.contain(n.streamId)?t.markPoorConnection()&&this.logger.info(`marks the tile ${n.tileId} as having a poor connection`):t.unmarkPoorConnection()&&this.logger.info(`unmarks the tile ${n.tileId} as having a poor connection`)}}}t.default=d},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(106),s=n(6),o=n(5),a=n(4);class c extends a.default{constructor(e){super(e.logger),this.context=e,this.taskName="SendAndReceiveDataMessagesTask",this.sendDataMessageHandler=(e,t,n)=>{if(!this.context.signalingClient.ready())throw new Error("Signaling client is not ready");{let i;i=t instanceof Uint8Array?t:"string"==typeof t?(new TextEncoder).encode(t):(new TextEncoder).encode(JSON.stringify(t)),this.validateDataMessage(e,i,n);const r=o.SdkDataMessagePayload.create();r.topic=e,r.lifetimeMs=n,r.data=i;const s=o.SdkDataMessageFrame.create();s.messages=[r],this.context.signalingClient.sendDataMessage(s)}}}run(){return i(this,void 0,void 0,(function*(){this.context.removableObservers.push(this),this.context.signalingClient.registerObserver(this),this.context.realtimeController.realtimeSubscribeToSendDataMessage(this.sendDataMessageHandler)}))}removeObserver(){this.context.realtimeController.realtimeUnsubscribeFromSendDataMessage(this.sendDataMessageHandler),this.context.signalingClient.removeObserver(this)}handleSignalingClientEvent(e){if(e.type===s.default.ReceivedSignalFrame&&e.message.type===o.SdkSignalFrame.Type.DATA_MESSAGE)for(const t of e.message.dataMessage.messages){const e=new r.default(t.ingestTimeNs/1e6,t.topic,t.data,t.senderAttendeeId,t.senderExternalUserId,0===t.ingestTimeNs);this.context.realtimeController.realtimeReceiveDataMessage(e)}}validateDataMessage(e,t,n){if(!c.TOPIC_REGEX.test(e))throw new Error("Invalid topic");if(t.length>c.DATA_SIZE)throw new Error("Data size has to be less than 2048 bytes");if(n&&n<0)throw new Error("The life time of the message has to be non negative")}}t.default=c,c.TOPIC_REGEX=new RegExp(/^[a-zA-Z0-9_-]{1,36}$/),c.DATA_SIZE=2048},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4),s=n(43);class o extends r.default{constructor(e,t,n){super(e),this.taskName=t,this.tasksToRunSerially=n,this.currentTask=null;for(const e of n)e.setParent(this)}cancel(){this.currentTask&&(this.logger.info(`canceling serial group task ${this.name()} subtask ${this.currentTask.name()}`),this.currentTask.cancel())}run(){return i(this,void 0,void 0,(function*(){for(const e of this.tasksToRunSerially){this.getStatus()===s.default.CANCELED&&this.logAndThrow(`serial group task ${this.name()} was canceled`);try{this.logger.info(`serial group task ${this.name()} running subtask ${e.name()}`),this.currentTask=e,yield e.run(),this.logger.info(`serial group task ${this.name()} completed subtask ${e.name()}`)}catch(e){this.logAndThrow(`serial group task ${this.name()} was canceled due to subtask ${this.currentTask.name()} error: ${e.message}`)}finally{this.currentTask=null}}this.logger.info(`serial group task ${this.name()} completed`)}))}}t.default=o},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(4);class s extends r.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetLocalDescriptionTask"}cancel(){if(this.cancelPromise){const e=new Error("canceling "+this.name());this.cancelPromise(e),delete this.cancelPromise}}run(){return i(this,void 0,void 0,(function*(){const e=this.context.peer,t=this.context.sdpOfferInit;this.logger.debug(()=>`local description is >>>${t.sdp}<<<`),yield new Promise((n,r)=>i(this,void 0,void 0,(function*(){this.cancelPromise=e=>{r(e)};try{yield e.setLocalDescription(t),n()}catch(e){r(e)}finally{delete this.cancelPromise}}))),this.context.logger.info("set local description")}))}}t.default=s},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),s=n(24),o=n(4);class a extends o.default{constructor(e){super(e.logger),this.context=e,this.taskName="SetRemoteDescriptionTask"}cancel(){this.cancelICEPromise&&this.cancelICEPromise()}run(){return i(this,void 0,void 0,(function*(){this.context.peer||this.logAndThrow("session does not have peer connection; bypass set remote description");let e=this.context.sdpAnswer;if(e=new s.default(e).withoutServerReflexiveCandidates().sdp,this.context.audioProfile&&(e=new s.default(e).withAudioMaxAverageBitrate(this.context.audioProfile.audioBitrateBps).sdp),!this.context.browserBehavior.requiresUnifiedPlan()&&(this.logger.info("checking for no videos (plan-b)"),this.context.videosToReceive.empty()&&this.context.peer.remoteDescription)){this.logger.info("have no videos and have remote description (plan-b)");const t=this.context.peer.localDescription.sdp,n=e;let i=n;const r=new s.default(t);if(r.hasVideo()){this.logger.info(`offer has video (plan-b): >>>${r.sdp}<<<`);const e=new s.default(n);this.logger.info(`existing answer (plan-b): >>>${e.sdp}<<<`),e.hasVideo()||(this.logger.info(`copying inactive video from offer into answer (plan-b); sdp answer before is >>>${n}<<<`),i=e.copyVideo(t).sdp)}e=i}(new r.default).requiresSortCodecPreferencesForSdpAnswer()&&(e=new s.default(e).preferH264IfExists().sdp),this.logger.info(`processed remote description is >>>${e}<<<`);const t={type:"answer",sdp:e,toJSON:null};try{yield this.createICEConnectionCompletedPromise(t)}catch(e){throw e}}))}createICEConnectionCompletedPromise(e){return new Promise((t,n)=>i(this,void 0,void 0,(function*(){const i=()=>{"connected"!==this.context.peer.iceConnectionState&&"completed"!==this.context.peer.iceConnectionState||(this.context.peer.removeEventListener("iceconnectionstatechange",i),t())};this.cancelICEPromise=()=>{this.context.peer&&this.context.peer.removeEventListener("iceconnectionstatechange",i),n(new Error(this.name()+" got canceled while waiting for the ICE connection state"))},this.context.peer.addEventListener("iceconnectionstatechange",i);try{yield this.context.peer.setRemoteDescription(e),this.logger.info("set remote description, waiting for ICE connection"),i()}catch(e){n(e)}})))}}t.default=a},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(24),s=n(6),o=n(146),a=n(5),c=n(4);class l extends c.default{constructor(e){super(e.logger),this.context=e,this.taskName="SubscribeAndReceiveSubscribeAckTask",this.taskCanceler=null}cancel(){this.taskCanceler&&(this.taskCanceler.cancel(),this.taskCanceler=null)}run(){return i(this,void 0,void 0,(function*(){let e="";if(this.context.peer&&this.context.peer.localDescription&&(e=this.context.browserBehavior.requiresUnifiedPlanMunging()?new r.default(this.context.peer.localDescription.sdp).withUnifiedPlanFormat().sdp:this.context.peer.localDescription.sdp),!this.context.enableSimulcast){let e=0,t=0;this.context.videoCaptureAndEncodeParameter&&(e=this.context.videoCaptureAndEncodeParameter.captureFrameRate(),t=this.context.videoCaptureAndEncodeParameter.encodeBitrates()[0]);const n={rid:"hi",maxBitrate:1e3*t,maxFramerate:e,active:!0};this.context.videoStreamIndex.integrateUplinkPolicyDecision([n])}this.context.videoStreamIndex.subscribeFrameSent();const t=this.context.videoDuplexMode===a.SdkStreamServiceType.TX||this.context.videoDuplexMode===a.SdkStreamServiceType.DUPLEX;this.context.previousSdpOffer=new r.default(e);const n=new o.default(this.context.meetingSessionConfiguration.credentials.attendeeId,e,this.context.meetingSessionConfiguration.urls.audioHostURL,this.context.realtimeController.realtimeIsLocalAudioMuted(),!1,this.context.videoSubscriptions,t,this.context.videoStreamIndex.localStreamDescriptions(),!0);this.context.logger.info("sending subscribe: "+JSON.stringify(n)),this.context.signalingClient.subscribe(n);const i=yield this.receiveSubscribeAck();this.context.logger.info("got subscribe ack: "+JSON.stringify(i)),this.context.sdpAnswer=i.sdpAnswer,this.context.videoStreamIndex.integrateSubscribeAckFrame(i)}))}receiveSubscribeAck(){return new Promise((e,t)=>{const n=new class{constructor(e){this.signalingClient=e}cancel(){this.signalingClient.removeObserver(this),t(new Error("SubscribeAndReceiveSubscribeAckTask got canceled while waiting for SdkSubscribeAckFrame"))}handleSignalingClientEvent(t){if(t.type!==s.default.ReceivedSignalFrame||t.message.type!==a.SdkSignalFrame.Type.SUBSCRIBE_ACK)return;this.signalingClient.removeObserver(this);const n=t.message.suback;e(n)}}(this.context.signalingClient);this.context.signalingClient.registerObserver(n),this.taskCanceler=n})}}t.default=l},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,i,r,s,o,a,c){this.attendeeId=e,this.sdpOffer=t,this.audioHost=n,this.audioMuted=i,this.audioCheckin=r,this.receiveStreamIds=s,this.localVideoEnabled=o,this.videoStreamDescriptions=a,this.connectionTypeHasVideo=c}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(12),s=n(4);class o extends s.default{constructor(e){super(e.logger),this.context=e,this.taskName="WaitForAttendeePresenceTask"}cancel(){if(this.cancelPromise){const e=new Error(`canceling ${this.name()} due to the meeting status code: ${r.default.NoAttendeePresent}`);this.cancelPromise(e),delete this.cancelPromise}}run(){return i(this,void 0,void 0,(function*(){const e=this.context.meetingSessionConfiguration.credentials.attendeeId;return new Promise((t,n)=>{const i=(n,r,s,o,a)=>{e===n&&r&&(this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(i),t(),delete this.cancelPromise)};this.cancelPromise=e=>{this.context.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(i),n(e)},this.context.realtimeController.realtimeSubscribeToAttendeeIdPresence(i)})}))}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(22),r=n(33),s=n(18);class o{constructor(){this.bandwidthEstimateKbps=0,this.usedBandwidthKbps=0,this.packetsLost=0,this.nackCount=0,this.rttMs=0}}class a{constructor(e,t){this.logger=e,this.tileController=t,this.reset()}reset(){this.optimalReceiveSet=new s.default,this.subscribedReceiveSet=new s.default,this.logCount=0,this.startupPeriod=!0,this.usingPrevTargetRate=!1,this.rateProbeState="Not Probing",this.timeFirstEstimate=0,this.lastUpgradeRateKbps=0,this.timeBeforeAllowSubscribeMs=a.MIN_TIME_BETWEEN_SUBSCRIBE,this.timeLastProbe=Date.now(),this.timeBeforeAllowProbeMs=a.MIN_TIME_BETWEEN_PROBE,this.downlinkStats=new o,this.prevDownlinkStats=new o}updateIndex(e){this.videoIndex=e}updateMetrics(e){if(this.videoIndex.allStreams().empty())return;this.prevDownlinkStats=this.downlinkStats,this.downlinkStats=new o;const t=e.getObservableMetrics();this.downlinkStats.bandwidthEstimateKbps=t.availableReceiveBandwidth/1e3;for(const t in e.streamMetricReports){const n=Number(t);e.streamMetricReports[n].direction===i.default.DOWNSTREAM&&(e.streamMetricReports[n].currentMetrics.hasOwnProperty("googNacksSent")&&e.streamMetricReports[n].currentMetrics.hasOwnProperty("googFrameRateReceived")&&(this.downlinkStats.nackCount+=e.countPerSecond("googNacksSent",n)),e.streamMetricReports[n].currentMetrics.hasOwnProperty("packetsLost")&&e.streamMetricReports[n].currentMetrics.hasOwnProperty("googFrameRateReceived")&&(this.downlinkStats.packetsLost+=e.countPerSecond("packetsLost",n)),e.streamMetricReports[n].currentMetrics.hasOwnProperty("bytesReceived")&&(this.downlinkStats.usedBandwidthKbps+=e.bitsPerSecond("bytesReceived",n)/1e3))}}wantsResubscribe(){return this.optimalReceiveSet=this.calculateOptimalReceiveSet(),!this.subscribedReceiveSet.equal(this.optimalReceiveSet)}chooseSubscriptions(){return this.subscribedReceiveSet.equal(this.optimalReceiveSet)||(this.timeLastSubscribe=Date.now()),this.subscribedReceiveSet=this.optimalReceiveSet.clone(),this.logger.info("bwe: chooseSubscriptions "+JSON.stringify(this.subscribedReceiveSet)),this.subscribedReceiveSet.clone()}calculateOptimalReceiveSet(){const e=new s.default,t=this.rateProbeState,n=this.videoIndex.remoteStreamDescriptions();if(0===n.length)return e;const i=new s.default;this.handlePausedStreams(e,i,n);const o=this.availStreamsSameAsLast(n);if(!this.startupPeriod&&o&&Date.now()-this.timeLastSubscribe<this.timeBeforeAllowSubscribeMs)return this.optimalReceiveSet;this.timeBeforeAllowSubscribeMs=a.MIN_TIME_BETWEEN_SUBSCRIBE;const c=[];n.sort((e,t)=>e.maxBitrateKbps===t.maxBitrateKbps?e.streamId-t.streamId:e.maxBitrateKbps-t.maxBitrateKbps);for(const e of n)(0===e.avgBitrateKbps||e.avgBitrateKbps>e.maxBitrateKbps)&&(e.attendeeId.endsWith(r.default.Modality)&&e.maxBitrateKbps<100?e.maxBitrateKbps=e.avgBitrateKbps:e.avgBitrateKbps=e.maxBitrateKbps);const l=this.determineTargetRate(n);let d,u=0,h=0;h+=this.chooseContent(c,n);for(const e of n)0!==e.avgBitrateKbps&&-1===c.findIndex(t=>t.groupId===e.groupId)&&(h+e.avgBitrateKbps<=l?(c.push(e),h+=e.avgBitrateKbps):0===u&&(u=e.avgBitrateKbps,d=e));let p=!0;for(;p;)p=!1,c.forEach((e,t)=>{for(const i of n)if(i.groupId===e.groupId&&i.streamId!==e.streamId&&i.avgBitrateKbps>e.avgBitrateKbps){const n=i.avgBitrateKbps-e.avgBitrateKbps;h+n<=l?(h+=n,c[t]=i,p=!0):0===u&&(u=n,d=i)}});let f=0;!this.startupPeriod&&o&&0!==u?f="Probing"===this.rateProbeState?this.handleProbe(c,i,l,n):this.maybeOverrideOrProbe(c,i,l,h,u,d):(this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0);let g=this.policyStateLogStr(n,l);if(this.logCount%15!=0&&this.rateProbeState===t||(this.logger.info(g),this.logCount=0,g=""),this.logCount++,this.prevTargetRateKbps=l,this.prevRemoteInfos=n,1===f)return this.logger.info("bwe: keepSameSubscriptions"),g.length>0&&this.logger.info(g),this.optimalReceiveSet;if(2===f){const e=this.calculateSubscribeRate(n,this.preProbeReceiveSet);return this.logger.info("bwe: Use Pre-Probe subscription subscribedRate:"+e),this.preProbeReceiveSet}for(const t of c)e.add(t.streamId);if(!this.optimalReceiveSet.equal(e)){g.length>0&&this.logger.info(g);const t=this.calculateSubscribeRate(n,e);this.logger.info(`bwe: new streamSelection: ${JSON.stringify(e)} subscribedRate:${t}`)}return e}determineTargetRate(e){let t=0,n=Number.MAX_VALUE;for(const t of e)0!==t.avgBitrateKbps&&t.avgBitrateKbps<n&&(n=t.avgBitrateKbps);const i=Date.now();return 0!==this.downlinkStats.bandwidthEstimateKbps?(0===this.timeFirstEstimate&&(this.timeFirstEstimate=i),this.startupPeriod&&(this.downlinkStats.bandwidthEstimateKbps>a.DEFAULT_BANDWIDTH_KBPS||this.downlinkStats.packetsLost>0||i-this.timeFirstEstimate>a.STARTUP_PERIOD_MS&&this.downlinkStats.bandwidthEstimateKbps<=this.prevDownlinkStats.bandwidthEstimateKbps)&&(this.startupPeriod=!1,this.prevTargetRateKbps=this.downlinkStats.bandwidthEstimateKbps),t=this.startupPeriod?a.DEFAULT_BANDWIDTH_KBPS:this.downlinkStats.bandwidthEstimateKbps):t=0===this.timeFirstEstimate?a.DEFAULT_BANDWIDTH_KBPS:this.prevTargetRateKbps,t=Math.max(n,t),!this.startupPeriod&&(this.usingPrevTargetRate&&this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps||this.downlinkStats.bandwidthEstimateKbps<this.prevTargetRateKbps*(100-a.LARGE_RATE_CHANGE_TRIGGER_PERCENT)/100||this.downlinkStats.bandwidthEstimateKbps<this.downlinkStats.usedBandwidthKbps*a.LARGE_RATE_CHANGE_TRIGGER_PERCENT/100)&&0===this.downlinkStats.packetsLost?(this.logger.debug(()=>"bwe: ValidateRate: Using Previous rate "+this.prevTargetRateKbps),this.usingPrevTargetRate=!0,t=this.prevTargetRateKbps):this.usingPrevTargetRate=!1,t}setProbeState(e){if(this.rateProbeState===e)return;const t=Date.now();switch(e){case"Not Probing":this.timeProbePendingStart=0;break;case"Probe Pending":if(!(0===this.timeLastProbe||t-this.timeLastProbe>a.MIN_TIME_BETWEEN_PROBE))return!1;this.timeProbePendingStart=t;break;case"Probing":if(!(t-this.timeProbePendingStart>this.timeBeforeAllowProbeMs))return!1;this.timeLastProbe=t,this.preProbeReceiveSet=this.subscribedReceiveSet,this.timeBeforeAllowProbeMs=Math.min(2*this.timeBeforeAllowProbeMs,a.MAX_HOLD_MS_BEFORE_PROBE)}return this.logger.info("bwe: setProbeState to "+e+" from "+this.rateProbeState),this.rateProbeState=e,!0}upgradeToStream(e,t){for(let n=0;n<e.length;n++)if(e[n].groupId===t.groupId){const i=t.avgBitrateKbps-e[n].avgBitrateKbps;return this.logger.info("bwe: upgradeStream from "+JSON.stringify(e[n])+" to "+JSON.stringify(t)),this.lastUpgradeRateKbps=i,e[n]=t,i}return e.push(t),this.lastUpgradeRateKbps=t.avgBitrateKbps,this.lastUpgradeRateKbps}handleProbe(e,t,n,i){if("Probing"!==this.rateProbeState)return 0;if(Date.now()-this.timeLastProbe>a.MAX_ALLOWED_PROBE_TIME_MS)return this.logger.info("bwe: Canceling probe due to timeout"),this.setProbeState("Not Probing"),0;if(this.downlinkStats.packetsLost>0)return this.setProbeState("Not Probing"),this.timeBeforeAllowSubscribeMs=3*a.MIN_TIME_BETWEEN_SUBSCRIBE,2;const r=this.calculateSubscribeRate(i,this.optimalReceiveSet);if(this.chosenStreamsSameAsLast(e,t)||n>r){let t=0;for(const n of e)t+=n.avgBitrateKbps;if(n>t)return this.setProbeState("Not Probing"),this.timeBeforeAllowProbeMs=a.MIN_TIME_BETWEEN_PROBE,0}return 1}maybeOverrideOrProbe(e,t,n,i,r,s){const o=this.chosenStreamsSameAsLast(e,t);let c=0;const l=Date.now(),d=i*(i>a.LOW_BITRATE_THRESHOLD_KBPS?a.TARGET_RATE_CHANGE_TRIGGER_PERCENT:2*a.TARGET_RATE_CHANGE_TRIGGER_PERCENT)/100;if(!o&&Math.abs(i-this.prevTargetRateKbps)<d&&(this.logger.info("bwe: MaybeOverrideOrProbe: Reuse last decision based on delta rate. {"+JSON.stringify(this.subscribedReceiveSet)+"}"),c=1),this.downlinkStats.packetsLost>this.prevDownlinkStats.packetsLost)return this.setProbeState("Not Probing"),this.lastUpgradeRateKbps=0,c;if(o||c)switch(this.rateProbeState){case"Not Probing":this.setProbeState("Probe Pending");break;case"Probe Pending":l-this.timeProbePendingStart>this.timeBeforeAllowProbeMs&&this.setProbeState("Probing")&&(this.timeBeforeAllowSubscribeMs=800,this.upgradeToStream(e,s),c=0);break;default:this.logger.info("bwe: MaybeOverrideOrProbe: Unhandled condition "+this.rateProbeState)}else this.setProbeState("Not Probing"),i+d>n+r&&(this.logger.info("bwe: MaybeOverrideOrProbe: Upgrade since we are within threshold"),this.upgradeToStream(e,s));return c}calculateSubscribeRate(e,t){let n=0;for(const i of t.array()){const t=e.find(e=>e.streamId===i);void 0!==t&&(n+=t.maxBitrateKbps)}return n}handlePausedStreams(e,t,n){const i=this.tileController.getAllRemoteVideoTiles();for(let r=0;r<i.length;r++){const s=i[r].state();if(s.paused){let i=n.length;for(;i--;)n[i].attendeeId===s.boundAttendeeId&&(this.logger.info("bwe: removed paused attendee "+s.boundAttendeeId+" streamId: "+n[i].streamId),t.add(n[i].streamId),this.subscribedReceiveSet.contain(n[i].streamId)&&e.add(n[i].streamId),n.splice(i,1))}}}chooseContent(e,t){let n=0;for(const i of t)i.attendeeId.endsWith(r.default.Modality)&&(e.push(i),n+=i.avgBitrateKbps);return n}availStreamsSameAsLast(e){if(void 0===this.prevRemoteInfos||e.length!==this.prevRemoteInfos.length)return!1;for(const t of e){if(void 0===this.prevRemoteInfos.find(e=>e.groupId===t.groupId&&e.streamId===t.streamId&&e.maxBitrateKbps===t.maxBitrateKbps))return!1}return!0}chosenStreamsSameAsLast(e,t){const n=this.optimalReceiveSet.array();for(const i of n)if(!t.contain(i)&&-1===e.findIndex(e=>e.streamId===i))return!1;return!0}policyStateLogStr(e,t){const n={targetBitrate:t,subscribedRate:this.calculateSubscribeRate(e,this.optimalReceiveSet),probeState:this.rateProbeState,startupPeriod:this.startupPeriod};let i="remoteInfos: [";for(const t of e)i+=`{grpId:${t.groupId} strId:${t.streamId} maxBr:${t.maxBitrateKbps} avgBr:${t.avgBitrateKbps}}, `;i+="]";return`bwe: optimalReceiveSet ${JSON.stringify(n)}\nbwe:   prev ${JSON.stringify(this.prevDownlinkStats)}\nbwe:   now  ${JSON.stringify(this.downlinkStats)}\nbwe:   `+i}}t.default=a,a.DEFAULT_BANDWIDTH_KBPS=2800,a.STARTUP_PERIOD_MS=6e3,a.LARGE_RATE_CHANGE_TRIGGER_PERCENT=20,a.TARGET_RATE_CHANGE_TRIGGER_PERCENT=15,a.LOW_BITRATE_THRESHOLD_KBPS=300,a.MIN_TIME_BETWEEN_PROBE=5e3,a.MIN_TIME_BETWEEN_SUBSCRIBE=2e3,a.MAX_HOLD_MS_BEFORE_PROBE=6e4,a.MAX_ALLOWED_PROBE_TIME_MS=6e4},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(5),r=n(60),s=n(61);class o extends r.default{constructor(e){super(e),this.streamIdToBitrateKbpsMap=new Map,this._localStreamInfos=[],this._lastBitRateMsgTime=Date.now()}localStreamDescriptions(){const e=[];return this._localStreamInfos.forEach(t=>{e.push(t.clone())}),e}integrateUplinkPolicyDecision(e){let t=!0,n=0;for(let i=0;i<e.length;i++){const r=e[i].maxBitrate/1e3,o=e[i].maxFramerate;if(t&&i!==this._localStreamInfos.length)0===this._localStreamInfos[n].maxBitrateKbps&&r>0&&(this._localStreamInfos[n].timeEnabled=Date.now()),this._localStreamInfos[n].maxBitrateKbps=r,this._localStreamInfos[n].maxFrameRate=o,this._localStreamInfos[n].disabledByUplinkPolicy=0===r,!0===this._localStreamInfos[n].disabledByUplinkPolicy&&(this._localStreamInfos[n].disabledByWebRTC=!1),n++;else{t=!1;const e=new s.default;e.maxBitrateKbps=r,e.maxFrameRate=o,e.disabledByUplinkPolicy=0===r,0!==r&&(e.timeEnabled=Date.now()),this._localStreamInfos.push(e),n++}}t&&this._localStreamInfos.splice(n)}integrateBitratesFrame(e){super.integrateBitratesFrame(e);const t=new Set,n=new Set(this.streamIdToBitrateKbpsMap.keys());for(const n of e.bitrates)t.add(n.sourceStreamId),this.streamIdToBitrateKbpsMap.set(n.sourceStreamId,Math.trunc(n.avgBitrateBps/1e3));for(const e of n)if(!t.has(e)){this.streamIdToBitrateKbpsMap.get(e)===o.UNSEEN_STREAM_BITRATE?this.streamIdToBitrateKbpsMap.set(e,o.RECENTLY_INACTIVE_STREAM_BITRATE):this.streamIdToBitrateKbpsMap.set(e,o.NOT_SENDING_STREAM_BITRATE)}for(let e=0;e<this._localStreamInfos.length;e++){this._localStreamInfos[e].disabledByWebRTC=!1;const t=this._localStreamInfos[e].streamId;if(!this._localStreamInfos[e].disabledByUplinkPolicy)if(this.streamIdToBitrateKbpsMap.has(t)){this.streamIdToBitrateKbpsMap.get(t)===o.NOT_SENDING_STREAM_BITRATE&&this._lastBitRateMsgTime-this._localStreamInfos[e].timeEnabled>o.BitratesMsgFrequencyMs&&(this._localStreamInfos[e].disabledByWebRTC=!0)}else this._lastBitRateMsgTime-this._localStreamInfos[e].timeEnabled>o.BitratesMsgFrequencyMs&&(this._localStreamInfos[e].disabledByWebRTC=!0)}this._lastBitRateMsgTime=Date.now(),this.logLocalStreamDescriptions()}logLocalStreamDescriptions(){let e="";for(const t of this._localStreamInfos)e+=`streamId=${t.streamId} maxBitrate=${t.maxBitrateKbps} disabledByWebRTC=${t.disabledByWebRTC} disabledByUplink=${t.disabledByUplinkPolicy}\n`;this.logger.debug(()=>e)}integrateIndexFrame(e){super.integrateIndexFrame(e);const t=new Set,n=new Set(this.streamIdToBitrateKbpsMap.keys());for(const e of this.currentIndex.sources)e.mediaType===i.SdkStreamMediaType.VIDEO&&(t.add(e.streamId),this.streamIdToBitrateKbpsMap.has(e.streamId)||this.streamIdToBitrateKbpsMap.set(e.streamId,o.UNSEEN_STREAM_BITRATE));for(const e of n)t.has(e)||this.streamIdToBitrateKbpsMap.delete(e)}integrateSubscribeAckFrame(e){if(super.integrateSubscribeAckFrame(e),!e.allocations||void 0===e.allocations)return;let t=0;for(const n of e.allocations){if(this._localStreamInfos.length<t+1){this.logger.info("simulcast: allocation has more than number of local streams");break}this._localStreamInfos[t].groupId=n.groupId,this._localStreamInfos[t].streamId=n.streamId,this.streamIdToBitrateKbpsMap.has(n.streamId)||this.streamIdToBitrateKbpsMap.set(n.streamId,o.UNSEEN_STREAM_BITRATE),t++}}}t.default=o,o.UNSEEN_STREAM_BITRATE=-2,o.RECENTLY_INACTIVE_STREAM_BITRATE=-1,o.NOT_SENDING_STREAM_BITRATE=0,o.BitratesMsgFrequencyMs=4e3},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(151),s=n(152),o=n(8);t.default=class{constructor(e,t,n){this.tileFactory=e,this.audioVideoController=t,this.logger=n,this.tileMap=new Map,this.nextTileId=1,this.currentLocalTile=null,this.currentPausedTilesByIds=new Set}createDevicePixelRatioMonitorIfNeeded(){this.devicePixelRatioMonitor||(this.devicePixelRatioMonitor=new r.default(new s.default,this.logger))}discardDevicePixelRatioMonitorIfNotNeeded(){return i(this,void 0,void 0,(function*(){if(this.tileMap.size||!this.devicePixelRatioMonitor)return;const e=this.devicePixelRatioMonitor;return this.devicePixelRatioMonitor=void 0,e.destroy()}))}bindVideoElement(e,t){const n=this.getVideoTile(e);null!==n?n.bindVideoElement(t):this.logger.warn("Ignoring video element binding for unknown tile id "+e)}unbindVideoElement(e){this.bindVideoElement(e,null)}startLocalVideoTile(){const e=this.findOrCreateLocalVideoTile();return this.currentLocalTile.stateRef().localTileStarted=!0,this.audioVideoController.update(),e.id()}stopLocalVideoTile(){this.currentLocalTile&&(this.currentLocalTile.stateRef().localTileStarted=!1,this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId),this.audioVideoController.update())}hasStartedLocalVideoTile(){return!(!this.currentLocalTile||!this.currentLocalTile.stateRef().localTileStarted)}removeLocalVideoTile(){this.currentLocalTile&&this.removeVideoTile(this.currentLocalTile.id())}getLocalVideoTile(){return this.currentLocalTile}pauseVideoTile(e){const t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)||(this.audioVideoController.pauseReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.add(e)),t.pause())}unpauseVideoTile(e){const t=this.getVideoTile(e);t&&(this.currentPausedTilesByIds.has(e)&&(this.audioVideoController.resumeReceivingStream(t.stateRef().streamId),this.currentPausedTilesByIds.delete(e)),t.unpause())}getVideoTile(e){return this.tileMap.has(e)?this.tileMap.get(e):null}getVideoTileArea(e){const t=e.state();let n=0,i=0;return t.boundVideoElement&&(n=t.boundVideoElement.clientHeight*t.devicePixelRatio,i=t.boundVideoElement.clientWidth*t.devicePixelRatio),n*i}getAllRemoteVideoTiles(){const e=new Array;return this.tileMap.forEach((t,n)=>{this.currentLocalTile&&n===this.currentLocalTile.id()||e.push(t)}),e}getAllVideoTiles(){return Array.from(this.tileMap.values())}addVideoTile(e=!1){const t=this.nextTileId;this.nextTileId+=1,this.createDevicePixelRatioMonitorIfNeeded();const n=this.tileFactory.makeTile(t,e,this,this.devicePixelRatioMonitor);return this.tileMap.set(t,n),n}removeVideoTile(e){if(!this.tileMap.has(e))return;const t=this.tileMap.get(e);this.currentLocalTile===t&&(this.currentLocalTile=null),t.destroy(),this.tileMap.delete(e),this.audioVideoController.forEachObserver(t=>{o.default.of(t.videoTileWasRemoved).map(n=>n.bind(t)(e))}),this.discardDevicePixelRatioMonitorIfNotNeeded()}removeVideoTilesByAttendeeId(e){const t=[];for(const n of this.getAllVideoTiles()){const i=n.state();i.boundAttendeeId===e&&(this.removeVideoTile(i.tileId),t.push(i.tileId))}return t}removeAllVideoTiles(){const e=Array.from(this.tileMap.keys());for(const t of e)this.removeVideoTile(t)}sendTileStateUpdate(e){this.audioVideoController.forEachObserver(t=>{o.default.of(t.videoTileDidUpdate).map(n=>n.bind(t)(e))})}haveVideoTilesWithStreams(){for(const e of this.getAllVideoTiles())if(e.state().boundVideoStream)return!0;return!1}haveVideoTileForAttendeeId(e){for(const t of this.getAllVideoTiles()){if(t.state().boundAttendeeId===e)return!0}return!1}captureVideoTile(e){const t=this.getVideoTile(e);return t?t.capture():null}findOrCreateLocalVideoTile(){return this.currentLocalTile||(this.currentLocalTile=this.addVideoTile(!0),this.currentLocalTile.bindVideoStream(this.audioVideoController.configuration.credentials.attendeeId,!0,null,null,null,null,this.audioVideoController.configuration.credentials.externalUserId)),this.currentLocalTile}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t){if(this.devicePixelRatioSource=e,this.observerQueue=new Set,this.mediaQueryListener=()=>{this.observerQueue.forEach(e=>{e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())})},"undefined"==typeof window)return;const n=matchMedia(`(resolution: ${this.devicePixelRatioSource.devicePixelRatio()}dppx)`);"function"==typeof n.addEventListener?(n.addEventListener("change",this.mediaQueryListener),this.mediaQueryList=n):"function"==typeof n.addListener?(n.addListener(this.mediaQueryListener),this.mediaQueryList=n):t.warn("ignoring DefaultDevicePixelRatioMonitor")}destroy(){return i(this,void 0,void 0,(function*(){this.mediaQueryList&&("function"==typeof this.mediaQueryList.addEventListener?this.mediaQueryList.removeEventListener("change",this.mediaQueryListener):this.mediaQueryList.removeListener(this.mediaQueryListener)),delete this.mediaQueryListener,this.observerQueue.clear()}))}registerObserver(e){this.observerQueue.add(e),e.devicePixelRatioChanged(this.devicePixelRatioSource.devicePixelRatio())}removeObserver(e){this.observerQueue.delete(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{devicePixelRatio(){return"undefined"!=typeof window&&window&&window.devicePixelRatio?window.devicePixelRatio:1}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(47);t.default=class{makeTile(e,t,n,r){return new i.default(e,t,n,r)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(8),r=n(11),s=n(155),o=n(59),a=n(25),c=n(74);class l{constructor(e,t){this.selfAttendeeId=e,this.logger=t,this.numSenders=0,this.numParticipants=-1,this.newQualityMap=new Map,this.currentQualityMap=new Map,this.newActiveStreams=1,this.currentActiveStreams=1,this.lastUplinkBandwidthKbps=l.defaultUplinkBandwidthKbps,this.startTimeMs=0,this.lastUpdatedMs=Date.now(),this.videoIndex=null,this.currLocalDescriptions=[],this.nextLocalDescriptions=[],this.observerQueue=new Set,this.optimalParameters=new a.default(0,0,0,0,!0),this.parametersInEffect=new a.default(0,0,0,0,!0),this.lastUplinkBandwidthKbps=l.defaultUplinkBandwidthKbps,this.currentQualityMap=this.fillEncodingParamWithBitrates([300,0,1200]),this.newQualityMap=this.fillEncodingParamWithBitrates([300,0,1200])}updateConnectionMetric({uplinkKbps:e=0}){if(isNaN(e))return;0===this.startTimeMs&&(this.startTimeMs=Date.now()),Date.now()-this.startTimeMs<l.startupDurationMs?this.lastUplinkBandwidthKbps=l.defaultUplinkBandwidthKbps:this.lastUplinkBandwidthKbps=e,this.logger.debug(()=>"simulcast: uplink policy update metrics "+this.lastUplinkBandwidthKbps);let t=l.holdDownDurationMs;3===this.currentActiveStreams?t=2*l.holdDownDurationMs:(2===this.currentActiveStreams&&e<=l.kMidDisabledRate||1===this.currentActiveStreams&&e<=l.kHiDisabledRate)&&(t=l.holdDownDurationMs/2),Date.now()<this.lastUpdatedMs+t||(this.newQualityMap=this.calculateEncodingParameters(!1))}calculateEncodingParameters(e){const t=[new c.default,new c.default,new c.default];let n=0,i=0;if(0===this.currentActiveStreams?(n=this.lastUplinkBandwidthKbps+1,i=0):1===this.currentActiveStreams?(n=2400,i=l.kHiDisabledRate):2===this.currentActiveStreams?(n=1e3,i=l.kMidDisabledRate):(n=300,i=0),e||this.lastUplinkBandwidthKbps>=n||this.lastUplinkBandwidthKbps<=i){this.numParticipants>=0&&this.numParticipants<=2?(this.newActiveStreams=0,t[0].maxBitrateKbps=0,t[1].maxBitrateKbps=0,t[2].maxBitrateKbps=1200):this.numSenders<=4&&this.lastUplinkBandwidthKbps>=l.kHiDisabledRate?(this.newActiveStreams=1,t[0].maxBitrateKbps=300,t[1].maxBitrateKbps=0,t[2].maxBitrateKbps=1200):this.lastUplinkBandwidthKbps>=l.kMidDisabledRate?(this.newActiveStreams=2,t[0].maxBitrateKbps=this.lastUplinkBandwidthKbps>=350?200:150,t[1].maxBitrateKbps=this.numSenders<=6?600:350,t[2].maxBitrateKbps=0):(this.newActiveStreams=3,t[0].maxBitrateKbps=300,t[1].maxBitrateKbps=0,t[2].maxBitrateKbps=0);const e=t.map((e,t,n)=>e.maxBitrateKbps);this.newQualityMap=this.fillEncodingParamWithBitrates(e),this.encodingParametersEqual()||this.logger.info(`simulcast: policy:calculateEncodingParameters bw:${this.lastUplinkBandwidthKbps} numSources:${this.numSenders} numClients:${this.numParticipants} newQualityMap: ${this.getQualityMapString(this.newQualityMap)}`)}return this.newQualityMap}chooseMediaTrackConstraints(){return{width:{ideal:1280},height:{ideal:768},frameRate:{ideal:15}}}chooseEncodingParameters(){return this.currentQualityMap=this.newQualityMap,this.currentActiveStreams=this.newActiveStreams,this.activeStreamsToPublish!==this.newActiveStreams&&(this.activeStreamsToPublish=this.newActiveStreams,this.publishEncodingSimulcastLayer()),this.currentQualityMap}updateIndex(e){const t=e.numberOfVideoPublishingParticipantsExcludingSelf(this.selfAttendeeId)+1,n=e.numberOfParticipants(),i=t!==this.numSenders,r=n>2&&this.numParticipants<=2||n<=2&&this.numParticipants>2;this.numSenders=t,this.numParticipants=n,this.optimalParameters=new a.default(this.captureWidth(),this.captureHeight(),this.captureFrameRate(),this.maxBandwidthKbps(),!1),this.videoIndex=e,this.newQualityMap=this.calculateEncodingParameters(i||r)}wantsResubscribe(){let e=!this.encodingParametersEqual();this.nextLocalDescriptions=this.videoIndex.localStreamDescriptions();for(let t=0;t<this.nextLocalDescriptions.length;t++){const n=this.nextLocalDescriptions[t].streamId;if(0!==n&&n){const i=this.currLocalDescriptions.findIndex(e=>e.streamId===n);-1!==i&&this.nextLocalDescriptions[t].disabledByWebRTC!==this.currLocalDescriptions[i].disabledByWebRTC&&(e=!0)}}return e&&(this.lastUpdatedMs=Date.now()),this.currLocalDescriptions=this.nextLocalDescriptions,e}compareEncodingParameter(e,t){return JSON.stringify(e)===JSON.stringify(t)}encodingParametersEqual(){let e=!1;for(const t of o.default.NAME_ARR_ASCENDING)if(e=e||!this.compareEncodingParameter(this.newQualityMap.get(t),this.currentQualityMap.get(t)),e)break;return!e}chooseCaptureAndEncodeParameters(){return this.parametersInEffect=this.optimalParameters.clone(),this.parametersInEffect.clone()}captureWidth(){return 1280}captureHeight(){return 768}captureFrameRate(){return 15}maxBandwidthKbps(){return 1400}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}fillEncodingParamWithBitrates(e){const t=new Map,n=o.default.NAME_ARR_ASCENDING,i=e;let r=4;for(let e=0;e<n.length;e++){const s=n[e];t.set(s,{rid:s,active:i[e]>0,scaleResolutionDownBy:r,maxBitrate:1e3*i[e]}),r/=2}return t}getQualityMapString(e){let t="";const n=this.videoIndex.localStreamDescriptions();return 3===n.length&&e.forEach(e=>{let i=!1;i="low"===e.rid?n[0].disabledByWebRTC:"mid"===e.rid?n[1].disabledByWebRTC:n[2].disabledByWebRTC,t+=`{ rid: ${e.rid} active:${e.active} disabledByWebRTC: ${i} maxBitrate:${e.maxBitrate}}`}),t}getEncodingSimulcastLayer(e){switch(e){case 0:return s.default.High;case 1:return s.default.LowAndHigh;case 2:return s.default.LowAndMedium;case 3:return s.default.Low}}publishEncodingSimulcastLayer(){const e=this.getEncodingSimulcastLayer(this.activeStreamsToPublish);this.forEachObserver(t=>{i.default.of(t.encodingSimulcastLayersDidChange).map(n=>n.bind(t)(e))})}addObserver(e){this.logger.info("adding simulcast uplink observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing simulcast uplink observer"),this.observerQueue.delete(e)}forEachObserver(e){for(const t of this.observerQueue)r.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}}t.default=l,l.defaultUplinkBandwidthKbps=1200,l.startupDurationMs=6e3,l.holdDownDurationMs=4e3,l.defaultMaxFrameRate=15,l.kHiDisabledRate=700,l.kMidDisabledRate=240},function(e,t,n){"use strict";var i;Object.defineProperty(t,"__esModule",{value:!0}),t.SimulcastLayers=void 0,function(e){e[e.Low=0]="Low",e[e.LowAndMedium=1]="LowAndMedium",e[e.LowAndHigh=2]="LowAndHigh",e[e.Medium=3]="Medium",e[e.MediumAndHigh=4]="MediumAndHigh",e[e.High=5]="High"}(i=t.SimulcastLayers||(t.SimulcastLayers={})),t.default=i},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});class i{constructor(e,t,n,i){this.logger=e,this.realtimeController=t,this.minVolumeDecibels=n,this.maxVolumeDecibels=i,this.streamIdToAttendeeId={},this.streamIdToExternalUserId={},this.warnedAboutMissingStreamIdMapping={},this.attendeeIdToStreamId={},this.sessionReconnected=!1}onReconnect(){this.sessionReconnected=!0}sendRealtimeUpdatesForAudioStreamIdInfo(e){let t=0;for(const n of e.streams){const i=!!n.attendeeId,r=!!n.externalUserId,s=n.hasOwnProperty("muted"),o=!!n.dropped;if(i){this.attendeeIdToStreamId[n.attendeeId]&&this.attendeeIdToStreamId[n.attendeeId]<n.audioStreamId&&delete this.attendeeIdToStreamId[n.attendeeId],this.streamIdToAttendeeId[n.audioStreamId]=n.attendeeId;const i=r?n.externalUserId:n.attendeeId;this.streamIdToExternalUserId[n.audioStreamId]=i,this.attendeeIdToStreamId[n.attendeeId]=n.audioStreamId,this.realtimeController.realtimeSetAttendeeIdPresence(n.attendeeId,!0,i,!1,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}if(s){const e=this.streamIdToAttendeeId[n.audioStreamId],t=this.streamIdToExternalUserId[n.audioStreamId];this.realtimeController.realtimeUpdateVolumeIndicator(e,null,n.muted,null,t)}if(!i&&!s){const i=this.streamIdToAttendeeId[n.audioStreamId];if(i){const r=this.streamIdToExternalUserId[n.audioStreamId];delete this.streamIdToAttendeeId[n.audioStreamId],delete this.streamIdToExternalUserId[n.audioStreamId],delete this.warnedAboutMissingStreamIdMapping[n.audioStreamId],this.attendeeIdToStreamId[i]===n.audioStreamId&&delete this.attendeeIdToStreamId[i];let s=!1;for(const e of Object.keys(this.streamIdToAttendeeId)){const t=parseInt(e);if(t>n.audioStreamId&&this.streamIdToAttendeeId[t]===i){s=!0;break}}s||this.realtimeController.realtimeSetAttendeeIdPresence(i,!1,r,o,{attendeeIndex:t++,attendeesInFrame:e.streams.length})}}}this.sessionReconnected&&(this.cleanUpState(e),this.sessionReconnected=!1)}cleanUpState(e){const t=Object.values(this.streamIdToAttendeeId),n=e.streams.map(e=>e.attendeeId),i=t.filter(e=>!n.includes(e));for(const[e,t]of i.entries()){const n=this.attendeeIdToStreamId[t],i=this.streamIdToExternalUserId[n];delete this.streamIdToAttendeeId[n],delete this.streamIdToExternalUserId[n],delete this.warnedAboutMissingStreamIdMapping[n],delete this.attendeeIdToStreamId[t],this.realtimeController.realtimeSetAttendeeIdPresence(t,!1,i,!1,{attendeeIndex:e,attendeesInFrame:t.length})}}sendRealtimeUpdatesForAudioMetadata(e){let t=null,n=null;for(const i of e.attendeeStates){const e=this.attendeeIdForStreamId(i.audioStreamId);i.hasOwnProperty("volume")&&(null===t&&(t={}),null!==e&&(t[e]=this.normalizedVolume(i))),i.hasOwnProperty("signalStrength")&&(null===n&&(n={}),null!==e&&(n[e]=this.normalizedSignalStrength(i)))}this.applyRealtimeUpdatesForAudioMetadata(t,n)}normalizedVolume(e){const t=1-(-e.volume-this.maxVolumeDecibels)/(this.minVolumeDecibels-this.maxVolumeDecibels);return Math.min(Math.max(t,0),1)}normalizedSignalStrength(e){const t=e.signalStrength/i.MAX_SIGNAL_STRENGTH_LEVELS;return Math.min(Math.max(t,0),1)}applyRealtimeUpdatesForAudioMetadata(e,t){for(const n in this.streamIdToAttendeeId){const r=this.streamIdToAttendeeId[n],s=this.streamIdToExternalUserId[n];let o=null,a=null;null!==e&&(o=e.hasOwnProperty(r)?e[r]:i.IMPLICIT_VOLUME),null!==t&&(a=t.hasOwnProperty(r)?t[r]:i.IMPLICIT_SIGNAL_STRENGTH),null===o&&null===a||this.realtimeController.realtimeUpdateVolumeIndicator(r,o,null,a,s)}}attendeeIdForStreamId(e){if(0===e)return null;const t=this.streamIdToAttendeeId[e];return t||(this.warnedAboutMissingStreamIdMapping[e]||(this.warnedAboutMissingStreamIdMapping[e]=!0,this.logger.warn(`volume indicator stream id ${e} seen before being defined`)),null)}}t.default=i,i.MAX_SIGNAL_STRENGTH_LEVELS=2,i.IMPLICIT_VOLUME=0,i.IMPLICIT_SIGNAL_STRENGTH=1},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(49);t.default=class{constructor(e,t,n,i,r,s){this.audioVideoController=e,this.videoTileController=t,this.realtimeController=n,this.audioMixController=i,this.deviceController=r,this.contentShareController=s}addObserver(e){this.audioVideoController.addObserver(e),this.trace("addObserver")}removeObserver(e){this.audioVideoController.removeObserver(e),this.trace("removeObserver")}setAudioProfile(e){this.trace("setAudioProfile",e),this.audioVideoController.setAudioProfile(e)}start(){this.audioVideoController.start(),this.trace("start")}stop(){this.audioVideoController.stop(),this.trace("stop")}getRTCPeerConnectionStats(e){return this.trace("getRTCPeerConnectionStats",e?e.id:null),this.audioVideoController.getRTCPeerConnectionStats(e)}bindAudioElement(e){const t=this.audioMixController.bindAudioElement(e);return this.trace("bindAudioElement",e.id,t),t}unbindAudioElement(){this.audioMixController.unbindAudioElement(),this.trace("unbindAudioElement")}bindVideoElement(e,t){this.videoTileController.bindVideoElement(e,t),this.trace("bindVideoElement",{tileId:e,videoElementId:t.id})}unbindVideoElement(e){this.videoTileController.unbindVideoElement(e),this.trace("unbindVideoElement",e)}startLocalVideoTile(){const e=this.videoTileController.startLocalVideoTile();return this.trace("startLocalVideoTile",null,e),e}stopLocalVideoTile(){this.videoTileController.stopLocalVideoTile(),this.trace("stopLocalVideoTile")}hasStartedLocalVideoTile(){const e=this.videoTileController.hasStartedLocalVideoTile();return this.trace("hasStartedLocalVideoTile",null,e),e}removeLocalVideoTile(){this.videoTileController.removeLocalVideoTile(),this.trace("removeLocalVideoTile")}getLocalVideoTile(){const e=this.videoTileController.getLocalVideoTile();return this.trace("getLocalVideoTile"),e}pauseVideoTile(e){this.videoTileController.pauseVideoTile(e),this.trace("pauseVideoTile",e)}unpauseVideoTile(e){this.videoTileController.unpauseVideoTile(e),this.trace("unpauseVideoTile",e)}getVideoTile(e){const t=this.videoTileController.getVideoTile(e);return this.trace("getVideoTile",e),t}getAllRemoteVideoTiles(){const e=this.videoTileController.getAllRemoteVideoTiles();return this.trace("getAllRemoteVideoTiles"),e}getAllVideoTiles(){const e=this.videoTileController.getAllVideoTiles();return this.trace("getAllVideoTiles"),e}addVideoTile(){const e=this.videoTileController.addVideoTile();return this.trace("addVideoTile",null,e.state()),e}removeVideoTile(e){this.videoTileController.removeVideoTile(e),this.trace("removeVideoTile",e)}removeVideoTilesByAttendeeId(e){const t=this.videoTileController.removeVideoTilesByAttendeeId(e);return this.trace("removeVideoTilesByAttendeeId",e,t),t}removeAllVideoTiles(){this.videoTileController.removeAllVideoTiles(),this.trace("removeAllVideoTiles")}captureVideoTile(e){const t=this.videoTileController.captureVideoTile(e);return this.trace("captureVideoTile",e),t}realtimeSubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeSubscribeToAttendeeIdPresence(e),this.trace("realtimeSubscribeToAttendeeIdPresence")}realtimeUnsubscribeToAttendeeIdPresence(e){this.realtimeController.realtimeUnsubscribeToAttendeeIdPresence(e),this.trace("realtimeUnsubscribeToAttendeeIdPresence")}realtimeSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSetCanUnmuteLocalAudio(e),this.trace("realtimeSetCanUnmuteLocalAudio",e)}realtimeSubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToSetCanUnmuteLocalAudio(e),this.trace("realtimeSubscribeToSetCanUnmuteLocalAudio")}realtimeUnsubscribeToSetCanUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToSetCanUnmuteLocalAudio(e)}realtimeCanUnmuteLocalAudio(){const e=this.realtimeController.realtimeCanUnmuteLocalAudio();return this.trace("realtimeCanUnmuteLocalAudio",null,e),e}realtimeMuteLocalAudio(){this.realtimeController.realtimeMuteLocalAudio(),this.trace("realtimeMuteLocalAudio")}realtimeUnmuteLocalAudio(){const e=this.realtimeController.realtimeUnmuteLocalAudio();return this.trace("realtimeUnmuteLocalAudio"),e}realtimeSubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeSubscribeToMuteAndUnmuteLocalAudio(e),this.trace("realtimeSubscribeToMuteAndUnmuteLocalAudio")}realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e){this.realtimeController.realtimeUnsubscribeToMuteAndUnmuteLocalAudio(e)}realtimeIsLocalAudioMuted(){const e=this.realtimeController.realtimeIsLocalAudioMuted();return this.trace("realtimeIsLocalAudioMuted"),e}realtimeSubscribeToVolumeIndicator(e,t){this.realtimeController.realtimeSubscribeToVolumeIndicator(e,t),this.trace("realtimeSubscribeToVolumeIndicator",e)}realtimeUnsubscribeFromVolumeIndicator(e,t){this.realtimeController.realtimeUnsubscribeFromVolumeIndicator(e,t),this.trace("realtimeUnsubscribeFromVolumeIndicator",e,t)}realtimeSubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeSubscribeToLocalSignalStrengthChange(e),this.trace("realtimeSubscribeToLocalSignalStrengthChange")}realtimeUnsubscribeToLocalSignalStrengthChange(e){this.realtimeController.realtimeUnsubscribeToLocalSignalStrengthChange(e),this.trace("realtimeUnsubscribeToLocalSignalStrengthChange")}realtimeSendDataMessage(e,t,n){this.realtimeController.realtimeSendDataMessage(e,t,n),this.trace("realtimeSendDataMessage")}realtimeSubscribeToReceiveDataMessage(e,t){this.realtimeController.realtimeSubscribeToReceiveDataMessage(e,t),this.trace("realtimeSubscribeToReceiveDataMessage")}realtimeUnsubscribeFromReceiveDataMessage(e){this.realtimeController.realtimeUnsubscribeFromReceiveDataMessage(e),this.trace("realtimeUnsubscribeFromReceiveDataMessage")}realtimeSubscribeToFatalError(e){this.realtimeController.realtimeSubscribeToFatalError(e)}realtimeUnsubscribeToFatalError(e){this.realtimeController.realtimeUnsubscribeToFatalError(e)}subscribeToActiveSpeakerDetector(e,t,n,i){this.audioVideoController.activeSpeakerDetector.subscribe(e,t,n,i),this.trace("subscribeToActiveSpeakerDetector")}unsubscribeFromActiveSpeakerDetector(e){this.audioVideoController.activeSpeakerDetector.unsubscribe(e),this.trace("unsubscribeFromActiveSpeakerDetector")}listAudioInputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.deviceController.listAudioInputDevices();return this.trace("listAudioInputDevices",null,e),e}))}listVideoInputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.deviceController.listVideoInputDevices();return this.trace("listVideoInputDevices",null,e),e}))}listAudioOutputDevices(){return i(this,void 0,void 0,(function*(){const e=yield this.deviceController.listAudioOutputDevices();return this.trace("listAudioOutputDevices",null,e),e}))}chooseAudioInputDevice(e){return this.trace("chooseAudioInputDevice",e),this.deviceController.chooseAudioInputDevice(e)}chooseVideoInputDevice(e){return r.isVideoTransformDevice(e)?this.trace("chooseVideoInputDevice with transform device"):this.trace("chooseVideoInputDevice",e),this.deviceController.chooseVideoInputDevice(e)}chooseAudioOutputDevice(e){const t=this.deviceController.chooseAudioOutputDevice(e);return this.trace("chooseAudioOutputDevice",e),t}addDeviceChangeObserver(e){this.deviceController.addDeviceChangeObserver(e),this.trace("addDeviceChangeObserver")}removeDeviceChangeObserver(e){this.deviceController.removeDeviceChangeObserver(e),this.trace("removeDeviceChangeObserver")}createAnalyserNodeForAudioInput(){const e=this.deviceController.createAnalyserNodeForAudioInput();return this.trace("createAnalyserNodeForAudioInput"),e}startVideoPreviewForVideoInput(e){this.deviceController.startVideoPreviewForVideoInput(e),this.trace("startVideoPreviewForVideoInput",e.id)}stopVideoPreviewForVideoInput(e){this.deviceController.stopVideoPreviewForVideoInput(e),this.trace("stopVideoPreviewForVideoInput",e.id)}setDeviceLabelTrigger(e){this.deviceController.setDeviceLabelTrigger(e),this.trace("setDeviceLabelTrigger")}mixIntoAudioInput(e){const t=this.deviceController.mixIntoAudioInput(e);return this.trace("mixIntoAudioInput",e.id),t}chooseVideoInputQuality(e,t,n,i){this.deviceController.chooseVideoInputQuality(e,t,n,i),this.trace("chooseVideoInputQuality",{width:e,height:t,frameRate:n,maxBandwidthKbps:i})}getVideoInputQualitySettings(){const e=this.deviceController.getVideoInputQualitySettings();return this.trace("getVideoInputQualitySettings"),e}setContentAudioProfile(e){this.trace("setContentAudioProfile",e),this.contentShareController.setContentAudioProfile(e)}startContentShare(e){const t=this.contentShareController.startContentShare(e);return this.trace("startContentShare"),t}startContentShareFromScreenCapture(e,t){const n=this.contentShareController.startContentShareFromScreenCapture(e,t);return this.trace("startContentShareFromScreenCapture"),n}pauseContentShare(){this.contentShareController.pauseContentShare(),this.trace("pauseContentShare")}unpauseContentShare(){this.contentShareController.unpauseContentShare(),this.trace("unpauseContentShare")}stopContentShare(){this.contentShareController.stopContentShare(),this.trace("stopContentShare")}addContentShareObserver(e){this.contentShareController.addContentShareObserver(e),this.trace("addContentShareObserver")}removeContentShareObserver(e){this.contentShareController.removeContentShareObserver(e),this.trace("removeContentShareObserver")}trace(e,t,n){let i=`API/DefaultAudioVideoFacade/${this.audioVideoController.configuration.meetingId}/${this.audioVideoController.configuration.credentials.attendeeId}/${e}`;void 0!==t&&(i+=" "+JSON.stringify(t)),void 0!==n&&(i+=" -> "+JSON.stringify(n)),this.audioVideoController.logger.info(i)}getRemoteVideoSources(){const e=this.audioVideoController.getRemoteVideoSources();return this.trace("getRemoteVideoSources",null,e),e}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(8),s=n(63),o=n(36),a=n(23),c=n(11),l=n(33);t.default=class{constructor(e,t,n){this.mediaStreamBroker=e,this.contentAudioVideo=t,this.attendeeAudioVideo=n,this.observerQueue=new Set,this.destroyed=!1,this.contentAudioVideo.addObserver(this),this.setupContentShareEvents()}static createContentShareMeetingSessionConfigure(e){const t=new s.default;return t.meetingId=e.meetingId,t.externalMeetingId=e.externalMeetingId,t.urls=e.urls,t.credentials=new o.default,t.credentials.attendeeId=e.credentials.attendeeId+l.default.Modality,t.credentials.externalUserId=e.credentials.externalUserId,t.credentials.joinToken=e.credentials.joinToken+l.default.Modality,t}setContentAudioProfile(e){this.contentAudioVideo.setAudioProfile(e)}startContentShare(e){return i(this,void 0,void 0,(function*(){if(e){this.mediaStreamBroker.mediaStream=e;for(let e=0;e<this.mediaStreamBroker.mediaStream.getTracks().length;e++)this.mediaStreamBroker.mediaStream.getTracks()[e].addEventListener("ended",()=>{this.stopContentShare()});this.contentAudioVideo.start(),this.mediaStreamBroker.mediaStream.getVideoTracks().length>0&&this.contentAudioVideo.videoTileController.startLocalVideoTile()}}))}startContentShareFromScreenCapture(e,t){return i(this,void 0,void 0,(function*(){const n=yield this.mediaStreamBroker.acquireScreenCaptureDisplayInputStream(e,t);return yield this.startContentShare(n),n}))}pauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!1)&&this.forEachContentShareObserver(e=>{r.default.of(e.contentShareDidPause).map(t=>t.call(e))})}unpauseContentShare(){this.mediaStreamBroker.toggleMediaStream(!0)&&this.forEachContentShareObserver(e=>{r.default.of(e.contentShareDidUnpause).map(t=>t.call(e))})}destroy(){return i(this,void 0,void 0,(function*(){this.contentAudioVideo&&(this.destroyed=!0,this.contentAudioVideo.removeObserver(this),this.stopContentShare(),this.observerQueue.clear(),this.contentAudioVideo=void 0,this.attendeeAudioVideo=void 0,this.mediaStreamBroker=void 0)}))}stopContentShare(){this.contentAudioVideo.stop(),this.mediaStreamBroker.cleanup()}addContentShareObserver(e){this.observerQueue.add(e)}removeContentShareObserver(e){this.observerQueue.delete(e)}forEachContentShareObserver(e){for(const t of this.observerQueue)c.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}audioVideoDidStop(e){this.mediaStreamBroker.cleanup(),this.contentShareTile&&(this.attendeeAudioVideo.videoTileController.removeVideoTile(this.contentShareTile.id()),this.contentShareTile=null),this.forEachContentShareObserver(e=>{r.default.of(e.contentShareDidStop).map(t=>t.call(e))})}setupContentShareEvents(){this.attendeeAudioVideo.realtimeController.realtimeSubscribeToAttendeeIdPresence((e,t,n,i)=>{const s=new a.default(e).hasModality(a.default.MODALITY_CONTENT),o=new a.default(e).base()===this.attendeeAudioVideo.configuration.credentials.attendeeId;if(!s||!o||!t||this.contentShareTile)return;const c=this.mediaStreamBroker.mediaStream;if(c.getVideoTracks().length>0){this.contentShareTile=this.attendeeAudioVideo.videoTileController.addVideoTile();const e=c.getVideoTracks()[0];let t,n;if(e.getSettings){const i=e.getSettings();t=i.width,n=i.height}else{const i=e.getCapabilities();t=i.width,n=i.height}this.contentShareTile.bindVideoStream(this.contentAudioVideo.configuration.credentials.attendeeId,!1,c,t,n,null,this.contentAudioVideo.configuration.credentials.externalUserId)}this.forEachContentShareObserver(e=>{r.default.of(e.contentShareDidStart).map(t=>t.call(e))})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.timeoutMs=1e4,this.waitDurationMs=3e3}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isDestroyable=void 0,t.isDestroyable=function(e){return e&&"destroy"in e}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n){this.type=e,this.headers=t,this.payload=n}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(16);t.default=class{constructor(e,t){this.chimeClient=e,this.awsClient=t}makeTwoDigits(e){return e>9?e.toString():"0"+e.toString()}getDateTimeString(){const e=new Date;return e.getUTCFullYear()+this.makeTwoDigits(e.getUTCMonth()+1)+this.makeTwoDigits(e.getUTCDate())+"T"+this.makeTwoDigits(e.getUTCHours())+this.makeTwoDigits(e.getUTCMinutes())+this.makeTwoDigits(e.getUTCSeconds())+"Z"}getDateString(e){return e.substring(0,e.indexOf("T"))}getSignatureKey(e,t,n,i){const r=this.awsClient.util.crypto.hmac("AWS4"+e,t,"buffer"),s=this.awsClient.util.crypto.hmac(r,n,"buffer"),o=this.awsClient.util.crypto.hmac(s,i,"buffer");return this.awsClient.util.crypto.hmac(o,"aws4_request","buffer")}signURL(e,t,n,r,s,o,a){const c=this.getDateTimeString(),l=this.getDateString(c),d=this.chimeClient.config.region,u="host:"+r.toLowerCase()+"\n",h=l+"/"+d+"/"+n+"/aws4_request",p=this.chimeClient.config.credentials;let f=new Map;f.set("X-Amz-Algorithm",["AWS4-HMAC-SHA256"]),f.set("X-Amz-Credential",[encodeURIComponent(p.accessKeyId+"/"+h)]),f.set("X-Amz-Date",[c]),f.set("X-Amz-Expires",["10"]),f.set("X-Amz-SignedHeaders",["host"]),p.sessionToken&&f.set("X-Amz-Security-Token",[encodeURIComponent(p.sessionToken)]),f.set(i.default.X_AMZN_VERSION,[encodeURIComponent(i.default.sdkVersion)]),f.set(i.default.X_AMZN_USER_AGENT,[encodeURIComponent(i.default.sdkUserAgentLowResolution)]),null==a||a.forEach((e,t)=>{const n=encodeURIComponent(t);e.sort().forEach(e=>{f.has(n)||f.set(n,[]),f.get(n).push(encodeURIComponent(e))})});let g="";f=new Map([...f.entries()].sort()),f.forEach((e,t)=>{e.forEach(e=>{g.length&&(g+="&"),g+=t+"="+e})});const m=e+"\n"+s+"\n"+g+"\n"+u+"\nhost\n"+this.awsClient.util.crypto.sha256(o,"hex"),v="AWS4-HMAC-SHA256\n"+c+"\n"+l+"/"+d+"/"+n+"/aws4_request\n"+this.awsClient.util.crypto.sha256(m,"hex"),b=this.getSignatureKey(p.secretAccessKey,l,d,n),S=this.awsClient.util.crypto.hmac(b,v,"hex");return t+"://"+r+s+"?"+(g+"&X-Amz-Signature="+S)}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(75);t.default=class{constructor(e,t){this.logger=e,this.stages=t,this.fr=15,this.outputMediaStream=new MediaStream,this.videoInput=document.createElement("video"),this.canvasOutput=document.createElement("canvas"),this.outputCtx=this.canvasOutput.getContext("2d"),this.canvasInput=document.createElement("canvas"),this.inputCtx=this.canvasInput.getContext("2d"),this.inputVideoStream=null,this.sourceBuffers=[],this.destBuffers=[],this.observers=new Set,this.hasStarted=!1,this.process=e=>i(this,void 0,void 0,(function*(){if(!this.inputVideoStream)return;const e=performance.now();this.videoInput.videoWidth&&(this.canvasInput.width!==this.videoInput.videoWidth&&(this.canvasInput.width=this.videoInput.videoWidth,this.canvasInput.height=this.videoInput.videoHeight,this.sourceBuffers[0].height=this.canvasInput.height,this.sourceBuffers[0].width=this.canvasInput.width,this.sourceBuffers[0].framerate=this.framerate),this.inputCtx.drawImage(this.videoInput,0,0));let t,n=[];n.push(this.sourceBuffers[0]);try{for(const e of this.processors)n=yield e.process(n)}catch(e){return void this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()})}this.destBuffers=n;try{t=yield this.destBuffers[0].asCanvasImageSource()}catch(e){return void(this.inputVideoStream&&(this.logger.info("buffers are destroyed and pipeline could not start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()})))}const i=t.width,r=t.height;0!==i&&0!==r&&(this.canvasOutput.width!==i&&this.canvasOutput.height!==r&&(this.canvasOutput.width=i,this.canvasOutput.height=r),this.outputCtx.drawImage(t,0,0,i,r,0,0,i,r),this.hasStarted||(this.hasStarted=!0,this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})));const s=performance.now()-e,o=2e3/this.framerate-s,a=Math.max(0,1e3/this.framerate-s);o<=0&&this.forEachObserver(e=>{e.processingLatencyTooHigh&&e.processingLatencyTooHigh(s)}),this.lastTimeOut=setTimeout(this.process,a)}))}destroy(){if(this.stop(),this.stages)for(const e of this.stages)e.destroy()}get framerate(){return this.fr}set framerate(e){this.fr=e<0?15:e}stop(){if(this.videoInput.removeEventListener("loadedmetadata",this.process),this.videoInput.srcObject=null,this.destroyInputMediaStreamAndBuffers(),this.outputMediaStream)for(const e of this.outputMediaStream.getVideoTracks())e.stop();this.lastTimeOut&&(clearTimeout(this.lastTimeOut),this.lastTimeOut=void 0),this.hasStarted&&(this.hasStarted=!1,this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()}))}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}getInputMediaStream(){return i(this,void 0,void 0,(function*(){return this.inputVideoStream}))}getActiveOutputMediaStream(){return this.outputMediaStream&&this.outputMediaStream.active?this.outputMediaStream:this.outputMediaStream=this.canvasOutput.captureStream(this.framerate)}setInputMediaStream(e){return i(this,void 0,void 0,(function*(){if(!e)return void this.stop();if(0===e.getVideoTracks().length)return void this.logger.error("No video tracks in input media stream, ignoring");this.inputVideoStream=e;const t=this.inputVideoStream.getVideoTracks()[0].getSettings();this.logger.info("processing pipeline input stream settings "+t),this.canvasOutput.width=t.width,this.canvasOutput.height=t.height,this.videoInput.addEventListener("loadedmetadata",this.process),this.videoInput.srcObject=this.inputVideoStream,this.videoInput.setAttribute("playsinline","true");const n=new r.default(this.canvasInput);this.sourceBuffers.push(n),this.videoInput.load(),yield this.videoInput.play()}))}set processors(e){this.stages=e}get processors(){return this.stages}forEachObserver(e){for(const t of this.observers)setTimeout(()=>{e(t)},0)}destroyInputMediaStreamAndBuffers(){if(this.inputVideoStream)for(const e of this.inputVideoStream.getTracks())e.stop();this.inputVideoStream=null;for(const e of this.sourceBuffers)e.destroy();this.sourceBuffers=[]}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(21);class r extends i.default{constructor(e,t,n,i){super(e,t,n),this.limit=i,this.attempts=0}nextBackoffAmountMs(){if(this.attempts++,this.attempts>this.limit)throw new Error("retry limit exceeded");return super.nextBackoffAmountMs()}}t.default=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,i){this.sequenceNumber=e,this.message=t,this.timestampMs=n,this.logLevel=i}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19),r=n(167);class s extends r.default{constructor(){super(i.default.DEBUG)}}t.default=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);t.default=class{constructor(e=i.default.OFF){this.level=e}info(e){}warn(e){}error(e){}debug(e){i.default.DEBUG<this.level||"string"!=typeof e&&e()}setLogLevel(e){this.level=e}getLogLevel(){return this.level}}},function(e,t,n){"use strict";function i(e,t,n){if(!n)return fetch(e,t);const i=s(e,n),o=r(t,n);return fetch(i,o)}function r(e,t){return(null==t?void 0:t.headers)?e?Object.assign(Object.assign({},e),{headers:Object.assign(Object.assign({},e.headers||{}),t.headers)}):{headers:t.headers}:e}function s(e,t){if(!(null==t?void 0:t.escapedQueryString))return e;const n=-1!==e.lastIndexOf("?");return`${e}${n?"&":"?"}${t.escapedQueryString}`}Object.defineProperty(t,"__esModule",{value:!0}),t.isValidRevisionID=t.isValidAssetGroup=t.resolveURL=t.addQueryParams=t.withQueryString=t.withRequestHeaders=t.fetchWithBehavior=void 0,t.fetchWithBehavior=i,t.withRequestHeaders=r,t.withQueryString=s,t.addQueryParams=function(e,t){const n=Object.keys(t);if(!n.length)return e;const i=new URLSearchParams(null==e?void 0:e.escapedQueryString);for(const e of n)i.append(e,t[e]);return Object.assign(Object.assign({},e),{escapedQueryString:i.toString()})};const o={method:"HEAD",mode:"cors",credentials:"omit",redirect:"follow",referrerPolicy:"origin"};t.resolveURL=function(e,t){return i(e,o,t).then(t=>t.redirected?t.url:e)},t.isValidAssetGroup=function(e){return!!e&&/^[-.a-zA-Z0-9]+$/.test(e)},t.isValidRevisionID=function(e){return!!e&&/^[123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ]{22}$/.test(e)}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7);class s{constructor(e,t,n,i,s=!1,o,a=new r.default){this.device=e,this.voiceFocus=t,this.delegate=n,this.nodeOptions=i,this.failed=s,this.node=o,this.browserBehavior=a}getInnerDevice(){return this.device}mute(e){return i(this,void 0,void 0,(function*(){this.node&&(e?yield this.node.disable():yield this.node.enable())}))}stop(){return i(this,void 0,void 0,(function*(){this.node&&(this.node.disconnect(),yield this.node.stop())}))}chooseNewInnerDevice(e){return i(this,void 0,void 0,(function*(){return this.device!==e||function(e){if("default"===e)return!0;if(!e||"object"!=typeof e)return!1;if("deviceId"in e&&"default"===e.deviceId)return!0;if("id"in e&&"default"===e.id)return!0;return!1}(e)?new s(e,this.voiceFocus,this.delegate,this.nodeOptions,this.failed,this.node,this.browserBehavior):this}))}intrinsicDevice(){return i(this,void 0,void 0,(function*(){if(this.failed)return this.device;const e={echoCancellation:!0,googEchoCancellation:!0,googEchoCancellation2:!0,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googNoiseSuppression2:!1};let t;return t=!this.nodeOptions||void 0===this.nodeOptions.agc||this.nodeOptions.agc.useBuiltInAGC,e.autoGainControl=t,e.googAutoGainControl=t,e.googAutoGainControl2=t,this.device?"string"==typeof this.device?(this.browserBehavior.requiresNoExactMediaStreamConstraints()?e.deviceId=this.device:e.deviceId={exact:this.device},e):this.device.id?this.device:Object.assign(Object.assign({},this.device),e):e}))}createAudioNode(e){var t,n;return i(this,void 0,void 0,(function*(){if((null===(t=this.node)||void 0===t?void 0:t.context)===e)return{start:this.node,end:this.node};const i=Object.assign({enabled:!0,agc:{useVoiceFocusAGC:!1}},this.nodeOptions);try{null===(n=this.node)||void 0===n||n.disconnect(),this.node=yield this.voiceFocus.createNode(e,i);const t=this.node;return{start:t,end:this.node}}catch(e){throw this.failed=!0,this.delegate.onFallback(this,e),e}}))}addObserver(e){this.delegate.addObserver(e)}removeObserver(e){this.delegate.removeObserver(e)}}t.default=s},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),i=0;i<n.length;i++)n[i]=arguments[i];return e.apply(t,n)}}},function(e,t,n){"use strict";var i=n(9);function r(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(i.isURLSearchParams(t))s=t.toString();else{var o=[];i.forEach(t,(function(e,t){null!=e&&(i.isArray(e)?t+="[]":e=[e],i.forEach(e,(function(e){i.isDate(e)?e=e.toISOString():i.isObject(e)&&(e=JSON.stringify(e)),o.push(r(t)+"="+r(e))})))})),s=o.join("&")}if(s){var a=e.indexOf("#");-1!==a&&(e=e.slice(0,a)),e+=(-1===e.indexOf("?")?"?":"&")+s}return e}},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";(function(t){var i=n(9),r=n(249),s={"Content-Type":"application/x-www-form-urlencoded"};function o(e,t){!i.isUndefined(e)&&i.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a,c={adapter:(("undefined"!=typeof XMLHttpRequest||void 0!==t&&"[object process]"===Object.prototype.toString.call(t))&&(a=n(174)),a),transformRequest:[function(e,t){return r(t,"Accept"),r(t,"Content-Type"),i.isFormData(e)||i.isArrayBuffer(e)||i.isBuffer(e)||i.isStream(e)||i.isFile(e)||i.isBlob(e)?e:i.isArrayBufferView(e)?e.buffer:i.isURLSearchParams(e)?(o(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):i.isObject(e)?(o(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300}};c.headers={common:{Accept:"application/json, text/plain, */*"}},i.forEach(["delete","get","head"],(function(e){c.headers[e]={}})),i.forEach(["post","put","patch"],(function(e){c.headers[e]=i.merge(s)})),e.exports=c}).call(this,n(20))},function(e,t,n){"use strict";var i=n(9),r=n(250),s=n(252),o=n(171),a=n(253),c=n(256),l=n(257),d=n(175);e.exports=function(e){return new Promise((function(t,n){var u=e.data,h=e.headers;i.isFormData(u)&&delete h["Content-Type"];var p=new XMLHttpRequest;if(e.auth){var f=e.auth.username||"",g=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";h.Authorization="Basic "+btoa(f+":"+g)}var m=a(e.baseURL,e.url);if(p.open(e.method.toUpperCase(),o(m,e.params,e.paramsSerializer),!0),p.timeout=e.timeout,p.onreadystatechange=function(){if(p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))){var i="getAllResponseHeaders"in p?c(p.getAllResponseHeaders()):null,s={data:e.responseType&&"text"!==e.responseType?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:i,config:e,request:p};r(t,n,s),p=null}},p.onabort=function(){p&&(n(d("Request aborted",e,"ECONNABORTED",p)),p=null)},p.onerror=function(){n(d("Network Error",e,null,p)),p=null},p.ontimeout=function(){var t="timeout of "+e.timeout+"ms exceeded";e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(d(t,e,"ECONNABORTED",p)),p=null},i.isStandardBrowserEnv()){var v=(e.withCredentials||l(m))&&e.xsrfCookieName?s.read(e.xsrfCookieName):void 0;v&&(h[e.xsrfHeaderName]=v)}if("setRequestHeader"in p&&i.forEach(h,(function(e,t){void 0===u&&"content-type"===t.toLowerCase()?delete h[t]:p.setRequestHeader(t,e)})),i.isUndefined(e.withCredentials)||(p.withCredentials=!!e.withCredentials),e.responseType)try{p.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&p.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&p.upload&&p.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){p&&(p.abort(),n(e),p=null)})),u||(u=null),p.send(u)}))}},function(e,t,n){"use strict";var i=n(251);e.exports=function(e,t,n,r,s){var o=new Error(e);return i(o,t,n,r,s)}},function(e,t,n){"use strict";var i=n(9);e.exports=function(e,t){t=t||{};var n={},r=["url","method","data"],s=["headers","auth","proxy","params"],o=["baseURL","transformRequest","transformResponse","paramsSerializer","timeout","timeoutMessage","withCredentials","adapter","responseType","xsrfCookieName","xsrfHeaderName","onUploadProgress","onDownloadProgress","decompress","maxContentLength","maxBodyLength","maxRedirects","transport","httpAgent","httpsAgent","cancelToken","socketPath","responseEncoding"],a=["validateStatus"];function c(e,t){return i.isPlainObject(e)&&i.isPlainObject(t)?i.merge(e,t):i.isPlainObject(t)?i.merge({},t):i.isArray(t)?t.slice():t}function l(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(n[r]=c(void 0,e[r])):n[r]=c(e[r],t[r])}i.forEach(r,(function(e){i.isUndefined(t[e])||(n[e]=c(void 0,t[e]))})),i.forEach(s,l),i.forEach(o,(function(r){i.isUndefined(t[r])?i.isUndefined(e[r])||(n[r]=c(void 0,e[r])):n[r]=c(void 0,t[r])})),i.forEach(a,(function(i){i in t?n[i]=c(e[i],t[i]):i in e&&(n[i]=c(void 0,e[i]))}));var d=r.concat(s).concat(o).concat(a),u=Object.keys(e).concat(Object.keys(t)).filter((function(e){return-1===d.indexOf(e)}));return i.forEach(u,l),n}},function(e,t,n){"use strict";function i(e){this.message=e}i.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},i.prototype.__CANCEL__=!0,e.exports=i},function(e,t){var n=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,i=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,r=e.indexOf("["),s=e.indexOf("]");-1!=r&&-1!=s&&(e=e.substring(0,r)+e.substring(r,s).replace(/:/g,";")+e.substring(s,e.length));for(var o,a,c=n.exec(e||""),l={},d=14;d--;)l[i[d]]=c[d]||"";return-1!=r&&-1!=s&&(l.source=t,l.host=l.host.substring(1,l.host.length-1).replace(/;/g,":"),l.authority=l.authority.replace("[","").replace("]","").replace(/;/g,":"),l.ipv6uri=!0),l.pathNames=function(e,t){var n=t.replace(/\/{2,9}/g,"/").split("/");"/"!=t.substr(0,1)&&0!==t.length||n.splice(0,1);"/"==t.substr(t.length-1,1)&&n.splice(n.length-1,1);return n}(0,l.path),l.queryKey=(o=l.query,a={},o.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(e,t,n){t&&(a[t]=n)})),a),l}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Manager=void 0;const i=n(271),r=n(187),s=n(70),o=n(189),a=n(290),c=n(190),l=n(39)("socket.io-client:manager");class d extends c.StrictEventEmitter{constructor(e,t){super(),this.nsps={},this.subs=[],e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new a({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const n=t.parser||s;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(l("readyState %s",this._readyState),~this._readyState.indexOf("open"))return this;l("opening %s",this.uri),this.engine=i(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=o.on(t,"open",(function(){n.onopen(),e&&e()})),s=o.on(t,"error",t=>{l("error"),n.cleanup(),n._readyState="closed",this.emitReserved("error",t),e?e(t):n.maybeReconnectOnOpen()});if(!1!==this._timeout){const e=this._timeout;l("connect attempt will timeout after %d",e),0===e&&r();const n=setTimeout(()=>{l("connect attempt timed out after %d",e),r(),t.close(),t.emit("error",new Error("timeout"))},e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(s),this}connect(e){return this.open(e)}onopen(){l("open"),this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(o.on(e,"ping",this.onping.bind(this)),o.on(e,"data",this.ondata.bind(this)),o.on(e,"error",this.onerror.bind(this)),o.on(e,"close",this.onclose.bind(this)),o.on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){this.decoder.add(e)}ondecoded(e){this.emitReserved("packet",e)}onerror(e){l("error",e),this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n||(n=new r.Socket(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const e of t){if(this.nsps[e].active)return void l("socket %s is still active, skipping close",e)}this._close()}_packet(e){l("writing packet %j",e);const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){l("cleanup"),this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){l("disconnect"),this.skipReconnect=!0,this._reconnecting=!1,"opening"===this._readyState&&this.cleanup(),this.backoff.reset(),this._readyState="closed",this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(e){l("onclose"),this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)l("reconnect failed"),this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();l("will wait %dms before reconnect attempt",t),this._reconnecting=!0;const n=setTimeout(()=>{e.skipReconnect||(l("attempting reconnect"),this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(l("reconnect attempt error"),e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):(l("reconnect success"),e.onreconnect())}))},t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}t.Manager=d},function(e,t,n){const i=n(181),r=n(274),s=n(280),o=n(281);t.polling=function(e){let t,n=!1,o=!1;const a=!1!==e.jsonp;if("undefined"!=typeof location){const t="https:"===location.protocol;let i=location.port;i||(i=t?443:80),n=e.hostname!==location.hostname||i!==e.port,o=e.secure!==t}if(e.xdomain=n,e.xscheme=o,t=new i(e),"open"in t&&!e.forceJSONP)return new r(e);if(!a)throw new Error("JSONP disabled");return new s(e)},t.websocket=o},function(e,t,n){const i=n(273),r=n(40);e.exports=function(e){const t=e.xdomain,n=e.xscheme,s=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||i))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&s)return new XDomainRequest}catch(e){}if(!t)try{return new(r[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(e,t,n){const i=n(68),r=n(69),s=n(27),o=n(184),a=n(29)("engine.io-client:polling");e.exports=class extends i{get name(){return"polling"}doOpen(){this.poll()}pause(e){const t=this;function n(){a("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){let e=0;this.polling&&(a("we are currently polling - waiting to pause"),e++,this.once("pollComplete",(function(){a("pre-pause polling complete"),--e||n()}))),this.writable||(a("we are currently writing - waiting to pause"),e++,this.once("drain",(function(){a("pre-pause writing complete"),--e||n()})))}else n()}poll(){a("polling"),this.polling=!0,this.doPoll(),this.emit("poll")}onData(e){const t=this;a("polling got data %s",e);s.decodePayload(e,this.socket.binaryType).forEach((function(e,n,i){if("opening"===t.readyState&&"open"===e.type&&t.onOpen(),"close"===e.type)return t.onClose(),!1;t.onPacket(e)})),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():a('ignoring poll - transport state "%s"',this.readyState))}doClose(){const e=this;function t(){a("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(a("transport open - closing"),t()):(a("transport not open - deferring close"),this.once("open",t))}write(e){this.writable=!1,s.encodePayload(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emit("drain")})})}uri(){let e=this.query||{};const t=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(e[this.opts.timestampParam]=o()),this.supportsBinary||e.sid||(e.b64=1),e=r.encode(e),this.opts.port&&("https"===t&&443!==Number(this.opts.port)||"http"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),e.length&&(e="?"+e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}}},function(e,t){const n=Object.create(null);n.open="0",n.close="1",n.ping="2",n.pong="3",n.message="4",n.upgrade="5",n.noop="6";const i=Object.create(null);Object.keys(n).forEach(e=>{i[n[e]]=e});e.exports={PACKET_TYPES:n,PACKET_TYPES_REVERSE:i,ERROR_PACKET:{type:"error",data:"parser error"}}},function(e,t,n){"use strict";var i,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),s={},o=0,a=0;function c(e){var t="";do{t=r[e%64]+t,e=Math.floor(e/64)}while(e>0);return t}function l(){var e=c(+new Date);return e!==i?(o=0,i=e):e+"."+c(o++)}for(;a<64;a++)s[r[a]]=a;l.encode=c,l.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=64*t+s[e.charAt(a)];return t},e.exports=l},function(e,t){e.exports.pick=(e,...t)=>t.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})},function(e,t,n){"use strict";(function(e){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <http://feross.org>
 * @license  MIT
 */
var i=n(282),r=n(283),s=n(284);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function a(e,t){if(o()<t)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=c.prototype:(null===e&&(e=new c(t)),e.length=t),e}function c(e,t,n){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return u(this,e)}return l(this,e,t,n)}function l(e,t,n,i){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,i){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(i||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===i?new Uint8Array(t):void 0===i?new Uint8Array(t,n):new Uint8Array(t,n,i);c.TYPED_ARRAY_SUPPORT?(e=t).__proto__=c.prototype:e=h(e,t);return e}(e,t,n,i):"string"==typeof t?function(e,t,n){"string"==typeof n&&""!==n||(n="utf8");if(!c.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var i=0|f(t,n),r=(e=a(e,i)).write(t,n);r!==i&&(e=e.slice(0,r));return e}(e,t,n):function(e,t){if(c.isBuffer(t)){var n=0|p(t.length);return 0===(e=a(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(i=t.length)!=i?a(e,0):h(e,t);if("Buffer"===t.type&&s(t.data))return h(e,t.data)}var i;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function d(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t){if(d(t),e=a(e,t<0?0:0|p(t)),!c.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function h(e,t){var n=t.length<0?0:0|p(t.length);e=a(e,n);for(var i=0;i<n;i+=1)e[i]=255&t[i];return e}function p(e){if(e>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|e}function f(e,t){if(c.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return B(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return U(e).length;default:if(i)return B(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){var i=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return E(this,t,n);case"utf8":case"utf-8":return T(this,t,n);case"ascii":return I(this,t,n);case"latin1":case"binary":return O(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,n);default:if(i)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),i=!0}}function m(e,t,n){var i=e[t];e[t]=e[n],e[n]=i}function v(e,t,n,i,r){if(0===e.length)return-1;if("string"==typeof n?(i=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=r?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(r)return-1;n=e.length-1}else if(n<0){if(!r)return-1;n=0}if("string"==typeof t&&(t=c.from(t,i)),c.isBuffer(t))return 0===t.length?-1:b(e,t,n,i,r);if("number"==typeof t)return t&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,i,r);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,i,r){var s,o=1,a=e.length,c=t.length;if(void 0!==i&&("ucs2"===(i=String(i).toLowerCase())||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(r){var d=-1;for(s=n;s<a;s++)if(l(e,s)===l(t,-1===d?0:s-d)){if(-1===d&&(d=s),s-d+1===c)return d*o}else-1!==d&&(s-=s-d),d=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){for(var u=!0,h=0;h<c;h++)if(l(e,s+h)!==l(t,h)){u=!1;break}if(u)return s}return-1}function S(e,t,n,i){n=Number(n)||0;var r=e.length-n;i?(i=Number(i))>r&&(i=r):i=r;var s=t.length;if(s%2!=0)throw new TypeError("Invalid hex string");i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(t.substr(2*o,2),16);if(isNaN(a))return o;e[n+o]=a}return o}function y(e,t,n,i){return W(B(t,e.length-n),e,n,i)}function C(e,t,n,i){return W(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,i)}function w(e,t,n,i){return C(e,t,n,i)}function _(e,t,n,i){return W(U(t),e,n,i)}function A(e,t,n,i){return W(function(e,t){for(var n,i,r,s=[],o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),i=n>>8,r=n%256,s.push(r),s.push(i);return s}(t,e.length-n),e,n,i)}function k(e,t,n){return 0===t&&n===e.length?i.fromByteArray(e):i.fromByteArray(e.slice(t,n))}function T(e,t,n){n=Math.min(e.length,n);for(var i=[],r=t;r<n;){var s,o,a,c,l=e[r],d=null,u=l>239?4:l>223?3:l>191?2:1;if(r+u<=n)switch(u){case 1:l<128&&(d=l);break;case 2:128==(192&(s=e[r+1]))&&(c=(31&l)<<6|63&s)>127&&(d=c);break;case 3:s=e[r+1],o=e[r+2],128==(192&s)&&128==(192&o)&&(c=(15&l)<<12|(63&s)<<6|63&o)>2047&&(c<55296||c>57343)&&(d=c);break;case 4:s=e[r+1],o=e[r+2],a=e[r+3],128==(192&s)&&128==(192&o)&&128==(192&a)&&(c=(15&l)<<18|(63&s)<<12|(63&o)<<6|63&a)>65535&&c<1114112&&(d=c)}null===d?(d=65533,u=1):d>65535&&(d-=65536,i.push(d>>>10&1023|55296),d=56320|1023&d),i.push(d),r+=u}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=4096));return n}(i)}t.Buffer=c,t.SlowBuffer=function(e){+e!=e&&(e=0);return c.alloc(+e)},t.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=o(),c.poolSize=8192,c._augment=function(e){return e.__proto__=c.prototype,e},c.from=function(e,t,n){return l(null,e,t,n)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(e,t,n){return function(e,t,n,i){return d(t),t<=0?a(e,t):void 0!==n?"string"==typeof i?a(e,t).fill(n,i):a(e,t).fill(n):a(e,t)}(null,e,t,n)},c.allocUnsafe=function(e){return u(null,e)},c.allocUnsafeSlow=function(e){return u(null,e)},c.isBuffer=function(e){return!(null==e||!e._isBuffer)},c.compare=function(e,t){if(!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,i=t.length,r=0,s=Math.min(n,i);r<s;++r)if(e[r]!==t[r]){n=e[r],i=t[r];break}return n<i?-1:i<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!s(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var i=c.allocUnsafe(t),r=0;for(n=0;n<e.length;++n){var o=e[n];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(i,r),r+=o.length}return i},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)m(this,t,t+1);return this},c.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)m(this,t,t+3),m(this,t+1,t+2);return this},c.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)m(this,t,t+7),m(this,t+1,t+6),m(this,t+2,t+5),m(this,t+3,t+4);return this},c.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?T(this,0,e):g.apply(this,arguments)},c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},c.prototype.compare=function(e,t,n,i,r){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===i&&(i=0),void 0===r&&(r=this.length),t<0||n>e.length||i<0||r>this.length)throw new RangeError("out of range index");if(i>=r&&t>=n)return 0;if(i>=r)return-1;if(t>=n)return 1;if(this===e)return 0;for(var s=(r>>>=0)-(i>>>=0),o=(n>>>=0)-(t>>>=0),a=Math.min(s,o),l=this.slice(i,r),d=e.slice(t,n),u=0;u<a;++u)if(l[u]!==d[u]){s=l[u],o=d[u];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,i){if(void 0===t)i="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)i=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===i&&(i="utf8")):(i=n,n=void 0)}var r=this.length-t;if((void 0===n||n>r)&&(n=r),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return S(this,e,t,n);case"utf8":case"utf-8":return y(this,e,t,n);case"ascii":return C(this,e,t,n);case"latin1":case"binary":return w(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return A(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function I(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(127&e[r]);return i}function O(e,t,n){var i="";n=Math.min(e.length,n);for(var r=t;r<n;++r)i+=String.fromCharCode(e[r]);return i}function E(e,t,n){var i=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>i)&&(n=i);for(var r="",s=t;s<n;++s)r+=V(e[s]);return r}function x(e,t,n){for(var i=e.slice(t,n),r="",s=0;s<i.length;s+=2)r+=String.fromCharCode(i[s]+256*i[s+1]);return r}function P(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,i,r,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>r||t<s)throw new RangeError('"value" argument is out of bounds');if(n+i>e.length)throw new RangeError("Index out of range")}function D(e,t,n,i){t<0&&(t=65535+t+1);for(var r=0,s=Math.min(e.length-n,2);r<s;++r)e[n+r]=(t&255<<8*(i?r:1-r))>>>8*(i?r:1-r)}function R(e,t,n,i){t<0&&(t=4294967295+t+1);for(var r=0,s=Math.min(e.length-n,4);r<s;++r)e[n+r]=t>>>8*(i?r:3-r)&255}function F(e,t,n,i,r,s){if(n+i>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function N(e,t,n,i,s){return s||F(e,0,n,4),r.write(e,t,n,i,23,4),n+4}function L(e,t,n,i,s){return s||F(e,0,n,8),r.write(e,t,n,i,52,8),n+8}c.prototype.slice=function(e,t){var n,i=this.length;if((e=~~e)<0?(e+=i)<0&&(e=0):e>i&&(e=i),(t=void 0===t?i:~~t)<0?(t+=i)<0&&(t=0):t>i&&(t=i),t<e&&(t=e),c.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=c.prototype;else{var r=t-e;n=new c(r,void 0);for(var s=0;s<r;++s)n[s]=this[s+e]}return n},c.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i},c.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e+--t],r=1;t>0&&(r*=256);)i+=this[e+--t]*r;return i},c.prototype.readUInt8=function(e,t){return t||P(e,1,this.length),this[e]},c.prototype.readUInt16LE=function(e,t){return t||P(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUInt16BE=function(e,t){return t||P(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUInt32LE=function(e,t){return t||P(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUInt32BE=function(e,t){return t||P(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=this[e],r=1,s=0;++s<t&&(r*=256);)i+=this[e+s]*r;return i>=(r*=128)&&(i-=Math.pow(2,8*t)),i},c.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||P(e,t,this.length);for(var i=t,r=1,s=this[e+--i];i>0&&(r*=256);)s+=this[e+--i]*r;return s>=(r*=128)&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return t||P(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){t||P(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){t||P(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return t||P(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return t||P(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readFloatLE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return t||P(e,4,this.length),r.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return t||P(e,8,this.length),r.read(this,e,!1,52,8)},c.prototype.writeUIntLE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var r=1,s=0;for(this[t]=255&e;++s<n&&(r*=256);)this[t+s]=e/r&255;return t+n},c.prototype.writeUIntBE=function(e,t,n,i){(e=+e,t|=0,n|=0,i)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var r=n-1,s=1;for(this[t+r]=255&e;--r>=0&&(s*=256);)this[t+r]=e/s&255;return t+n},c.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},c.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);M(this,e,t,n,r-1,-r)}var s=0,o=1,a=0;for(this[t]=255&e;++s<n&&(o*=256);)e<0&&0===a&&0!==this[t+s-1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},c.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t|=0,!i){var r=Math.pow(2,8*n-1);M(this,e,t,n,r-1,-r)}var s=n-1,o=1,a=0;for(this[t+s]=255&e;--s>=0&&(o*=256);)e<0&&0===a&&0!==this[t+s+1]&&(a=1),this[t+s]=(e/o>>0)-a&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),c.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):D(this,e,t,!0),t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):D(this,e,t,!1),t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),c.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},c.prototype.writeFloatLE=function(e,t,n){return N(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return N(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return L(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return L(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,i){if(n||(n=0),i||0===i||(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);var r,s=i-n;if(this===e&&n<t&&t<i)for(r=s-1;r>=0;--r)e[r+t]=this[r+n];else if(s<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<s;++r)e[r+t]=this[r+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+s),t);return s},c.prototype.fill=function(e,t,n,i){if("string"==typeof e){if("string"==typeof t?(i=t,t=0,n=this.length):"string"==typeof n&&(i=n,n=this.length),1===e.length){var r=e.charCodeAt(0);r<256&&(e=r)}if(void 0!==i&&"string"!=typeof i)throw new TypeError("encoding must be a string");if("string"==typeof i&&!c.isEncoding(i))throw new TypeError("Unknown encoding: "+i)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var s;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(s=t;s<n;++s)this[s]=e;else{var o=c.isBuffer(e)?e:B(new c(e,i).toString()),a=o.length;for(s=0;s<n-t;++s)this[s+t]=o[s%a]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function V(e){return e<16?"0"+e.toString(16):e.toString(16)}function B(e,t){var n;t=t||1/0;for(var i=e.length,r=null,s=[],o=0;o<i;++o){if((n=e.charCodeAt(o))>55295&&n<57344){if(!r){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(t-=3)>-1&&s.push(239,191,189);continue}r=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),r=n;continue}n=65536+(r-55296<<10|n-56320)}else r&&(t-=3)>-1&&s.push(239,191,189);if(r=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function U(e){return i.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(j,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function W(e,t,n,i){for(var r=0;r<i&&!(r+n>=t.length||r>=e.length);++r)t[r+n]=e[r];return r}}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=void 0;const i=n(70),r=n(189),s=n(190),o=n(39)("socket.io-client:socket"),a=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class c extends s.StrictEventEmitter{constructor(e,t,n){super(),this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}subEvents(){if(this.subs)return;const e=this.io;this.subs=[r.on(e,"open",this.onopen.bind(this)),r.on(e,"packet",this.onpacket.bind(this)),r.on(e,"error",this.onerror.bind(this)),r.on(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...e){return e.unshift("message"),this.emit.apply(this,e),this}emit(e,...t){if(a.hasOwnProperty(e))throw new Error('"'+e+'" is a reserved event name');t.unshift(e);const n={type:i.PacketType.EVENT,data:t,options:{}};n.options.compress=!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(o("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++);const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)?o("discard packet as the transport is not currently writable"):this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){o("transport is open - connecting"),"function"==typeof this.auth?this.auth(e=>{this.packet({type:i.PacketType.CONNECT,data:e})}):this.packet({type:i.PacketType.CONNECT,data:this.auth})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e){o("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emitReserved("disconnect",e)}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case i.PacketType.CONNECT:if(e.data&&e.data.sid){const t=e.data.sid;this.onconnect(t)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case i.PacketType.EVENT:case i.PacketType.BINARY_EVENT:this.onevent(e);break;case i.PacketType.ACK:case i.PacketType.BINARY_ACK:this.onack(e);break;case i.PacketType.DISCONNECT:this.ondisconnect();break;case i.PacketType.CONNECT_ERROR:const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];o("emitting event %j",t),null!=e.id&&(o("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e)}ack(e){const t=this;let n=!1;return function(...r){n||(n=!0,o("sending ack %j",r),t.packet({type:i.PacketType.ACK,id:e,data:r}))}}onack(e){const t=this.acks[e.id];"function"==typeof t?(o("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):o("bad ack %s",e.id)}onconnect(e){o("socket connected with id %s",e),this.id=e,this.connected=!0,this.disconnected=!1,this.emitReserved("connect"),this.emitBuffered()}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>this.packet(e)),this.sendBuffer=[]}ondisconnect(){o("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&(o("performing disconnect (%s)",this.nsp),this.packet({type:i.PacketType.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}}t.Socket=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasBinary=t.isBinary=void 0;const i="function"==typeof ArrayBuffer,r=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),o="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);function a(e){return i&&(e instanceof ArrayBuffer||(e=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||s&&e instanceof Blob||o&&e instanceof File}t.isBinary=a,t.hasBinary=function e(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,i=t.length;n<i;n++)if(e(t[n]))return!0;return!1}if(a(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return!0;return!1}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.on=void 0,t.on=function(e,t,n){return e.on(t,n),function(){e.off(t,n)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StrictEventEmitter=void 0;const i=n(28);t.StrictEventEmitter=class extends i{on(e,t){return super.on(e,t),this}once(e,t){return super.once(e,t),this}emit(e,...t){return super.emit(e,...t),this}emitReserved(e,...t){return super.emit(e,...t),this}listeners(e){return super.listeners(e)}}},function(e,t){},function(e,t,n){e.exports=n(244)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Socket=t.io=t.Manager=t.protocol=void 0;const i=n(268),r=n(179),s=n(187);Object.defineProperty(t,"Socket",{enumerable:!0,get:function(){return s.Socket}});const o=n(39)("socket.io-client");e.exports=t=c;const a=t.managers={};function c(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};const n=i.url(e,t.path),s=n.source,c=n.id,l=n.path,d=a[c]&&l in a[c].nsps;let u;return t.forceNew||t["force new connection"]||!1===t.multiplex||d?(o("ignoring socket cache for %s",s),u=new r.Manager(s,t)):(a[c]||(o("new io instance for %s",s),a[c]=new r.Manager(s,t)),u=a[c]),n.query&&!t.query&&(t.query=n.queryKey),u.socket(n.path,t)}t.io=c;var l=n(70);Object.defineProperty(t,"protocol",{enumerable:!0,get:function(){return l.protocol}}),t.connect=c;var d=n(179);Object.defineProperty(t,"Manager",{enumerable:!0,get:function(){return d.Manager}}),t.default=c},function(e,t,n){"use strict";var i=n(41),r=n.n(i);n.d(t,"default",(function(){return r.a}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return g}));var i=n(3),r=n(1);var s=("undefined"!=typeof window?window:void 0!==e?e:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function o(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function a(e){return null!==e&&"object"==typeof e}function c(e,t){if(!e)throw new Error("[vuex] "+t)}var l=function(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},d={namespaced:{configurable:!0}};d.namespaced.get=function(){return!!this._rawModule.namespaced},l.prototype.addChild=function(e,t){this._children[e]=t},l.prototype.removeChild=function(e){delete this._children[e]},l.prototype.getChild=function(e){return this._children[e]},l.prototype.hasChild=function(e){return e in this._children},l.prototype.update=function(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},l.prototype.forEachChild=function(e){o(this._children,e)},l.prototype.forEachGetter=function(e){this._rawModule.getters&&o(this._rawModule.getters,e)},l.prototype.forEachAction=function(e){this._rawModule.actions&&o(this._rawModule.actions,e)},l.prototype.forEachMutation=function(e){this._rawModule.mutations&&o(this._rawModule.mutations,e)},Object.defineProperties(l.prototype,d);var u=function(e){this.register([],e,!1)};u.prototype.get=function(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},u.prototype.getNamespace=function(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},u.prototype.update=function(e){!function e(t,n,i){if(f(t,i),n.update(i),i.modules)for(var r in i.modules){if(!n.getChild(r))return void console.warn("[vuex] trying to add a new module '"+r+"' on hot reloading, manual reload is needed");e(t.concat(r),n.getChild(r),i.modules[r])}}([],this.root,e)},u.prototype.register=function(e,t,n){var i=this;void 0===n&&(n=!0),f(e,t);var r=new l(t,n);0===e.length?this.root=r:this.get(e.slice(0,-1)).addChild(e[e.length-1],r);t.modules&&o(t.modules,(function(t,r){i.register(e.concat(r),t,n)}))},u.prototype.unregister=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],i=t.getChild(n);i?i.runtime&&t.removeChild(n):console.warn("[vuex] trying to unregister module '"+n+"', which is not registered")},u.prototype.isRegistered=function(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var h={assert:function(e){return"function"==typeof e},expected:"function"},p={getters:h,mutations:h,actions:{assert:function(e){return"function"==typeof e||"object"==typeof e&&"function"==typeof e.handler},expected:'function or object with "handler" function'}};function f(e,t){Object.keys(p).forEach((function(n){if(t[n]){var i=p[n];o(t[n],(function(t,r){c(i.assert(t),function(e,t,n,i,r){var s=t+" should be "+r+' but "'+t+"."+n+'"';e.length>0&&(s+=' in module "'+e.join(".")+'"');return s+=" is "+JSON.stringify(i)+"."}(e,n,r,t,i.expected))}))}}))}function g(e){return new m(e)}var m=function e(t){var n=this;void 0===t&&(t={}),c("undefined"!=typeof Promise,"vuex requires a Promise polyfill in this browser."),c(this instanceof e,"store must be called with the new operator.");var i=t.plugins;void 0===i&&(i=[]);var r=t.strict;void 0===r&&(r=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new u(t),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._makeLocalGettersCache=Object.create(null);var o=this,a=this.dispatch,l=this.commit;this.dispatch=function(e,t){return a.call(o,e,t)},this.commit=function(e,t,n){return l.call(o,e,t,n)},this.strict=r;var d=this._modules.root.state;C(this,d,[],this._modules.root),y(this,d),i.forEach((function(e){return e(n)})),(void 0===t.devtools||t.devtools)&&function(e){s&&(e._devtoolHook=s,s.emit("vuex:init",e),s.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){s.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){s.emit("vuex:action",e,t)}),{prepend:!0}))}(this)},v={state:{configurable:!0}};function b(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function S(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;C(e,n,[],e._modules.root,!0),y(e,n,t)}function y(e,t,n){var s=e._state;e.getters={},e._makeLocalGettersCache=Object.create(null);var a=e._wrappedGetters,l={};o(a,(function(t,n){l[n]=function(e,t){return function(){return e(t)}}(t,e),Object.defineProperty(e.getters,n,{get:function(){return l[n]()},enumerable:!0})})),e._state=Object(r.i)({data:t}),e.strict&&function(e){Object(i.x)((function(){return e._state.data}),(function(){c(e._committing,"do not mutate vuex store state outside mutation handlers.")}),{deep:!0,flush:"sync"})}(e),s&&n&&e._withCommit((function(){s.data=null}))}function C(e,t,n,i,r){var s=!n.length,o=e._modules.getNamespace(n);if(i.namespaced&&(e._modulesNamespaceMap[o]&&console.error("[vuex] duplicate namespace "+o+" for the namespaced module "+n.join("/")),e._modulesNamespaceMap[o]=i),!s&&!r){var a=w(t,n.slice(0,-1)),c=n[n.length-1];e._withCommit((function(){c in a&&console.warn('[vuex] state field "'+c+'" was overridden by a module with the same name at "'+n.join(".")+'"'),a[c]=i.state}))}var l=i.context=function(e,t,n){var i=""===t,r={dispatch:i?e.dispatch:function(n,i,r){var s=_(n,i,r),o=s.payload,a=s.options,c=s.type;if(a&&a.root||(c=t+c,e._actions[c]))return e.dispatch(c,o);console.error("[vuex] unknown local action type: "+s.type+", global type: "+c)},commit:i?e.commit:function(n,i,r){var s=_(n,i,r),o=s.payload,a=s.options,c=s.type;a&&a.root||(c=t+c,e._mutations[c])?e.commit(c,o,a):console.error("[vuex] unknown local mutation type: "+s.type+", global type: "+c)}};return Object.defineProperties(r,{getters:{get:i?function(){return e.getters}:function(){return function(e,t){if(!e._makeLocalGettersCache[t]){var n={},i=t.length;Object.keys(e.getters).forEach((function(r){if(r.slice(0,i)===t){var s=r.slice(i);Object.defineProperty(n,s,{get:function(){return e.getters[r]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}(e,t)}},state:{get:function(){return w(e.state,n)}}}),r}(e,o,n);i.forEachMutation((function(t,n){!function(e,t,n,i){(e._mutations[t]||(e._mutations[t]=[])).push((function(t){n.call(e,i.state,t)}))}(e,o+n,t,l)})),i.forEachAction((function(t,n){var i=t.root?n:o+n,r=t.handler||t;!function(e,t,n,i){(e._actions[t]||(e._actions[t]=[])).push((function(t){var r,s=n.call(e,{dispatch:i.dispatch,commit:i.commit,getters:i.getters,state:i.state,rootGetters:e.getters,rootState:e.state},t);return(r=s)&&"function"==typeof r.then||(s=Promise.resolve(s)),e._devtoolHook?s.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):s}))}(e,i,r,l)})),i.forEachGetter((function(t,n){!function(e,t,n,i){if(e._wrappedGetters[t])return void console.error("[vuex] duplicate getter key: "+t);e._wrappedGetters[t]=function(e){return n(i.state,i.getters,e.state,e.getters)}}(e,o+n,t,l)})),i.forEachChild((function(i,s){C(e,t,n.concat(s),i,r)}))}function w(e,t){return t.reduce((function(e,t){return e[t]}),e)}function _(e,t,n){return a(e)&&e.type&&(n=t,t=e,e=e.type),c("string"==typeof e,"expects string as the type, but found "+typeof e+"."),{type:e,payload:t,options:n}}m.prototype.install=function(e,t){e.provide(t||"store",this),e.config.globalProperties.$store=this},v.state.get=function(){return this._state.data},v.state.set=function(e){c(!1,"use store.replaceState() to explicit replace store state.")},m.prototype.commit=function(e,t,n){var i=this,r=_(e,t,n),s=r.type,o=r.payload,a=r.options,c={type:s,payload:o},l=this._mutations[s];l?(this._withCommit((function(){l.forEach((function(e){e(o)}))})),this._subscribers.slice().forEach((function(e){return e(c,i.state)})),a&&a.silent&&console.warn("[vuex] mutation type: "+s+". Silent option has been removed. Use the filter functionality in the vue-devtools")):console.error("[vuex] unknown mutation type: "+s)},m.prototype.dispatch=function(e,t){var n=this,i=_(e,t),r=i.type,s=i.payload,o={type:r,payload:s},a=this._actions[r];if(a){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(o,n.state)}))}catch(e){console.warn("[vuex] error in before action subscribers: "),console.error(e)}var c=a.length>1?Promise.all(a.map((function(e){return e(s)}))):a[0](s);return new Promise((function(e,t){c.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(o,n.state)}))}catch(e){console.warn("[vuex] error in after action subscribers: "),console.error(e)}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(o,n.state,e)}))}catch(e){console.warn("[vuex] error in error action subscribers: "),console.error(e)}t(e)}))}))}console.error("[vuex] unknown action type: "+r)},m.prototype.subscribe=function(e,t){return b(e,this._subscribers,t)},m.prototype.subscribeAction=function(e,t){return b("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},m.prototype.watch=function(e,t,n){var r=this;return c("function"==typeof e,"store.watch only accepts a function."),Object(i.x)((function(){return e(r.state,r.getters)}),t,Object.assign({},n))},m.prototype.replaceState=function(e){var t=this;this._withCommit((function(){t._state.data=e}))},m.prototype.registerModule=function(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),c(Array.isArray(e),"module path must be a string or an Array."),c(e.length>0,"cannot register the root module by using registerModule."),this._modules.register(e,t),C(this,this.state,e,this._modules.get(e),n.preserveState),y(this,this.state)},m.prototype.unregisterModule=function(e){var t=this;"string"==typeof e&&(e=[e]),c(Array.isArray(e),"module path must be a string or an Array."),this._modules.unregister(e),this._withCommit((function(){delete w(t.state,e.slice(0,-1))[e[e.length-1]]})),S(this)},m.prototype.hasModule=function(e){return"string"==typeof e&&(e=[e]),c(Array.isArray(e),"module path must be a string or an Array."),this._modules.isRegistered(e)},m.prototype.hotUpdate=function(e){this._modules.update(e),S(this,!0)},m.prototype._withCommit=function(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(m.prototype,v);T((function(e,t){var n={};return k(t)||console.error("[vuex] mapState: mapper parameter must be either an Array or an Object"),A(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){var t=this.$store.state,n=this.$store.getters;if(e){var i=I(this.$store,"mapState",e);if(!i)return;t=i.context.state,n=i.context.getters}return"function"==typeof r?r.call(this,t,n):t[r]},n[i].vuex=!0})),n})),T((function(e,t){var n={};return k(t)||console.error("[vuex] mapMutations: mapper parameter must be either an Array or an Object"),A(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var i=this.$store.commit;if(e){var s=I(this.$store,"mapMutations",e);if(!s)return;i=s.context.commit}return"function"==typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}})),n})),T((function(e,t){var n={};return k(t)||console.error("[vuex] mapGetters: mapper parameter must be either an Array or an Object"),A(t).forEach((function(t){var i=t.key,r=t.val;r=e+r,n[i]=function(){if(!e||I(this.$store,"mapGetters",e)){if(r in this.$store.getters)return this.$store.getters[r];console.error("[vuex] unknown getter: "+r)}},n[i].vuex=!0})),n})),T((function(e,t){var n={};return k(t)||console.error("[vuex] mapActions: mapper parameter must be either an Array or an Object"),A(t).forEach((function(t){var i=t.key,r=t.val;n[i]=function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var i=this.$store.dispatch;if(e){var s=I(this.$store,"mapActions",e);if(!s)return;i=s.context.dispatch}return"function"==typeof r?r.apply(this,[i].concat(t)):i.apply(this.$store,[r].concat(t))}})),n}));function A(e){return k(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function k(e){return Array.isArray(e)||a(e)}function T(e){return function(t,n){return"string"!=typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function I(e,t,n){var i=e._modulesNamespaceMap[n];return i||console.error("[vuex] module namespace not found in "+t+"(): "+n),i}}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);t.default=class{constructor(e,t=i.default.WARN){this.name=e,this.level=t}info(e){this.log(i.default.INFO,e)}warn(e){this.log(i.default.WARN,e)}error(e){this.log(i.default.ERROR,e)}debug(e){i.default.DEBUG<this.level||("string"==typeof e?this.log(i.default.DEBUG,e):e?this.log(i.default.DEBUG,e()):this.log(i.default.DEBUG,""+e))}setLogLevel(e){this.level=e}getLogLevel(){return this.level}log(e,t){if(e<this.level)return;const n=`${(new Date).toISOString()} [${i.default[e]}] ${this.name} - ${t}`;switch(e){case i.default.ERROR:console.error(n);break;case i.default.WARN:console.warn(n);break;case i.default.DEBUG:console.debug(n.replace(/\\r\\n/g,"\n"));break;case i.default.INFO:console.info(n)}}}},function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"BrowserInfo",(function(){return r})),n.d(t,"NodeInfo",(function(){return s})),n.d(t,"SearchBotDeviceInfo",(function(){return o})),n.d(t,"BotInfo",(function(){return a})),n.d(t,"ReactNativeInfo",(function(){return c})),n.d(t,"detect",(function(){return h})),n.d(t,"browserName",(function(){return f})),n.d(t,"parseUserAgent",(function(){return g})),n.d(t,"detectOS",(function(){return m})),n.d(t,"getNodeVersion",(function(){return v}));var i=function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var i=Array(e),r=0;for(t=0;t<n;t++)for(var s=arguments[t],o=0,a=s.length;o<a;o++,r++)i[r]=s[o];return i},r=function(e,t,n){this.name=e,this.version=t,this.os=n,this.type="browser"},s=function(t){this.version=t,this.type="node",this.name="node",this.os=e.platform},o=function(e,t,n,i){this.name=e,this.version=t,this.os=n,this.bot=i,this.type="bot-device"},a=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},c=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},l=/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,d=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],u=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function h(e){return e?g(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new c:"undefined"!=typeof navigator?g(navigator.userAgent):v()}function p(e){return""!==e&&d.reduce((function(t,n){var i=n[0],r=n[1];if(t)return t;var s=r.exec(e);return!!s&&[i,s]}),!1)}function f(e){var t=p(e);return t?t[0]:null}function g(e){var t=p(e);if(!t)return null;var n=t[0],s=t[1];if("searchbot"===n)return new a;var c=s[1]&&s[1].split(/[._]/).slice(0,3);c?c.length<3&&(c=i(c,function(e){for(var t=[],n=0;n<e;n++)t.push("0");return t}(3-c.length))):c=[];var d=c.join("."),u=m(e),h=l.exec(e);return h&&h[1]?new o(n,d,u,h[1]):new r(n,d,u)}function m(e){for(var t=0,n=u.length;t<n;t++){var i=u[t],r=i[0];if(i[1].exec(e))return r}return null}function v(){return void 0!==e&&e.version?new s(e.version.slice(1)):null}}.call(this,n(20))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e=.9,t=.01,n=.2,i=.2){this.speakerWeight=e,this.cutoffThreshold=t,this.silenceThreshold=n,this.takeoverRate=i,this.volumes={}}calculateScore(e,t,n){(n||null===t)&&(t=0),this.volumes.hasOwnProperty(e)||(this.volumes[e]=0),t=t>this.silenceThreshold?1:0;const i=this.volumes[e]*this.speakerWeight+t*(1-this.speakerWeight);this.volumes[e]=i;for(const n in this.volumes)n!==e&&(this.volumes[n]=Math.max(this.volumes[n]-this.takeoverRate*t,0));return i<this.cutoffThreshold?0:i}prioritizeVideoSendBandwidthForActiveSpeaker(){return!0}}},function(e,t,n){var i;
/*!@license
 * UAParser.js v0.7.28
 * Lightweight JavaScript-based User-Agent string parser
 * https://github.com/faisalman/ua-parser-js
 *
 * Copyright  2012-2021 Faisal Salman <f@faisalman.com>
 * Licensed under MIT License
 */!function(r,s){"use strict";var o="model",a="name",c="type",l="vendor",d="version",u="mobile",h="tablet",p="smarttv",f={extend:function(e,t){var n={};for(var i in e)t[i]&&t[i].length%2==0?n[i]=t[i].concat(e[i]):n[i]=e[i];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(e,t){return e=e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),void 0===t?e:e.substring(0,255)}},g={rgx:function(e,t){for(var n,i,r,s,o,a,c=0;c<t.length&&!o;){var l=t[c],d=t[c+1];for(n=i=0;n<l.length&&!o;)if(o=l[n++].exec(e))for(r=0;r<d.length;r++)a=o[++i],"object"==typeof(s=d[r])&&s.length>0?2==s.length?"function"==typeof s[1]?this[s[0]]=s[1].call(this,a):this[s[0]]=s[1]:3==s.length?"function"!=typeof s[1]||s[1].exec&&s[1].test?this[s[0]]=a?a.replace(s[1],s[2]):void 0:this[s[0]]=a?s[1].call(this,a,s[2]):void 0:4==s.length&&(this[s[0]]=a?s[3].call(this,a.replace(s[1],s[2])):void 0):this[s]=a||void 0;c+=2}},str:function(e,t){for(var n in t)if("object"==typeof t[n]&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(f.has(t[n][i],e))return"?"===n?void 0:n}else if(f.has(t[n],e))return"?"===n?void 0:n;return e}},m={browser:{oldSafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}},oldEdge:{version:{.1:"12.",21:"13.",31:"14.",39:"15.",41:"16.",42:"17.",44:"18."}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},v={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[d,[a,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[d,[a,"Edge"]],[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]{3,6})\b.+version\/([\w\.-]+)/i,/(opera)(?:.+version\/|[\/\s]+)([\w\.]+)/i],[a,d],[/opios[\/\s]+([\w\.]+)/i],[d,[a,"Opera Mini"]],[/\sopr\/([\w\.]+)/i],[d,[a,"Opera"]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(ba?idubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i,/(rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([\w\.]+)/i,/(weibo)__([\d\.]+)/i],[a,d],[/(?:[\s\/]uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[d,[a,"UCBrowser"]],[/(?:windowswechat)?\sqbcore\/([\w\.]+)\b.*(?:windowswechat)?/i],[d,[a,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[d,[a,"WeChat"]],[/konqueror\/([\w\.]+)/i],[d,[a,"Konqueror"]],[/trident.+rv[:\s]([\w\.]{1,9})\b.+like\sgecko/i],[d,[a,"IE"]],[/yabrowser\/([\w\.]+)/i],[d,[a,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[a,/(.+)/,"$1 Secure Browser"],d],[/focus\/([\w\.]+)/i],[d,[a,"Firefox Focus"]],[/opt\/([\w\.]+)/i],[d,[a,"Opera Touch"]],[/coc_coc_browser\/([\w\.]+)/i],[d,[a,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[d,[a,"Dolphin"]],[/coast\/([\w\.]+)/i],[d,[a,"Opera Coast"]],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[d,[a,"MIUI Browser"]],[/fxios\/([\w\.-]+)/i],[d,[a,"Firefox"]],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[a,"360 Browser"]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[a,/(.+)/,"$1 Browser"],d],[/(comodo_dragon)\/([\w\.]+)/i],[[a,/_/g," "],d],[/\s(electron)\/([\w\.]+)\ssafari/i,/(tesla)(?:\sqtcarbrowser|\/(20[12]\d\.[\w\.-]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/\s]?([\w\.]+)/i],[a,d],[/(MetaSr)[\/\s]?([\w\.]+)/i,/(LBBROWSER)/i],[a],[/;fbav\/([\w\.]+);/i],[d,[a,"Facebook"]],[/FBAN\/FBIOS|FB_IAB\/FB4A/i],[[a,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/\s]([\w\.-]+)/i],[a,d],[/\bgsa\/([\w\.]+)\s.*safari\//i],[d,[a,"GSA"]],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[d,[a,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[a,"Chrome WebView"],d],[/droid.+\sversion\/([\w\.]+)\b.+(?:mobile\ssafari|safari)/i],[d,[a,"Android Browser"]],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[a,d],[/version\/([\w\.]+)\s.*mobile\/\w+\s(safari)/i],[d,[a,"Mobile Safari"]],[/version\/([\w\.]+)\s.*(mobile\s?safari|safari)/i],[d,a],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[a,[d,g.str,m.browser.oldSafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[a,d],[/(navigator|netscape)\/([\w\.-]+)/i],[[a,"Netscape"],d],[/ile\svr;\srv:([\w\.]+)\).+firefox/i],[d,[a,"Firefox Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(firefox)\/([\w\.]+)\s[\w\s\-]+\/[\w\.]+$/i,/(mozilla)\/([\w\.]+)\s.+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[a,d]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[["architecture","amd64"]],[/(ia32(?=;))/i],[["architecture",f.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[["architecture","ia32"]],[/\b(aarch64|armv?8e?l?)\b/i],[["architecture","arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[["architecture","armhf"]],[/windows\s(ce|mobile);\sppc;/i],[["architecture","arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[["architecture",/ower/,"",f.lowerize]],[/(sun4\w)[;\)]/i],[["architecture","sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?:64|(?=v(?:[1-7]|[5-7]1)l?|;|eabi))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[["architecture",f.lowerize]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus\s10)/i],[o,[l,"Samsung"],[c,h]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy\snexus)/i,/\ssamsung[\s-]([\w-]+)/i,/sec-(sgh\w+)/i],[o,[l,"Samsung"],[c,u]],[/\((ip(?:hone|od)[\s\w]*);/i],[o,[l,"Apple"],[c,u]],[/\((ipad);[\w\s\),;-]+apple/i,/applecoremedia\/[\w\.]+\s\((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[o,[l,"Apple"],[c,h]],[/\b((?:agr|ags[23]|bah2?|sht?)-a?[lw]\d{2})/i],[o,[l,"Huawei"],[c,h]],[/d\/huawei([\w\s-]+)[;\)]/i,/\b(nexus\s6p|vog-[at]?l\d\d|ane-[at]?l[x\d]\d|eml-a?l\d\da?|lya-[at]?l\d[\dc]|clt-a?l\d\di?|ele-l\d\d)/i,/\b(\w{2,4}-[atu][ln][01259][019])[;\)\s]/i],[o,[l,"Huawei"],[c,u]],[/\b(poco[\s\w]+)(?:\sbuild|\))/i,/\b;\s(\w+)\sbuild\/hm\1/i,/\b(hm[\s\-_]?note?[\s_]?(?:\d\w)?)\sbuild/i,/\b(redmi[\s\-_]?(?:note|k)?[\w\s_]+)(?:\sbuild|\))/i,/\b(mi[\s\-_]?(?:a\d|one|one[\s_]plus|note lte)?[\s_]?(?:\d?\w?)[\s_]?(?:plus)?)\sbuild/i],[[o,/_/g," "],[l,"Xiaomi"],[c,u]],[/\b(mi[\s\-_]?(?:pad)(?:[\w\s_]+))(?:\sbuild|\))/i],[[o,/_/g," "],[l,"Xiaomi"],[c,h]],[/;\s(\w+)\sbuild.+\soppo/i,/\s(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007)\b/i],[o,[l,"OPPO"],[c,u]],[/\svivo\s(\w+)(?:\sbuild|\))/i,/\s(v[12]\d{3}\w?[at])(?:\sbuild|;)/i],[o,[l,"Vivo"],[c,u]],[/\s(rmx[12]\d{3})(?:\sbuild|;)/i],[o,[l,"Realme"],[c,u]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)\b[\w\s]+build\//i,/\smot(?:orola)?[\s-](\w*)/i,/((?:moto[\s\w\(\)]+|xt\d{3,4}|nexus\s6)(?=\sbuild|\)))/i],[o,[l,"Motorola"],[c,u]],[/\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[o,[l,"Motorola"],[c,h]],[/((?=lg)?[vl]k\-?\d{3})\sbuild|\s3\.[\s\w;-]{10}lg?-([06cv9]{3,4})/i],[o,[l,"LG"],[c,h]],[/(lm-?f100[nv]?|nexus\s[45])/i,/lg[e;\s\/-]+((?!browser|netcast)\w+)/i,/\blg(\-?[\d\w]+)\sbuild/i],[o,[l,"LG"],[c,u]],[/(ideatab[\w\-\s]+)/i,/lenovo\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+)|yt[\d\w-]{6}|tb[\d\w-]{6})/i],[o,[l,"Lenovo"],[c,h]],[/(?:maemo|nokia).*(n900|lumia\s\d+)/i,/nokia[\s_-]?([\w\.-]*)/i],[[o,/_/g," "],[l,"Nokia"],[c,u]],[/droid.+;\s(pixel\sc)[\s)]/i],[o,[l,"Google"],[c,h]],[/droid.+;\s(pixel[\s\daxl]{0,6})(?:\sbuild|\))/i],[o,[l,"Google"],[c,u]],[/droid.+\s([c-g]\d{4}|so[-l]\w+|xq-a\w[4-7][12])(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[o,[l,"Sony"],[c,u]],[/sony\stablet\s[ps]\sbuild\//i,/(?:sony)?sgp\w+(?:\sbuild\/|\))/i],[[o,"Xperia Tablet"],[l,"Sony"],[c,h]],[/\s(kb2005|in20[12]5|be20[12][59])\b/i,/\ba000(1)\sbuild/i,/\boneplus\s(a\d{4})[\s)]/i],[o,[l,"OnePlus"],[c,u]],[/(alexa)webm/i,/(kf[a-z]{2}wi)(\sbuild\/|\))/i,/(kf[a-z]+)(\sbuild\/|\)).+silk\//i],[o,[l,"Amazon"],[c,h]],[/(sd|kf)[0349hijorstuw]+(\sbuild\/|\)).+silk\//i],[[o,"Fire Phone"],[l,"Amazon"],[c,u]],[/\((playbook);[\w\s\),;-]+(rim)/i],[o,l,[c,h]],[/((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10;\s(\w+)/i],[o,[l,"BlackBerry"],[c,u]],[/(?:\b|asus_)(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus\s7|padfone|p00[cj])/i],[o,[l,"ASUS"],[c,h]],[/\s(z[es]6[027][01][km][ls]|zenfone\s\d\w?)\b/i],[o,[l,"ASUS"],[c,u]],[/(nexus\s9)/i],[o,[l,"HTC"],[c,h]],[/(htc)[;_\s-]{1,2}([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[o,/_/g," "],[c,u]],[/droid[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[o,[l,"Acer"],[c,h]],[/droid.+;\s(m[1-5]\snote)\sbuild/i,/\bmz-([\w-]{2,})/i],[o,[l,"Meizu"],[c,u]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i,/(microsoft);\s(lumia[\s\w]+)/i,/(lenovo)[_\s-]?([\w-]+)/i,/linux;.+(jolla);/i,/droid.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,o,[c,u]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i,/[;\/]\s?(le[\s\-]+pan)[\s\-]+(\w{1,9})\sbuild/i,/[;\/]\s?(trinity)[\-\s]*(t\d{3})\sbuild/i,/\b(gigaset)[\s\-]+(q\w{1,9})\sbuild/i,/\b(vodafone)\s([\w\s]+)(?:\)|\sbuild)/i],[l,o,[c,h]],[/\s(surface\sduo)\s/i],[o,[l,"Microsoft"],[c,h]],[/droid\s[\d\.]+;\s(fp\du?)\sbuild/i],[o,[l,"Fairphone"],[c,u]],[/\s(u304aa)\sbuild/i],[o,[l,"AT&T"],[c,u]],[/sie-(\w*)/i],[o,[l,"Siemens"],[c,u]],[/[;\/]\s?(rct\w+)\sbuild/i],[o,[l,"RCA"],[c,h]],[/[;\/\s](venue[\d\s]{2,7})\sbuild/i],[o,[l,"Dell"],[c,h]],[/[;\/]\s?(q(?:mv|ta)\w+)\sbuild/i],[o,[l,"Verizon"],[c,h]],[/[;\/]\s(?:barnes[&\s]+noble\s|bn[rt])([\w\s\+]*)\sbuild/i],[o,[l,"Barnes & Noble"],[c,h]],[/[;\/]\s(tm\d{3}\w+)\sbuild/i],[o,[l,"NuVision"],[c,h]],[/;\s(k88)\sbuild/i],[o,[l,"ZTE"],[c,h]],[/;\s(nx\d{3}j)\sbuild/i],[o,[l,"ZTE"],[c,u]],[/[;\/]\s?(gen\d{3})\sbuild.*49h/i],[o,[l,"Swiss"],[c,u]],[/[;\/]\s?(zur\d{3})\sbuild/i],[o,[l,"Swiss"],[c,h]],[/[;\/]\s?((zeki)?tb.*\b)\sbuild/i],[o,[l,"Zeki"],[c,h]],[/[;\/]\s([yr]\d{2})\sbuild/i,/[;\/]\s(dragon[\-\s]+touch\s|dt)(\w{5})\sbuild/i],[[l,"Dragon Touch"],o,[c,h]],[/[;\/]\s?(ns-?\w{0,9})\sbuild/i],[o,[l,"Insignia"],[c,h]],[/[;\/]\s?((nxa|Next)-?\w{0,9})\sbuild/i],[o,[l,"NextBook"],[c,h]],[/[;\/]\s?(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05]))\sbuild/i],[[l,"Voice"],o,[c,u]],[/[;\/]\s?(lvtel\-)?(v1[12])\sbuild/i],[[l,"LvTel"],o,[c,u]],[/;\s(ph-1)\s/i],[o,[l,"Essential"],[c,u]],[/[;\/]\s?(v(100md|700na|7011|917g).*\b)\sbuild/i],[o,[l,"Envizen"],[c,h]],[/[;\/]\s?(trio[\s\w\-\.]+)\sbuild/i],[o,[l,"MachSpeed"],[c,h]],[/[;\/]\s?tu_(1491)\sbuild/i],[o,[l,"Rotor"],[c,h]],[/(shield[\w\s]+)\sbuild/i],[o,[l,"Nvidia"],[c,h]],[/(sprint)\s(\w+)/i],[l,o,[c,u]],[/(kin\.[onetw]{3})/i],[[o,/\./g," "],[l,"Microsoft"],[c,u]],[/droid\s[\d\.]+;\s(cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[o,[l,"Zebra"],[c,h]],[/droid\s[\d\.]+;\s(ec30|ps20|tc[2-8]\d[kx])\)/i],[o,[l,"Zebra"],[c,u]],[/\s(ouya)\s/i,/(nintendo)\s([wids3utch]+)/i],[l,o,[c,"console"]],[/droid.+;\s(shield)\sbuild/i],[o,[l,"Nvidia"],[c,"console"]],[/(playstation\s[345portablevi]+)/i],[o,[l,"Sony"],[c,"console"]],[/[\s\(;](xbox(?:\sone)?(?!;\sxbox))[\s\);]/i],[o,[l,"Microsoft"],[c,"console"]],[/smart-tv.+(samsung)/i],[l,[c,p]],[/hbbtv.+maple;(\d+)/i],[[o,/^/,"SmartTV"],[l,"Samsung"],[c,p]],[/(?:linux;\snetcast.+smarttv|lg\snetcast\.tv-201\d)/i],[[l,"LG"],[c,p]],[/(apple)\s?tv/i],[l,[o,"Apple TV"],[c,p]],[/crkey/i],[[o,"Chromecast"],[l,"Google"],[c,p]],[/droid.+aft([\w])(\sbuild\/|\))/i],[o,[l,"Amazon"],[c,p]],[/\(dtv[\);].+(aquos)/i],[o,[l,"Sharp"],[c,p]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,f.trim],[o,f.trim],[c,p]],[/[\s\/\(](android\s|smart[-\s]?|opera\s)tv[;\)\s]/i],[[c,p]],[/((pebble))app\/[\d\.]+\s/i],[l,o,[c,"wearable"]],[/droid.+;\s(glass)\s\d/i],[o,[l,"Google"],[c,"wearable"]],[/droid\s[\d\.]+;\s(wt63?0{2,3})\)/i],[o,[l,"Zebra"],[c,"wearable"]],[/(tesla)(?:\sqtcarbrowser|\/20[12]\d\.[\w\.-]+)/i],[l,[c,"embedded"]],[/droid .+?; ([^;]+?)(?: build|\) applewebkit).+? mobile safari/i],[o,[c,u]],[/droid .+?;\s([^;]+?)(?: build|\) applewebkit).+?(?! mobile) safari/i],[o,[c,h]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,f.lowerize]],[/(android[\w\.\s\-]{0,9});.+build/i],[o,[l,"Generic"]],[/(phone)/i],[[c,u]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[d,[a,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[d,[a,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[a,d],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[d,a]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[a,d],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)(?!.+xbox)/i],[a,[d,g.str,m.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[a,"Windows"],[d,g.str,m.os.windows.version]],[/ip[honead]{2,4}\b(?:.*os\s([\w]+)\slike\smac|;\sopera)/i,/cfnetwork\/.+darwin/i],[[d,/_/g,"."],[a,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)(?!.+haiku)/i],[[a,"Mac OS"],[d,/_/g,"."]],[/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/\((series40);/i],[a,d],[/\(bb(10);/i],[d,[a,"BlackBerry"]],[/(?:symbian\s?os|symbos|s60(?=;)|series60)[\/\s-]?([\w\.]*)/i],[d,[a,"Symbian"]],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[a,"Firefox OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[d,[a,"webOS"]],[/crkey\/([\d\.]+)/i],[d,[a,"Chromecast"]],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[a,"Chromium OS"],d],[/(nintendo|playstation)\s([wids345portablevuch]+)/i,/(xbox);\s+xbox\s([^\);]+)/i,/(mint)[\/\s\(\)]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?=\slinux)|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus|raspbian)(?:\sgnu\/linux)?(?:\slinux)?[\/\s-]?(?!chrom|package)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i,/\s([frentopc-]{0,4}bsd|dragonfly)\s?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku)\s(\w+)/i],[a,d],[/(sunos)\s?([\w\.\d]*)/i],[[a,"Solaris"],d],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[a,d]]},b=function(e,t){if("object"==typeof e&&(t=e,e=void 0),!(this instanceof b))return new b(e,t).getResult();var n=e||(void 0!==r&&r.navigator&&r.navigator.userAgent?r.navigator.userAgent:""),i=t?f.extend(v,t):v;return this.getBrowser=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,n,i.browser),e.major=f.major(e.version),e},this.getCPU=function(){var e={architecture:void 0};return g.rgx.call(e,n,i.cpu),e},this.getDevice=function(){var e={vendor:void 0,model:void 0,type:void 0};return g.rgx.call(e,n,i.device),e},this.getEngine=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,n,i.engine),e},this.getOS=function(){var e={name:void 0,version:void 0};return g.rgx.call(e,n,i.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return n},this.setUA=function(e){return n="string"==typeof e&&e.length>255?f.trim(e,255):e,this},this.setUA(n),this};b.VERSION="0.7.28",b.BROWSER={NAME:a,MAJOR:"major",VERSION:d},b.CPU={ARCHITECTURE:"architecture"},b.DEVICE={MODEL:o,VENDOR:l,TYPE:c,CONSOLE:"console",MOBILE:u,SMARTTV:p,TABLET:h,WEARABLE:"wearable",EMBEDDED:"embedded"},b.ENGINE={NAME:a,VERSION:d},b.OS={NAME:a,VERSION:d},void 0!==t?(void 0!==e&&e.exports&&(t=e.exports=b),t.UAParser=b):void 0===(i=function(){return b}.call(t,n,t,e))||(e.exports=i);var S=void 0!==r&&(r.jQuery||r.Zepto);if(S&&!S.ua){var y=new b;S.ua=y.getResult(),S.ua.get=function(){return y.getUA()},S.ua.set=function(e){y.setUA(e);var t=y.getResult();for(var n in t)S.ua[n]=t[n]}}}("object"==typeof window?window:this)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={hash:"13ff6f2",raw:"v2.7.0",semverString:"2.7.0"}},function(e,t,n){"use strict";e.exports=n(203)},function(e,t,n){"use strict";var i=t;function r(){i.Reader._configure(i.BufferReader),i.util._configure()}i.build="minimal",i.Writer=n(110),i.BufferWriter=n(212),i.Reader=n(111),i.BufferReader=n(213),i.util=n(17),i.rpc=n(214),i.roots=n(216),i.configure=r,i.Writer._configure(i.BufferWriter),r()},function(e,t,n){"use strict";e.exports=function(e,t){var n=new Array(arguments.length-1),i=0,r=2,s=!0;for(;r<arguments.length;)n[i++]=arguments[r++];return new Promise((function(r,o){n[i]=function(e){if(s)if(s=!1,e)o(e);else{for(var t=new Array(arguments.length-1),n=0;n<t.length;)t[n++]=arguments[n];r.apply(null,t)}};try{e.apply(t||null,n)}catch(e){s&&(s=!1,o(e))}}))}},function(e,t,n){"use strict";var i=t;i.length=function(e){var t=e.length;if(!t)return 0;for(var n=0;--t%4>1&&"="===e.charAt(t);)++n;return Math.ceil(3*e.length)/4-n};for(var r=new Array(64),s=new Array(123),o=0;o<64;)s[r[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;i.encode=function(e,t,n){for(var i,s=null,o=[],a=0,c=0;t<n;){var l=e[t++];switch(c){case 0:o[a++]=r[l>>2],i=(3&l)<<4,c=1;break;case 1:o[a++]=r[i|l>>4],i=(15&l)<<2,c=2;break;case 2:o[a++]=r[i|l>>6],o[a++]=r[63&l],c=0}a>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,o)),a=0)}return c&&(o[a++]=r[i],o[a++]=61,1===c&&(o[a++]=61)),s?(a&&s.push(String.fromCharCode.apply(String,o.slice(0,a))),s.join("")):String.fromCharCode.apply(String,o.slice(0,a))};i.decode=function(e,t,n){for(var i,r=n,o=0,a=0;a<e.length;){var c=e.charCodeAt(a++);if(61===c&&o>1)break;if(void 0===(c=s[c]))throw Error("invalid encoding");switch(o){case 0:i=c,o=1;break;case 1:t[n++]=i<<2|(48&c)>>4,i=c,o=2;break;case 2:t[n++]=(15&i)<<4|(60&c)>>2,i=c,o=3;break;case 3:t[n++]=(3&i)<<6|c,o=0}}if(1===o)throw Error("invalid encoding");return n-r},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},function(e,t,n){"use strict";function i(){this._listeners={}}e.exports=i,i.prototype.on=function(e,t,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:n||this}),this},i.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===t?n.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,n)}return this}},function(e,t,n){"use strict";function i(e){return"undefined"!=typeof Float32Array?function(){var t=new Float32Array([-0]),n=new Uint8Array(t.buffer),i=128===n[3];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3]}function s(e,i,r){t[0]=e,i[r]=n[3],i[r+1]=n[2],i[r+2]=n[1],i[r+3]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],t[0]}function a(e,i){return n[3]=e[i],n[2]=e[i+1],n[1]=e[i+2],n[0]=e[i+3],t[0]}e.writeFloatLE=i?r:s,e.writeFloatBE=i?s:r,e.readFloatLE=i?o:a,e.readFloatBE=i?a:o}():function(){function t(e,t,n,i){var r=t<0?1:0;if(r&&(t=-t),0===t)e(1/t>0?0:2147483648,n,i);else if(isNaN(t))e(2143289344,n,i);else if(t>34028234663852886e22)e((r<<31|2139095040)>>>0,n,i);else if(t<11754943508222875e-54)e((r<<31|Math.round(t/1401298464324817e-60))>>>0,n,i);else{var s=Math.floor(Math.log(t)/Math.LN2);e((r<<31|s+127<<23|8388607&Math.round(t*Math.pow(2,-s)*8388608))>>>0,n,i)}}function n(e,t,n){var i=e(t,n),r=2*(i>>31)+1,s=i>>>23&255,o=8388607&i;return 255===s?o?NaN:r*(1/0):0===s?1401298464324817e-60*r*o:r*Math.pow(2,s-150)*(o+8388608)}e.writeFloatLE=t.bind(null,r),e.writeFloatBE=t.bind(null,s),e.readFloatLE=n.bind(null,o),e.readFloatBE=n.bind(null,a)}(),"undefined"!=typeof Float64Array?function(){var t=new Float64Array([-0]),n=new Uint8Array(t.buffer),i=128===n[7];function r(e,i,r){t[0]=e,i[r]=n[0],i[r+1]=n[1],i[r+2]=n[2],i[r+3]=n[3],i[r+4]=n[4],i[r+5]=n[5],i[r+6]=n[6],i[r+7]=n[7]}function s(e,i,r){t[0]=e,i[r]=n[7],i[r+1]=n[6],i[r+2]=n[5],i[r+3]=n[4],i[r+4]=n[3],i[r+5]=n[2],i[r+6]=n[1],i[r+7]=n[0]}function o(e,i){return n[0]=e[i],n[1]=e[i+1],n[2]=e[i+2],n[3]=e[i+3],n[4]=e[i+4],n[5]=e[i+5],n[6]=e[i+6],n[7]=e[i+7],t[0]}function a(e,i){return n[7]=e[i],n[6]=e[i+1],n[5]=e[i+2],n[4]=e[i+3],n[3]=e[i+4],n[2]=e[i+5],n[1]=e[i+6],n[0]=e[i+7],t[0]}e.writeDoubleLE=i?r:s,e.writeDoubleBE=i?s:r,e.readDoubleLE=i?o:a,e.readDoubleBE=i?a:o}():function(){function t(e,t,n,i,r,s){var o=i<0?1:0;if(o&&(i=-i),0===i)e(0,r,s+t),e(1/i>0?0:2147483648,r,s+n);else if(isNaN(i))e(0,r,s+t),e(2146959360,r,s+n);else if(i>17976931348623157e292)e(0,r,s+t),e((o<<31|2146435072)>>>0,r,s+n);else{var a;if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,r,s+t),e((o<<31|a/4294967296)>>>0,r,s+n);else{var c=Math.floor(Math.log(i)/Math.LN2);1024===c&&(c=1023),e(4503599627370496*(a=i*Math.pow(2,-c))>>>0,r,s+t),e((o<<31|c+1023<<20|1048576*a&1048575)>>>0,r,s+n)}}}function n(e,t,n,i,r){var s=e(i,r+t),o=e(i,r+n),a=2*(o>>31)+1,c=o>>>20&2047,l=4294967296*(1048575&o)+s;return 2047===c?l?NaN:a*(1/0):0===c?5e-324*a*l:a*Math.pow(2,c-1075)*(l+4503599627370496)}e.writeDoubleLE=t.bind(null,r,0,4),e.writeDoubleBE=t.bind(null,s,4,0),e.readDoubleLE=n.bind(null,o,0,4),e.readDoubleBE=n.bind(null,a,4,0)}(),e}function r(e,t,n){t[n]=255&e,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24}function s(e,t,n){t[n]=e>>>24,t[n+1]=e>>>16&255,t[n+2]=e>>>8&255,t[n+3]=255&e}function o(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function a(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}e.exports=i(i)},function(module,exports,__webpack_require__){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},function(e,t,n){"use strict";var i=t;i.length=function(e){for(var t=0,n=0,i=0;i<e.length;++i)(n=e.charCodeAt(i))<128?t+=1:n<2048?t+=2:55296==(64512&n)&&56320==(64512&e.charCodeAt(i+1))?(++i,t+=4):t+=3;return t},i.read=function(e,t,n){if(n-t<1)return"";for(var i,r=null,s=[],o=0;t<n;)(i=e[t++])<128?s[o++]=i:i>191&&i<224?s[o++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[o++]=55296+(i>>10),s[o++]=56320+(1023&i)):s[o++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],o>8191&&((r||(r=[])).push(String.fromCharCode.apply(String,s)),o=0);return r?(o&&r.push(String.fromCharCode.apply(String,s.slice(0,o))),r.join("")):String.fromCharCode.apply(String,s.slice(0,o))},i.write=function(e,t,n){for(var i,r,s=n,o=0;o<e.length;++o)(i=e.charCodeAt(o))<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296==(64512&i)&&56320==(64512&(r=e.charCodeAt(o+1)))?(i=65536+((1023&i)<<10)+(1023&r),++o,t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128);return n-s}},function(e,t,n){"use strict";e.exports=function(e,t,n){var i=n||8192,r=i>>>1,s=null,o=i;return function(n){if(n<1||n>r)return e(n);o+n>i&&(s=e(i),o=0);var a=t.call(s,o,o+=n);return 7&o&&(o=1+(7|o)),a}}},function(e,t,n){"use strict";e.exports=r;var i=n(17);function r(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=r.zero=new r(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var o=r.zeroHash="\0\0\0\0\0\0\0\0";r.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return t&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new r(n,i)},r.from=function(e){if("number"==typeof e)return r.fromNumber(e);if(i.isString(e)){if(!i.Long)return r.fromNumber(parseInt(e,10));e=i.Long.fromString(e)}return e.low||e.high?new r(e.low>>>0,e.high>>>0):s},r.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=1+~this.lo>>>0,n=~this.hi>>>0;return t||(n=n+1>>>0),-(t+4294967296*n)}return this.lo+4294967296*this.hi},r.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,Boolean(e)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(e)}};var a=String.prototype.charCodeAt;r.fromHash=function(e){return e===o?s:new r((a.call(e,0)|a.call(e,1)<<8|a.call(e,2)<<16|a.call(e,3)<<24)>>>0,(a.call(e,4)|a.call(e,5)<<8|a.call(e,6)<<16|a.call(e,7)<<24)>>>0)},r.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},r.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},r.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},r.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return 0===n?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:n<128?9:10}},function(e,t,n){"use strict";e.exports=o;var i=n(110);(o.prototype=Object.create(i.prototype)).constructor=o;var r=n(17),s=r.Buffer;function o(){i.call(this)}o.alloc=function(e){return(o.alloc=r._Buffer_allocUnsafe)(e)};var a=s&&s.prototype instanceof Uint8Array&&"set"===s.prototype.set.name?function(e,t,n){t.set(e,n)}:function(e,t,n){if(e.copy)e.copy(t,n,0,e.length);else for(var i=0;i<e.length;)t[n++]=e[i++]};function c(e,t,n){e.length<40?r.utf8.write(e,t,n):t.utf8Write(e,n)}o.prototype.bytes=function(e){r.isString(e)&&(e=r._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(a,t,e),this},o.prototype.string=function(e){var t=s.byteLength(e);return this.uint32(t),t&&this._push(c,t,e),this}},function(e,t,n){"use strict";e.exports=s;var i=n(111);(s.prototype=Object.create(i.prototype)).constructor=s;var r=n(17);function s(e){i.call(this,e)}r.Buffer&&(s.prototype._slice=r.Buffer.prototype.slice),s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len))}},function(e,t,n){"use strict";t.Service=n(215)},function(e,t,n){"use strict";e.exports=r;var i=n(17);function r(e,t,n){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=Boolean(t),this.responseDelimited=Boolean(n)}(r.prototype=Object.create(i.EventEmitter.prototype)).constructor=r,r.prototype.rpcCall=function e(t,n,r,s,o){if(!s)throw TypeError("request must be specified");var a=this;if(!o)return i.asPromise(e,a,t,n,r,s);if(a.rpcImpl)try{return a.rpcImpl(t,n[a.requestDelimited?"encodeDelimited":"encode"](s).finish(),(function(e,n){if(e)return a.emit("error",e,t),o(e);if(null!==n){if(!(n instanceof r))try{n=r[a.responseDelimited?"decodeDelimited":"decode"](n)}catch(e){return a.emit("error",e,t),o(e)}return a.emit("data",n,t),o(null,n)}a.end(!0)}))}catch(e){return a.emit("error",e,t),void setTimeout((function(){o(e)}),0)}else setTimeout((function(){o(Error("already ended"))}),0)},r.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},function(e,t,n){"use strict";e.exports={}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(50),s=n(7),o=n(46),a=n(48),c=n(4),l=n(57),d=n(76),u=n(77),h=n(78),p=n(79),f=n(80),g=n(81),m=n(82),v=n(83),b=n(84),S=n(159);class y{constructor(e,t,n=new S.default){this.logger=e,this.meetingSession=t,this.configuration=n,this.browserBehavior=new s.default}static delay(e){return i(this,void 0,void 0,(function*(){return new Promise(t=>setTimeout(t,e))}))}checkAudioInput(e){return i(this,void 0,void 0,(function*(){try{return yield this.meetingSession.audioVideo.chooseAudioInputDevice(e),yield this.meetingSession.audioVideo.chooseAudioInputDevice(null),u.default.Succeeded}catch(e){return this.logger.error("MeetingReadinessChecker: Audio input check failed with error "+e),e instanceof a.default?u.default.PermissionDenied:u.default.Failed}}))}checkAudioOutput(e,t,n=null){return i(this,void 0,void 0,(function*(){try{const i=e?o.default.getIntrinsicDeviceId(e):"";yield this.playTone(i,440,n);return(yield t())?h.default.Succeeded:h.default.Failed}catch(e){return this.logger.error("MeetingReadinessChecker: Audio output check failed with error: "+e),h.default.Failed}finally{this.stopTone()}}))}playTone(e,t,n){return i(this,void 0,void 0,(function*(){this.oscillatorNode&&this.stopTone(),this.audioContext=o.default.getAudioContext(),this.gainNode=this.audioContext.createGain(),this.gainNode.gain.value=0,this.oscillatorNode=this.audioContext.createOscillator(),this.oscillatorNode.frequency.value=t,this.oscillatorNode.connect(this.gainNode),this.destinationStream=this.audioContext.createMediaStreamDestination(),this.gainNode.connect(this.destinationStream);const i=this.audioContext.currentTime+.1;this.gainNode.gain.linearRampToValueAtTime(0,i),this.gainNode.gain.linearRampToValueAtTime(.1,i+.1),this.oscillatorNode.start();const s=new r.default(this.logger);try{this.browserBehavior.supportsSetSinkId()&&(yield s.bindAudioDevice({deviceId:e}))}catch(e){this.logger.error("Failed to bind audio device: "+e)}try{yield s.bindAudioElement(n||new Audio)}catch(e){this.logger.error("Failed to bind audio element: "+e)}yield s.bindAudioStream(this.destinationStream.stream)}))}stopTone(){if(!(this.audioContext&&this.gainNode&&this.oscillatorNode&&this.destinationStream))return;const e=this.audioContext.currentTime;this.gainNode.gain.linearRampToValueAtTime(.1,e+.1+1),this.gainNode.gain.linearRampToValueAtTime(0,e+.2+1),this.oscillatorNode.stop(),this.oscillatorNode.disconnect(this.gainNode),this.gainNode.disconnect(this.destinationStream),this.oscillatorNode=null,this.gainNode=null,this.destinationStream=null}checkVideoInput(e){return i(this,void 0,void 0,(function*(){try{return yield this.meetingSession.audioVideo.chooseVideoInputDevice(e),yield this.meetingSession.audioVideo.chooseVideoInputDevice(null),b.default.Succeeded}catch(e){return this.logger.error("MeetingReadinessChecker: Video check failed with error "+e),e instanceof a.default?b.default.PermissionDenied:b.default.Failed}}))}checkCameraResolution(e,t,n){return i(this,void 0,void 0,(function*(){let i;try{const r=o.default.getIntrinsicDeviceId(e),s={video:this.calculateVideoConstraint(r,t,n)};i=yield navigator.mediaDevices.getUserMedia(s)}catch(e){return this.logger.error(`MeetingReadinessChecker: Camera resolution check with width: ${t} height ${n} failed with error ${e}`),e&&"OverconstrainedError"===e.name?p.default.ResolutionNotSupported:e&&"NotAllowedError"===e.name?p.default.PermissionDenied:p.default.Failed}finally{i&&i.getTracks().forEach((function(e){e.stop()}))}return p.default.Succeeded}))}calculateVideoConstraint(e,t,n){const i=this.browserBehavior.requiresResolutionAlignment(t,n),r={};return this.browserBehavior.requiresNoExactMediaStreamConstraints()?(r.deviceId=e,r.width=t,r.height=n):(r.deviceId={exact:e},r.width={exact:i[0]},r.height={exact:i[1]}),r}checkContentShareConnectivity(e){return i(this,void 0,void 0,(function*(){let t=!1,n=!1;const r={contentShareDidStart:()=>{t=!0}},s={audioVideoDidStart:()=>{n=!0}};try{return this.meetingSession.audioVideo.addObserver(s),this.meetingSession.audioVideo.start(),this.meetingSession.audioVideo.addContentShareObserver(r),yield this.meetingSession.audioVideo.startContentShareFromScreenCapture(e),yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){return n&&t}))),n?(yield this.stopMeeting(),t?f.default.Succeeded:f.default.TimedOut):f.default.ConnectionFailed}catch(e){return this.logger.error("MeetingReadinessChecker: Content share check failed with error "+e),"NotAllowedError"===e.name?f.default.PermissionDenied:f.default.Failed}finally{this.meetingSession.audioVideo.removeObserver(s),this.meetingSession.audioVideo.stopContentShare(),this.meetingSession.audioVideo.removeContentShareObserver(r)}}))}checkAudioConnectivity(e){return i(this,void 0,void 0,(function*(){let t=!1;const n=this.meetingSession.audioVideo,r=(e,n,i,r)=>{e===this.meetingSession.configuration.credentials.attendeeId&&n&&(t=!0)};try{yield n.chooseAudioInputDevice(e)}catch(e){return this.logger.error("MeetingReadinessChecker: Failed to get audio input device with error "+e),e instanceof a.default?d.default.AudioInputPermissionDenied:d.default.AudioInputRequestFailed}if(n.realtimeSubscribeToAttendeeIdPresence(r),!(yield this.startMeeting())){n.realtimeUnsubscribeToAttendeeIdPresence(r);try{yield this.meetingSession.audioVideo.chooseAudioInputDevice(null)}catch(e){this.logger.error("MeetingReadinessChecker: Failed to choose null device with error "+e)}return d.default.ConnectionFailed}yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){return t}))),n.realtimeUnsubscribeToAttendeeIdPresence(r),yield this.stopMeeting();try{yield this.meetingSession.audioVideo.chooseAudioInputDevice(null)}catch(e){this.logger.error("MeetingReadinessChecker: Failed to choose null device with error "+e)}return t?d.default.Succeeded:d.default.AudioNotReceived}))}checkVideoConnectivity(e){return i(this,void 0,void 0,(function*(){const t=this.meetingSession.audioVideo;try{yield t.chooseVideoInputDevice(e)}catch(e){return this.logger.error("MeetingReadinessChecker: Failed to get video input device with error "+e),e instanceof a.default?v.default.VideoInputPermissionDenied:v.default.VideoInputRequestFailed}if(!(yield this.startMeeting()))return v.default.ConnectionFailed;let n=0;return t.startLocalVideoTile(),yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){const e=yield t.getRTCPeerConnectionStats();return e&&e.forEach(e=>{"outbound-rtp"===e.type&&"video"===e.mediaType&&(n=e.packetsSent)}),n>0}))),t.stopLocalVideoTile(),yield this.stopMeeting(),n<=0?v.default.VideoNotSent:v.default.Succeeded}))}checkNetworkUDPConnectivity(){return i(this,void 0,void 0,(function*(){try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error("MeetingSessionConfiguration.urls doesn't exist. Error: "+e),m.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{const t=this.originalURLRewriter(e);return t.includes("transport=tcp")?"":t};const e=this.meetingSession.audioVideo;if(!(yield this.startMeeting()))return this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,m.default.ConnectionFailed;let t=!1;return yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){const n=yield e.getRTCPeerConnectionStats();return n&&n.forEach(e=>{"candidate-pair"===e.type&&"succeeded"===e.state&&(t=!0)}),t}))),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),t?m.default.Succeeded:m.default.ICENegotiationFailed}))}checkNetworkTCPConnectivity(){return i(this,void 0,void 0,(function*(){try{this.originalURLRewriter=this.meetingSession.configuration.urls.urlRewriter}catch(e){return this.logger.error("MeetingSessionConfiguration.urls doesn't exist. Error: "+e),g.default.MeetingSessionURLsNotInitialized}this.meetingSession.configuration.urls.urlRewriter=e=>{const t=this.originalURLRewriter(e);return t.includes("transport=udp")?"":t};const e=this.meetingSession.audioVideo;if(!(yield this.startMeeting()))return this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,g.default.ConnectionFailed;let t=!1;return yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){const n=yield e.getRTCPeerConnectionStats();return n&&n.forEach(e=>{"candidate-pair"===e.type&&"succeeded"===e.state&&(t=!0)}),t}))),this.meetingSession.configuration.urls.urlRewriter=this.originalURLRewriter,yield this.stopMeeting(),t?g.default.Succeeded:g.default.ICENegotiationFailed}))}startMeeting(){return i(this,void 0,void 0,(function*(){let e=!1;const t={audioVideoDidStart:()=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.start(),yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){return e}))),this.meetingSession.audioVideo.removeObserver(t),e}))}stopMeeting(){return i(this,void 0,void 0,(function*(){let e=!1;const t={audioVideoDidStop:t=>{e=!0}};return this.meetingSession.audioVideo.addObserver(t),this.meetingSession.audioVideo.stop(),yield this.executeTimeoutTask(()=>i(this,void 0,void 0,(function*(){return e}))),this.meetingSession.audioVideo.removeObserver(t),e}))}executeTimeoutTask(e){return i(this,void 0,void 0,(function*(){let t=!1;class n extends c.default{constructor(e,t){super(e),this.waitDurationMs=t,this.isCancelled=!1}cancel(){this.isCancelled=!0}run(){return i(this,void 0,void 0,(function*(){for(;!this.isCancelled;){if(yield e()){t=!0;break}yield y.delay(this.waitDurationMs)}}))}}const r=new l.default(this.logger,new n(this.logger,this.configuration.waitDurationMs),this.configuration.timeoutMs);return yield r.run(),t}))}}t.default=y},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(51),s=n(157),o=n(21),a=n(7),c=n(90),l=n(158),d=n(160),u=n(37),h=n(38);class p{constructor(e,t,n){this._configuration=e,this._logger=t,this.checkBrowserSupportAndFeatureConfiguration(),this._deviceController=n,this.audioVideoController=new r.default(this._configuration,this._logger,new h.default(this._logger),n,new u.default(p.RECONNECT_TIMEOUT_MS,new o.default(p.RECONNECT_FIXED_WAIT_MS,p.RECONNECT_SHORT_BACKOFF_MS,p.RECONNECT_LONG_BACKOFF_MS))),n.bindToAudioVideoController(this.audioVideoController);const i=new c.default(this._logger);this.contentShareController=new l.default(i,new r.default(l.default.createContentShareMeetingSessionConfigure(this._configuration),this._logger,new h.default(this._logger),i,new u.default(p.RECONNECT_TIMEOUT_MS,new o.default(p.RECONNECT_FIXED_WAIT_MS,p.RECONNECT_SHORT_BACKOFF_MS,p.RECONNECT_LONG_BACKOFF_MS))),this.audioVideoController),this.audioVideoFacade=new s.default(this.audioVideoController,this.audioVideoController.videoTileController,this.audioVideoController.realtimeController,this.audioVideoController.audioMixController,this._deviceController,this.contentShareController)}get configuration(){return this._configuration}get logger(){return this._logger}get audioVideo(){return this.audioVideoFacade}get contentShare(){return this.contentShareController}get deviceController(){return this._deviceController}destroy(){return i(this,void 0,void 0,(function*(){d.isDestroyable(this.contentShareController)&&(yield this.contentShareController.destroy()),d.isDestroyable(this.audioVideoController)&&(yield this.audioVideoController.destroy()),this._logger=void 0,this._configuration=void 0,this._deviceController=void 0,this.audioVideoFacade=void 0,this.audioVideoController=void 0,this.contentShareController=void 0}))}checkBrowserSupportAndFeatureConfiguration(){const e=new a.default,t=`${e.name()} ${e.majorVersion()} (${e.version()})`;this.logger.info("browser is "+t),e.isSupported()||this.logger.warn(`this browser is not currently supported. Stability may suffer. Supported browsers are: ${e.supportString()}.`),this._configuration.enableUnifiedPlanForChromiumBasedBrowsers&&(e.hasChromiumWebRTC()?this.logger.info("WebRTC unified plan for Chromium-based browsers is enabled"):this.logger.info("WebRTC unified plan is required for "+e.name())),this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers&&(this._configuration.enableUnifiedPlanForChromiumBasedBrowsers?e.hasChromiumWebRTC()?this.logger.info("Simulcast is enabled for "+e.name()):(this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.logger.info("Simulcast requires WebRTC Unified Plan and is only supported on Chromium-based browsers")):(this._configuration.enableSimulcastForUnifiedPlanChromiumBasedBrowsers=!1,this.logger.info("Simulcast requires enabling WebRTC Unified Plan for Chromium-based browsers")))}}t.default=p,p.RECONNECT_TIMEOUT_MS=12e4,p.RECONNECT_FIXED_WAIT_MS=0,p.RECONNECT_SHORT_BACKOFF_MS=1e3,p.RECONNECT_LONG_BACKOFF_MS=5e3},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(21),s=n(161),o=n(37),a=n(11),c=n(162),l=n(38),d=n(35);t.default=class{constructor(e,t,n,i,s){this.configuration=e,this.logger=t,this.webSocket=n,this.reconnectController=i,this.sigV4=s,this.observerQueue=new Set,this.webSocket||(this.webSocket=new l.default(this.logger)),this.reconnectController||(this.reconnectController=new o.default(e.reconnectTimeoutMs,new r.default(e.reconnectFixedWaitMs,e.reconnectShortBackoffMs,e.reconnectLongBackoffMs))),this.sigV4||(this.sigV4=new c.default(this.configuration.chimeClient,this.configuration.awsClient))}addObserver(e){this.logger.info("adding messaging observer"),this.observerQueue.add(e)}removeObserver(e){this.logger.info("removing messaging observer"),this.observerQueue.delete(e)}start(){this.isClosed()?this.startConnecting(!1):this.logger.info("messaging session already started")}stop(){this.isClosed()?this.logger.info("no existing connection needs closing"):(this.isClosing=!0,this.webSocket.close())}forEachObserver(e){for(const t of this.observerQueue)a.default.nextTick(()=>{this.observerQueue.has(t)&&e(t)})}setUpEventListeners(){this.webSocket.addEventListener("open",()=>{this.openEventHandler()}),this.webSocket.addEventListener("message",e=>{this.receiveMessageHandler(e.data)}),this.webSocket.addEventListener("close",e=>{this.closeEventHandler(e)}),this.webSocket.addEventListener("error",()=>{this.logger.error("WebSocket error")})}startConnecting(e){const t=this.prepareWebSocketUrl();this.logger.info("opening connection to "+t),e||this.reconnectController.reset(),this.reconnectController.hasStartedConnectionAttempt()?this.reconnectController.startedConnectionAttempt(!1):this.reconnectController.startedConnectionAttempt(!0),this.webSocket.create(t,[],!0),this.forEachObserver(t=>{t.messagingSessionDidStartConnecting&&t.messagingSessionDidStartConnecting(e)}),this.setUpEventListeners()}prepareWebSocketUrl(){const e=new Map;return e.set("userArn",[this.configuration.userArn]),e.set("sessionId",[this.configuration.messagingSessionId]),this.sigV4.signURL("GET","wss","chime",this.configuration.endpointUrl,"/connect","",e)}isClosed(){return this.webSocket.readyState()===d.default.None||this.webSocket.readyState()===d.default.Closed}openEventHandler(){this.reconnectController.reset(),this.isFirstMessageReceived=!1}receiveMessageHandler(e){try{const t=JSON.parse(e),n=t.Headers["x-amz-chime-event-type"],i=new s.default(n,t.Headers,t.Payload||null);this.isFirstMessageReceived||(this.forEachObserver(e=>{e.messagingSessionDidStart&&e.messagingSessionDidStart()}),this.isFirstMessageReceived=!0),this.forEachObserver(e=>{e.messagingSessionDidReceiveMessage&&e.messagingSessionDidReceiveMessage(i)})}catch(e){this.logger.error("Messaging parsing failed: "+e)}}closeEventHandler(e){this.logger.info(`WebSocket close: ${e.code} ${e.reason}`),this.webSocket.destroy(),!this.isClosing&&this.canReconnect(e.code)&&this.reconnectController.retryWithBackoff(()=>i(this,void 0,void 0,(function*(){this.startConnecting(!0)})),null)||(this.isClosing=!1,this.isFirstMessageReceived&&this.forEachObserver(t=>{t.messagingSessionDidStop&&t.messagingSessionDidStop(e)}))}canReconnect(e){return 1001===e||1006===e||e>=1011&&e<=1014||e>4e3&&4002!==e&&4003!==e&&4401!==e}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(7),s=n(163);class o{constructor(e,t,n,i=new r.default){this.logger=e,this.device=t,this.processors=n,this.browserBehavior=i,this.observers=new Set,this.pipe=new s.default(this.logger,this.processors),this.pipe.addObserver(this)}get outputMediaStream(){return this.pipe.outputMediaStream}chooseNewInnerDevice(e){const t=new o(this.logger,e,this.processors,this.browserBehavior);return t.pipe=this.pipe,t}getInnerDevice(){return this.device}intrinsicDevice(){return i(this,void 0,void 0,(function*(){const e={};return this.device?"string"==typeof this.device?(this.browserBehavior.requiresNoExactMediaStreamConstraints()?e.deviceId=this.device:e.deviceId={exact:this.device},e):this.device.id?this.device:Object.assign(Object.assign({},this.device),e):e}))}transformStream(e){return i(this,void 0,void 0,(function*(){return yield this.pipe.setInputMediaStream(e),this.inputMediaStream=e,this.pipe.getActiveOutputMediaStream()}))}onOutputStreamDisconnect(){this.logger.info("DefaultVideoTransformDevice: detach stopping input media stream");const e=this.device&&this.device.id;if(this.pipe.stop(),!e&&this.inputMediaStream)for(const e of this.inputMediaStream.getVideoTracks())e.stop()}stop(){return i(this,void 0,void 0,(function*(){if(this.inputMediaStream)for(const e of this.inputMediaStream.getVideoTracks())e.stop();this.pipe.destroy(),this.inputMediaStream=null}))}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.add(e)}processingDidStart(){this.logger.info("video transform device processing started"),this.forEachObserver(e=>{e.processingDidStart&&e.processingDidStart()})}processingLatencyTooHigh(e){this.forEachObserver(t=>{t.processingLatencyTooHigh&&t.processingLatencyTooHigh(e)})}processingDidFailToStart(){this.logger.info("video transform device processing failed to start"),this.forEachObserver(e=>{e.processingDidFailToStart&&e.processingDidFailToStart()})}processingDidStop(){this.logger.info("video transform device processing stopped"),this.forEachObserver(e=>{e.processingDidStop&&e.processingDidStop()})}forEachObserver(e){for(const t of this.observers)setTimeout(()=>{e(t)},0)}}t.default=o},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(21),r=n(164);t.default=class{constructor(e,t,n){this.fixedWaitMs=e,this.shortBackoffMs=t,this.longBackoffMs=n}create(){return new i.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs)}createWithLimit(e){return new r.default(this.fixedWaitMs,this.shortBackoffMs,this.longBackoffMs,e)}}},function(e,t,n){"use strict";(function(e){var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(19),s=n(14),o=n(165);t.default=class{constructor(e,t,n,i,s,o=r.default.WARN){this.name=e,this.configuration=t,this.batchSize=n,this.intervalMs=i,this.url=s,this.level=o,this.logCapture=[],this.sequenceNumber=0,this.lock=!1,this.startLogPublishScheduler(this.batchSize),this.eventListener=()=>{this.stop()},this.addEventListener()}addEventListener(){this.eventListener&&"window"in e&&window.addEventListener&&window.addEventListener("unload",this.eventListener)}removeEventListener(){this.eventListener&&"window"in e&&window.removeEventListener&&window.removeEventListener("unload",this.eventListener)}debug(e){r.default.DEBUG<this.level||("string"==typeof e?this.log(r.default.DEBUG,e):e?this.log(r.default.DEBUG,e()):this.log(r.default.DEBUG,""+e))}info(e){this.log(r.default.INFO,e)}warn(e){this.log(r.default.WARN,e)}error(e){this.log(r.default.ERROR,e)}setLogLevel(e){this.level=e}getLogLevel(){return this.level}getLogCaptureSize(){return this.logCapture.length}startLogPublishScheduler(e){var t;this.addEventListener(),null===(t=this.intervalScheduler)||void 0===t||t.stop(),this.intervalScheduler=new s.default(this.intervalMs),this.intervalScheduler.start(()=>i(this,void 0,void 0,(function*(){if(!0===this.lock||0===this.getLogCaptureSize())return;this.lock=!0;const t=this.logCapture.slice(0,e),n=this.makeRequestBody(t);try{200===(yield fetch(this.url,{method:"POST",body:n})).status&&(this.logCapture=this.logCapture.slice(t.length))}catch(e){console.warn("[MeetingSessionPOSTLogger] "+e.message)}finally{this.lock=!1}})))}stop(){var e;null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.removeEventListener();const t=this.makeRequestBody(this.logCapture);navigator.sendBeacon(this.url,t)}destroy(){var e;return i(this,void 0,void 0,(function*(){null===(e=this.intervalScheduler)||void 0===e||e.stop(),this.intervalScheduler=void 0,this.removeEventListener(),this.configuration=void 0,this.logCapture=[]}))}makeRequestBody(e){return JSON.stringify({meetingId:this.configuration.meetingId,attendeeId:this.configuration.credentials.attendeeId,appName:this.name,logs:e})}log(e,t){if(e<this.level)return;const n=Date.now();this.logCapture.push(new o.default(this.sequenceNumber,t,n,r.default[e])),this.sequenceNumber+=1}}}).call(this,n(13))},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e,t,n,i,r){this.userArn=e,this.messagingSessionId=t,this.endpointUrl=n,this.chimeClient=i,this.awsClient=r,this.reconnectTimeoutMs=1e4,this.reconnectFixedWaitMs=0,this.reconnectShortBackoffMs=1e3,this.reconnectLongBackoffMs=5e3,this.messagingSessionId||(this.messagingSessionId=this.generateSessionId())}generateSessionId(){const e=new Uint32Array(1);return window.crypto.getRandomValues(e)[0].toString()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(19);t.default=class{constructor(...e){this._loggers=e}info(e){for(const t of this._loggers)t.info(e)}warn(e){for(const t of this._loggers)t.warn(e)}error(e){for(const t of this._loggers)t.error(e)}debug(e){let t,n;n="string"==typeof e?e:e?()=>(t||(t=e()),t):""+e;for(const e of this._loggers)e.debug(n)}setLogLevel(e){for(const t of this._loggers)t.setLogLevel(e)}getLogLevel(){for(const e of this._loggers)return e.getLogLevel();return i.default.OFF}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(21),r=n(166),s=n(65),o=n(63),a=n(36),c=n(64),l=n(37),d=n(38),u=n(51);class h extends u.default{constructor(e){const t=new o.default;t.meetingId="",t.externalMeetingId="",t.credentials=new a.default,t.credentials.attendeeId="",t.credentials.joinToken="",t.urls=new c.default,t.urls.turnControlURL="",t.urls.audioHostURL="",t.urls.screenViewingURL="",t.urls.screenDataURL="",t.urls.screenSharingURL="wss://localhost/",t.urls.signalingURL="wss://localhost/",super(e||t,new r.default,new d.default(new r.default),new s.default,new l.default(0,new i.default(0,0,0)))}setAudioProfile(e){}start(){}stop(){}}t.default=h},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.DestroyableNoOpDeviceController=void 0;const r=n(65);class s extends r.default{constructor(e){super()}listAudioInputDevices(){return Promise.resolve([])}listVideoInputDevices(){return Promise.resolve([])}listAudioOutputDevices(){return Promise.resolve([])}chooseAudioInputDevice(e){return Promise.reject()}chooseVideoInputDevice(e){return Promise.reject()}chooseAudioOutputDevice(e){return Promise.reject()}addDeviceChangeObserver(e){}removeDeviceChangeObserver(e){}createAnalyserNodeForAudioInput(){return null}startVideoPreviewForVideoInput(e){}stopVideoPreviewForVideoInput(e){}setDeviceLabelTrigger(e){}mixIntoAudioInput(e){return null}chooseVideoInputQuality(e,t,n,i){}getVideoInputQualitySettings(){return null}}t.default=s;t.DestroyableNoOpDeviceController=class extends s{constructor(){super(...arguments),this.destroyed=!1}destroy(){return i(this,void 0,void 0,(function*(){this.destroyed=!0}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{cancel(){}name(){return"NoOpTask"}run(){}setParent(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{create(){return{clientWidth:400,clientHeight:300,width:400,height:300,videoWidth:400,videoHeight:300,style:{transform:""},hasAttribute:()=>!1,removeAttribute:()=>{},setAttribute:()=>{},srcObject:!1,pause:()=>{},play:()=>Promise.resolve()}}}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{process(e){return i(this,void 0,void 0,(function*(){return e}))}destroy(){return i(this,void 0,void 0,(function*(){}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(18);t.default=class{reset(){}updateIndex(e){}updateMetrics(e){}wantsResubscribe(){return!1}chooseSubscriptions(){return new i.default}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(25);t.default=class{constructor(){}updateConnectionMetric(e){}chooseMediaTrackConstraints(){return{}}chooseEncodingParameters(){return new Map}updateIndex(e){}wantsResubscribe(){return!1}chooseCaptureAndEncodeParameters(){return new i.default(0,0,0,0,!1)}maxBandwidthKbps(){return 0}setIdealMaxBandwidthKbps(e){}setHasBandwidthPriority(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.attendeeIndex=null,this.attendeesInFrame=null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const i=n(4);class r extends i.default{constructor(e,t,n="RunnableTask"){super(e),this.fn=t,this.taskName=n}run(){return this.fn().then(()=>{})}}t.default=r},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.inner=e}mute(e){return i(this,void 0,void 0,(function*(){}))}stop(){var e;return i(this,void 0,void 0,(function*(){null===(e=this.node)||void 0===e||e.disconnect()}))}intrinsicDevice(){return i(this,void 0,void 0,(function*(){return this.inner}))}createAudioNode(e){var t;return i(this,void 0,void 0,(function*(){return null===(t=this.node)||void 0===t||t.disconnect(),this.node=yield this.createSingleAudioNode(e),{start:this.node,end:this.node}}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{}},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.VoiceFocusDeviceTransformer=void 0;const r=n(237),s=n(16),o=n(242),a=n(169),c=n(243);class l{constructor(e,{preload:t=!0,logger:n,fetchBehavior:i=l.defaultFetchBehavior()},r){this.spec=e,this.supported=!0,this.logger=n,this.vfLogger=n?new o.default(n):void 0,this.preload=t,this.fetchBehavior=i,this.spec=l.augmentSpec(this.spec),r&&(this.configuration=Promise.resolve(r))}static isSupported(e,t){const n={fetchBehavior:l.defaultFetchBehavior(),logger:(null==t?void 0:t.logger)?new o.default(t.logger):void 0};return r.VoiceFocus.isSupported(l.augmentSpec(e),n)}static create(e={},t={},n){return i(this,void 0,void 0,(function*(){const i=new l(e,t,n);return yield i.init(),i}))}static configure(e={},t={}){return i(this,void 0,void 0,(function*(){return new l(e,t,void 0).configure(!0)}))}getConfiguration(){return this.configuration}isSupported(){return this.supported}createTransformDevice(e,t){return i(this,void 0,void 0,(function*(){if(this.supported)try{const n=!0,[i,r]=yield this.allocateVoiceFocus(n);return new a.default(e,i,r,t)}catch(e){return}}))}static augmentSpec(e){return e&&(e.assetGroup||e.revisionID)?e:Object.assign(Object.assign({},e),{assetGroup:l.currentSDKAssetGroup()})}configure(e=!1){return i(this,void 0,void 0,(function*(){const t={fetchBehavior:this.fetchBehavior,preResolve:e,logger:this.vfLogger};return r.VoiceFocus.configure(this.spec,t)}))}init(){var e;return i(this,void 0,void 0,(function*(){this.configuration||(this.configuration=this.configure());const t=yield this.configuration;if(t.supported){this.pendingVoiceFocus=this.createVoiceFocus(t,this.preload);try{yield this.pendingVoiceFocus}catch(t){null===(e=this.logger)||void 0===e||e.error("Unable to initialize Amazon Voice Focus: "+t),this.supported=!1}}else this.supported=!1}))}createVoiceFocus(e,t){return i(this,void 0,void 0,(function*(){const n=new c.default;return[yield r.VoiceFocus.init(e,{delegate:n,preload:t,logger:this.vfLogger}),n]}))}allocateVoiceFocus(e){return i(this,void 0,void 0,(function*(){if(!this.supported)throw new Error("Not supported.");if(this.pendingVoiceFocus){const e=this.pendingVoiceFocus;return this.pendingVoiceFocus=void 0,e}return this.createVoiceFocus(yield this.configuration,e)}))}static majorVersion(){return s.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|[1-9][0-9]*)/)[0]}static majorMinorVersion(){return s.default.sdkVersion.match(/^[1-9][0-9]*\.(?:0|(?:[1-9][0-9]*))\.(?:0|[1-9][0-9]*)/)[0]}static currentSDKAssetGroup(){const e=this.majorVersion();return e?"sdk-"+e:"stable-v1"}static defaultFetchBehavior(){const e=l.majorMinorVersion()||"unknown",t=s.default.sdkUserAgentLowResolution;return{escapedQueryString:`sdk=${encodeURIComponent(e)}&ua=${encodeURIComponent(t)}`}}}t.VoiceFocusDeviceTransformer=l,t.default=l},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.getAudioInput=t.createAudioContext=t.VoiceFocus=void 0;const r=n(238),s=n(168),o=n(66),a=n(26),c=n(239),l=n(240),d=n(241),u={useVoiceFocusAGC:!1,useBuiltInAGC:!0},h="stable-v1",p="https://static.sdkassets.chime.aws/",f={processors:p+"processors/",workers:p+"workers/",wasm:p+"wasm/",models:p+"wasm/"},g={latencyHint:0},m={channelCount:1,echoCancellation:!0,googEchoCancellation:!0,noiseSuppression:!1,googNoiseSuppression:!1,googHighpassFilter:!1,googTypingNoiseDetection:!1},v=Object.assign(Object.assign({},m),{autoGainControl:!0,googAutoGainControl:!0,googAutoGainControl2:!0}),b=Object.assign(Object.assign({},m),{autoGainControl:!1,googAutoGainControl:!1,googAutoGainControl2:!1}),S={"voicefocus-worker-sab-processor":{file:"worklet-worker-sab-processor-v1.js",node:l.default},"voicefocus-worker-postMessage-processor":{file:"worklet-worker-postMessage-processor-v1.js",node:d.default},"voicefocus-inline-processor":{file:"worklet-inline-processor-v1.js",node:c.default}},y=(e,t)=>{if(void 0!==e&&!s.isValidAssetGroup(e))throw new Error("Invalid asset group "+e);if(void 0!==t&&!s.isValidRevisionID(t))throw new Error("Invalid revision ID "+t)},C=(e,t)=>`${t.models}${r.decideModel(e)}.wasm`;class w{constructor(e,t,n,i,r){this.processorURL=t,this.nodeConstructor=n,this.nodeOptions=i,this.executionQuanta=r,this.internal={worker:e,nodeOptions:i}}static isSupported(e,t){const{fetchBehavior:n,logger:i}=t||{};if("undefined"==typeof globalThis)return null==i||i.debug("Browser does not have globalThis."),Promise.resolve(!1);if(!a.supportsAudioWorklet(globalThis,i))return null==i||i.debug("Browser does not support Audio Worklet."),Promise.resolve(!1);if(!a.supportsWASM(globalThis,i))return null==i||i.debug("Browser does not support WASM."),Promise.resolve(!1);a.supportsWASMStreaming(globalThis,i)||null==i||i.debug("Browser does not support streaming WASM compilation.");const{assetGroup:r=h,revisionID:o,paths:c=f}=e||{};y(r,o);const l=o?{revisionID:o}:{assetGroup:r},d=s.addQueryParams(n,l),u=Object.assign(Object.assign({},d),{paths:c});return a.supportsVoiceFocusWorker(globalThis,u,i)}static mungeExecutionPreference(e,t){const n=void 0===e||"auto"===e;if(a.isSafari(globalThis)){if(n||"inline"===e)return"inline";if(!n)throw new Error("Unsupported execution preference "+e)}if("worker-sab"===e&&!a.supportsSharedArrayBuffer(globalThis,globalThis,t))throw new Error("Unsupported execution preference "+e);return e||"auto"}static configure(e,t){return i(this,void 0,void 0,(function*(){const{fetchBehavior:n,preResolve:i,logger:o}=t||{},{category:a="voicefocus",name:c="default",variant:l="auto",assetGroup:d=h,revisionID:u,simd:p="detect",executionPreference:g="auto",executionQuantaPreference:m,usagePreference:v="interactivity",estimatorBudget:b=100,paths:S=f,thresholds:w}=e||{};if(null==o||o.debug("Configuring Voice Focus with spec",e),void 0!==a&&"voicefocus"!==a)throw new Error("Unrecognized category "+a);if(void 0!==c&&"default"!==c)throw new Error("Unrecognized feature name "+c);if(void 0!==l&&!["auto","c100","c50","c20","c10"].includes(l))throw new Error("Unrecognized feature variant "+l);if(void 0!==m&&![1,2,3].includes(m))throw new Error("Unrecognized execution quanta preference "+m);if(y(d,u),void 0!==p&&!["detect","force","disable"].includes(p))throw new Error("Unrecognized SIMD option "+p);if(void 0!==g&&!["auto","inline","worker","worker-sab","worker-postMessage"].includes(g))throw new Error("Unrecognized execution preference "+g);if(void 0!==v&&!["quality","interactivity"].includes(v))throw new Error("Unrecognized usage preference "+v);const _={executionPreference:this.mungeExecutionPreference(g,o),usagePreference:v,executionQuantaPreference:m,variantPreference:l,simdPreference:p,estimatorBudget:b},A=u?{revisionID:u}:{assetGroup:d},k=s.addQueryParams(n,A),T=Object.assign({paths:S},k),I=yield r.measureAndDecideExecutionApproach(_,T,o,w);if(!1===I.supported)return{supported:!1,reason:I.reason};null==o||o.info("Decided execution approach",I);const{useSIMD:O,processor:E,variant:x,executionQuanta:P}=I,M={category:a||"voicefocus",name:c||"default",variant:x,simd:O};if(i){const e=C(M,S);M.url=yield s.resolveURL(e,k)}return{fetchConfig:T,model:M,processor:E,executionQuanta:P,supported:!0}}))}static init(e,{delegate:t,preload:n=!0,logger:r}){return i(this,void 0,void 0,(function*(){if(!1===e.supported)throw new Error("Voice Focus not supported. Reason: "+e.reason);const{model:i,processor:s,fetchConfig:c,executionQuanta:l}=e,{simd:d}=i,{paths:u}=c;if("voicefocus-inline-processor"!==s&&"voicefocus-worker-postMessage-processor"!==s&&"voicefocus-worker-sab-processor"!==s)throw new Error("Unknown processor "+s);const h=i.url||C(i,u);null==r||r.debug(`Using model URL ${h}.`);const p=`${u.wasm}audio_buffer-v1${d?"_simd":""}.wasm`,f=`${u.wasm}resampler-v1${d?"_simd":""}.wasm`,g=u.workers+"worker-v1.js",{file:m,node:v}=S[s],b=`${u.processors}${m}`,y=yield o.loadWorker(g,"VoiceFocusWorker",c,r);if(n){null==r||r.debug("Preloading",h);let e=a.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";y.postMessage({message:e,preload:!0,key:"model",fetchBehavior:c,path:h})}const _=new w(y,b,v,{processor:s,worker:y,audioBufferURL:p,resamplerURL:f,fetchBehavior:c,modelURL:h,delegate:t},l);return Promise.resolve(_)}))}createNode(e,t){var n;const{voiceFocusSampleRate:i=(16e3===e.sampleRate?16e3:48e3),enabled:r=!0,agc:o=u}=t||{},a={voiceFocusSampleRate:i,enabled:r,sendBufferCount:10,prefill:6,agc:o,executionQuanta:this.executionQuanta},c=s.withQueryString(this.processorURL,null===(n=this.nodeOptions)||void 0===n?void 0:n.fetchBehavior);return e.audioWorklet.addModule(c).then(()=>new this.nodeConstructor(e,Object.assign(Object.assign({},this.nodeOptions),{processorOptions:a})))}applyToStream(e,t,n){return i(this,void 0,void 0,(function*(){const i=t.createMediaStreamSource(e),r=yield this.applyToSourceNode(i,t,n),s=t.createMediaStreamDestination();return r.connect(s),{node:r,source:i,destination:s,stream:s.stream}}))}applyToSourceNode(e,t,n){return i(this,void 0,void 0,(function*(){const i=yield this.createNode(t,n);return e.connect(i),i}))}}t.VoiceFocus=w;t.createAudioContext=(e=g)=>new(window.AudioContext||window.webkitAudioContext)(e);t.getAudioInput=(e,t,n)=>i(void 0,void 0,void 0,(function*(){var i,r;const{constraints:s,spec:o,delegate:a,preload:c=!0,options:l}=t,{logger:d}=n,h=yield w.configure(o,n);if(!h.supported)return null===(i=n.logger)||void 0===i||i.warn("Voice Focus not supported; returning standard stream."),window.navigator.mediaDevices.getUserMedia(s);const p=yield w.init(h,{delegate:a,preload:c,logger:d}),f=(null===(r=t.options)||void 0===r?void 0:r.agc)||u,g=yield window.navigator.mediaDevices.getUserMedia(((e,t)=>{let n;if(n=t.useBuiltInAGC?v:b,!e)return{audio:n};if(!e.audio)return e;if(e.video)throw new Error("Not adding Voice Focus to multi-device getUserMedia call.");return Object.assign(Object.assign({},e),{audio:!0===e.audio?n:Object.assign(Object.assign({},e.audio),n)})})(s,f));return p.applyToStream(g,e,l).then(e=>e.stream)}))},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.decideModel=t.measureAndDecideExecutionApproach=void 0;const r=n(66),s=n(26),o={wasm:{noSupport:.07,inline:{c100:1,c50:.36,c20:.16,c10:.07},worker:{c100:.5,c50:.18,c20:.08,c10:.06}},simd:{noSupport:.1,inline:{c100:1,c50:.43,c20:.3,c10:.2},worker:{c100:.5,c50:.21,c20:.15,c10:.1}}};class a{constructor(e,t){this.fetchConfig=e,this.logger=t;const n=e.paths.workers+"estimator-v1.js";this.fetchBehavior={headers:e.headers,escapedQueryString:e.escapedQueryString},this.worker=r.loadWorker(n,"VoiceFocusEstimator",this.fetchBehavior,t)}roundtrip(e,t,n){return new Promise((i,r)=>{this.worker.then(r=>{let s;s=e=>{const{message:o,key:a}=e.data;o===t&&a===n&&(r.removeEventListener("message",s),i(e.data))},r.addEventListener("message",s),r.postMessage(e)}).catch(e=>{var t;null===(t=this.logger)||void 0===t||t.error("Failed to load worker.",e),r(e)})})}supportsSIMD(e){const t=e||this.fetchConfig.paths.wasm+"simd-v1.wasm",n={message:"supports-simd",fetchBehavior:this.fetchBehavior,path:t,key:"simd"};return this.roundtrip(n,"simd-support","simd").then(e=>e.supports)}measure(e,t){const n=this.fetchConfig.paths.wasm+"bench-v1.wasm",i=this.fetchConfig.paths.wasm+"bench-v1_simd.wasm",r=e?i:n,s="bench:"+e,o={message:"measure",fetchBehavior:this.fetchBehavior,budget:t,path:r,key:s};return this.roundtrip(o,"measurement",s).then(e=>{if(e.measurement)return e.measurement;throw new Error("Failed to measure.")})}stop(){this.worker.then(e=>{var t;null===(t=this.logger)||void 0===t||t.debug("Stopping estimator worker."),e.terminate()}).catch(e=>{})}}const c=(e,t,n,r)=>i(void 0,void 0,void 0,(function*(){const i={supportsSIMD:e,supportsSAB:s.supportsSharedArrayBuffer(globalThis,window,n),duration:-1};if(e)return null==n||n.info("Supports SIMD: true (force)"),i;const o=!r,c=r||new a(t,n);try{const t=!s.isOldChrome(window,n)&&(yield c.supportsSIMD());return null==n||n.info(`Supports SIMD: ${t} (force: ${e})`),i.supportsSIMD=t,i}finally{o&&c.stop()}}));t.measureAndDecideExecutionApproach=(e,t,n,r=o)=>i(void 0,void 0,void 0,(function*(){let l=e.executionPreference;const{usagePreference:d,variantPreference:u,simdPreference:h,estimatorBudget:p,executionQuantaPreference:f}=e;"interactivity"===d&&"inline"!==l&&(null==n||n.debug(`Overriding execution preference ${l} to reflect interactivity preference.`),l="inline");const g="force"===h,m="auto"!==u,v="auto"!==l;let b;try{b=m&&v?yield c(g,t,n):yield((e,t,n,r)=>i(void 0,void 0,void 0,(function*(){const i=new a(t,r);try{const s=yield c(e,t,r,i);if(s.supportsSIMD)try{return s.duration=yield i.measure(!0,n),null==r||r.info("SIMD timing:",s.duration),s}catch(e){null==r||r.warn("Failed SIMD estimation; falling back to non-SIMD."),s.supportsSIMD=!1}return s.duration=yield i.measure(!1,n),null==r||r.info("No-SIMD timing:",s.duration),s}catch(e){throw null==r||r.error("Could not feature check.",e),e}finally{i.stop()}})))(g,t,p,n)}catch(e){throw null==n||n.error("Could not load estimator.",e),new Error("Could not load Voice Focus estimator.")}return(({supportsSIMD:e,supportsSAB:t,duration:n,executionPreference:i="auto",simdPreference:r,variantPreference:a="auto",usagePreference:c,executionQuantaPreference:l=3},d=o,u)=>{const h="force"===r||"disable"!==r&&e,p=-1!==n,f=p?(h?2.5:2.63)/n:0,g=h?d.simd:d.wasm,m=p?((e,t)=>1===e?.6:"quality"===t?.65*e:.5*e)(l,c)*f:0,v=p?.7*f:0,b=e=>({supported:!1,reason:e});if(p){if(f<g.noSupport)return b(`Performance score ${f} worse than threshold ${g.noSupport}.`)}else if("auto"===i||"auto"===a)return b(`Missing explicit execution (${i}) or variant (${a}) preference, but no scoring performed.`);null==u||u.debug(`Bench duration ${n} yields inline score ${m} and worker score ${v}.`);const S=(e,t,n)=>({supported:!0,useSIMD:h,processor:e,executionApproach:t,variant:n,executionQuanta:"inline"===t?l:void 0}),y=(e,t,n)=>"auto"!==t?!p||e>n[t]?t:"failed":e>n.c100?"c100":e>n.c50?"c50":e>n.c20?"c20":e>n.c10?"c10":"failed",C=e=>{switch(e||"auto"){case"auto":{let e=C("inline"),t=C("worker");return null==u||u.debug(`Reducing auto preference: ${JSON.stringify(e)} vs ${JSON.stringify(t)}`),!1===e.supported||!1===t.supported?t:e.variant===t.variant||"c50"===e.variant?e:t}case"worker":return s.supportsSharedArrayBuffer(globalThis,window,u)?C("worker-sab"):C("worker-postMessage");case"inline":{const e=y(m,a,g.inline);return"failed"===e?b(`Performance score ${m} not sufficient for inline use with variant preference ${a}.`):S("voicefocus-inline-processor","inline",e)}case"worker-sab":{if(!t){const e="Requested worker-sab but no SharedArrayBuffer support.";return null==u||u.warn(e),{supported:!1,reason:e}}const e=y(v,a,g.worker);return"failed"===e?b(`Performance score ${v} not sufficient for worker use with variant preference ${a}.`):S("voicefocus-worker-sab-processor","worker-sab",e)}case"worker-postMessage":{const e=y(v,a,g.worker);return"failed"===e?b(`Performance score ${v} not sufficient for worker use.`):S("voicefocus-worker-postMessage-processor","worker-postMessage",e)}}};return C(i)})(Object.assign(Object.assign({},b),{simdPreference:h,executionPreference:l,variantPreference:u,usagePreference:d,executionQuantaPreference:f}),r,n)}));t.decideModel=({category:e,name:t,variant:n,simd:i,url:r})=>`${e}-${t}-${n}-v1${i?"_simd":""}`},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(26),s=n(67);class o extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t);const{modelURL:n,worker:i,fetchBehavior:s,logger:o}=t;this.logger=o,this.port.onmessage=this.onProcessorMessage.bind(this),o&&o.debug("VoiceFocusInlineNode:",n),this.worker=i,this.worker.onmessage=this.onWorkerMessage.bind(this);const a=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:a,key:"model",fetchBehavior:s,path:n})}onModuleBufferLoaded(e,t){this.port.postMessage({message:"module-buffer",buffer:e,key:t})}onModuleLoaded(e,t){this.port.postMessage({message:"module",module:e,key:t})}enable(){return i(this,void 0,void 0,(function*(){this.port.postMessage({message:"enable"})}))}disable(){return i(this,void 0,void 0,(function*(){this.port.postMessage({message:"disable"})}))}stop(){return i(this,void 0,void 0,(function*(){this.port.postMessage({message:"stop"}),this.disconnect()}))}onProcessorMessage(e){var t;switch(e.data.message){case"cpu":break;default:null===(t=this.logger)||void 0===t||t.debug("Ignoring processor message.")}}onWorkerMessage(e){const t=e.data;switch(t.message){case"module-buffer":if(!t.buffer||!t.key)return;this.onModuleBufferLoaded(t.buffer,t.key);break;case"module":if(!t.module||!t.key)return;this.onModuleLoaded(t.module,t.key);break;case"stopped":this.worker&&this.worker.terminate();break;default:return}}}t.default=o},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(26),s=n(67),o=0,a=1,c=0,l=1,d=2;class u extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t);const{modelURL:n,resamplerURL:i,worker:s,fetchBehavior:o,delegate:a}=t;this.delegate=a,this.worker=s,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this),this.worker.postMessage({message:"init",approach:"sab",frames:16e3===e.sampleRate?160:480,enabled:t.processorOptions.enabled,model:n});const c=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:c,key:"resampler",fetchBehavior:o,path:i})}enable(){return i(this,void 0,void 0,(function*(){this.state?(Atomics.store(this.state,a,l),Atomics.notify(this.state,o,1)):this.worker.postMessage({message:"enable"})}))}disable(){return i(this,void 0,void 0,(function*(){this.state?(Atomics.store(this.state,a,c),Atomics.notify(this.state,o,1)):this.worker.postMessage({message:"disable"})}))}stop(){return i(this,void 0,void 0,(function*(){if(this.state)Atomics.store(this.state,a,d),Atomics.notify(this.state,o,1);else try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()}))}onWorkerMessage(e){var t;const n=e.data;switch(n.message){case"ready":if(!n.shared)throw new Error("No shared state.");this.state=new Int32Array(n.shared.state),this.port.postMessage(n);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":this.port.postMessage(n);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"processing":this.port.postMessage(n);break;default:return}}onProcessorMessage(e){var t;const n=e.data;switch(n.message){case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(n)}}}t.default=u},function(e,t,n){"use strict";var i=this&&this.__awaiter||function(e,t,n,i){return new(n||(n=Promise))((function(r,s){function o(e){try{c(i.next(e))}catch(e){s(e)}}function a(e){try{c(i.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}c((i=i.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0});const r=n(26),s=n(67);class o extends s.VoiceFocusAudioWorkletNode{constructor(e,t){super(e,t.processor,t);const{modelURL:n,audioBufferURL:i,worker:s,fetchBehavior:o,delegate:a}=t;this.delegate=a,this.worker=s,this.worker.onmessage=this.onWorkerMessage.bind(this),this.port.onmessage=this.onProcessorMessage.bind(this),this.worker.postMessage({message:"init",approach:"postMessage",frames:16e3===e.sampleRate?160:480,enabled:t.processorOptions.enabled,agc:t.processorOptions.agc,fetchBehavior:o,model:n});const c=r.supportsWASMPostMessage(globalThis)?"get-module":"get-module-buffer";this.worker.postMessage({message:c,key:"buffer",fetchBehavior:o,path:i})}enable(){return i(this,void 0,void 0,(function*(){this.worker.postMessage({message:"enable"})}))}disable(){return i(this,void 0,void 0,(function*(){this.worker.postMessage({message:"disable"})}))}stop(){return i(this,void 0,void 0,(function*(){try{this.worker.postMessage({message:"stop"})}catch(e){}this.disconnect()}))}onWorkerMessage(e){var t;const n=e.data;switch(n.message){case"ready":this.port.postMessage({message:"ready",shared:n.shared},n.shared?Object.values(n.shared):[]);break;case"data":if(!n.buffer)return;this.port.postMessage({message:"data",buffer:n.buffer},[n.buffer]);break;case"stopped":this.worker.terminate();break;case"module-buffer":case"module":this.port.postMessage(n);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"processing":this.port.postMessage(n);break;default:return}}onProcessorMessage(e){var t;const n=e.data;switch(n.message){case"data":if(!n.buffer)return;this.worker.postMessage({message:"data",buffer:n.buffer},[n.buffer]);break;case"cpu":null===(t=this.delegate)||void 0===t||t.onCPUWarning();break;case"prepare-for-frames":this.worker.postMessage(n);break;default:return}}}t.default=o},function(e,t,n){"use strict";function i(e){return e.map(e=>"object"==typeof e?JSON.stringify(e):""+e).join(" ")}Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(e){this.base=e}debug(...e){this.base.debug(i(e))}info(...e){this.base.info(i(e))}warn(...e){this.base.warn(i(e))}error(...e){this.base.error(i(e))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=class{constructor(){this.observers=new Set}addObserver(e){this.observers.add(e)}removeObserver(e){this.observers.delete(e)}onFallback(e,t){var n;for(const i of this.observers)null===(n=i.voiceFocusFellBackToInnerStream)||void 0===n||n.call(i,e,t)}onCPUWarning(){var e;for(const t of this.observers)null===(e=t.voiceFocusInsufficientResources)||void 0===e||e.call(t)}}},function(e,t,n){"use strict";var i=n(9),r=n(170),s=n(245),o=n(176);function a(e){var t=new s(e),n=r(s.prototype.request,t);return i.extend(n,s.prototype,t),i.extend(n,t),n}var c=a(n(173));c.Axios=s,c.create=function(e){return a(o(c.defaults,e))},c.Cancel=n(177),c.CancelToken=n(258),c.isCancel=n(172),c.all=function(e){return Promise.all(e)},c.spread=n(259),c.isAxiosError=n(260),e.exports=c,e.exports.default=c},function(e,t,n){"use strict";var i=n(9),r=n(171),s=n(246),o=n(247),a=n(176);function c(e){this.defaults=e,this.interceptors={request:new s,response:new s}}c.prototype.request=function(e){"string"==typeof e?(e=arguments[1]||{}).url=arguments[0]:e=e||{},(e=a(this.defaults,e)).method?e.method=e.method.toLowerCase():this.defaults.method?e.method=this.defaults.method.toLowerCase():e.method="get";var t=[o,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach((function(e){t.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){t.push(e.fulfilled,e.rejected)}));t.length;)n=n.then(t.shift(),t.shift());return n},c.prototype.getUri=function(e){return e=a(this.defaults,e),r(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},i.forEach(["delete","get","head","options"],(function(e){c.prototype[e]=function(t,n){return this.request(a(n||{},{method:e,url:t,data:(n||{}).data}))}})),i.forEach(["post","put","patch"],(function(e){c.prototype[e]=function(t,n,i){return this.request(a(i||{},{method:e,url:t,data:n}))}})),e.exports=c},function(e,t,n){"use strict";var i=n(9);function r(){this.handlers=[]}r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){i.forEach(this.handlers,(function(t){null!==t&&e(t)}))},e.exports=r},function(e,t,n){"use strict";var i=n(9),r=n(248),s=n(172),o=n(173);function a(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return a(e),e.headers=e.headers||{},e.data=r(e.data,e.headers,e.transformRequest),e.headers=i.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),i.forEach(["delete","get","head","post","put","patch","common"],(function(t){delete e.headers[t]})),(e.adapter||o.adapter)(e).then((function(t){return a(e),t.data=r(t.data,t.headers,e.transformResponse),t}),(function(t){return s(t)||(a(e),t&&t.response&&(t.response.data=r(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},function(e,t,n){"use strict";var i=n(9);e.exports=function(e,t,n){return i.forEach(n,(function(n){e=n(e,t)})),e}},function(e,t,n){"use strict";var i=n(9);e.exports=function(e,t){i.forEach(e,(function(n,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[i])}))}},function(e,t,n){"use strict";var i=n(175);e.exports=function(e,t,n){var r=n.config.validateStatus;n.status&&r&&!r(n.status)?t(i("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";e.exports=function(e,t,n,i,r){return e.config=t,n&&(e.code=n),e.request=i,e.response=r,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}},function(e,t,n){"use strict";var i=n(9);e.exports=i.isStandardBrowserEnv()?{write:function(e,t,n,r,s,o){var a=[];a.push(e+"="+encodeURIComponent(t)),i.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),i.isString(r)&&a.push("path="+r),i.isString(s)&&a.push("domain="+s),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var i=n(254),r=n(255);e.exports=function(e,t){return e&&!i(t)?r(e,t):t}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";var i=n(9),r=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,s,o={};return e?(i.forEach(e.split("\n"),(function(e){if(s=e.indexOf(":"),t=i.trim(e.substr(0,s)).toLowerCase(),n=i.trim(e.substr(s+1)),t){if(o[t]&&r.indexOf(t)>=0)return;o[t]="set-cookie"===t?(o[t]?o[t]:[]).concat([n]):o[t]?o[t]+", "+n:n}})),o):o}},function(e,t,n){"use strict";var i=n(9);e.exports=i.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function r(e){var i=e;return t&&(n.setAttribute("href",i),i=n.href),n.setAttribute("href",i),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=r(window.location.href),function(t){var n=i.isString(t)?r(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var i=n(177);function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new i(e),t(n.reason))}))}r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e;return{token:new r((function(t){e=t})),cancel:e}},e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";e.exports=function(e){return"object"==typeof e&&!0===e.isAxiosError}},function(e,t,n){"use strict";var i=n(262),r=n(264);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=S,t.resolve=function(e,t){return S(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?S(e,!1,!0).resolveObject(t):t},t.format=function(e){r.isString(e)&&(e=S(e));return e instanceof s?e.format():s.prototype.format.call(e)},t.Url=s;var o=/^([a-z0-9.+-]+:)/i,a=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,l=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),d=["'"].concat(l),u=["%","/","?",";","#"].concat(d),h=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,g={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},b=n(265);function S(e,t,n){if(e&&r.isObject(e)&&e instanceof s)return e;var i=new s;return i.parse(e,t,n),i}s.prototype.parse=function(e,t,n){if(!r.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),a=-1!==s&&s<e.indexOf("#")?"?":"#",l=e.split(a);l[0]=l[0].replace(/\\/g,"/");var S=e=l.join(a);if(S=S.trim(),!n&&1===e.split("#").length){var y=c.exec(S);if(y)return this.path=S,this.href=S,this.pathname=y[1],y[2]?(this.search=y[2],this.query=t?b.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var C=o.exec(S);if(C){var w=(C=C[0]).toLowerCase();this.protocol=w,S=S.substr(C.length)}if(n||C||S.match(/^\/\/[^@\/]+@[^@\/]+/)){var _="//"===S.substr(0,2);!_||C&&m[C]||(S=S.substr(2),this.slashes=!0)}if(!m[C]&&(_||C&&!v[C])){for(var A,k,T=-1,I=0;I<h.length;I++){-1!==(O=S.indexOf(h[I]))&&(-1===T||O<T)&&(T=O)}-1!==(k=-1===T?S.lastIndexOf("@"):S.lastIndexOf("@",T))&&(A=S.slice(0,k),S=S.slice(k+1),this.auth=decodeURIComponent(A)),T=-1;for(I=0;I<u.length;I++){var O;-1!==(O=S.indexOf(u[I]))&&(-1===T||O<T)&&(T=O)}-1===T&&(T=S.length),this.host=S.slice(0,T),S=S.slice(T),this.parseHost(),this.hostname=this.hostname||"";var E="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!E)for(var x=this.hostname.split(/\./),P=(I=0,x.length);I<P;I++){var M=x[I];if(M&&!M.match(p)){for(var D="",R=0,F=M.length;R<F;R++)M.charCodeAt(R)>127?D+="x":D+=M[R];if(!D.match(p)){var N=x.slice(0,I),L=x.slice(I+1),j=M.match(f);j&&(N.push(j[1]),L.unshift(j[2])),L.length&&(S="/"+L.join(".")+S),this.hostname=N.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),E||(this.hostname=i.toASCII(this.hostname));var V=this.port?":"+this.port:"",B=this.hostname||"";this.host=B+V,this.href+=this.host,E&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==S[0]&&(S="/"+S))}if(!g[w])for(I=0,P=d.length;I<P;I++){var U=d[I];if(-1!==S.indexOf(U)){var W=encodeURIComponent(U);W===U&&(W=escape(U)),S=S.split(U).join(W)}}var H=S.indexOf("#");-1!==H&&(this.hash=S.substr(H),S=S.slice(0,H));var q=S.indexOf("?");if(-1!==q?(this.search=S.substr(q),this.query=S.substr(q+1),t&&(this.query=b.parse(this.query)),S=S.slice(0,q)):t&&(this.search="",this.query={}),S&&(this.pathname=S),v[w]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){V=this.pathname||"";var $=this.search||"";this.path=V+$}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",i=this.hash||"",s=!1,o="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=b.stringify(this.query));var a=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||v[t])&&!1!==s?(s="//"+(s||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):s||(s=""),i&&"#"!==i.charAt(0)&&(i="#"+i),a&&"?"!==a.charAt(0)&&(a="?"+a),t+s+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(a=a.replace("#","%23"))+i},s.prototype.resolve=function(e){return this.resolveObject(S(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(r.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var n=new s,i=Object.keys(this),o=0;o<i.length;o++){var a=i[o];n[a]=this[a]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var c=Object.keys(e),l=0;l<c.length;l++){var d=c[l];"protocol"!==d&&(n[d]=e[d])}return v[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!v[e.protocol]){for(var u=Object.keys(e),h=0;h<u.length;h++){var p=u[h];n[p]=e[p]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||m[e.protocol])n.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),n.pathname=f.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var g=n.pathname||"",b=n.search||"";n.path=g+b}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var S=n.pathname&&"/"===n.pathname.charAt(0),y=e.host||e.pathname&&"/"===e.pathname.charAt(0),C=y||S||n.host&&e.pathname,w=C,_=n.pathname&&n.pathname.split("/")||[],A=(f=e.pathname&&e.pathname.split("/")||[],n.protocol&&!v[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===_[0]?_[0]=n.host:_.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),C=C&&(""===f[0]||""===_[0])),y)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,_=f;else if(f.length)_||(_=[]),_.pop(),_=_.concat(f),n.search=e.search,n.query=e.query;else if(!r.isNullOrUndefined(e.search)){if(A)n.hostname=n.host=_.shift(),(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift());return n.search=e.search,n.query=e.query,r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!_.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var k=_.slice(-1)[0],T=(n.host||e.host||_.length>1)&&("."===k||".."===k)||""===k,I=0,O=_.length;O>=0;O--)"."===(k=_[O])?_.splice(O,1):".."===k?(_.splice(O,1),I++):I&&(_.splice(O,1),I--);if(!C&&!w)for(;I--;I)_.unshift("..");!C||""===_[0]||_[0]&&"/"===_[0].charAt(0)||_.unshift(""),T&&"/"!==_.join("/").substr(-1)&&_.push("");var E,x=""===_[0]||_[0]&&"/"===_[0].charAt(0);A&&(n.hostname=n.host=x?"":_.length?_.shift():"",(E=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=E.shift(),n.host=n.hostname=E.shift()));return(C=C||n.host&&_.length)&&!x&&_.unshift(""),_.length?n.pathname=_.join("/"):(n.pathname=null,n.path=null),r.isNull(n.pathname)&&r.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},s.prototype.parseHost=function(){var e=this.host,t=a.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,n){(function(e,i){var r;/*! https://mths.be/punycode v1.3.2 by @mathias */!function(s){t&&t.nodeType,e&&e.nodeType;var o="object"==typeof i&&i;o.global!==o&&o.window!==o&&o.self;var a,c=2147483647,l=/^xn--/,d=/[^\x20-\x7E]/,u=/[\x2E\u3002\uFF0E\uFF61]/g,h={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},p=Math.floor,f=String.fromCharCode;function g(e){throw RangeError(h[e])}function m(e,t){for(var n=e.length,i=[];n--;)i[n]=t(e[n]);return i}function v(e,t){var n=e.split("@"),i="";return n.length>1&&(i=n[0]+"@",e=n[1]),i+m((e=e.replace(u,".")).split("."),t).join(".")}function b(e){for(var t,n,i=[],r=0,s=e.length;r<s;)(t=e.charCodeAt(r++))>=55296&&t<=56319&&r<s?56320==(64512&(n=e.charCodeAt(r++)))?i.push(((1023&t)<<10)+(1023&n)+65536):(i.push(t),r--):i.push(t);return i}function S(e){return m(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=f(e)})).join("")}function y(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function C(e,t,n){var i=0;for(e=n?p(e/700):e>>1,e+=p(e/t);e>455;i+=36)e=p(e/35);return p(i+36*e/(e+38))}function w(e){var t,n,i,r,s,o,a,l,d,u,h,f=[],m=e.length,v=0,b=128,y=72;for((n=e.lastIndexOf("-"))<0&&(n=0),i=0;i<n;++i)e.charCodeAt(i)>=128&&g("not-basic"),f.push(e.charCodeAt(i));for(r=n>0?n+1:0;r<m;){for(s=v,o=1,a=36;r>=m&&g("invalid-input"),((l=(h=e.charCodeAt(r++))-48<10?h-22:h-65<26?h-65:h-97<26?h-97:36)>=36||l>p((c-v)/o))&&g("overflow"),v+=l*o,!(l<(d=a<=y?1:a>=y+26?26:a-y));a+=36)o>p(c/(u=36-d))&&g("overflow"),o*=u;y=C(v-s,t=f.length+1,0==s),p(v/t)>c-b&&g("overflow"),b+=p(v/t),v%=t,f.splice(v++,0,b)}return S(f)}function _(e){var t,n,i,r,s,o,a,l,d,u,h,m,v,S,w,_=[];for(m=(e=b(e)).length,t=128,n=0,s=72,o=0;o<m;++o)(h=e[o])<128&&_.push(f(h));for(i=r=_.length,r&&_.push("-");i<m;){for(a=c,o=0;o<m;++o)(h=e[o])>=t&&h<a&&(a=h);for(a-t>p((c-n)/(v=i+1))&&g("overflow"),n+=(a-t)*v,t=a,o=0;o<m;++o)if((h=e[o])<t&&++n>c&&g("overflow"),h==t){for(l=n,d=36;!(l<(u=d<=s?1:d>=s+26?26:d-s));d+=36)w=l-u,S=36-u,_.push(f(y(u+w%S,0))),l=p(w/S);_.push(f(y(l,0))),s=C(n,v,i==r),n=0,++i}++n,++t}return _.join("")}a={version:"1.3.2",ucs2:{decode:b,encode:S},decode:w,encode:_,toASCII:function(e){return v(e,(function(e){return d.test(e)?"xn--"+_(e):e}))},toUnicode:function(e){return v(e,(function(e){return l.test(e)?w(e.slice(4).toLowerCase()):e}))}},void 0===(r=function(){return a}.call(t,n,t,e))||(e.exports=r)}()}).call(this,n(263)(e),n(13))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,n){"use strict";t.decode=t.parse=n(266),t.encode=t.stringify=n(267)},function(e,t,n){"use strict";function i(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,n,s){t=t||"&",n=n||"=";var o={};if("string"!=typeof e||0===e.length)return o;var a=/\+/g;e=e.split(t);var c=1e3;s&&"number"==typeof s.maxKeys&&(c=s.maxKeys);var l=e.length;c>0&&l>c&&(l=c);for(var d=0;d<l;++d){var u,h,p,f,g=e[d].replace(a,"%20"),m=g.indexOf(n);m>=0?(u=g.substr(0,m),h=g.substr(m+1)):(u=g,h=""),p=decodeURIComponent(u),f=decodeURIComponent(h),i(o,p)?r(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,n){"use strict";var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?s(o(e),(function(o){var a=encodeURIComponent(i(o))+n;return r(e[o])?s(e[o],(function(e){return a+encodeURIComponent(i(e))})).join(t):a+encodeURIComponent(i(e[o]))})).join(t):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(e)):""};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)};function s(e,t){if(e.map)return e.map(t);for(var n=[],i=0;i<e.length;i++)n.push(t(e[i],i));return n}var o=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.url=void 0;const i=n(178),r=n(39)("socket.io-client:url");t.url=function(e,t="",n){let s=e;n=n||"undefined"!=typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(r("protocol-less url %s",e),e=void 0!==n?n.protocol+"//"+e:"https://"+e),r("parse %s",e),s=i(e)),s.port||(/^(http|ws)$/.test(s.protocol)?s.port="80":/^(http|ws)s$/.test(s.protocol)&&(s.port="443")),s.path=s.path||"/";const o=-1!==s.host.indexOf(":")?"["+s.host+"]":s.host;return s.id=s.protocol+"://"+o+":"+s.port+t,s.href=s.protocol+"://"+o+(n&&n.port===s.port?"":":"+s.port),s}},function(e,t,n){e.exports=function(e){function t(e){let n,r=null;function s(...e){if(!s.enabled)return;const i=s,r=Number(new Date),o=r-(n||r);i.diff=o,i.prev=n,i.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";a++;const s=t.formatters[r];if("function"==typeof s){const t=e[a];n=s.call(i,t),e.splice(a,1),a--}return n}),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===r?t.enabled(e):r,set:e=>{r=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,n){const i=t(this.namespace+(void 0===n?":":n)+e);return i.log=this.log,i}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),r=i.length;for(n=0;n<r;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(270),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,i=6e4,r=60*i,s=24*r;function o(e,t,n,i){var r=t>=1.5*n;return Math.round(e/n)+" "+i+(r?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return o(e,t,s,"day");if(t>=r)return o(e,t,r,"hour");if(t>=i)return o(e,t,i,"minute");if(t>=n)return o(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=r)return Math.round(e/r)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){const i=n(272);e.exports=(e,t)=>new i(e,t),e.exports.Socket=i,e.exports.protocol=i.protocol,e.exports.Transport=n(68),e.exports.transports=n(180),e.exports.parser=n(27)},function(e,t,n){const i=n(180),r=n(28),s=n(29)("engine.io-client:socket"),o=n(27),a=n(178),c=n(69);class l extends r{constructor(e,t={}){super(),e&&"object"==typeof e&&(t=e,e=null),e?(e=a(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.transports=t.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,jsonp:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{}},t),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=c.decode(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(addEventListener("beforeunload",()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close")},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(e){s('creating transport "%s"',e);const t=function(e){const t={};for(let n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.opts.query);t.EIO=o.protocol,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts.transportOptions[e],this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return s("options: %j",n),new i[e](n)}open(){let e;if(this.opts.rememberUpgrade&&l.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){const e=this;return void setTimeout((function(){e.emit("error","No transports available")}),0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return s("error while creating transport: %s",e),this.transports.shift(),void this.open()}e.open(),this.setTransport(e)}setTransport(e){s("setting transport %s",e.name);const t=this;this.transport&&(s("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=e,e.on("drain",(function(){t.onDrain()})).on("packet",(function(e){t.onPacket(e)})).on("error",(function(e){t.onError(e)})).on("close",(function(){t.onClose("transport close")}))}probe(e){s('probing transport "%s"',e);let t=this.createTransport(e,{probe:1}),n=!1;const i=this;function r(){if(i.onlyBinaryUpgrades){const e=!this.supportsBinary&&i.transport.supportsBinary;n=n||e}n||(s('probe transport "%s" opened',e),t.send([{type:"ping",data:"probe"}]),t.once("packet",(function(r){if(!n)if("pong"===r.type&&"probe"===r.data){if(s('probe transport "%s" pong',e),i.upgrading=!0,i.emit("upgrading",t),!t)return;l.priorWebsocketSuccess="websocket"===t.name,s('pausing current transport "%s"',i.transport.name),i.transport.pause((function(){n||"closed"!==i.readyState&&(s("changing transport and sending upgrade packet"),h(),i.setTransport(t),t.send([{type:"upgrade"}]),i.emit("upgrade",t),t=null,i.upgrading=!1,i.flush())}))}else{s('probe transport "%s" failed',e);const n=new Error("probe error");n.transport=t.name,i.emit("upgradeError",n)}})))}function o(){n||(n=!0,h(),t.close(),t=null)}function a(n){const r=new Error("probe error: "+n);r.transport=t.name,o(),s('probe transport "%s" failed because of error: %s',e,n),i.emit("upgradeError",r)}function c(){a("transport closed")}function d(){a("socket closed")}function u(e){t&&e.name!==t.name&&(s('"%s" works - aborting "%s"',e.name,t.name),o())}function h(){t.removeListener("open",r),t.removeListener("error",a),t.removeListener("close",c),i.removeListener("close",d),i.removeListener("upgrading",u)}l.priorWebsocketSuccess=!1,t.once("open",r),t.once("error",a),t.once("close",c),this.once("close",d),this.once("upgrading",u),t.open()}onOpen(){if(s("socket open"),this.readyState="open",l.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){s("starting upgrade probes");let e=0;const t=this.upgrades.length;for(;e<t;e++)this.probe(this.upgrades[e])}}onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(s('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emit("pong");break;case"error":const t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else s('packet received with socket readyState "%s"',this.readyState)}onHandshake(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){clearTimeout(this.pingTimeoutTimer),this.pingTimeoutTimer=setTimeout(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()}flush(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(s("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))}write(e,t,n){return this.sendPacket("message",e,t,n),this}send(e,t,n){return this.sendPacket("message",e,t,n),this}sendPacket(e,t,n,i){if("function"==typeof t&&(i=t,t=void 0),"function"==typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:e,data:t,options:n};this.emit("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=this;function t(){e.onClose("forced close"),s("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function i(){e.once("upgrade",n),e.once("upgradeError",n)}return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(function(){this.upgrading?i():t()})):this.upgrading?i():t()),this}onError(e){s("socket error %j",e),l.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)}onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){s('socket close with reason: "%s"',e);const n=this;clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emit("close",e,t),n.writeBuffer=[],n.prevBufferLen=0}}filterUpgrades(e){const t=[];let n=0;const i=e.length;for(;n<i;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}l.priorWebsocketSuccess=!1,l.protocol=o.protocol,e.exports=l},function(e,t){try{e.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){e.exports=!1}},function(e,t,n){const i=n(181),r=n(182),s=n(28),{pick:o}=n(185),a=n(40),c=n(29)("engine.io-client:polling-xhr");function l(){}const d=null!=new i({xdomain:!1}).responseType;class u extends s{constructor(e,t){super(),this.opts=t,this.method=t.method||"GET",this.uri=e,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.create()}create(){const e=o(this.opts,"agent","enablesXDR","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");e.xdomain=!!this.opts.xd,e.xscheme=!!this.opts.xs;const t=this.xhr=new i(e),n=this;try{c("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0);for(let e in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(e)&&t.setRequestHeader(e,this.opts.extraHeaders[e])}}catch(e){}if("POST"===this.method)try{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(t.timeout=this.opts.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout((function(){n.onError("number"==typeof t.status?t.status:0)}),0))},c("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout((function(){n.onError(e)}),0)}"undefined"!=typeof document&&(this.index=u.requestsCount++,u.requests[this.index]=this)}onSuccess(){this.emit("success"),this.cleanup()}onData(e){this.emit("data",e),this.onSuccess()}onError(e){this.emit("error",e),this.cleanup(!0)}cleanup(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=l:this.xhr.onreadystatechange=l,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete u.requests[this.index],this.xhr=null}}onLoad(){const e=this.xhr.responseText;null!==e&&this.onData(e)}hasXDR(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR}abort(){this.cleanup()}}if(u.requestsCount=0,u.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",h);else if("function"==typeof addEventListener){addEventListener("onpagehide"in a?"pagehide":"unload",h,!1)}function h(){for(let e in u.requests)u.requests.hasOwnProperty(e)&&u.requests[e].abort()}e.exports=class extends r{constructor(e){if(super(e),"undefined"!=typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}const t=e&&e.forceBase64;this.supportsBinary=d&&!t}request(e={}){return Object.assign(e,{xd:this.xd,xs:this.xs},this.opts),new u(this.uri(),e)}doWrite(e,t){const n=this.request({method:"POST",data:e}),i=this;n.on("success",t),n.on("error",(function(e){i.onError("xhr post error",e)}))}doPoll(){c("xhr poll");const e=this.request(),t=this;e.on("data",(function(e){t.onData(e)})),e.on("error",(function(e){t.onError("xhr poll error",e)})),this.pollXhr=e}},e.exports.Request=u},function(e,t,n){const{PACKET_TYPES:i}=n(183),r="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),s="function"==typeof ArrayBuffer,o=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+e)},n.readAsDataURL(e)};e.exports=({type:e,data:t},n,a)=>{return r&&t instanceof Blob?n?a(t):o(t,a):s&&(t instanceof ArrayBuffer||(c=t,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(c):c&&c.buffer instanceof ArrayBuffer))?n?a(t instanceof ArrayBuffer?t:t.buffer):o(new Blob([t]),a):a(i[e]+(t||""));var c}},function(e,t,n){const{PACKET_TYPES_REVERSE:i,ERROR_PACKET:r}=n(183);let s;"function"==typeof ArrayBuffer&&(s=n(277));const o=(e,t)=>{if(s){const n=s.decode(e);return a(n,t)}return{base64:!0,data:e}},a=(e,t)=>{switch(t){case"blob":return e instanceof ArrayBuffer?new Blob([e]):e;case"arraybuffer":default:return e}};e.exports=(e,t)=>{if("string"!=typeof e)return{type:"message",data:a(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:o(e.substring(1),t)};return i[n]?e.length>1?{type:i[n],data:e.substring(1)}:{type:i[n]}:r}},function(e,t){!function(e){"use strict";t.encode=function(t){var n,i=new Uint8Array(t),r=i.length,s="";for(n=0;n<r;n+=3)s+=e[i[n]>>2],s+=e[(3&i[n])<<4|i[n+1]>>4],s+=e[(15&i[n+1])<<2|i[n+2]>>6],s+=e[63&i[n+2]];return r%3==2?s=s.substring(0,s.length-1)+"=":r%3==1&&(s=s.substring(0,s.length-2)+"=="),s},t.decode=function(t){var n,i,r,s,o,a=.75*t.length,c=t.length,l=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var d=new ArrayBuffer(a),u=new Uint8Array(d);for(n=0;n<c;n+=4)i=e.indexOf(t[n]),r=e.indexOf(t[n+1]),s=e.indexOf(t[n+2]),o=e.indexOf(t[n+3]),u[l++]=i<<2|r>>4,u[l++]=(15&r)<<4|s>>2,u[l++]=(3&s)<<6|63&o;return d}}("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/")},function(e,t,n){e.exports=function(e){function t(e){let n,r=null;function s(...e){if(!s.enabled)return;const i=s,r=Number(new Date),o=r-(n||r);i.diff=o,i.prev=n,i.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";a++;const s=t.formatters[r];if("function"==typeof s){const t=e[a];n=s.call(i,t),e.splice(a,1),a--}return n}),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===r?t.enabled(e):r,set:e=>{r=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,n){const i=t(this.namespace+(void 0===n?":":n)+e);return i.log=this.log,i}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),r=i.length;for(n=0;n<r;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(279),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,i=6e4,r=60*i,s=24*r;function o(e,t,n,i){var r=t>=1.5*n;return Math.round(e/n)+" "+i+(r?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return o(e,t,s,"day");if(t>=r)return o(e,t,r,"hour");if(t>=i)return o(e,t,i,"minute");if(t>=n)return o(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=r)return Math.round(e/r)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){const i=n(182),r=n(40),s=/\n/g,o=/\\n/g;let a;e.exports=class extends i{constructor(e){super(e),this.query=this.query||{},a||(a=r.___eio=r.___eio||[]),this.index=a.length;const t=this;a.push((function(e){t.onData(e)})),this.query.j=this.index}get supportsBinary(){return!1}doClose(){this.script&&(this.script.onerror=()=>{},this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),super.doClose()}doPoll(){const e=this,t=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),t.async=!0,t.src=this.uri(),t.onerror=function(t){e.onError("jsonp poll error",t)};const n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(t,n):(document.head||document.body).appendChild(t),this.script=t;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout((function(){const e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)}),100)}doWrite(e,t){const n=this;let i;if(!this.form){const e=document.createElement("form"),t=document.createElement("textarea"),n=this.iframeId="eio_iframe_"+this.index;e.className="socketio",e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.target=n,e.method="POST",e.setAttribute("accept-charset","utf-8"),t.name="d",e.appendChild(t),document.body.appendChild(e),this.form=e,this.area=t}function r(){a(),t()}function a(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{const e='<iframe src="javascript:0" name="'+n.iframeId+'">';i=document.createElement(e)}catch(e){i=document.createElement("iframe"),i.name=n.iframeId,i.src="javascript:0"}i.id=n.iframeId,n.form.appendChild(i),n.iframe=i}this.form.action=this.uri(),a(),e=e.replace(o,"\\\n"),this.area.value=e.replace(s,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&r()}:this.iframe.onload=r}}},function(e,t,n){(function(t){const i=n(68),r=n(27),s=n(69),o=n(184),{pick:a}=n(185),{WebSocket:c,usingBrowserWebSocket:l,defaultBinaryType:d}=n(285),u=n(29)("engine.io-client:websocket"),h="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class p extends i{constructor(e){super(e),this.supportsBinary=!e.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const e=this.uri(),t=this.opts.protocols,n=h?{}:a(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=l&&!h?t?new c(e,t):new c(e):new c(e,t,n)}catch(e){return this.emit("error",e)}this.ws.binaryType=this.socket.binaryType||d,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=this.onClose.bind(this),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){const n=this;this.writable=!1;let i=e.length,s=0;const o=i;for(;s<o;s++)!function(e){r.encodePacket(e,n.supportsBinary,(function(r){const s={};if(!l&&(e.options&&(s.compress=e.options.compress),n.opts.perMessageDeflate)){("string"==typeof r?t.byteLength(r):r.length)<n.opts.perMessageDeflate.threshold&&(s.compress=!1)}try{l?n.ws.send(r):n.ws.send(r,s)}catch(e){u("websocket closed before onclose event")}--i||a()}))}(e[s]);function a(){n.emit("flush"),setTimeout((function(){n.writable=!0,n.emit("drain")}),0)}}onClose(){i.prototype.onClose.call(this)}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let e=this.query||{};const t=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===t&&443!==Number(this.opts.port)||"ws"===t&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(e[this.opts.timestampParam]=o()),this.supportsBinary||(e.b64=1),e=s.encode(e),e.length&&(e="?"+e);return t+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+e}check(){return!(!c||"__initialize"in c&&this.name===p.prototype.name)}}e.exports=p}).call(this,n(186).Buffer)},function(e,t,n){"use strict";t.byteLength=function(e){var t=l(e),n=t[0],i=t[1];return 3*(n+i)/4-i},t.toByteArray=function(e){var t,n,i=l(e),o=i[0],a=i[1],c=new s(function(e,t,n){return 3*(t+n)/4-n}(0,o,a)),d=0,u=a>0?o-4:o;for(n=0;n<u;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],c[d++]=t>>16&255,c[d++]=t>>8&255,c[d++]=255&t;2===a&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,c[d++]=255&t);1===a&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,c[d++]=t>>8&255,c[d++]=255&t);return c},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,s=[],o=0,a=n-r;o<a;o+=16383)s.push(d(e,o,o+16383>a?a:o+16383));1===r?(t=e[n-1],s.push(i[t>>2]+i[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],s.push(i[t>>10]+i[t>>4&63]+i[t<<2&63]+"="));return s.join("")};for(var i=[],r=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=0,c=o.length;a<c;++a)i[a]=o[a],r[o.charCodeAt(a)]=a;function l(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function d(e,t,n){for(var r,s,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(i[(s=r)>>18&63]+i[s>>12&63]+i[s>>6&63]+i[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,i,r){var s,o,a=8*r-i-1,c=(1<<a)-1,l=c>>1,d=-7,u=n?r-1:0,h=n?-1:1,p=e[t+u];for(u+=h,s=p&(1<<-d)-1,p>>=-d,d+=a;d>0;s=256*s+e[t+u],u+=h,d-=8);for(o=s&(1<<-d)-1,s>>=-d,d+=i;d>0;o=256*o+e[t+u],u+=h,d-=8);if(0===s)s=1-l;else{if(s===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,i),s-=l}return(p?-1:1)*o*Math.pow(2,s-i)},t.write=function(e,t,n,i,r,s){var o,a,c,l=8*s-r-1,d=(1<<l)-1,u=d>>1,h=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=i?0:s-1,f=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=d):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+u>=1?h/c:h*Math.pow(2,1-u))*c>=2&&(o++,c/=2),o+u>=d?(a=0,o=d):o+u>=1?(a=(t*c-1)*Math.pow(2,r),o+=u):(a=t*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;e[n+p]=255&a,p+=f,a/=256,r-=8);for(o=o<<r|a,l+=r;l>0;e[n+p]=255&o,p+=f,o/=256,l-=8);e[n+p-f]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){const i=n(40);e.exports={WebSocket:i.WebSocket||i.MozWebSocket,usingBrowserWebSocket:!0,defaultBinaryType:"arraybuffer"}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reconstructPacket=t.deconstructPacket=void 0;const i=n(188);t.deconstructPacket=function(e){const t=[],n=e.data,r=e;return r.data=function e(t,n){if(!t)return t;if(i.isBinary(t)){const e={_placeholder:!0,num:n.length};return n.push(t),e}if(Array.isArray(t)){const i=new Array(t.length);for(let r=0;r<t.length;r++)i[r]=e(t[r],n);return i}if("object"==typeof t&&!(t instanceof Date)){const i={};for(const r in t)t.hasOwnProperty(r)&&(i[r]=e(t[r],n));return i}return t}(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(Array.isArray(t))for(let i=0;i<t.length;i++)t[i]=e(t[i],n);else if("object"==typeof t)for(const i in t)t.hasOwnProperty(i)&&(t[i]=e(t[i],n));return t}(e.data,t),e.attachments=void 0,e}},function(e,t,n){(function(i){t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let i=0,r=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(i++,"%c"===e&&(r=i))}),t.splice(r,0,n)},t.save=function(e){try{e?t.storage.setItem("debug",e):t.storage.removeItem("debug")}catch(e){}},t.load=function(){let e;try{e=t.storage.getItem("debug")}catch(e){}!e&&void 0!==i&&"env"in i&&(e=i.env.DEBUG);return e},t.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage=function(){try{return localStorage}catch(e){}}(),t.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),e.exports=n(288)(t);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(this,n(20))},function(e,t,n){e.exports=function(e){function t(e){let n,r=null;function s(...e){if(!s.enabled)return;const i=s,r=Number(new Date),o=r-(n||r);i.diff=o,i.prev=n,i.curr=r,n=r,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,r)=>{if("%%"===n)return"%";a++;const s=t.formatters[r];if("function"==typeof s){const t=e[a];n=s.call(i,t),e.splice(a,1),a--}return n}),t.formatArgs.call(i,e);(i.log||t.log).apply(i,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=i,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null===r?t.enabled(e):r,set:e=>{r=e}}),"function"==typeof t.init&&t.init(s),s}function i(e,n){const i=t(this.namespace+(void 0===n?":":n)+e);return i.log=this.log,i}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){if(e instanceof Error)return e.stack||e.message;return e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.names=[],t.skips=[];const i=("string"==typeof e?e:"").split(/[\s,]+/),r=i.length;for(n=0;n<r;n++)i[n]&&("-"===(e=i[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,i;for(n=0,i=t.skips.length;n<i;n++)if(t.skips[n].test(e))return!1;for(n=0,i=t.names.length;n<i;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(289),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}},function(e,t){var n=1e3,i=6e4,r=60*i,s=24*r;function o(e,t,n,i){var r=t>=1.5*n;return Math.round(e/n)+" "+i+(r?"s":"")}e.exports=function(e,t){t=t||{};var a=typeof e;if("string"===a&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var o=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*s;case"hours":case"hour":case"hrs":case"hr":case"h":return o*r;case"minutes":case"minute":case"mins":case"min":case"m":return o*i;case"seconds":case"second":case"secs":case"sec":case"s":return o*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}(e);if("number"===a&&isFinite(e))return t.long?function(e){var t=Math.abs(e);if(t>=s)return o(e,t,s,"day");if(t>=r)return o(e,t,r,"hour");if(t>=i)return o(e,t,i,"minute");if(t>=n)return o(e,t,n,"second");return e+" ms"}(e):function(e){var t=Math.abs(e);if(t>=s)return Math.round(e/s)+"d";if(t>=r)return Math.round(e/r)+"h";if(t>=i)return Math.round(e/i)+"m";if(t>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}e.exports=n,n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}},function(module,exports,__webpack_require__){(function(process,Buffer){var factory;factory=function(){return function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"addLinkAttributes",{enumerable:!0,get:function(){return i.addLinkAttributes}}),Object.defineProperty(t,"getFilenameFromUrl",{enumerable:!0,get:function(){return i.getFilenameFromUrl}}),Object.defineProperty(t,"LinkTarget",{enumerable:!0,get:function(){return i.LinkTarget}}),Object.defineProperty(t,"loadScript",{enumerable:!0,get:function(){return i.loadScript}}),Object.defineProperty(t,"PDFDateString",{enumerable:!0,get:function(){return i.PDFDateString}}),Object.defineProperty(t,"RenderingCancelledException",{enumerable:!0,get:function(){return i.RenderingCancelledException}}),Object.defineProperty(t,"build",{enumerable:!0,get:function(){return r.build}}),Object.defineProperty(t,"getDocument",{enumerable:!0,get:function(){return r.getDocument}}),Object.defineProperty(t,"LoopbackPort",{enumerable:!0,get:function(){return r.LoopbackPort}}),Object.defineProperty(t,"PDFDataRangeTransport",{enumerable:!0,get:function(){return r.PDFDataRangeTransport}}),Object.defineProperty(t,"PDFWorker",{enumerable:!0,get:function(){return r.PDFWorker}}),Object.defineProperty(t,"version",{enumerable:!0,get:function(){return r.version}}),Object.defineProperty(t,"CMapCompressionType",{enumerable:!0,get:function(){return s.CMapCompressionType}}),Object.defineProperty(t,"createObjectURL",{enumerable:!0,get:function(){return s.createObjectURL}}),Object.defineProperty(t,"createPromiseCapability",{enumerable:!0,get:function(){return s.createPromiseCapability}}),Object.defineProperty(t,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return s.createValidAbsoluteUrl}}),Object.defineProperty(t,"InvalidPDFException",{enumerable:!0,get:function(){return s.InvalidPDFException}}),Object.defineProperty(t,"MissingPDFException",{enumerable:!0,get:function(){return s.MissingPDFException}}),Object.defineProperty(t,"OPS",{enumerable:!0,get:function(){return s.OPS}}),Object.defineProperty(t,"PasswordResponses",{enumerable:!0,get:function(){return s.PasswordResponses}}),Object.defineProperty(t,"PermissionFlag",{enumerable:!0,get:function(){return s.PermissionFlag}}),Object.defineProperty(t,"removeNullCharacters",{enumerable:!0,get:function(){return s.removeNullCharacters}}),Object.defineProperty(t,"shadow",{enumerable:!0,get:function(){return s.shadow}}),Object.defineProperty(t,"UnexpectedResponseException",{enumerable:!0,get:function(){return s.UnexpectedResponseException}}),Object.defineProperty(t,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return s.UNSUPPORTED_FEATURES}}),Object.defineProperty(t,"Util",{enumerable:!0,get:function(){return s.Util}}),Object.defineProperty(t,"VerbosityLevel",{enumerable:!0,get:function(){return s.VerbosityLevel}}),Object.defineProperty(t,"AnnotationLayer",{enumerable:!0,get:function(){return o.AnnotationLayer}}),Object.defineProperty(t,"apiCompatibilityParams",{enumerable:!0,get:function(){return a.apiCompatibilityParams}}),Object.defineProperty(t,"GlobalWorkerOptions",{enumerable:!0,get:function(){return c.GlobalWorkerOptions}}),Object.defineProperty(t,"renderTextLayer",{enumerable:!0,get:function(){return l.renderTextLayer}}),Object.defineProperty(t,"SVGGraphics",{enumerable:!0,get:function(){return d.SVGGraphics}});var i=n(1),r=n(5),s=n(2),o=n(19),a=n(9),c=n(12),l=n(20),d=n(21);{const{isNodeJS:e}=n(4);if(e){const e=n(22).PDFNodeStream;(0,r.setPDFNetworkStreamFactory)(t=>new e(t))}else{const e=n(25).PDFNetworkStream;let t;(0,i.isFetchSupported)()&&(t=n(26).PDFFetchStream),(0,r.setPDFNetworkStreamFactory)(n=>t&&(0,i.isValidFetchUrl)(n.url)?new t(n):new e(n))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addLinkAttributes=function(e,{url:t,target:n,rel:r,enabled:s=!0}={}){(0,i.assert)(t&&"string"==typeof t,'addLinkAttributes: A valid "url" parameter must provided.');const o=(0,i.removeNullCharacters)(t);s?e.href=e.title=o:(e.href="",e.title="Disabled: "+o,e.onclick=()=>!1);let a="";switch(n){case l.NONE:break;case l.SELF:a="_self";break;case l.BLANK:a="_blank";break;case l.PARENT:a="_parent";break;case l.TOP:a="_top"}e.target=a,e.rel="string"==typeof r?r:"noopener noreferrer nofollow"},t.getFilenameFromUrl=function(e){const t=e.indexOf("#"),n=e.indexOf("?"),i=Math.min(t>0?t:e.length,n>0?n:e.length);return e.substring(e.lastIndexOf("/",i)+1,i)},t.isFetchSupported=d,t.isValidFetchUrl=u,t.loadScript=function(e){return new Promise((t,n)=>{const i=document.createElement("script");i.src=e,i.onload=t,i.onerror=function(){n(new Error("Cannot load script at: "+i.src))},(document.head||document.documentElement).appendChild(i)})},t.deprecated=function(e){console.log("Deprecated API usage: "+e)},t.PDFDateString=t.StatTimer=t.DOMSVGFactory=t.DOMCMapReaderFactory=t.BaseCMapReaderFactory=t.DOMCanvasFactory=t.BaseCanvasFactory=t.DEFAULT_LINK_REL=t.LinkTarget=t.RenderingCancelledException=t.PageViewport=void 0;var i=n(2);t.DEFAULT_LINK_REL="noopener noreferrer nofollow";const r="http://www.w3.org/2000/svg";class s{constructor(){this.constructor===s&&(0,i.unreachable)("Cannot initialize BaseCanvasFactory.")}create(e,t){(0,i.unreachable)("Abstract method `create` called.")}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}}t.BaseCanvasFactory=s,t.DOMCanvasFactory=class extends s{constructor({ownerDocument:e=globalThis.document}={}){super(),this._document=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._document.createElement("canvas"),i=n.getContext("2d");return n.width=e,n.height=t,{canvas:n,context:i}}};class o{constructor({baseUrl:e=null,isCompressed:t=!1}){this.constructor===o&&(0,i.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":""),n=this.isCompressed?i.CMapCompressionType.BINARY:i.CMapCompressionType.NONE;return this._fetchData(t,n).catch(e=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}_fetchData(e,t){(0,i.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=o,t.DOMCMapReaderFactory=class extends o{_fetchData(e,t){return d()&&u(e,document.baseURI)?fetch(e).then(async e=>{if(!e.ok)throw new Error(e.statusText);let n;return n=this.isCompressed?new Uint8Array(await e.arrayBuffer()):(0,i.stringToBytes)(await e.text()),{cMapData:n,compressionType:t}}):new Promise((n,r)=>{const s=new XMLHttpRequest;s.open("GET",e,!0),this.isCompressed&&(s.responseType="arraybuffer"),s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(200===s.status||0===s.status){let e;if(this.isCompressed&&s.response?e=new Uint8Array(s.response):!this.isCompressed&&s.responseText&&(e=(0,i.stringToBytes)(s.responseText)),e)return void n({cMapData:e,compressionType:t})}r(new Error(s.statusText))}},s.send(null)})}},t.DOMSVGFactory=class{create(e,t){(0,i.assert)(e>0&&t>0,"Invalid SVG dimensions");const n=document.createElementNS(r,"svg:svg");return n.setAttribute("version","1.1"),n.setAttribute("width",e+"px"),n.setAttribute("height",t+"px"),n.setAttribute("preserveAspectRatio","none"),n.setAttribute("viewBox","0 0 "+e+" "+t),n}createElement(e){return(0,i.assert)("string"==typeof e,"Invalid SVG element type"),document.createElementNS(r,e)}};class a{constructor({viewBox:e,scale:t,rotation:n,offsetX:i=0,offsetY:r=0,dontFlip:s=!1}){this.viewBox=e,this.scale=t,this.rotation=n,this.offsetX=i,this.offsetY=r;const o=(e[2]+e[0])/2,a=(e[3]+e[1])/2;let c,l,d,u,h,p,f,g;switch(n=(n%=360)<0?n+360:n){case 180:c=-1,l=0,d=0,u=1;break;case 90:c=0,l=1,d=1,u=0;break;case 270:c=0,l=-1,d=-1,u=0;break;case 0:c=1,l=0,d=0,u=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}s&&(d=-d,u=-u),0===c?(h=Math.abs(a-e[1])*t+i,p=Math.abs(o-e[0])*t+r,f=Math.abs(e[3]-e[1])*t,g=Math.abs(e[2]-e[0])*t):(h=Math.abs(o-e[0])*t+i,p=Math.abs(a-e[1])*t+r,f=Math.abs(e[2]-e[0])*t,g=Math.abs(e[3]-e[1])*t),this.transform=[c*t,l*t,d*t,u*t,h-c*t*o-d*t*a,p-l*t*o-u*t*a],this.width=f,this.height=g}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:i=this.offsetY,dontFlip:r=!1}={}){return new a({viewBox:this.viewBox.slice(),scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}convertToViewportPoint(e,t){return i.Util.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=i.Util.applyTransform([e[0],e[1]],this.transform),n=i.Util.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){return i.Util.applyInverseTransform([e,t],this.transform)}}t.PageViewport=a;class c extends i.BaseException{constructor(e,t){super(e),this.type=t}}t.RenderingCancelledException=c;const l={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};function d(){return"undefined"!=typeof fetch&&"undefined"!=typeof Response&&"body"in Response.prototype&&"undefined"!=typeof ReadableStream}function u(e,t){try{const{protocol:n}=t?new URL(e,t):new URL(e);return"http:"===n||"https:"===n}catch(e){return!1}}let h;t.LinkTarget=l,t.StatTimer=class{constructor(){this.started=Object.create(null),this.times=[]}time(e){e in this.started&&(0,i.warn)("Timer is already running for "+e),this.started[e]=Date.now()}timeEnd(e){e in this.started||(0,i.warn)("Timer has not been started for "+e),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const e of this.times){const n=e.name;n.length>t&&(t=n.length)}for(const n of this.times){const i=n.end-n.start;e.push(`${n.name.padEnd(t)} ${i}ms\n`)}return e.join("")}},t.PDFDateString=class{static toDateObject(e){if(!e||!(0,i.isString)(e))return null;h||(h=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=h.exec(e);if(!t)return null;const n=parseInt(t[1],10);let r=parseInt(t[2],10);r=r>=1&&r<=12?r-1:0;let s=parseInt(t[3],10);s=s>=1&&s<=31?s:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let c=parseInt(t[6],10);c=c>=0&&c<=59?c:0;const l=t[7]||"Z";let d=parseInt(t[8],10);d=d>=0&&d<=23?d:0;let u=parseInt(t[9],10)||0;return u=u>=0&&u<=59?u:0,"-"===l?(o+=d,a+=u):"+"===l&&(o-=d,a-=u),new Date(Date.UTC(n,r,s,o,a,c))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.arrayByteLength=h,t.arraysToBytes=function(e){const t=e.length;if(1===t&&e[0]instanceof Uint8Array)return e[0];let n=0;for(let i=0;i<t;i++)n+=h(e[i]);let i=0;const r=new Uint8Array(n);for(let n=0;n<t;n++){let t=e[n];t instanceof Uint8Array||(t="string"==typeof t?u(t):new Uint8Array(t));const s=t.byteLength;r.set(t,i),i+=s}return r},t.assert=a,t.bytesToString=function(e){a(null!==e&&"object"==typeof e&&void 0!==e.length,"Invalid argument for bytesToString");const t=e.length;if(t<8192)return String.fromCharCode.apply(null,e);const n=[];for(let i=0;i<t;i+=8192){const r=Math.min(i+8192,t),s=e.subarray(i,r);n.push(String.fromCharCode.apply(null,s))}return n.join("")},t.createPromiseCapability=function(){const e=Object.create(null);let t=!1;return Object.defineProperty(e,"settled",{get:()=>t}),e.promise=new Promise((function(n,i){e.resolve=function(e){t=!0,n(e)},e.reject=function(e){t=!0,i(e)}})),e},t.escapeString=function(e){return e.replace(/([\(\)\\])/g,"\\$1")},t.getModificationDate=function(e=new Date(Date.now())){return[e.getUTCFullYear().toString(),(e.getUTCMonth()+1).toString().padStart(2,"0"),(e.getUTCDate()+1).toString().padStart(2,"0"),e.getUTCHours().toString().padStart(2,"0"),e.getUTCMinutes().toString().padStart(2,"0"),e.getUTCSeconds().toString().padStart(2,"0")].join("")},t.getVerbosityLevel=function(){return r},t.info=function(e){r>=i.INFOS&&console.log("Info: "+e)},t.isArrayBuffer=function(e){return"object"==typeof e&&null!==e&&void 0!==e.byteLength},t.isArrayEqual=function(e,t){return e.length===t.length&&e.every((function(e,n){return e===t[n]}))},t.isBool=function(e){return"boolean"==typeof e},t.isNum=function(e){return"number"==typeof e},t.isString=function(e){return"string"==typeof e},t.isSameOrigin=function(e,t){let n;try{if(n=new URL(e),!n.origin||"null"===n.origin)return!1}catch(e){return!1}const i=new URL(t,n);return n.origin===i.origin},t.createValidAbsoluteUrl=function(e,t){if(!e)return null;try{const n=t?new URL(e,t):new URL(e);if(function(e){if(!e)return!1;switch(e.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}(n))return n}catch(e){}return null},t.removeNullCharacters=function(e){return"string"!=typeof e?(s("The argument for removeNullCharacters must be a string."),e):e.replace(d,"")},t.setVerbosityLevel=function(e){Number.isInteger(e)&&(r=e)},t.shadow=c,t.string32=function(e){return String.fromCharCode(e>>24&255,e>>16&255,e>>8&255,255&e)},t.stringToBytes=u,t.stringToPDFString=function(e){const t=e.length,n=[];if(""===e[0]&&""===e[1])for(let i=2;i<t;i+=2)n.push(String.fromCharCode(e.charCodeAt(i)<<8|e.charCodeAt(i+1)));else if(""===e[0]&&""===e[1])for(let i=2;i<t;i+=2)n.push(String.fromCharCode(e.charCodeAt(i+1)<<8|e.charCodeAt(i)));else for(let i=0;i<t;++i){const t=v[e.charCodeAt(i)];n.push(t?String.fromCharCode(t):e.charAt(i))}return n.join("")},t.stringToUTF8String=function(e){return decodeURIComponent(escape(e))},t.utf8StringToString=function(e){return unescape(encodeURIComponent(e))},t.warn=s,t.unreachable=o,t.IsEvalSupportedCached=t.IsLittleEndianCached=t.createObjectURL=t.FormatError=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.StreamType=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.MissingPDFException=t.InvalidPDFException=t.AbortException=t.CMapCompressionType=t.ImageKind=t.FontType=t.AnnotationType=t.AnnotationStateModelType=t.AnnotationReviewState=t.AnnotationReplyType=t.AnnotationMarkedState=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationBorderStyleType=t.UNSUPPORTED_FEATURES=t.VerbosityLevel=t.OPS=t.IDENTITY_MATRIX=t.FONT_IDENTITY_MATRIX=t.BaseException=void 0,n(3),t.IDENTITY_MATRIX=[1,0,0,1,0,0],t.FONT_IDENTITY_MATRIX=[.001,0,0,.001,0,0],t.PermissionFlag={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},t.TextRenderingMode={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},t.ImageKind={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},t.AnnotationType={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},t.AnnotationStateModelType={MARKED:"Marked",REVIEW:"Review"},t.AnnotationMarkedState={MARKED:"Marked",UNMARKED:"Unmarked"},t.AnnotationReviewState={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"},t.AnnotationReplyType={GROUP:"Group",REPLY:"R"},t.AnnotationFlag={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512},t.AnnotationFieldFlag={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864},t.AnnotationBorderStyleType={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},t.StreamType={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"},t.FontType={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};const i={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=i,t.CMapCompressionType={NONE:0,BINARY:1,STREAM:2},t.OPS={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91},t.UNSUPPORTED_FEATURES={unknown:"unknown",forms:"forms",javaScript:"javaScript",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent"},t.PasswordResponses={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let r=i.WARNINGS;function s(e){r>=i.WARNINGS&&console.log("Warning: "+e)}function o(e){throw new Error(e)}function a(e,t){e||o(t)}function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!1}),n}const l=function(){function e(t){this.constructor===e&&o("Cannot initialize BaseException."),this.message=t,this.name=this.constructor.name}return e.prototype=new Error,e.constructor=e,e}();t.BaseException=l,t.PasswordException=class extends l{constructor(e,t){super(e),this.code=t}},t.UnknownErrorException=class extends l{constructor(e,t){super(e),this.details=t}},t.InvalidPDFException=class extends l{},t.MissingPDFException=class extends l{},t.UnexpectedResponseException=class extends l{constructor(e,t){super(e),this.status=t}},t.FormatError=class extends l{},t.AbortException=class extends l{};const d=/\x00/g;function u(e){a("string"==typeof e,"Invalid argument for stringToBytes");const t=e.length,n=new Uint8Array(t);for(let i=0;i<t;++i)n[i]=255&e.charCodeAt(i);return n}function h(e){return void 0!==e.length?e.length:(a(void 0!==e.byteLength,"arrayByteLength - invalid argument."),e.byteLength)}const p={get value(){return c(this,"value",function(){const e=new Uint8Array(4);return e[0]=1,1===new Uint32Array(e.buffer,0,1)[0]}())}};t.IsLittleEndianCached=p;const f={get value(){return c(this,"value",function(){try{return new Function(""),!0}catch(e){return!1}}())}};t.IsEvalSupportedCached=f;const g=["rgb(",0,",",0,",",0,")"];class m{static makeCssRgb(e,t,n){return g[1]=e,g[3]=t,g[5]=n,g.join("")}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){return[e[0]*t[0]+e[1]*t[2]+t[4],e[0]*t[1]+e[1]*t[3]+t[5]]}static applyInverseTransform(e,t){const n=t[0]*t[3]-t[1]*t[2];return[(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/n,(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/n]}static getAxialAlignedBoundingBox(e,t){const n=m.applyTransform(e,t),i=m.applyTransform(e.slice(2,4),t),r=m.applyTransform([e[0],e[3]],t),s=m.applyTransform([e[2],e[1]],t);return[Math.min(n[0],i[0],r[0],s[0]),Math.min(n[1],i[1],r[1],s[1]),Math.max(n[0],i[0],r[0],s[0]),Math.max(n[1],i[1],r[1],s[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static apply3dTransform(e,t){return[e[0]*t[0]+e[1]*t[1]+e[2]*t[2],e[3]*t[0]+e[4]*t[1]+e[5]*t[2],e[6]*t[0]+e[7]*t[1]+e[8]*t[2]]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],n=e[0]*t[0]+e[1]*t[2],i=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],s=e[2]*t[1]+e[3]*t[3],o=(n+s)/2,a=Math.sqrt((n+s)*(n+s)-4*(n*s-r*i))/2,c=o+a||1,l=o-a||1;return[Math.sqrt(c),Math.sqrt(l)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){function n(e,t){return e-t}const i=[e[0],e[2],t[0],t[2]].sort(n),r=[e[1],e[3],t[1],t[3]].sort(n),s=[];return e=m.normalizeRect(e),t=m.normalizeRect(t),i[0]===e[0]&&i[1]===t[0]||i[0]===t[0]&&i[1]===e[0]?(s[0]=i[1],s[2]=i[2],r[0]===e[1]&&r[1]===t[1]||r[0]===t[1]&&r[1]===e[1]?(s[1]=r[1],s[3]=r[2],s):null):null}}t.Util=m;const v=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364],b=function(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";return function(t,n,i=!1){if(!i&&URL.createObjectURL){const e=new Blob([t],{type:n});return URL.createObjectURL(e)}let r=`data:${n};base64,`;for(let n=0,i=t.length;n<i;n+=3){const s=255&t[n],o=255&t[n+1],a=255&t[n+2];r+=e[s>>2]+e[(3&s)<<4|o>>4]+e[n+1<i?(15&o)<<2|a>>6:64]+e[n+2<i?63&a:64]}return r}}();t.createObjectURL=b},function(e,t,n){"use strict";n(4)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNodeJS=void 0;const i=!("object"!=typeof process||process+""!="[object process]"||process.versions.nw||process.versions.electron&&process.type&&"browser"!==process.type);t.isNodeJS=i},function(module,exports,__w_pdfjs_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.build=exports.version=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFWorker=exports.PDFDataRangeTransport=exports.LoopbackPort=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(6),_node_utils=__w_pdfjs_require__(7),_annotation_storage=__w_pdfjs_require__(8),_api_compatibility=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(16),_transport_stream=__w_pdfjs_require__(17),_webgl=__w_pdfjs_require__(18);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory,DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(e){createPDFNetworkStream=e}function getDocument(e){const t=new PDFDocumentLoadingTask;let n;if("string"==typeof e)n={url:e};else if((0,_util.isArrayBuffer)(e))n={data:e};else if(e instanceof PDFDataRangeTransport)n={range:e};else{if("object"!=typeof e)throw new Error("Invalid parameter in getDocument, need either Uint8Array, string or a parameter object");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");n=e}const i=Object.create(null);let r=null,s=null;for(const e in n)if("url"!==e||"undefined"==typeof window)if("range"!==e)if("worker"!==e)if("data"!==e||n[e]instanceof Uint8Array)i[e]=n[e];else{const t=n[e];if("string"==typeof t)i[e]=(0,_util.stringToBytes)(t);else if("object"!=typeof t||null===t||isNaN(t.length)){if(!(0,_util.isArrayBuffer)(t))throw new Error("Invalid PDF binary data: either typed array, string or array-like object is expected in the data property.");i[e]=new Uint8Array(t)}else i[e]=new Uint8Array(t)}else s=n[e];else r=n[e];else i[e]=new URL(n[e],window.location).href;if(i.rangeChunkSize=i.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,i.CMapReaderFactory=i.CMapReaderFactory||DefaultCMapReaderFactory,i.ignoreErrors=!0!==i.stopAtErrors,i.fontExtraProperties=!0===i.fontExtraProperties,i.pdfBug=!0===i.pdfBug,Number.isInteger(i.maxImageSize)||(i.maxImageSize=-1),"boolean"!=typeof i.isEvalSupported&&(i.isEvalSupported=!0),"boolean"!=typeof i.disableFontFace&&(i.disableFontFace=_api_compatibility.apiCompatibilityParams.disableFontFace||!1),void 0===i.ownerDocument&&(i.ownerDocument=globalThis.document),"boolean"!=typeof i.disableRange&&(i.disableRange=!1),"boolean"!=typeof i.disableStream&&(i.disableStream=!1),"boolean"!=typeof i.disableAutoFetch&&(i.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(i.verbosity),!s){const e={verbosity:i.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};s=e.port?PDFWorker.fromPort(e):new PDFWorker(e),t._worker=s}const o=t.docId;return s.promise.then((function(){if(t.destroyed)throw new Error("Loading aborted");const e=_fetchDocument(s,i,r,o),n=new Promise((function(e){let t;r?t=new _transport_stream.PDFDataTransportStream({length:i.length,initialData:i.initialData,progressiveDone:i.progressiveDone,disableRange:i.disableRange,disableStream:i.disableStream},r):i.data||(t=createPDFNetworkStream({url:i.url,length:i.length,httpHeaders:i.httpHeaders,withCredentials:i.withCredentials,rangeChunkSize:i.rangeChunkSize,disableRange:i.disableRange,disableStream:i.disableStream})),e(t)}));return Promise.all([e,n]).then((function([e,n]){if(t.destroyed)throw new Error("Loading aborted");const r=new _message_handler.MessageHandler(o,e,s.port);r.postMessageTransfers=s.postMessageTransfers;const a=new WorkerTransport(r,t,n,i);t._transport=a,r.send("Ready",null)}))})).catch(t._capability.reject),t}function _fetchDocument(e,t,n,i){return e.destroyed?Promise.reject(new Error("Worker was destroyed")):(n&&(t.length=n.length,t.initialData=n.initialData,t.progressiveDone=n.progressiveDone),e.messageHandler.sendWithPromise("GetDocRequest",{docId:i,apiVersion:"2.6.347",source:{data:t.data,url:t.url,password:t.password,disableAutoFetch:t.disableAutoFetch,rangeChunkSize:t.rangeChunkSize,length:t.length},maxImageSize:t.maxImageSize,disableFontFace:t.disableFontFace,postMessageTransfers:e.postMessageTransfers,docBaseUrl:t.docBaseUrl,ignoreErrors:t.ignoreErrors,isEvalSupported:t.isEvalSupported,fontExtraProperties:t.fontExtraProperties}).then((function(t){if(e.destroyed)throw new Error("Worker was destroyed");return t})))}const PDFDocumentLoadingTask=function(){let e=0;return class{constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId="d"+e++,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}destroy(){return this.destroyed=!0,(this._transport?this._transport.destroy():Promise.resolve()).then(()=>{this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)})}}}();class PDFDataRangeTransport{constructor(e,t,n=!1){this.length=e,this.initialData=t,this.progressiveDone=n,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const n of this._rangeListeners)n(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}get numPages(){return this._pdfInfo.numPages}get fingerprint(){return this._pdfInfo.fingerprint}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(){return this._transport.startCleanup()}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(e){return this._transport.saveDocument(e)}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(e,t,n,i,r=!1){this._pageIndex=e,this._pageInfo=t,this._ownerDocument=i,this._transport=n,this._stats=r?new _display_utils.StatTimer:null,this._pdfBug=r,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:i=0,dontFlip:r=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:e,rotation:t,offsetX:n,offsetY:i,dontFlip:r})}getAnnotations({intent:e=null}={}){return this.annotationsPromise&&this.annotationsIntent===e||(this.annotationsPromise=this._transport.getAnnotations(this._pageIndex,e),this.annotationsIntent=e),this.annotationsPromise}render({canvasContext:e,viewport:t,intent:n="display",enableWebGL:i=!1,renderInteractiveForms:r=!1,transform:s=null,imageLayer:o=null,canvasFactory:a=null,background:c=null,annotationStorage:l=null,optionalContentConfigPromise:d=null}){this._stats&&this._stats.time("Overall");const u="print"===n?"print":"display";this.pendingCleanup=!1,d||(d=this._transport.getOptionalContentConfig());let h=this._intentStates.get(u);h||(h=Object.create(null),this._intentStates.set(u,h)),h.streamReaderCancelTimeout&&(clearTimeout(h.streamReaderCancelTimeout),h.streamReaderCancelTimeout=null);const p=a||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),f=new _webgl.WebGLContext({enable:i});h.displayReadyCapability||(h.displayReadyCapability=(0,_util.createPromiseCapability)(),h.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:u,renderInteractiveForms:!0===r,annotationStorage:l&&l.getAll()||null}));const g=e=>{const t=h.renderTasks.indexOf(m);t>=0&&h.renderTasks.splice(t,1),(this.cleanupAfterRender||"print"===u)&&(this.pendingCleanup=!0),this._tryCleanup(),e?(m.capability.reject(e),this._abortOperatorList({intentState:h,reason:e})):m.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},m=new InternalRenderTask({callback:g,params:{canvasContext:e,viewport:t,transform:s,imageLayer:o,background:c},objs:this.objs,commonObjs:this.commonObjs,operatorList:h.operatorList,pageIndex:this._pageIndex,canvasFactory:p,webGLContext:f,useRequestAnimationFrame:"print"!==u,pdfBug:this._pdfBug});h.renderTasks||(h.renderTasks=[]),h.renderTasks.push(m);const v=m.task;return Promise.all([h.displayReadyCapability.promise,d]).then(([e,t])=>{this.pendingCleanup?g():(this._stats&&this._stats.time("Rendering"),m.initializeGraphics({transparency:e,optionalContentConfig:t}),m.operatorListChanged())}).catch(g),v}getOperatorList(){let e,t=this._intentStates.get("oplist");return t||(t=Object.create(null),this._intentStates.set("oplist",t)),t.opListReadCapability||(e=Object.create(null),e.operatorListChanged=function(){if(t.operatorList.lastChunk){t.opListReadCapability.resolve(t.operatorList);const n=t.renderTasks.indexOf(e);n>=0&&t.renderTasks.splice(n,1)}},t.opListReadCapability=(0,_util.createPromiseCapability)(),t.renderTasks=[],t.renderTasks.push(e),t.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList({pageIndex:this._pageIndex,intent:"oplist"})),t.opListReadCapability.promise}streamTextContent({normalizeWhitespace:e=!1,disableCombineTextItems:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:!0===e,combineTextItems:!0!==t},{highWaterMark:100,size:e=>e.items.length})}getTextContent(e={}){const t=this.streamTextContent(e);return new Promise((function(e,n){const i=t.getReader(),r={items:[],styles:Object.create(null)};!function t(){i.read().then((function({value:n,done:i}){i?e(r):(Object.assign(r.styles,n.styles),r.items.push(...n.items),t())}),n)}()}))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const e=[];for(const[t,n]of this._intentStates)if(this._abortOperatorList({intentState:n,reason:new Error("Page was destroyed."),force:!0}),"oplist"!==t)for(const t of n.renderTasks)e.push(t.completed),t.cancel();return this.objs.clear(),this.annotationsPromise=null,this.pendingCleanup=!1,Promise.all(e)}cleanup(e=!1){return this.pendingCleanup=!0,this._tryCleanup(e)}_tryCleanup(e=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(0!==e.length||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.annotationsPromise=null,e&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats&&this._stats.timeEnd("Page Request"),n.displayReadyCapability&&n.displayReadyCapability.resolve(e))}_renderPageChunk(e,t){for(let n=0,i=e.length;n<i;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk;for(let e=0;e<t.renderTasks.length;e++)t.renderTasks[e].operatorListChanged();e.lastChunk&&this._tryCleanup()}_pumpOperatorList(e){(0,_util.assert)(e.intent,'PDFPageProxy._pumpOperatorList: Expected "intent" argument.');const t=this._transport.messageHandler.sendWithStream("GetOperatorList",e).getReader(),n=this._intentStates.get(e.intent);n.streamReader=t;const i=()=>{t.read().then(({value:e,done:t})=>{t?n.streamReader=null:this._transport.destroyed||(this._renderPageChunk(e,n),i())},e=>{if(n.streamReader=null,!this._transport.destroyed){if(n.operatorList){n.operatorList.lastChunk=!0;for(let e=0;e<n.renderTasks.length;e++)n.renderTasks[e].operatorListChanged();this._tryCleanup()}if(n.displayReadyCapability)n.displayReadyCapability.reject(e);else{if(!n.opListReadCapability)throw e;n.opListReadCapability.reject(e)}}})};i()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if((0,_util.assert)(t instanceof Error||"object"==typeof t&&null!==t,'PDFPageProxy._abortOperatorList: Expected "reason" argument.'),e.streamReader){if(!n){if(0!==e.renderTasks.length)return;if(t instanceof _display_utils.RenderingCancelledException)return void(e.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:e,reason:t,force:!0}),e.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT))}if(e.streamReader.cancel(new _util.AbortException(t&&t.message)),e.streamReader=null,!this._transport.destroyed){for(const[t,n]of this._intentStates)if(n===e){this._intentStates.delete(t);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(e=!0){this._listeners=[],this._defer=e,this._deferred=Promise.resolve(void 0)}postMessage(e,t){if(!this._defer)return void this._listeners.forEach(t=>{t.call(this,{data:e})});const n=new WeakMap,i={data:function e(i){if("object"!=typeof i||null===i)return i;if(n.has(i))return n.get(i);let r,s;if((r=i.buffer)&&(0,_util.isArrayBuffer)(r))return s=t&&t.includes(r)?new i.constructor(r,i.byteOffset,i.byteLength):new i.constructor(i),n.set(i,s),s;s=Array.isArray(i)?[]:{},n.set(i,s);for(const t in i){let n,r=i;for(;!(n=Object.getOwnPropertyDescriptor(r,t));)r=Object.getPrototypeOf(r);if(void 0!==n.value)if("function"!=typeof n.value)s[t]=e(n.value);else if(i.hasOwnProperty&&i.hasOwnProperty(t))throw new Error("LoopbackPort.postMessage - cannot clone: "+i[t])}return s}(e)};this._deferred.then(()=>{this._listeners.forEach(e=>{e.call(this,i)})})}addEventListener(e,t){this._listeners.push(t)}removeEventListener(e,t){const n=this._listeners.indexOf(t);this._listeners.splice(n,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorker=function PDFWorkerClosure(){const pdfWorkerPorts=new WeakMap;let isWorkerDisabled=!1,fallbackWorkerSrc,nextFakeWorkerId=0,fakeWorkerCapability;if(_is_node.isNodeJS)isWorkerDisabled=!0,fallbackWorkerSrc="./pdf.worker.js";else if("object"==typeof document&&"currentScript"in document){const e=document.currentScript&&document.currentScript.src;e&&(fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}function getWorkerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(void 0!==fallbackWorkerSrc)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}function getMainThreadWorkerMessageHandler(){let e;try{e=globalThis.pdfjsWorker&&globalThis.pdfjsWorker.WorkerMessageHandler}catch(e){}return e||null}function setupFakeWorkerGlobal(){if(fakeWorkerCapability)return fakeWorkerCapability.promise;fakeWorkerCapability=(0,_util.createPromiseCapability)();const loader=async function(){const mainWorkerMessageHandler=getMainThreadWorkerMessageHandler();if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS){const worker=eval("require")(getWorkerSrc());return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(getWorkerSrc()),window.pdfjsWorker.WorkerMessageHandler};return loader().then(fakeWorkerCapability.resolve,fakeWorkerCapability.reject),fakeWorkerCapability.promise}function createCDNWrapper(e){const t="importScripts('"+e+"');";return URL.createObjectURL(new Blob([t]))}class PDFWorker{constructor({name:e=null,port:t=null,verbosity:n=(0,_util.getVerbosityLevel)()}={}){if(t&&pdfWorkerPorts.has(t))throw new Error("Cannot use more than one PDFWorker per port");if(this.name=e,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=n,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,t)return pdfWorkerPorts.set(t,this),void this._initializeFromPort(t);this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",(function(){})),this._readyCapability.resolve()}_initialize(){if("undefined"!=typeof Worker&&!isWorkerDisabled&&!getMainThreadWorkerMessageHandler()){let e=getWorkerSrc();try{(0,_util.isSameOrigin)(window.location.href,e)||(e=createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),n=new _message_handler.MessageHandler("main","worker",t),i=()=>{t.removeEventListener("error",r),n.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=()=>{this._webWorker||i()};t.addEventListener("error",r),n.on("test",e=>{t.removeEventListener("error",r),this.destroyed?i():e?(this._messageHandler=n,this._port=t,this._webWorker=t,e.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),n.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),n.destroy(),t.terminate())}),n.on("ready",e=>{if(t.removeEventListener("error",r),this.destroyed)i();else try{s()}catch(e){this._setupFakeWorker()}});const s=()=>{const e=new Uint8Array([this.postMessageTransfers?255:0]);try{n.send("test",e,[e.buffer])}catch(t){(0,_util.warn)("Cannot use postMessage transfers."),e[0]=0,n.send("test",e)}};return void s()}catch(e){(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),isWorkerDisabled=!0),setupFakeWorkerGlobal().then(e=>{if(this.destroyed)return void this._readyCapability.reject(new Error("Worker was destroyed"));const t=new LoopbackPort;this._port=t;const n="fake"+nextFakeWorkerId++,i=new _message_handler.MessageHandler(n+"_worker",n,t);e.setup(i,t);const r=new _message_handler.MessageHandler(n,n+"_worker",t);this._messageHandler=r,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),pdfWorkerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e||!e.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return pdfWorkerPorts.has(e.port)?pdfWorkerPorts.get(e.port):new PDFWorker(e)}static getWorkerSrc(){return getWorkerSrc()}}return PDFWorker}();exports.PDFWorker=PDFWorker;class WorkerTransport{constructor(e,t,n,i){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:i.ownerDocument}),this._params=i,this.CMapReaderFactory=new i.CMapReaderFactory({baseUrl:i.cMapUrl,isCompressed:i.cMapPacked}),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];this.pageCache.forEach((function(t){t&&e.push(t._destroy())})),this.pageCache.length=0,this.pagePromises.length=0;const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.fontLoader.clear(),this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=e=>{this._lastProgress={loaded:e.loaded,total:e.total}},t.onPull=()=>{this._fullReader.read().then((function({value:e,done:n}){n?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(e),"GetReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))})).catch(e=>{t.error(e)})},t.onCancel=e=>{this._fullReader.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}}),e.on("ReaderHeadersReady",e=>{const n=(0,_util.createPromiseCapability)(),i=this._fullReader;return i.headersReady.then(()=>{i.isStreamingSupported&&i.isRangeSupported||(this._lastProgress&&t.onProgress&&t.onProgress(this._lastProgress),i.onProgress=e=>{t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),n.resolve({isStreamingSupported:i.isStreamingSupported,isRangeSupported:i.isRangeSupported,contentLength:i.contentLength})},n.reject),n.promise}),e.on("GetRangeReader",(e,t)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const n=this._networkStream.getRangeReader(e.begin,e.end);n?(t.onPull=()=>{n.read().then((function({value:e,done:n}){n?t.close():((0,_util.assert)((0,_util.isArrayBuffer)(e),"GetRangeReader - expected an ArrayBuffer."),t.enqueue(new Uint8Array(e),1,[e]))})).catch(e=>{t.error(e)})},t.onCancel=e=>{n.cancel(e),t.ready.catch(e=>{if(!this.destroyed)throw e})}):t.close()}),e.on("GetDoc",({pdfInfo:e})=>{this._numPages=e.numPages,t._capability.resolve(new PDFDocumentProxy(e,this))}),e.on("DocException",(function(e){let n;switch(e.name){case"PasswordException":n=new _util.PasswordException(e.message,e.code);break;case"InvalidPDFException":n=new _util.InvalidPDFException(e.message);break;case"MissingPDFException":n=new _util.MissingPDFException(e.message);break;case"UnexpectedResponseException":n=new _util.UnexpectedResponseException(e.message,e.status);break;case"UnknownErrorException":n=new _util.UnknownErrorException(e.message,e.details)}if(!(n instanceof Error)){const e="DocException - expected a valid Error.";(0,_util.warn)(e)}t._capability.reject(n)})),e.on("PasswordRequest",e=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const n=e=>{this._passwordCapability.resolve({password:e})};try{t.onPassword(n,e.code)}catch(e){this._passwordCapability.reject(e)}}else this._passwordCapability.reject(new _util.PasswordException(e.message,e.code));return this._passwordCapability.promise}),e.on("DataLoaded",e=>{t.onProgress&&t.onProgress({loaded:e.length,total:e.length}),this.downloadInfoCapability.resolve(e)}),e.on("StartRenderPage",e=>{this.destroyed||this.pageCache[e.pageIndex]._startRenderPage(e.transparency,e.intent)}),e.on("commonobj",t=>{if(this.destroyed)return;const[n,i,r]=t;if(!this.commonObjs.has(n))switch(i){case"Font":const t=this._params;if("error"in r){const e=r.error;(0,_util.warn)("Error during font loading: "+e),this.commonObjs.resolve(n,e);break}let s=null;t.pdfBug&&globalThis.FontInspector&&globalThis.FontInspector.enabled&&(s={registerFont(e,t){globalThis.FontInspector.fontAdded(e,t)}});const o=new _font_loader.FontFaceObject(r,{isEvalSupported:t.isEvalSupported,disableFontFace:t.disableFontFace,ignoreErrors:t.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:s});this.fontLoader.bind(o).catch(t=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!t.fontExtraProperties&&o.data&&(o.data=null),this.commonObjs.resolve(n,o)});break;case"FontPath":case"Image":this.commonObjs.resolve(n,r);break;default:throw new Error("Got unknown common object type "+i)}}),e.on("obj",e=>{if(this.destroyed)return;const[t,n,i,r]=e,s=this.pageCache[n];if(!s.objs.has(t))switch(i){case"Image":s.objs.resolve(t,r);const e=8e6;r&&"data"in r&&r.data.length>e&&(s.cleanupAfterRender=!0);break;default:throw new Error("Got unknown object type "+i)}}),e.on("DocProgress",e=>{this.destroyed||t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}),e.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),e.on("FetchBuiltInCMap",(e,t)=>{if(this.destroyed)return void t.error(new Error("Worker was destroyed"));let n=!1;t.onPull=()=>{n?t.close():(n=!0,this.CMapReaderFactory.fetch(e).then((function(e){t.enqueue(e,1,[e.cMapData.buffer])})).catch((function(e){t.error(e)})))}})}_onUnsupportedFeature({featureId:e}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(e)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request"));const t=e-1;if(t in this.pagePromises)return this.pagePromises[t];const n=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(e=>{if(this.destroyed)throw new Error("Transport destroyed");const n=new PDFPageProxy(t,e,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[t]=n,n});return this.pagePromises[t]=n,n}getPageIndex(e){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:e}).catch((function(e){return Promise.reject(new Error(e))}))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}saveDocument(e){return this.messageHandler.sendWithPromise("SaveDocument",{numPages:this._numPages,annotationStorage:e&&e.getAll()||null,filename:this._fullReader?this._fullReader.filename:null}).finally(()=>{e&&e.resetModified()})}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return"string"!=typeof e?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(e=>new _optional_content_config.OptionalContentConfig(e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(e=>({info:e[0],metadata:e[1]?new _metadata.Metadata(e[1]):null,contentDispositionFilename:this._fullReader?this._fullReader.filename:null}))}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}startCleanup(){return this.messageHandler.sendWithPromise("Cleanup",null).then(()=>{for(let e=0,t=this.pageCache.length;e<t;e++){const t=this.pageCache[e];if(t&&!t.cleanup())throw new Error(`startCleanup: Page ${e+1} is currently rendering.`)}this.commonObjs.clear(),this.fontLoader.clear()})}get loadingParams(){const e=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:e.disableAutoFetch,disableFontFace:e.disableFontFace})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(e){return this._objs[e]?this._objs[e]:this._objs[e]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(e,t=null){if(t)return this._ensureObj(e).capability.promise.then(t),null;const n=this._objs[e];if(!n||!n.resolved)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this._objs[e];return!!t&&t.resolved}resolve(e,t){const n=this._ensureObj(e);n.resolved=!0,n.data=t,n.capability.resolve(t)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(e){this._internalRenderTask=e,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}const InternalRenderTask=function(){const e=new WeakSet;return class{constructor({callback:e,params:t,objs:n,commonObjs:i,operatorList:r,pageIndex:s,canvasFactory:o,webGLContext:a,useRequestAnimationFrame:c=!1,pdfBug:l=!1}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=i,this.operatorListIdx=null,this.operatorList=r,this._pageIndex=s,this.canvasFactory=o,this.webGLContext=a,this._pdfBug=l,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=!0===c&&"undefined"!=typeof window,this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch((function(){}))}initializeGraphics({transparency:t=!1,optionalContentConfig:n}){if(this.cancelled)return;if(this._canvas){if(e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager&&globalThis.StepperManager.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:r,transform:s,imageLayer:o,background:a}=this.params;this.gfx=new _canvas.CanvasGraphics(i,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext,o,n),this.gfx.beginDrawing({transform:s,viewport:r,transparency:t,background:a}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(t=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException("Rendering cancelled, page "+(this._pageIndex+1),"canvas"))}operatorListChanged(){this.graphicsReady?(this.stepper&&this.stepper.updateOperatorList(this.operatorList),this.running||this._continue()):this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound)}_continue(){this.running=!0,this.cancelled||(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this.cancel.bind(this))}):Promise.resolve().then(this._nextBound).catch(this.cancel.bind(this))}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&e.delete(this._canvas),this.callback())))}}}(),version="2.6.347";exports.version=version;const build="3be9c65f";exports.build=build},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var i=n(2);class r{constructor({docId:e,onUnsupportedFeature:t,ownerDocument:n=globalThis.document}){this.constructor===r&&(0,i.unreachable)("Cannot initialize BaseFontLoader."),this.docId=e,this._onUnsupportedFeature=t,this._document=n,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(e){this.nativeFontFaces.push(e),this._document.fonts.add(e)}insertRule(e){let t=this.styleElement;t||(t=this.styleElement=this._document.createElement("style"),t.id="PDFJS_FONT_STYLE_TAG_"+this.docId,this._document.documentElement.getElementsByTagName("head")[0].appendChild(t));const n=t.sheet;n.insertRule(e,n.cssRules.length)}clear(){this.nativeFontFaces.forEach(e=>{this._document.fonts.delete(e)}),this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(e){if(e.attached||e.missingFile)return;if(e.attached=!0,this.isFontLoadingAPISupported){const t=e.createNativeFontFace();if(t){this.addNativeFontFace(t);try{await t.loaded}catch(n){throw this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,i.warn)(`Failed to load font '${t.family}': '${n}'.`),e.disableFontFace=!0,n}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const i=this._queueLoadingCallback(n);this._prepareFontLoadEvent([t],[e],i)})}}_queueLoadingCallback(e){(0,i.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){const e=void 0!==this._document&&!!this._document.fonts;return(0,i.shadow)(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){(0,i.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,i.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(e,t,n){(0,i.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let s;t.FontLoader=s,t.FontLoader=s=class extends r{constructor(e){super(e),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let e=!1;if("undefined"==typeof navigator)e=!0;else{const t=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);t&&t[1]>=14&&(e=!0)}return(0,i.shadow)(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){const t=this.loadingContext,n={id:"pdfjs-font-loading-"+t.nextRequestId++,done:!1,complete:function(){for((0,i.assert)(!n.done,"completeRequest() cannot be called twice."),n.done=!0;t.requests.length>0&&t.requests[0].done;){const e=t.requests.shift();setTimeout(e.callback,0)}},callback:e};return t.requests.push(n),n}get _loadTestFont(){return(0,i.shadow)(this,"_loadTestFont",atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA=="))}_prepareFontLoadEvent(e,t,n){function r(e,t){return e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|255&e.charCodeAt(t+3)}function s(e,t,n,i){return e.substring(0,t)+i+e.substring(t+n)}let o,a;const c=this._document.createElement("canvas");c.width=1,c.height=1;const l=c.getContext("2d");let d=0;const u=`lt${Date.now()}${this.loadTestFontId++}`;let h=this._loadTestFont;h=s(h,976,u.length,u);let p=r(h,16);for(o=0,a=u.length-3;o<a;o+=4)p=p-1482184792+r(u,o)|0;o<u.length&&(p=p-1482184792+r(u+"XXX",o)|0),h=s(h,16,4,(0,i.string32)(p));const f=`@font-face {font-family:"${u}";src:url(data:font/opentype;base64,${btoa(h)});}`;this.insertRule(f);const g=[];for(o=0,a=t.length;o<a;o++)g.push(t[o].loadedName);g.push(u);const m=this._document.createElement("div");for(m.style.visibility="hidden",m.style.width=m.style.height="10px",m.style.position="absolute",m.style.top=m.style.left="0px",o=0,a=g.length;o<a;++o){const e=this._document.createElement("span");e.textContent="Hi",e.style.fontFamily=g[o],m.appendChild(e)}this._document.body.appendChild(m),function e(t,n){if(d++,d>30)return(0,i.warn)("Load test font never loaded."),void n();l.font="30px "+t,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0?n():setTimeout(e.bind(null,t,n))}(u,()=>{this._document.body.removeChild(m),n.complete()})}},t.FontFaceObject=class{constructor(e,{isEvalSupported:t=!0,disableFontFace:n=!1,ignoreErrors:i=!1,onUnsupportedFeature:r=null,fontRegistry:s=null}){this.compiledGlyphs=Object.create(null);for(const t in e)this[t]=e[t];this.isEvalSupported=!1!==t,this.disableFontFace=!0===n,this.ignoreErrors=!0===i,this._onUnsupportedFeature=r,this.fontRegistry=s}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;const e=new FontFace(this.loadedName,this.data,{});return this.fontRegistry&&this.fontRegistry.registerFont(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=(0,i.bytesToString)(new Uint8Array(this.data)),t=`url(data:${this.mimetype};base64,${btoa(e)});`,n=`@font-face {font-family:"${this.loadedName}";src:${t}}`;return this.fontRegistry&&this.fontRegistry.registerFont(this,t),n}getPathGenerator(e,t){if(void 0!==this.compiledGlyphs[t])return this.compiledGlyphs[t];let n,r;try{n=e.get(this.loadedName+"_path_"+t)}catch(e){if(!this.ignoreErrors)throw e;return this._onUnsupportedFeature&&this._onUnsupportedFeature({featureId:i.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,i.warn)(`getPathGenerator - ignoring character: "${e}".`),this.compiledGlyphs[t]=function(e,t){}}if(this.isEvalSupported&&i.IsEvalSupportedCached.value){let e,i="";for(let t=0,s=n.length;t<s;t++)r=n[t],e=void 0!==r.args?r.args.join(","):"",i+="c."+r.cmd+"("+e+");\n";return this.compiledGlyphs[t]=new Function("c","size",i)}return this.compiledGlyphs[t]=function(e,t){for(let i=0,s=n.length;i<s;i++)r=n[i],"scale"===r.cmd&&(r.args=[t,-t]),e[r.cmd].apply(e,r.args)}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NodeCMapReaderFactory=t.NodeCanvasFactory=void 0;var i=n(1),r=n(4),s=n(2);let o=class{constructor(){(0,s.unreachable)("Not implemented: NodeCanvasFactory")}};t.NodeCanvasFactory=o;let a=class{constructor(){(0,s.unreachable)("Not implemented: NodeCMapReaderFactory")}};t.NodeCMapReaderFactory=a,r.isNodeJS&&(t.NodeCanvasFactory=o=class extends i.BaseCanvasFactory{create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=__webpack_require__(292).createCanvas(e,t);return{canvas:n,context:n.getContext("2d")}}},t.NodeCMapReaderFactory=a=class extends i.BaseCMapReaderFactory{_fetchData(e,t){return new Promise((n,i)=>{__webpack_require__(191).readFile(e,(e,r)=>{!e&&r?n({cMapData:new Uint8Array(r),compressionType:t}):i(new Error(e))})})}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationStorage=void 0,t.AnnotationStorage=class{constructor(){this._storage=new Map,this._modified=!1,this.onSetModified=null,this.onResetModified=null}getOrCreateValue(e,t){return this._storage.has(e)?this._storage.get(e):(this._storage.set(e,t),t)}setValue(e,t){this._storage.get(e)!==t&&this._setModified(),this._storage.set(e,t)}getAll(){return 0===this._storage.size?null:Object.fromEntries(this._storage)}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,"function"==typeof this.onSetModified&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,"function"==typeof this.onResetModified&&this.onResetModified())}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.apiCompatibilityParams=void 0;var i=n(4);const r=Object.create(null);i.isNodeJS&&(r.disableFontFace=!0);const s=Object.freeze(r);t.apiCompatibilityParams=s},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var i=n(2),r=n(11);function s(e){e.mozCurrentTransform||(e._originalSave=e.save,e._originalRestore=e.restore,e._originalRotate=e.rotate,e._originalScale=e.scale,e._originalTranslate=e.translate,e._originalTransform=e.transform,e._originalSetTransform=e.setTransform,e._transformMatrix=e._transformMatrix||[1,0,0,1,0,0],e._transformStack=[],Object.defineProperty(e,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(e,"mozCurrentTransformInverse",{get:function(){var e=this._transformMatrix,t=e[0],n=e[1],i=e[2],r=e[3],s=e[4],o=e[5],a=t*r-n*i,c=n*i-t*r;return[r/a,n/c,i/c,t/a,(r*s-i*o)/c,(n*s-t*o)/a]}}),e.save=function(){var e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},e.restore=function(){var e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},e.translate=function(e,t){var n=this._transformMatrix;n[4]=n[0]*e+n[2]*t+n[4],n[5]=n[1]*e+n[3]*t+n[5],this._originalTranslate(e,t)},e.scale=function(e,t){var n=this._transformMatrix;n[0]=n[0]*e,n[1]=n[1]*e,n[2]=n[2]*t,n[3]=n[3]*t,this._originalScale(e,t)},e.transform=function(t,n,i,r,s,o){var a=this._transformMatrix;this._transformMatrix=[a[0]*t+a[2]*n,a[1]*t+a[3]*n,a[0]*i+a[2]*r,a[1]*i+a[3]*r,a[0]*s+a[2]*o+a[4],a[1]*s+a[3]*o+a[5]],e._originalTransform(t,n,i,r,s,o)},e.setTransform=function(t,n,i,r,s,o){this._transformMatrix=[t,n,i,r,s,o],e._originalSetTransform(t,n,i,r,s,o)},e.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),i=this._transformMatrix;this._transformMatrix=[i[0]*t+i[2]*n,i[1]*t+i[3]*n,i[0]*-n+i[2]*t,i[1]*-n+i[3]*t,i[4],i[5]],this._originalRotate(e)})}var o=function(){function e(e){this.canvasFactory=e,this.cache=Object.create(null)}return e.prototype={getCanvas:function(e,t,n,i){var r;return void 0!==this.cache[e]?(r=this.cache[e],this.canvasFactory.reset(r,t,n),r.context.setTransform(1,0,0,1,0,0)):(r=this.canvasFactory.create(t,n),this.cache[e]=r),i&&s(r.context),r},clear(){for(var e in this.cache){var t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}},e}(),a=function(){function e(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=i.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=i.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}return e.prototype={clone:function(){return Object.create(this)},setCurrentPoint:function(e,t){this.x=e,this.y=t}},e}(),c=function(){function e(e,t,n,i,r,c,l){this.ctx=e,this.current=new a,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=i,this.webGLContext=r,this.imageLayer=c,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=l,this.cachedCanvases=new o(this.canvasFactory),e&&s(e),this._cachedGetSinglePixelWidth=null}function t(e,t,n=null){if("undefined"!=typeof ImageData&&t instanceof ImageData)return void e.putImageData(t,0,0);var r,s,o,a,c,l=t.height,d=t.width,u=l%16,h=(l-u)/16,p=0===u?h:h+1,f=e.createImageData(d,16),g=0,m=t.data,v=f.data;let b,S,y,C;if(n)switch(n.length){case 1:b=n[0],S=n[0],y=n[0],C=n[0];break;case 4:b=n[0],S=n[1],y=n[2],C=n[3]}if(t.kind===i.ImageKind.GRAYSCALE_1BPP){var w=m.byteLength,_=new Uint32Array(v.buffer,0,v.byteLength>>2),A=_.length,k=d+7>>3,T=4294967295,I=i.IsLittleEndianCached.value?4278190080:255;for(C&&255===C[0]&&0===C[255]&&([T,I]=[I,T]),s=0;s<p;s++){for(a=s<h?16:u,r=0,o=0;o<a;o++){var O=w-g;let e=0;for(var E=O>k?d:8*O-7,x=-8&E,P=0,M=0;e<x;e+=8)M=m[g++],_[r++]=128&M?T:I,_[r++]=64&M?T:I,_[r++]=32&M?T:I,_[r++]=16&M?T:I,_[r++]=8&M?T:I,_[r++]=4&M?T:I,_[r++]=2&M?T:I,_[r++]=1&M?T:I;for(;e<E;e++)0===P&&(M=m[g++],P=128),_[r++]=M&P?T:I,P>>=1}for(;r<A;)_[r++]=0;e.putImageData(f,0,16*s)}}else if(t.kind===i.ImageKind.RGBA_32BPP){const t=!!(b||S||y);for(o=0,c=16*d*4,s=0;s<h;s++){if(v.set(m.subarray(g,g+c)),g+=c,t)for(let e=0;e<c;e+=4)b&&(v[e+0]=b[v[e+0]]),S&&(v[e+1]=S[v[e+1]]),y&&(v[e+2]=y[v[e+2]]);e.putImageData(f,0,o),o+=16}if(s<p){if(c=d*u*4,v.set(m.subarray(g,g+c)),t)for(let e=0;e<c;e+=4)b&&(v[e+0]=b[v[e+0]]),S&&(v[e+1]=S[v[e+1]]),y&&(v[e+2]=y[v[e+2]]);e.putImageData(f,0,o)}}else{if(t.kind!==i.ImageKind.RGB_24BPP)throw new Error("bad image kind: "+t.kind);{const t=!!(b||S||y);for(c=d*(a=16),s=0;s<p;s++){for(s>=h&&(c=d*(a=u)),r=0,o=c;o--;)v[r++]=m[g++],v[r++]=m[g++],v[r++]=m[g++],v[r++]=255;if(t)for(let e=0;e<r;e+=4)b&&(v[e+0]=b[v[e+0]]),S&&(v[e+1]=S[v[e+1]]),y&&(v[e+2]=y[v[e+2]]);e.putImageData(f,0,16*s)}}}}function n(e,t){for(var n=t.height,i=t.width,r=n%16,s=(n-r)/16,o=0===r?s:s+1,a=e.createImageData(i,16),c=0,l=t.data,d=a.data,u=0;u<o;u++){for(var h=u<s?16:r,p=3,f=0;f<h;f++)for(var g=0,m=0;m<i;m++){if(!g){var v=l[c++];g=128}d[p]=v&g?0:255,p+=4,g>>=1}e.putImageData(a,0,16*u)}}function c(e,t){for(var n=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"],i=0,r=n.length;i<r;i++){var s=n[i];void 0!==e[s]&&(t[s]=e[s])}void 0!==e.setLineDash&&(t.setLineDash(e.getLineDash()),t.lineDashOffset=e.lineDashOffset)}function l(e){e.strokeStyle="#000000",e.fillStyle="#000000",e.fillRule="nonzero",e.globalAlpha=1,e.lineWidth=1,e.lineCap="butt",e.lineJoin="miter",e.miterLimit=10,e.globalCompositeOperation="source-over",e.font="10px sans-serif",void 0!==e.setLineDash&&(e.setLineDash([]),e.lineDashOffset=0)}function d(e,t,n,i){for(var r=e.length,s=3;s<r;s+=4){var o=e[s];if(0===o)e[s-3]=t,e[s-2]=n,e[s-1]=i;else if(o<255){var a=255-o;e[s-3]=e[s-3]*o+t*a>>8,e[s-2]=e[s-2]*o+n*a>>8,e[s-1]=e[s-1]*o+i*a>>8}}}function u(e,t,n){for(var i=e.length,r=3;r<i;r+=4){var s=n?n[e[r]]:e[r];t[r]=t[r]*s*(1/255)|0}}function h(e,t,n){for(var i=e.length,r=3;r<i;r+=4){var s=77*e[r-3]+152*e[r-2]+28*e[r-1];t[r]=n?t[r]*n[s>>8]>>8:t[r]*s>>16}}function p(e,t,n,i){var r=t.canvas,s=t.context;e.setTransform(t.scaleX,0,0,t.scaleY,t.offsetX,t.offsetY);var o=t.backdrop||null;if(!t.transferMap&&i.isEnabled){const s=i.composeSMask({layer:n.canvas,mask:r,properties:{subtype:t.subtype,backdrop:o}});return e.setTransform(1,0,0,1,0,0),void e.drawImage(s,t.offsetX,t.offsetY)}!function(e,t,n,i,r,s,o){var a,c=!!s,l=c?s[0]:0,p=c?s[1]:0,f=c?s[2]:0;a="Luminosity"===r?h:u;for(var g=Math.min(i,Math.ceil(1048576/n)),m=0;m<i;m+=g){var v=Math.min(g,i-m),b=e.getImageData(0,m,n,v),S=t.getImageData(0,m,n,v);c&&d(b.data,l,p,f),a(b.data,S.data,o),e.putImageData(S,0,m)}}(s,n,r.width,r.height,t.subtype,o,t.transferMap),e.drawImage(r,0,0)}var f=["butt","round","square"],g=["miter","round","bevel"],m={},v={};for(var b in e.prototype={beginDrawing({transform:e,viewport:t,transparency:n=!1,background:i=null}){var r=this.ctx.canvas.width,s=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=i||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,r,s),this.ctx.restore(),n){var o=this.cachedCanvases.getCanvas("transparent",r,s,!0);this.compositeCtx=this.ctx,this.transparentCanvas=o.canvas,this.ctx=o.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),l(this.ctx),e&&this.ctx.transform.apply(this.ctx,e),this.ctx.transform.apply(this.ctx,t.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this.imageLayer&&this.imageLayer.beginLayout()},executeOperatorList:function(e,t,n,r){var s=e.argsArray,o=e.fnArray,a=t||0,c=s.length;if(c===a)return a;for(var l,d=c-a>10&&"function"==typeof n,u=d?Date.now()+15:0,h=0,p=this.commonObjs,f=this.objs;;){if(void 0!==r&&a===r.nextBreakPoint)return r.breakIt(a,n),a;if((l=o[a])!==i.OPS.dependency)this[l].apply(this,s[a]);else for(const e of s[a]){const t=e.startsWith("g_")?p:f;if(!t.has(e))return t.get(e,n),a}if(++a===c)return a;if(d&&++h>10){if(Date.now()>u)return n(),a;h=0}}},endDrawing:function(){null!==this.current.activeSMask&&this.endSMaskGroup(),this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.webGLContext.clear(),this.imageLayer&&this.imageLayer.endLayout()},setLineWidth:function(e){this.current.lineWidth=e,this.ctx.lineWidth=e},setLineCap:function(e){this.ctx.lineCap=f[e]},setLineJoin:function(e){this.ctx.lineJoin=g[e]},setMiterLimit:function(e){this.ctx.miterLimit=e},setDash:function(e,t){var n=this.ctx;void 0!==n.setLineDash&&(n.setLineDash(e),n.lineDashOffset=t)},setRenderingIntent(e){},setFlatness(e){},setGState:function(e){for(var t=0,n=e.length;t<n;t++){var i=e[t],r=i[0],s=i[1];switch(r){case"LW":this.setLineWidth(s);break;case"LC":this.setLineCap(s);break;case"LJ":this.setLineJoin(s);break;case"ML":this.setMiterLimit(s);break;case"D":this.setDash(s[0],s[1]);break;case"RI":this.setRenderingIntent(s);break;case"FL":this.setFlatness(s);break;case"Font":this.setFont(s[0],s[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=s;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=s?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=s}}},beginSMaskGroup:function(){var e=this.current.activeSMask,t=e.canvas.width,n=e.canvas.height,i="smaskGroupAt"+this.groupLevel,r=this.cachedCanvases.getCanvas(i,t,n,!0),s=this.ctx,o=s.mozCurrentTransform;this.ctx.save();var a=r.context;a.scale(1/e.scaleX,1/e.scaleY),a.translate(-e.offsetX,-e.offsetY),a.transform.apply(a,o),e.startTransformInverse=a.mozCurrentTransformInverse,c(s,a),this.ctx=a,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(s),this.groupLevel++},suspendSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),p(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),this.ctx.save(),c(e,this.ctx),this.current.resumeSMaskCtx=e;var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t),e.save(),e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,e.canvas.width,e.canvas.height),e.restore()},resumeSMaskGroup:function(){var e=this.current.resumeSMaskCtx,t=this.ctx;this.ctx=e,this.groupStack.push(t),this.groupLevel++},endSMaskGroup:function(){var e=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),p(this.ctx,this.current.activeSMask,e,this.webGLContext),this.ctx.restore(),c(e,this.ctx);var t=i.Util.transform(this.current.activeSMask.startTransformInverse,e.mozCurrentTransform);this.ctx.transform.apply(this.ctx,t)},save:function(){this.ctx.save();var e=this.current;this.stateStack.push(e),this.current=e.clone(),this.current.resumeSMaskCtx=null},restore:function(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),null===this.current.activeSMask||0!==this.stateStack.length&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask||this.endSMaskGroup(),0!==this.stateStack.length&&(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null)},transform:function(e,t,n,i,r,s){this.ctx.transform(e,t,n,i,r,s),this._cachedGetSinglePixelWidth=null},constructPath:function(e,t){for(var n=this.ctx,r=this.current,s=r.x,o=r.y,a=0,c=0,l=e.length;a<l;a++)switch(0|e[a]){case i.OPS.rectangle:s=t[c++],o=t[c++];var d=t[c++],u=t[c++];0===d&&n.lineWidth<this.getSinglePixelWidth()&&(d=this.getSinglePixelWidth()),0===u&&n.lineWidth<this.getSinglePixelWidth()&&(u=this.getSinglePixelWidth());var h=s+d,p=o+u;n.moveTo(s,o),n.lineTo(h,o),n.lineTo(h,p),n.lineTo(s,p),n.lineTo(s,o),n.closePath();break;case i.OPS.moveTo:s=t[c++],o=t[c++],n.moveTo(s,o);break;case i.OPS.lineTo:s=t[c++],o=t[c++],n.lineTo(s,o);break;case i.OPS.curveTo:s=t[c+4],o=t[c+5],n.bezierCurveTo(t[c],t[c+1],t[c+2],t[c+3],s,o),c+=6;break;case i.OPS.curveTo2:n.bezierCurveTo(s,o,t[c],t[c+1],t[c+2],t[c+3]),s=t[c+2],o=t[c+3],c+=4;break;case i.OPS.curveTo3:s=t[c+2],o=t[c+3],n.bezierCurveTo(t[c],t[c+1],s,o,s,o),c+=4;break;case i.OPS.closePath:n.closePath()}r.setCurrentPoint(s,o)},closePath:function(){this.ctx.closePath()},stroke:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.strokeColor;if(t.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(n&&n.hasOwnProperty("type")&&"Pattern"===n.type){t.save();const e=t.mozCurrentTransform,r=i.Util.singularValueDecompose2dScale(e)[0];t.strokeStyle=n.getPattern(t,this),t.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth*r),t.stroke(),t.restore()}else t.lineWidth=Math.max(.65*this.getSinglePixelWidth(),this.current.lineWidth),t.stroke();e&&this.consumePath(),t.globalAlpha=this.current.fillAlpha},closeStroke:function(){this.closePath(),this.stroke()},fill:function(e){e=void 0===e||e;var t=this.ctx,n=this.current.fillColor,i=!1;this.current.patternFill&&(t.save(),this.baseTransform&&t.setTransform.apply(t,this.baseTransform),t.fillStyle=n.getPattern(t,this),i=!0),this.contentVisible&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),i&&t.restore(),e&&this.consumePath()},eoFill:function(){this.pendingEOFill=!0,this.fill()},fillStroke:function(){this.fill(!1),this.stroke(!1),this.consumePath()},eoFillStroke:function(){this.pendingEOFill=!0,this.fillStroke()},closeFillStroke:function(){this.closePath(),this.fillStroke()},closeEOFillStroke:function(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()},endPath:function(){this.consumePath()},clip:function(){this.pendingClip=m},eoClip:function(){this.pendingClip=v},beginText:function(){this.current.textMatrix=i.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},endText:function(){var e=this.pendingTextPaths,t=this.ctx;if(void 0!==e){t.save(),t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.setTransform.apply(t,i.transform),t.translate(i.x,i.y),i.addToPath(t,i.fontSize)}t.restore(),t.clip(),t.beginPath(),delete this.pendingTextPaths}else t.beginPath()},setCharSpacing:function(e){this.current.charSpacing=e},setWordSpacing:function(e){this.current.wordSpacing=e},setHScale:function(e){this.current.textHScale=e/100},setLeading:function(e){this.current.leading=-e},setFont:function(e,t){var n=this.commonObjs.get(e),r=this.current;if(!n)throw new Error("Can't find font for "+e);if(r.fontMatrix=n.fontMatrix?n.fontMatrix:i.FONT_IDENTITY_MATRIX,0!==r.fontMatrix[0]&&0!==r.fontMatrix[3]||(0,i.warn)("Invalid font matrix for font "+e),t<0?(t=-t,r.fontDirection=-1):r.fontDirection=1,this.current.font=n,this.current.fontSize=t,n.isType3Font)return;var s=n.loadedName||"sans-serif";let o="normal";n.black?o="900":n.bold&&(o="bold");var a=n.italic?"italic":"normal",c=`"${s}", ${n.fallbackName}`;let l=t;t<16?l=16:t>100&&(l=100),this.current.fontSizeScale=t/l,this.ctx.font=`${a} ${o} ${l}px ${c}`},setTextRenderingMode:function(e){this.current.textRenderingMode=e},setTextRise:function(e){this.current.textRise=e},moveText:function(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t},setLeadingMoveText:function(e,t){this.setLeading(-t),this.moveText(e,t)},setTextMatrix:function(e,t,n,i,r,s){this.current.textMatrix=[e,t,n,i,r,s],this.current.textMatrixScale=Math.sqrt(e*e+t*t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0},nextLine:function(){this.moveText(0,this.current.leading)},paintChar(e,t,n,r){var s=this.ctx,o=this.current,a=o.font,c=o.textRenderingMode,l=o.fontSize/o.fontSizeScale,d=c&i.TextRenderingMode.FILL_STROKE_MASK,u=!!(c&i.TextRenderingMode.ADD_TO_PATH_FLAG);const h=o.patternFill&&!a.missingFile;var p;(a.disableFontFace||u||h)&&(p=a.getPathGenerator(this.commonObjs,e)),a.disableFontFace||h?(s.save(),s.translate(t,n),s.beginPath(),p(s,l),r&&s.setTransform.apply(s,r),d!==i.TextRenderingMode.FILL&&d!==i.TextRenderingMode.FILL_STROKE||s.fill(),d!==i.TextRenderingMode.STROKE&&d!==i.TextRenderingMode.FILL_STROKE||s.stroke(),s.restore()):(d!==i.TextRenderingMode.FILL&&d!==i.TextRenderingMode.FILL_STROKE||s.fillText(e,t,n),d!==i.TextRenderingMode.STROKE&&d!==i.TextRenderingMode.FILL_STROKE||s.strokeText(e,t,n)),u&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:s.mozCurrentTransform,x:t,y:n,fontSize:l,addToPath:p})},get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);for(var t=e.getImageData(0,0,10,10).data,n=!1,r=3;r<t.length;r+=4)if(t[r]>0&&t[r]<255){n=!0;break}return(0,i.shadow)(this,"isFontSubpixelAAEnabled",n)},showText:function(e){var t=this.current,n=t.font;if(n.isType3Font)return this.showType3Text(e);var r=t.fontSize;if(0===r)return;var s=this.ctx,o=t.fontSizeScale,a=t.charSpacing,c=t.wordSpacing,l=t.fontDirection,d=t.textHScale*l,u=e.length,h=n.vertical,p=h?1:-1,f=n.defaultVMetrics,g=r*t.fontMatrix[0],m=t.textRenderingMode===i.TextRenderingMode.FILL&&!n.disableFontFace&&!t.patternFill;let v;if(s.save(),t.patternFill){s.save();const e=t.fillColor.getPattern(s,this);v=s.mozCurrentTransform,s.restore(),s.fillStyle=e}s.transform.apply(s,t.textMatrix),s.translate(t.x,t.y+t.textRise),l>0?s.scale(d,-1):s.scale(d,1);var b=t.lineWidth,S=t.textMatrixScale;if(0===S||0===b){var y=t.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;y!==i.TextRenderingMode.STROKE&&y!==i.TextRenderingMode.FILL_STROKE||(this._cachedGetSinglePixelWidth=null,b=.65*this.getSinglePixelWidth())}else b/=S;1!==o&&(s.scale(o,o),b/=o),s.lineWidth=b;var C,w=0;for(C=0;C<u;++C){var _=e[C];if((0,i.isNum)(_))w+=p*_*r/1e3;else{var A,k,T,I,O,E,x,P=!1,M=(_.isSpace?c:0)+a,D=_.fontChar,R=_.accent,F=_.width;if(h?(O=_.vmetric||f,E=-(E=_.vmetric?O[1]:.5*F)*g,x=O[2]*g,F=O?-O[0]:F,A=E/o,k=(w+x)/o):(A=w/o,k=0),n.remeasure&&F>0){var N=1e3*s.measureText(D).width/r*o;if(F<N&&this.isFontSubpixelAAEnabled){var L=F/N;P=!0,s.save(),s.scale(L,1),A/=L}else F!==N&&(A+=(F-N)/2e3*r/o)}this.contentVisible&&(_.isInFont||n.missingFile)&&(m&&!R?s.fillText(D,A,k):(this.paintChar(D,A,k,v),R&&(T=A+r*R.offset.x/o,I=k-r*R.offset.y/o,this.paintChar(R.fontChar,T,I,v)))),w+=h?F*g-M*l:F*g+M*l,P&&s.restore()}}h?t.y-=w:t.x+=w*d,s.restore()},showType3Text:function(e){var t,n,r,s,o=this.ctx,a=this.current,c=a.font,l=a.fontSize,d=a.fontDirection,u=c.vertical?1:-1,h=a.charSpacing,p=a.wordSpacing,f=a.textHScale*d,g=a.fontMatrix||i.FONT_IDENTITY_MATRIX,m=e.length;if(a.textRenderingMode!==i.TextRenderingMode.INVISIBLE&&0!==l){for(this._cachedGetSinglePixelWidth=null,o.save(),o.transform.apply(o,a.textMatrix),o.translate(a.x,a.y),o.scale(f,d),t=0;t<m;++t)if(n=e[t],(0,i.isNum)(n))s=u*n*l/1e3,this.ctx.translate(s,0),a.x+=s*f;else{var v=(n.isSpace?p:0)+h,b=c.charProcOperatorList[n.operatorListId];b?(this.contentVisible&&(this.processingType3=n,this.save(),o.scale(l,l),o.transform.apply(o,g),this.executeOperatorList(b),this.restore()),r=i.Util.applyTransform([n.width,0],g)[0]*l+v,o.translate(r,0),a.x+=r*f):(0,i.warn)(`Type3 character "${n.operatorListId}" is not available.`)}o.restore(),this.processingType3=null}},setCharWidth:function(e,t){},setCharWidthAndBounds:function(e,t,n,i,r,s){this.ctx.rect(n,i,r-n,s-i),this.clip(),this.endPath()},getColorN_Pattern:function(t){var n;if("TilingPattern"===t[0]){var i=t[1],s=this.baseTransform||this.ctx.mozCurrentTransform.slice(),o={createCanvasGraphics:t=>new e(t,this.commonObjs,this.objs,this.canvasFactory,this.webGLContext)};n=new r.TilingPattern(t,i,this.ctx,o,s)}else n=(0,r.getShadingPatternFromIR)(t);return n},setStrokeColorN:function(){this.current.strokeColor=this.getColorN_Pattern(arguments)},setFillColorN:function(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0},setStrokeRGBColor:function(e,t,n){var r=i.Util.makeCssRgb(e,t,n);this.ctx.strokeStyle=r,this.current.strokeColor=r},setFillRGBColor:function(e,t,n){var r=i.Util.makeCssRgb(e,t,n);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1},shadingFill:function(e){if(this.contentVisible){var t=this.ctx;this.save();var n=(0,r.getShadingPatternFromIR)(e);t.fillStyle=n.getPattern(t,this,!0);var s=t.mozCurrentTransformInverse;if(s){var o=t.canvas,a=o.width,c=o.height,l=i.Util.applyTransform([0,0],s),d=i.Util.applyTransform([0,c],s),u=i.Util.applyTransform([a,0],s),h=i.Util.applyTransform([a,c],s),p=Math.min(l[0],d[0],u[0],h[0]),f=Math.min(l[1],d[1],u[1],h[1]),g=Math.max(l[0],d[0],u[0],h[0]),m=Math.max(l[1],d[1],u[1],h[1]);this.ctx.fillRect(p,f,g-p,m-f)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}},beginInlineImage:function(){(0,i.unreachable)("Should not call beginInlineImage")},beginImageData:function(){(0,i.unreachable)("Should not call beginImageData")},paintFormXObjectBegin:function(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(e)&&6===e.length&&this.transform.apply(this,e),this.baseTransform=this.ctx.mozCurrentTransform,t)){var n=t[2]-t[0],i=t[3]-t[1];this.ctx.rect(t[0],t[1],n,i),this.clip(),this.endPath()}},paintFormXObjectEnd:function(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())},beginGroup:function(e){if(this.contentVisible){this.save();var t=this.ctx;e.isolated||(0,i.info)("TODO: Support non-isolated groups."),e.knockout&&(0,i.warn)("Knockout groups not supported.");var n=t.mozCurrentTransform;if(e.matrix&&t.transform.apply(t,e.matrix),!e.bbox)throw new Error("Bounding box is required.");var r=i.Util.getAxialAlignedBoundingBox(e.bbox,t.mozCurrentTransform),s=[0,0,t.canvas.width,t.canvas.height];r=i.Util.intersect(r,s)||[0,0,0,0];var o=Math.floor(r[0]),a=Math.floor(r[1]),l=Math.max(Math.ceil(r[2])-o,1),d=Math.max(Math.ceil(r[3])-a,1),u=1,h=1;l>4096&&(u=l/4096,l=4096),d>4096&&(h=d/4096,d=4096);var p="groupAt"+this.groupLevel;e.smask&&(p+="_smask_"+this.smaskCounter++%2);var f=this.cachedCanvases.getCanvas(p,l,d,!0),g=f.context;g.scale(1/u,1/h),g.translate(-o,-a),g.transform.apply(g,n),e.smask?this.smaskStack.push({canvas:f.canvas,context:g,offsetX:o,offsetY:a,scaleX:u,scaleY:h,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.scale(u,h)),c(t,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++,this.current.activeSMask=null}},endGroup:function(e){if(this.contentVisible){this.groupLevel--;var t=this.ctx;this.ctx=this.groupStack.pop(),void 0!==this.ctx.imageSmoothingEnabled?this.ctx.imageSmoothingEnabled=!1:this.ctx.mozImageSmoothingEnabled=!1,e.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(t.canvas,0,0),this.restore()}},beginAnnotations:function(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)},endAnnotations:function(){this.restore()},beginAnnotation:function(e,t,n){if(this.save(),l(this.ctx),this.current=new a,Array.isArray(e)&&4===e.length){var i=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],i,r),this.clip(),this.endPath()}this.transform.apply(this,t),this.transform.apply(this,n)},endAnnotation:function(){this.restore()},paintImageMaskXObject:function(e){if(this.contentVisible){var t=this.ctx,i=e.width,r=e.height,s=this.current.fillColor,o=this.current.patternFill,a=this.processingType3;if(a&&void 0===a.compiled&&(a.compiled=i<=1e3&&r<=1e3?function(e){var t,n,i,r,s=e.width,o=e.height,a=s+1,c=new Uint8Array(a*(o+1)),l=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),d=s+7&-8,u=e.data,h=new Uint8Array(d*o),p=0;for(t=0,r=u.length;t<r;t++)for(var f=128,g=u[t];f>0;)h[p++]=g&f?0:255,f>>=1;var m=0;for(0!==h[p=0]&&(c[0]=1,++m),n=1;n<s;n++)h[p]!==h[p+1]&&(c[n]=h[p]?2:1,++m),p++;for(0!==h[p]&&(c[n]=2,++m),t=1;t<o;t++){i=t*a,h[(p=t*d)-d]!==h[p]&&(c[i]=h[p]?1:8,++m);var v=(h[p]?4:0)+(h[p-d]?8:0);for(n=1;n<s;n++)l[v=(v>>2)+(h[p+1]?4:0)+(h[p-d+1]?8:0)]&&(c[i+n]=l[v],++m),p++;if(h[p-d]!==h[p]&&(c[i+n]=h[p]?2:4,++m),m>1e3)return null}for(i=t*a,0!==h[p=d*(o-1)]&&(c[i]=8,++m),n=1;n<s;n++)h[p]!==h[p+1]&&(c[i+n]=h[p]?4:8,++m),p++;if(0!==h[p]&&(c[i+n]=4,++m),m>1e3)return null;var b=new Int32Array([0,a,-1,0,-a,0,0,0,1]),S=[];for(t=0;m&&t<=o;t++){for(var y=t*a,C=y+s;y<C&&!c[y];)y++;if(y!==C){var w,_=[y%a,t],A=c[y],k=y;do{var T=b[A];do{y+=T}while(!c[y]);5!==(w=c[y])&&10!==w?(A=w,c[y]=0):(A=w&51*A>>4,c[y]&=A>>2|A<<2),_.push(y%a),_.push(y/a|0),c[y]||--m}while(k!==y);S.push(_),--t}}return function(e){e.save(),e.scale(1/s,-1/o),e.translate(0,-o),e.beginPath();for(let n=0,i=S.length;n<i;n++){var t=S[n];e.moveTo(t[0],t[1]);for(let n=2,i=t.length;n<i;n+=2)e.lineTo(t[n],t[n+1])}e.fill(),e.beginPath(),e.restore()}}({data:e.data,width:i,height:r}):null),a&&a.compiled)a.compiled(t);else{var c=this.cachedCanvases.getCanvas("maskCanvas",i,r),l=c.context;l.save(),n(l,e),l.globalCompositeOperation="source-in",l.fillStyle=o?s.getPattern(l,this):s,l.fillRect(0,0,i,r),l.restore(),this.paintInlineImageXObject(c.canvas)}}},paintImageMaskXObjectRepeat(e,t,i=0,r=0,s,o){if(this.contentVisible){var a=e.width,c=e.height,l=this.current.fillColor,d=this.current.patternFill,u=this.cachedCanvases.getCanvas("maskCanvas",a,c),h=u.context;h.save(),n(h,e),h.globalCompositeOperation="source-in",h.fillStyle=d?l.getPattern(h,this):l,h.fillRect(0,0,a,c),h.restore();for(var p=this.ctx,f=0,g=o.length;f<g;f+=2)p.save(),p.transform(t,i,r,s,o[f],o[f+1]),p.scale(1,-1),p.drawImage(u.canvas,0,0,a,c,0,-1,1,1),p.restore()}},paintImageMaskXObjectGroup:function(e){if(this.contentVisible)for(var t=this.ctx,i=this.current.fillColor,r=this.current.patternFill,s=0,o=e.length;s<o;s++){var a=e[s],c=a.width,l=a.height,d=this.cachedCanvases.getCanvas("maskCanvas",c,l),u=d.context;u.save(),n(u,a),u.globalCompositeOperation="source-in",u.fillStyle=r?i.getPattern(u,this):i,u.fillRect(0,0,c,l),u.restore(),t.save(),t.transform.apply(t,a.transform),t.scale(1,-1),t.drawImage(d.canvas,0,0,c,l,0,-1,1,1),t.restore()}},paintImageXObject:function(e){if(!this.contentVisible)return;const t=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,i.warn)("Dependent image isn't ready yet")},paintImageXObjectRepeat:function(e,t,n,r){if(!this.contentVisible)return;const s=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);if(s){for(var o=s.width,a=s.height,c=[],l=0,d=r.length;l<d;l+=2)c.push({transform:[t,0,0,n,r[l],r[l+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(s,c)}else(0,i.warn)("Dependent image isn't ready yet")},paintInlineImageXObject:function(e){if(this.contentVisible){var n=e.width,i=e.height,r=this.ctx;this.save(),r.scale(1/n,-1/i);var s,o,a=r.mozCurrentTransformInverse,c=a[0],l=a[1],d=Math.max(Math.sqrt(c*c+l*l),1),u=a[2],h=a[3],p=Math.max(Math.sqrt(u*u+h*h),1);if("function"==typeof HTMLElement&&e instanceof HTMLElement||!e.data)s=e;else{var f=(o=this.cachedCanvases.getCanvas("inlineImage",n,i)).context;t(f,e,this.current.transferMaps),s=o.canvas}for(var g=n,m=i,v="prescale1";d>2&&g>1||p>2&&m>1;){var b=g,S=m;d>2&&g>1&&(d/=g/(b=Math.ceil(g/2))),p>2&&m>1&&(p/=m/(S=Math.ceil(m/2))),(f=(o=this.cachedCanvases.getCanvas(v,b,S)).context).clearRect(0,0,b,S),f.drawImage(s,0,0,g,m,0,0,b,S),s=o.canvas,g=b,m=S,v="prescale1"===v?"prescale2":"prescale1"}if(r.drawImage(s,0,0,g,m,0,-i,n,i),this.imageLayer){var y=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:e,left:y[0],top:y[1],width:n/a[0],height:i/a[3]})}this.restore()}},paintInlineImageXObjectGroup:function(e,n){if(this.contentVisible){var i=this.ctx,r=e.width,s=e.height,o=this.cachedCanvases.getCanvas("inlineImage",r,s);t(o.context,e,this.current.transferMaps);for(var a=0,c=n.length;a<c;a++){var l=n[a];if(i.save(),i.transform.apply(i,l.transform),i.scale(1,-1),i.drawImage(o.canvas,l.x,l.y,l.w,l.h,0,-1,1,1),this.imageLayer){var d=this.getCanvasPosition(l.x,l.y);this.imageLayer.appendImage({imgData:e,left:d[0],top:d[1],width:r,height:s})}i.restore()}}},paintSolidColorImageMask:function(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)},markPoint:function(e){},markPointProps:function(e,t){},beginMarkedContent:function(e){this.markedContentStack.push({visible:!0})},beginMarkedContentProps:function(e,t){"OC"===e?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()},endMarkedContent:function(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()},beginCompat:function(){},endCompat:function(){},consumePath:function(){var e=this.ctx;this.pendingClip&&(this.pendingClip===v?e.clip("evenodd"):e.clip(),this.pendingClip=null),e.beginPath()},getSinglePixelWidth(e){if(null===this._cachedGetSinglePixelWidth){const e=this.ctx.mozCurrentTransformInverse;this._cachedGetSinglePixelWidth=Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1],e[2]*e[2]+e[3]*e[3]))}return this._cachedGetSinglePixelWidth},getCanvasPosition:function(e,t){var n=this.ctx.mozCurrentTransform;return[n[0]*e+n[2]*t+n[4],n[1]*e+n[3]*t+n[5]]},isContentVisible:function(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}},i.OPS)e.prototype[i.OPS[b]]=e.prototype[b];return e}();t.CanvasGraphics=c},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getShadingPatternFromIR=function(e){var t=r[e[0]];if(!t)throw new Error("Unknown IR type: "+e[0]);return t.fromIR(e)},t.TilingPattern=void 0;var i=n(2),r={};function s(e,t){if(!t||"undefined"==typeof Path2D)return;const n=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],n,i),e.clip(r)}r.RadialAxial={fromIR:function(e){var t=e[1],n=e[2],i=e[3],r=e[4],o=e[5],a=e[6],c=e[7];return{type:"Pattern",getPattern:function(e){var l;s(e,n),"axial"===t?l=e.createLinearGradient(r[0],r[1],o[0],o[1]):"radial"===t&&(l=e.createRadialGradient(r[0],r[1],a,o[0],o[1],c));for(var d=0,u=i.length;d<u;++d){var h=i[d];l.addColorStop(h[0],h[1])}return l}}}};var o=function(){function e(e,t,n,i,r,s,o,a){var c,l=t.coords,d=t.colors,u=e.data,h=4*e.width;l[n+1]>l[i+1]&&(c=n,n=i,i=c,c=s,s=o,o=c),l[i+1]>l[r+1]&&(c=i,i=r,r=c,c=o,o=a,a=c),l[n+1]>l[i+1]&&(c=n,n=i,i=c,c=s,s=o,o=c);var p=(l[n]+t.offsetX)*t.scaleX,f=(l[n+1]+t.offsetY)*t.scaleY,g=(l[i]+t.offsetX)*t.scaleX,m=(l[i+1]+t.offsetY)*t.scaleY,v=(l[r]+t.offsetX)*t.scaleX,b=(l[r+1]+t.offsetY)*t.scaleY;if(!(f>=b))for(var S,y,C,w,_,A,k,T,I=d[s],O=d[s+1],E=d[s+2],x=d[o],P=d[o+1],M=d[o+2],D=d[a],R=d[a+1],F=d[a+2],N=Math.round(f),L=Math.round(b),j=N;j<=L;j++){if(j<m){let e;e=j<f?0:f===m?1:(f-j)/(f-m),S=p-(p-g)*e,y=I-(I-x)*e,C=O-(O-P)*e,w=E-(E-M)*e}else{let e;e=j>b?1:m===b?0:(m-j)/(m-b),S=g-(g-v)*e,y=x-(x-D)*e,C=P-(P-R)*e,w=M-(M-F)*e}let e;e=j<f?0:j>b?1:(f-j)/(f-b),_=p-(p-v)*e,A=I-(I-D)*e,k=O-(O-R)*e,T=E-(E-F)*e;for(var V=Math.round(Math.min(S,_)),B=Math.round(Math.max(S,_)),U=h*j+4*V,W=V;W<=B;W++)e=(S-W)/(S-_),e<0?e=0:e>1&&(e=1),u[U++]=y-(y-A)*e|0,u[U++]=C-(C-k)*e|0,u[U++]=w-(w-T)*e|0,u[U++]=255}}function t(t,n,i){var r,s,o=n.coords,a=n.colors;switch(n.type){case"lattice":var c=n.verticesPerRow,l=Math.floor(o.length/c)-1,d=c-1;for(r=0;r<l;r++)for(var u=r*c,h=0;h<d;h++,u++)e(t,i,o[u],o[u+1],o[u+c],a[u],a[u+1],a[u+c]),e(t,i,o[u+c+1],o[u+1],o[u+c],a[u+c+1],a[u+1],a[u+c]);break;case"triangles":for(r=0,s=o.length;r<s;r+=3)e(t,i,o[r],o[r+1],o[r+2],a[r],a[r+1],a[r+2]);break;default:throw new Error("illegal figure")}}return function(e,n,i,r,s,o,a,c){var l,d,u,h,p=Math.floor(e[0]),f=Math.floor(e[1]),g=Math.ceil(e[2])-p,m=Math.ceil(e[3])-f,v=Math.min(Math.ceil(Math.abs(g*n[0]*1.1)),3e3),b=Math.min(Math.ceil(Math.abs(m*n[1]*1.1)),3e3),S=g/v,y=m/b,C={coords:i,colors:r,offsetX:-p,offsetY:-f,scaleX:1/S,scaleY:1/y},w=v+4,_=b+4;if(c.isEnabled)l=c.drawFigures({width:v,height:b,backgroundColor:o,figures:s,context:C}),(d=a.getCanvas("mesh",w,_,!1)).context.drawImage(l,2,2),l=d.canvas;else{var A=(d=a.getCanvas("mesh",w,_,!1)).context,k=A.createImageData(v,b);if(o){var T=k.data;for(u=0,h=T.length;u<h;u+=4)T[u]=o[0],T[u+1]=o[1],T[u+2]=o[2],T[u+3]=255}for(u=0;u<s.length;u++)t(k,s[u],C);A.putImageData(k,2,2),l=d.canvas}return{canvas:l,offsetX:p-2*S,offsetY:f-2*y,scaleX:S,scaleY:y}}}();r.Mesh={fromIR:function(e){var t=e[2],n=e[3],r=e[4],a=e[5],c=e[6],l=e[7],d=e[8];return{type:"Pattern",getPattern:function(e,u,h){var p;if(s(e,l),h)p=i.Util.singularValueDecompose2dScale(e.mozCurrentTransform);else if(p=i.Util.singularValueDecompose2dScale(u.baseTransform),c){var f=i.Util.singularValueDecompose2dScale(c);p=[p[0]*f[0],p[1]*f[1]]}var g=o(a,p,t,n,r,h?null:d,u.cachedCanvases,u.webGLContext);return h||(e.setTransform.apply(e,u.baseTransform),c&&e.transform.apply(e,c)),e.translate(g.offsetX,g.offsetY),e.scale(g.scaleX,g.scaleY),e.createPattern(g.canvas,"no-repeat")}}}},r.Dummy={fromIR:function(){return{type:"Pattern",getPattern:function(){return"hotpink"}}}};var a=function(){var e=1,t=2;function n(e,t,n,i,r){this.operatorList=e[2],this.matrix=e[3]||[1,0,0,1,0,0],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.canvasGraphicsFactory=i,this.baseTransform=r,this.type="Pattern",this.ctx=n}return n.prototype={createPatternCanvas:function(e){var t=this.operatorList,n=this.bbox,r=this.xstep,s=this.ystep,o=this.paintType,a=this.tilingType,c=this.color,l=this.canvasGraphicsFactory;(0,i.info)("TilingType: "+a);var d=n[0],u=n[1],h=n[2],p=n[3],f=i.Util.singularValueDecompose2dScale(this.matrix),g=i.Util.singularValueDecompose2dScale(this.baseTransform),m=[f[0]*g[0],f[1]*g[1]],v=this.getSizeAndScale(r,this.ctx.canvas.width,m[0]),b=this.getSizeAndScale(s,this.ctx.canvas.height,m[1]),S=e.cachedCanvases.getCanvas("pattern",v.size,b.size,!0),y=S.context,C=l.createCanvasGraphics(y);return C.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(C,o,c),C.transform(v.scale,0,0,b.scale,0,0),C.transform(1,0,0,1,-d,-u),this.clipBbox(C,n,d,u,h,p),C.executeOperatorList(t),this.ctx.transform(1,0,0,1,d,u),this.ctx.scale(1/v.scale,1/b.scale),S.canvas},getSizeAndScale:function(e,t,n){e=Math.abs(e);var i=Math.max(3e3,t),r=Math.ceil(e*n);return r>=i?r=i:n=r/e,{scale:n,size:r}},clipBbox:function(e,t,n,i,r,s){if(Array.isArray(t)&&4===t.length){var o=r-n,a=s-i;e.ctx.rect(n,i,o,a),e.clip(),e.endPath()}},setFillAndStrokeStyleToContext:function(n,r,s){const o=n.ctx,a=n.current;switch(r){case e:var c=this.ctx;o.fillStyle=c.fillStyle,o.strokeStyle=c.strokeStyle,a.fillColor=c.fillStyle,a.strokeColor=c.strokeStyle;break;case t:var l=i.Util.makeCssRgb(s[0],s[1],s[2]);o.fillStyle=l,o.strokeStyle=l,a.fillColor=l,a.strokeColor=l;break;default:throw new i.FormatError("Unsupported paint type: "+r)}},getPattern:function(e,t){(e=this.ctx).setTransform.apply(e,this.baseTransform),e.transform.apply(e,this.matrix);var n=this.createPatternCanvas(t);return e.createPattern(n,"repeat")}},n}();t.TilingPattern=a},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const i=Object.create(null);t.GlobalWorkerOptions=i,i.workerPort=void 0===i.workerPort?null:i.workerPort,i.workerSrc=void 0===i.workerSrc?"":i.workerSrc},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var i=n(2);const r=1,s=2,o=1,a=2,c=3,l=4,d=5,u=6,h=7,p=8;function f(e){if("object"!=typeof e||null===e)return e;switch(e.name){case"AbortException":return new i.AbortException(e.message);case"MissingPDFException":return new i.MissingPDFException(e.message);case"UnexpectedResponseException":return new i.UnexpectedResponseException(e.message,e.status);case"UnknownErrorException":return new i.UnknownErrorException(e.message,e.details);default:return new i.UnknownErrorException(e.message,e.toString())}}t.MessageHandler=class{constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=e=>{const t=e.data;if(t.targetName!==this.sourceName)return;if(t.stream)return void this._processStreamMessage(t);if(t.callback){const e=t.callbackId,n=this.callbackCapabilities[e];if(!n)throw new Error("Cannot resolve callback "+e);if(delete this.callbackCapabilities[e],t.callback===r)n.resolve(t.data);else{if(t.callback!==s)throw new Error("Unexpected callback case");n.reject(f(t.reason))}return}const i=this.actionHandler[t.action];if(!i)throw new Error("Unknown action from worker: "+t.action);if(t.callbackId){const e=this.sourceName,o=t.sourceName;new Promise((function(e){e(i(t.data))})).then((function(i){n.postMessage({sourceName:e,targetName:o,callback:r,callbackId:t.callbackId,data:i})}),(function(i){n.postMessage({sourceName:e,targetName:o,callback:s,callbackId:t.callbackId,reason:f(i)})}))}else t.streamId?this._createStreamSink(t):i(t.data)},n.addEventListener("message",this._onComObjOnMessage)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const r=this.callbackId++,s=(0,i.createPromiseCapability)();this.callbackCapabilities[r]=s;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:r,data:t},n)}catch(e){s.reject(e)}return s.promise}sendWithStream(e,t,n,r){const s=this.streamId++,a=this.sourceName,c=this.targetName,l=this.comObj;return new ReadableStream({start:n=>{const o=(0,i.createPromiseCapability)();return this.streamControllers[s]={controller:n,startCall:o,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:a,targetName:c,action:e,streamId:s,data:t,desiredSize:n.desiredSize},r),o.promise},pull:e=>{const t=(0,i.createPromiseCapability)();return this.streamControllers[s].pullCall=t,l.postMessage({sourceName:a,targetName:c,stream:u,streamId:s,desiredSize:e.desiredSize}),t.promise},cancel:e=>{(0,i.assert)(e instanceof Error,"cancel must have a valid reason");const t=(0,i.createPromiseCapability)();return this.streamControllers[s].cancelCall=t,this.streamControllers[s].isClosed=!0,l.postMessage({sourceName:a,targetName:c,stream:o,streamId:s,reason:f(e)}),t.promise}},n)}_createStreamSink(e){const t=this,n=this.actionHandler[e.action],r=e.streamId,s=this.sourceName,o=e.sourceName,a=this.comObj,u={enqueue(e,n=1,a){if(this.isCancelled)return;const c=this.desiredSize;this.desiredSize-=n,c>0&&this.desiredSize<=0&&(this.sinkCapability=(0,i.createPromiseCapability)(),this.ready=this.sinkCapability.promise),t._postMessage({sourceName:s,targetName:o,stream:l,streamId:r,chunk:e},a)},close(){this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:s,targetName:o,stream:c,streamId:r}),delete t.streamSinks[r])},error(e){(0,i.assert)(e instanceof Error,"error must have a valid reason"),this.isCancelled||(this.isCancelled=!0,a.postMessage({sourceName:s,targetName:o,stream:d,streamId:r,reason:f(e)}))},sinkCapability:(0,i.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};u.sinkCapability.resolve(),u.ready=u.sinkCapability.promise,this.streamSinks[r]=u,new Promise((function(t){t(n(e.data,u))})).then((function(){a.postMessage({sourceName:s,targetName:o,stream:p,streamId:r,success:!0})}),(function(e){a.postMessage({sourceName:s,targetName:o,stream:p,streamId:r,reason:f(e)})}))}_processStreamMessage(e){const t=e.streamId,n=this.sourceName,r=e.sourceName,s=this.comObj;switch(e.stream){case p:e.success?this.streamControllers[t].startCall.resolve():this.streamControllers[t].startCall.reject(f(e.reason));break;case h:e.success?this.streamControllers[t].pullCall.resolve():this.streamControllers[t].pullCall.reject(f(e.reason));break;case u:if(!this.streamSinks[t]){s.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,success:!0});break}this.streamSinks[t].desiredSize<=0&&e.desiredSize>0&&this.streamSinks[t].sinkCapability.resolve(),this.streamSinks[t].desiredSize=e.desiredSize;const{onPull:g}=this.streamSinks[e.streamId];new Promise((function(e){e(g&&g())})).then((function(){s.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,success:!0})}),(function(e){s.postMessage({sourceName:n,targetName:r,stream:h,streamId:t,reason:f(e)})}));break;case l:if((0,i.assert)(this.streamControllers[t],"enqueue should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].controller.enqueue(e.chunk);break;case c:if((0,i.assert)(this.streamControllers[t],"close should have stream controller"),this.streamControllers[t].isClosed)break;this.streamControllers[t].isClosed=!0,this.streamControllers[t].controller.close(),this._deleteStreamController(t);break;case d:(0,i.assert)(this.streamControllers[t],"error should have stream controller"),this.streamControllers[t].controller.error(f(e.reason)),this._deleteStreamController(t);break;case a:e.success?this.streamControllers[t].cancelCall.resolve():this.streamControllers[t].cancelCall.reject(f(e.reason)),this._deleteStreamController(t);break;case o:if(!this.streamSinks[t])break;const{onCancel:m}=this.streamSinks[e.streamId];new Promise((function(t){t(m&&m(f(e.reason)))})).then((function(){s.postMessage({sourceName:n,targetName:r,stream:a,streamId:t,success:!0})}),(function(e){s.postMessage({sourceName:n,targetName:r,stream:a,streamId:t,reason:f(e)})})),this.streamSinks[t].sinkCapability.reject(f(e.reason)),this.streamSinks[t].isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(e){await Promise.allSettled([this.streamControllers[e].startCall,this.streamControllers[e].pullCall,this.streamControllers[e].cancelCall].map((function(e){return e&&e.promise}))),delete this.streamControllers[e]}_postMessage(e,t){t&&this.postMessageTransfers?this.comObj.postMessage(e,t):this.comObj.postMessage(e)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var i=n(2),r=n(15);t.Metadata=class{constructor(e){(0,i.assert)("string"==typeof e,"Metadata: input is not a string"),e=this._repair(e);const t=(new r.SimpleXMLParser).parseFromString(e);this._metadataMap=new Map,t&&this._parse(t)}_repair(e){return e.replace(/^[^<]+/,"").replace(/>\\376\\377([^<]+)/g,(function(e,t){const n=t.replace(/\\([0-3])([0-7])([0-7])/g,(function(e,t,n,i){return String.fromCharCode(64*t+8*n+1*i)})).replace(/&(amp|apos|gt|lt|quot);/g,(function(e,t){switch(t){case"amp":return"&";case"apos":return"'";case"gt":return">";case"lt":return"<";case"quot":return'"'}throw new Error(`_repair: ${t} isn't defined.`)}));let i="";for(let e=0,t=n.length;e<t;e+=2){const t=256*n.charCodeAt(e)+n.charCodeAt(e+1);i+=t>=32&&t<127&&60!==t&&62!==t&&38!==t?String.fromCharCode(t):"&#x"+(65536+t).toString(16).substring(1)+";"}return">"+i}))}_parse(e){let t=e.documentElement;if("rdf:rdf"!==t.nodeName.toLowerCase())for(t=t.firstChild;t&&"rdf:rdf"!==t.nodeName.toLowerCase();)t=t.nextSibling;const n=t?t.nodeName.toLowerCase():null;if(!t||"rdf:rdf"!==n||!t.hasChildNodes())return;const i=t.childNodes;for(let e=0,t=i.length;e<t;e++){const t=i[e];if("rdf:description"===t.nodeName.toLowerCase())for(let e=0,n=t.childNodes.length;e<n;e++)if("#text"!==t.childNodes[e].nodeName.toLowerCase()){const n=t.childNodes[e],i=n.nodeName.toLowerCase();this._metadataMap.set(i,n.textContent.trim())}}}get(e){return this._metadataMap.has(e)?this._metadataMap.get(e):null}getAll(){return Object.fromEntries(this._metadataMap)}has(e){return this._metadataMap.has(e)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SimpleXMLParser=void 0;const i=0,r=-2,s=-3,o=-4,a=-5,c=-6,l=-9;function d(e,t){const n=e[t];return" "===n||"\n"===n||"\r"===n||"\t"===n}class u{constructor(e,t){this.nodeName=e,this.nodeValue=t,Object.defineProperty(this,"parentNode",{value:null,writable:!0})}get firstChild(){return this.childNodes&&this.childNodes[0]}get nextSibling(){const e=this.parentNode.childNodes;if(!e)return;const t=e.indexOf(this);return-1!==t?e[t+1]:void 0}get textContent(){return this.childNodes?this.childNodes.map((function(e){return e.textContent})).join(""):this.nodeValue||""}hasChildNodes(){return this.childNodes&&this.childNodes.length>0}}t.SimpleXMLParser=class extends class{_resolveEntities(e){return e.replace(/&([^;]+);/g,(e,t)=>{if("#x"===t.substring(0,2))return String.fromCharCode(parseInt(t.substring(2),16));if("#"===t.substring(0,1))return String.fromCharCode(parseInt(t.substring(1),10));switch(t){case"lt":return"<";case"gt":return">";case"amp":return"&";case"quot":return'"'}return this.onResolveEntity(t)})}_parseContent(e,t){const n=[];let i=t;function r(){for(;i<e.length&&d(e,i);)++i}for(;i<e.length&&!d(e,i)&&">"!==e[i]&&"/"!==e[i];)++i;const s=e.substring(t,i);for(r();i<e.length&&">"!==e[i]&&"/"!==e[i]&&"?"!==e[i];){r();let t="",s="";for(;i<e.length&&!d(e,i)&&"="!==e[i];)t+=e[i],++i;if(r(),"="!==e[i])return null;++i,r();const o=e[i];if('"'!==o&&"'"!==o)return null;const a=e.indexOf(o,++i);if(a<0)return null;s=e.substring(i,a),n.push({name:t,value:this._resolveEntities(s)}),i=a+1,r()}return{name:s,attributes:n,parsed:i-t}}_parseProcessingInstruction(e,t){let n=t;for(;n<e.length&&!d(e,n)&&">"!==e[n]&&"/"!==e[n];)++n;const i=e.substring(t,n);!function(){for(;n<e.length&&d(e,n);)++n}();const r=n;for(;n<e.length&&("?"!==e[n]||">"!==e[n+1]);)++n;return{name:i,value:e.substring(r,n),parsed:n-t}}parseXml(e){let t=0;for(;t<e.length;){let n=t;if("<"===e[t]){let t;switch(++n,e[n]){case"/":if(++n,t=e.indexOf(">",n),t<0)return void this.onError(l);this.onEndElement(e.substring(n,t)),n=t+1;break;case"?":++n;const i=this._parseProcessingInstruction(e,n);if("?>"!==e.substring(n+i.parsed,n+i.parsed+2))return void this.onError(s);this.onPi(i.name,i.value),n+=i.parsed+2;break;case"!":if("--"===e.substring(n+1,n+3)){if(t=e.indexOf("--\x3e",n+3),t<0)return void this.onError(a);this.onComment(e.substring(n+3,t)),n=t+3}else if("[CDATA["===e.substring(n+1,n+8)){if(t=e.indexOf("]]>",n+8),t<0)return void this.onError(r);this.onCdata(e.substring(n+8,t)),n=t+3}else{if("DOCTYPE"!==e.substring(n+1,n+8))return void this.onError(c);{const i=e.indexOf("[",n+8);let r=!1;if(t=e.indexOf(">",n+8),t<0)return void this.onError(o);if(i>0&&t>i){if(t=e.indexOf("]>",n+8),t<0)return void this.onError(o);r=!0}const s=e.substring(n+8,t+(r?1:0));this.onDoctype(s),n=t+(r?2:1)}}break;default:const d=this._parseContent(e,n);if(null===d)return void this.onError(c);let u=!1;if("/>"===e.substring(n+d.parsed,n+d.parsed+2))u=!0;else if(">"!==e.substring(n+d.parsed,n+d.parsed+1))return void this.onError(l);this.onBeginElement(d.name,d.attributes,u),n+=d.parsed+(u?2:1)}}else{for(;n<e.length&&"<"!==e[n];)n++;const i=e.substring(t,n);this.onText(this._resolveEntities(i))}t=n}}onResolveEntity(e){return`&${e};`}onPi(e,t){}onComment(e){}onCdata(e){}onDoctype(e){}onText(e){}onBeginElement(e,t,n){}onEndElement(e){}onError(e){}}{constructor(){super(),this._currentFragment=null,this._stack=null,this._errorCode=i}parseFromString(e){if(this._currentFragment=[],this._stack=[],this._errorCode=i,this.parseXml(e),this._errorCode!==i)return;const[t]=this._currentFragment;return t?{documentElement:t}:void 0}onResolveEntity(e){switch(e){case"apos":return"'"}return super.onResolveEntity(e)}onText(e){if(function(e){for(let t=0,n=e.length;t<n;t++)if(!d(e,t))return!1;return!0}(e))return;const t=new u("#text",e);this._currentFragment.push(t)}onCdata(e){const t=new u("#text",e);this._currentFragment.push(t)}onBeginElement(e,t,n){const i=new u(e);i.childNodes=[],this._currentFragment.push(i),n||(this._stack.push(this._currentFragment),this._currentFragment=i.childNodes)}onEndElement(e){this._currentFragment=this._stack.pop()||[];const t=this._currentFragment[this._currentFragment.length-1];if(t)for(let e=0,n=t.childNodes.length;e<n;e++)t.childNodes[e].parentNode=t}onError(e){this._errorCode=e}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var i=n(2);class r{constructor(e,t){this.visible=!0,this.name=e,this.intent=t}}t.OptionalContentConfig=class{constructor(e){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,null!==e){this.name=e.name,this.creator=e.creator,this._order=e.order;for(const t of e.groups)this._groups.set(t.id,new r(t.name,t.intent));if("OFF"===e.baseState)for(const e of this._groups)e.visible=!1;for(const t of e.on)this._groups.get(t).visible=!0;for(const t of e.off)this._groups.get(t).visible=!1}}isVisible(e){if("OCG"===e.type)return this._groups.has(e.id)?this._groups.get(e.id).visible:((0,i.warn)("Optional content group not found: "+e.id),!0);if("OCMD"===e.type){if(e.expression&&(0,i.warn)("Visibility expression not supported yet."),!e.policy||"AnyOn"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,i.warn)("Optional content group not found: "+t),!0;if(this._groups.get(t).visible)return!0}return!1}if("AllOn"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,i.warn)("Optional content group not found: "+t),!0;if(!this._groups.get(t).visible)return!1}return!0}if("AnyOff"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,i.warn)("Optional content group not found: "+t),!0;if(!this._groups.get(t).visible)return!0}return!1}if("AllOff"===e.policy){for(const t of e.ids){if(!this._groups.has(t))return(0,i.warn)("Optional content group not found: "+t),!0;if(this._groups.get(t).visible)return!1}return!0}return(0,i.warn)(`Unknown optional content policy ${e.policy}.`),!0}return(0,i.warn)(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0){this._groups.has(e)?this._groups.get(e).visible=!!t:(0,i.warn)("Optional content group not found: "+e)}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size?Object.fromEntries(this._groups):null}getGroup(e){return this._groups.get(e)||null}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var i=n(2);t.PDFDataTransportStream=class{constructor(e,t){(0,i.assert)(t,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=e.progressiveDone||!1;const n=e.initialData;if(n&&n.length>0){const e=new Uint8Array(n).buffer;this._queuedChunks.push(e)}this._pdfDataRangeTransport=t,this._isStreamingSupported=!e.disableStream,this._isRangeSupported=!e.disableRange,this._contentLength=e.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((e,t)=>{this._onReceiveData({begin:e,chunk:t})}),this._pdfDataRangeTransport.addProgressListener((e,t)=>{this._onProgress({loaded:e,total:t})}),this._pdfDataRangeTransport.addProgressiveReadListener(e=>{this._onReceiveData({chunk:e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(e){const t=new Uint8Array(e.chunk).buffer;if(void 0===e.begin)this._fullRequestReader?this._fullRequestReader._enqueue(t):this._queuedChunks.push(t);else{const n=this._rangeReaders.some((function(n){return n._begin===e.begin&&(n._enqueue(t),!0)}));(0,i.assert)(n,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}_onProgress(e){if(void 0===e.total){const t=this._rangeReaders[0];t&&t.onProgress&&t.onProgress({loaded:e.loaded})}else{const t=this._fullRequestReader;t&&t.onProgress&&t.onProgress({loaded:e.loaded,total:e.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){(0,i.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new r(this,e,this._progressiveDone)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new s(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeReaders.slice(0).forEach((function(t){t.cancel(e)})),this._pdfDataRangeTransport.abort()}};class r{constructor(e,t,n=!1){this._stream=e,this._done=n||!1,this._filename=null,this._queuedChunks=t||[],this._loaded=0;for(const e of this._queuedChunks)this._loaded+=e.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]}progressiveDone(){this._done||(this._done=!0)}}class s{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){this._done||(0===this._requests.length?this._queuedChunk=e:(this._requests.shift().resolve({value:e,done:!1}),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[]),this._done=!0,this._stream._removeRangeReader(this))}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._stream._removeRangeReader(this)}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WebGLContext=void 0;var i=n(2);t.WebGLContext=class{constructor({enable:e=!1}){this._enabled=!0===e}get isEnabled(){let e=this._enabled;return e&&(e=r.tryInitGL()),(0,i.shadow)(this,"isEnabled",e)}composeSMask({layer:e,mask:t,properties:n}){return r.composeSMask(e,t,n)}drawFigures({width:e,height:t,backgroundColor:n,figures:i,context:s}){return r.drawFigures(e,t,n,i,s)}clear(){r.cleanup()}};var r=function(){function e(e,t,n){var i=e.createShader(n);if(e.shaderSource(i,t),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS)){var r=e.getShaderInfoLog(i);throw new Error("Error during shader compilation: "+r)}return i}function t(t,n){return e(t,n,t.VERTEX_SHADER)}function n(t,n){return e(t,n,t.FRAGMENT_SHADER)}function i(e,t){for(var n=e.createProgram(),i=0,r=t.length;i<r;++i)e.attachShader(n,t[i]);if(e.linkProgram(n),!e.getProgramParameter(n,e.LINK_STATUS)){var s=e.getProgramInfoLog(n);throw new Error("Error during program linking: "+s)}return n}function r(e,t,n){e.activeTexture(n);var i=e.createTexture();return e.bindTexture(e.TEXTURE_2D,i),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),i}var s,o;function a(){s||(o=document.createElement("canvas"),s=o.getContext("webgl",{premultipliedalpha:!1}))}var c=null,l=null;return{tryInitGL(){try{return a(),!!s}catch(e){}return!1},composeSMask:function(e,l,d){var u=e.width,h=e.height;c||function(){var e,r;a(),e=o,o=null,r=s,s=null;var l=i(r,[t(r,"  attribute vec2 a_position;                                      attribute vec2 a_texCoord;                                                                                                      uniform vec2 u_resolution;                                                                                                      varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec2 clipSpace = (a_position / u_resolution) * 2.0 - 1.0;       gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_texCoord = a_texCoord;                                      }                                                             "),n(r,"  precision mediump float;                                                                                                        uniform vec4 u_backdrop;                                        uniform int u_subtype;                                          uniform sampler2D u_image;                                      uniform sampler2D u_mask;                                                                                                       varying vec2 v_texCoord;                                                                                                        void main() {                                                     vec4 imageColor = texture2D(u_image, v_texCoord);               vec4 maskColor = texture2D(u_mask, v_texCoord);                 if (u_backdrop.a > 0.0) {                                         maskColor.rgb = maskColor.rgb * maskColor.a +                                   u_backdrop.rgb * (1.0 - maskColor.a);         }                                                               float lum;                                                      if (u_subtype == 0) {                                             lum = maskColor.a;                                            } else {                                                          lum = maskColor.r * 0.3 + maskColor.g * 0.59 +                        maskColor.b * 0.11;                                     }                                                               imageColor.a *= lum;                                            imageColor.rgb *= imageColor.a;                                 gl_FragColor = imageColor;                                    }                                                             ")]);r.useProgram(l);var d={};d.gl=r,d.canvas=e,d.resolutionLocation=r.getUniformLocation(l,"u_resolution"),d.positionLocation=r.getAttribLocation(l,"a_position"),d.backdropLocation=r.getUniformLocation(l,"u_backdrop"),d.subtypeLocation=r.getUniformLocation(l,"u_subtype");var u=r.getAttribLocation(l,"a_texCoord"),h=r.getUniformLocation(l,"u_image"),p=r.getUniformLocation(l,"u_mask"),f=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,f),r.bufferData(r.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),r.STATIC_DRAW),r.enableVertexAttribArray(u),r.vertexAttribPointer(u,2,r.FLOAT,!1,0,0),r.uniform1i(h,0),r.uniform1i(p,1),c=d}();var p=c,f=p.canvas,g=p.gl;f.width=u,f.height=h,g.viewport(0,0,g.drawingBufferWidth,g.drawingBufferHeight),g.uniform2f(p.resolutionLocation,u,h),d.backdrop?g.uniform4f(p.resolutionLocation,d.backdrop[0],d.backdrop[1],d.backdrop[2],1):g.uniform4f(p.resolutionLocation,0,0,0,0),g.uniform1i(p.subtypeLocation,"Luminosity"===d.subtype?1:0);var m=r(g,e,g.TEXTURE0),v=r(g,l,g.TEXTURE1),b=g.createBuffer();return g.bindBuffer(g.ARRAY_BUFFER,b),g.bufferData(g.ARRAY_BUFFER,new Float32Array([0,0,u,0,0,h,0,h,u,0,u,h]),g.STATIC_DRAW),g.enableVertexAttribArray(p.positionLocation),g.vertexAttribPointer(p.positionLocation,2,g.FLOAT,!1,0,0),g.clearColor(0,0,0,0),g.enable(g.BLEND),g.blendFunc(g.ONE,g.ONE_MINUS_SRC_ALPHA),g.clear(g.COLOR_BUFFER_BIT),g.drawArrays(g.TRIANGLES,0,6),g.flush(),g.deleteTexture(m),g.deleteTexture(v),g.deleteBuffer(b),f},drawFigures:function(e,r,c,d,u){l||function(){var e,r;a(),e=o,o=null,r=s,s=null;var c=i(r,[t(r,"  attribute vec2 a_position;                                      attribute vec3 a_color;                                                                                                         uniform vec2 u_resolution;                                      uniform vec2 u_scale;                                           uniform vec2 u_offset;                                                                                                          varying vec4 v_color;                                                                                                           void main() {                                                     vec2 position = (a_position + u_offset) * u_scale;              vec2 clipSpace = (position / u_resolution) * 2.0 - 1.0;         gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);                                                                              v_color = vec4(a_color / 255.0, 1.0);                         }                                                             "),n(r,"  precision mediump float;                                                                                                        varying vec4 v_color;                                                                                                           void main() {                                                     gl_FragColor = v_color;                                       }                                                             ")]);r.useProgram(c);var d={};d.gl=r,d.canvas=e,d.resolutionLocation=r.getUniformLocation(c,"u_resolution"),d.scaleLocation=r.getUniformLocation(c,"u_scale"),d.offsetLocation=r.getUniformLocation(c,"u_offset"),d.positionLocation=r.getAttribLocation(c,"a_position"),d.colorLocation=r.getAttribLocation(c,"a_color"),l=d}();var h=l,p=h.canvas,f=h.gl;p.width=e,p.height=r,f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.uniform2f(h.resolutionLocation,e,r);var g,m,v,b=0;for(g=0,m=d.length;g<m;g++)switch(d[g].type){case"lattice":b+=((v=d[g].coords.length/d[g].verticesPerRow|0)-1)*(d[g].verticesPerRow-1)*6;break;case"triangles":b+=d[g].coords.length}var S=new Float32Array(2*b),y=new Uint8Array(3*b),C=u.coords,w=u.colors,_=0,A=0;for(g=0,m=d.length;g<m;g++){var k=d[g],T=k.coords,I=k.colors;switch(k.type){case"lattice":var O=k.verticesPerRow;v=T.length/O|0;for(var E=1;E<v;E++)for(var x=E*O+1,P=1;P<O;P++,x++)S[_]=C[T[x-O-1]],S[_+1]=C[T[x-O-1]+1],S[_+2]=C[T[x-O]],S[_+3]=C[T[x-O]+1],S[_+4]=C[T[x-1]],S[_+5]=C[T[x-1]+1],y[A]=w[I[x-O-1]],y[A+1]=w[I[x-O-1]+1],y[A+2]=w[I[x-O-1]+2],y[A+3]=w[I[x-O]],y[A+4]=w[I[x-O]+1],y[A+5]=w[I[x-O]+2],y[A+6]=w[I[x-1]],y[A+7]=w[I[x-1]+1],y[A+8]=w[I[x-1]+2],S[_+6]=S[_+2],S[_+7]=S[_+3],S[_+8]=S[_+4],S[_+9]=S[_+5],S[_+10]=C[T[x]],S[_+11]=C[T[x]+1],y[A+9]=y[A+3],y[A+10]=y[A+4],y[A+11]=y[A+5],y[A+12]=y[A+6],y[A+13]=y[A+7],y[A+14]=y[A+8],y[A+15]=w[I[x]],y[A+16]=w[I[x]+1],y[A+17]=w[I[x]+2],_+=12,A+=18;break;case"triangles":for(var M=0,D=T.length;M<D;M++)S[_]=C[T[M]],S[_+1]=C[T[M]+1],y[A]=w[I[M]],y[A+1]=w[I[M]+1],y[A+2]=w[I[M]+2],_+=2,A+=3}}c?f.clearColor(c[0]/255,c[1]/255,c[2]/255,1):f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT);var R=f.createBuffer();f.bindBuffer(f.ARRAY_BUFFER,R),f.bufferData(f.ARRAY_BUFFER,S,f.STATIC_DRAW),f.enableVertexAttribArray(h.positionLocation),f.vertexAttribPointer(h.positionLocation,2,f.FLOAT,!1,0,0);var F=f.createBuffer();return f.bindBuffer(f.ARRAY_BUFFER,F),f.bufferData(f.ARRAY_BUFFER,y,f.STATIC_DRAW),f.enableVertexAttribArray(h.colorLocation),f.vertexAttribPointer(h.colorLocation,3,f.UNSIGNED_BYTE,!1,0,0),f.uniform2f(h.scaleLocation,u.scaleX,u.scaleY),f.uniform2f(h.offsetLocation,u.offsetX,u.offsetY),f.drawArrays(f.TRIANGLES,0,b),f.flush(),f.deleteBuffer(R),f.deleteBuffer(F),p},cleanup(){c&&c.canvas&&(c.canvas.width=0,c.canvas.height=0),l&&l.canvas&&(l.canvas.width=0,l.canvas.height=0),c=null,l=null}}}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationLayer=void 0;var i=n(1),r=n(2),s=n(8);class o{static create(e){switch(e.data.annotationType){case r.AnnotationType.LINK:return new c(e);case r.AnnotationType.TEXT:return new l(e);case r.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new u(e);case"Btn":return e.data.radioButton?new p(e):e.data.checkBox?new h(e):new f(e);case"Ch":return new g(e)}return new d(e);case r.AnnotationType.POPUP:return new m(e);case r.AnnotationType.FREETEXT:return new b(e);case r.AnnotationType.LINE:return new S(e);case r.AnnotationType.SQUARE:return new y(e);case r.AnnotationType.CIRCLE:return new C(e);case r.AnnotationType.POLYLINE:return new w(e);case r.AnnotationType.CARET:return new A(e);case r.AnnotationType.INK:return new k(e);case r.AnnotationType.POLYGON:return new _(e);case r.AnnotationType.HIGHLIGHT:return new T(e);case r.AnnotationType.UNDERLINE:return new I(e);case r.AnnotationType.SQUIGGLY:return new O(e);case r.AnnotationType.STRIKEOUT:return new E(e);case r.AnnotationType.STAMP:return new x(e);case r.AnnotationType.FILEATTACHMENT:return new P(e);default:return new a(e)}}}class a{constructor(e,t=!1,n=!1){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderInteractiveForms=e.renderInteractiveForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,t&&(this.container=this._createContainer(n))}_createContainer(e=!1){const t=this.data,n=this.page,i=this.viewport,s=document.createElement("section");let o=t.rect[2]-t.rect[0],a=t.rect[3]-t.rect[1];s.setAttribute("data-annotation-id",t.id);const c=r.Util.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]);if(s.style.transform=`matrix(${i.transform.join(",")})`,s.style.transformOrigin=`-${c[0]}px -${c[1]}px`,!e&&t.borderStyle.width>0){s.style.borderWidth=t.borderStyle.width+"px",t.borderStyle.style!==r.AnnotationBorderStyleType.UNDERLINE&&(o-=2*t.borderStyle.width,a-=2*t.borderStyle.width);const e=t.borderStyle.horizontalCornerRadius,n=t.borderStyle.verticalCornerRadius;if(e>0||n>0){const t=`${e}px / ${n}px`;s.style.borderRadius=t}switch(t.borderStyle.style){case r.AnnotationBorderStyleType.SOLID:s.style.borderStyle="solid";break;case r.AnnotationBorderStyleType.DASHED:s.style.borderStyle="dashed";break;case r.AnnotationBorderStyleType.BEVELED:(0,r.warn)("Unimplemented border style: beveled");break;case r.AnnotationBorderStyleType.INSET:(0,r.warn)("Unimplemented border style: inset");break;case r.AnnotationBorderStyleType.UNDERLINE:s.style.borderBottomStyle="solid"}t.color?s.style.borderColor=r.Util.makeCssRgb(0|t.color[0],0|t.color[1],0|t.color[2]):s.style.borderWidth=0}return s.style.left=c[0]+"px",s.style.top=c[1]+"px",s.style.width=o+"px",s.style.height=a+"px",s}_createPopup(e,t,n){t||((t=document.createElement("div")).style.height=e.style.height,t.style.width=e.style.width,e.appendChild(t));const i=new v({container:e,trigger:t,color:n.color,title:n.title,modificationDate:n.modificationDate,contents:n.contents,hideWrapper:!0}).render();i.style.left=e.style.width,e.appendChild(i)}render(){(0,r.unreachable)("Abstract method `AnnotationElement.render` called")}}class c extends a{constructor(e){super(e,!!(e.data.url||e.data.dest||e.data.action))}render(){this.container.className="linkAnnotation";const{data:e,linkService:t}=this,n=document.createElement("a");return e.url?(0,i.addLinkAttributes)(n,{url:e.url,target:e.newWindow?i.LinkTarget.BLANK:t.externalLinkTarget,rel:t.externalLinkRel,enabled:t.externalLinkEnabled}):e.action?this._bindNamedAction(n,e.action):this._bindLink(n,e.dest),this.container.appendChild(n),this.container}_bindLink(e,t){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.navigateTo(t),!1),t&&(e.className="internalLink")}_bindNamedAction(e,t){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),e.className="internalLink"}}class l extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents))}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}}class d extends a{render(){return this.container}}class u extends d{constructor(e){super(e,e.renderInteractiveForms||!e.data.hasAppearance&&!!e.data.fieldValue)}render(){const e=["left","center","right"],t=this.annotationStorage,n=this.data.id;this.container.className="textWidgetAnnotation";let i=null;if(this.renderInteractiveForms){const e=t.getOrCreateValue(n,this.data.fieldValue);if(this.data.multiLine?(i=document.createElement("textarea"),i.textContent=e):(i=document.createElement("input"),i.type="text",i.setAttribute("value",e)),i.addEventListener("input",(function(e){t.setValue(n,e.target.value)})),i.disabled=this.data.readOnly,i.name=this.data.fieldName,null!==this.data.maxLen&&(i.maxLength=this.data.maxLen),this.data.comb){const e=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;i.classList.add("comb"),i.style.letterSpacing=`calc(${e}px - 1ch)`}}else{i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";let e=null;this.data.fontRefName&&this.page.commonObjs.has(this.data.fontRefName)&&(e=this.page.commonObjs.get(this.data.fontRefName)),this._setTextStyle(i,e)}return null!==this.data.textAlignment&&(i.style.textAlign=e[this.data.textAlignment]),this.container.appendChild(i),this.container}_setTextStyle(e,t){const n=e.style;if(n.fontSize=this.data.fontSize+"px",n.direction=this.data.fontDirection<0?"rtl":"ltr",!t)return;let i="normal";t.black?i="900":t.bold&&(i="bold"),n.fontWeight=i,n.fontStyle=t.italic?"italic":"normal";const r=t.loadedName?`"${t.loadedName}", `:"",s=t.fallbackName||"Helvetica, sans-serif";n.fontFamily=r+s}}class h extends d{constructor(e){super(e,e.renderInteractiveForms)}render(){const e=this.annotationStorage,t=this.data,n=t.id,i=e.getOrCreateValue(n,t.fieldValue&&"Off"!==t.fieldValue);this.container.className="buttonWidgetAnnotation checkBox";const r=document.createElement("input");return r.disabled=t.readOnly,r.type="checkbox",r.name=this.data.fieldName,i&&r.setAttribute("checked",!0),r.addEventListener("change",(function(t){e.setValue(n,t.target.checked)})),this.container.appendChild(r),this.container}}class p extends d{constructor(e){super(e,e.renderInteractiveForms)}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,t=this.data,n=t.id,i=e.getOrCreateValue(n,t.fieldValue===t.buttonValue),r=document.createElement("input");return r.disabled=t.readOnly,r.type="radio",r.name=t.fieldName,i&&r.setAttribute("checked",!0),r.addEventListener("change",(function(t){const i=t.target.name;for(const n of document.getElementsByName(i))n!==t.target&&e.setValue(n.parentNode.getAttribute("data-annotation-id"),!1);e.setValue(n,t.target.checked)})),this.container.appendChild(r),this.container}}class f extends c{render(){const e=super.render();return e.className="buttonWidgetAnnotation pushButton",e}}class g extends d{constructor(e){super(e,e.renderInteractiveForms)}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,t=this.data.id;e.getOrCreateValue(t,this.data.fieldValue.length>0?this.data.fieldValue[0]:null);const n=document.createElement("select");n.disabled=this.data.readOnly,n.name=this.data.fieldName,this.data.combo||(n.size=this.data.options.length,this.data.multiSelect&&(n.multiple=!0));for(const e of this.data.options){const t=document.createElement("option");t.textContent=e.displayValue,t.value=e.exportValue,this.data.fieldValue.includes(e.exportValue)&&t.setAttribute("selected",!0),n.appendChild(t)}return n.addEventListener("input",(function(n){const i=n.target.options,r=i[i.selectedIndex].value;e.setValue(t,r)})),this.container.appendChild(n),this.container}}class m extends a{constructor(e){super(e,!(!e.data.title&&!e.data.contents))}render(){if(this.container.className="popupAnnotation",["Line","Square","Circle","PolyLine","Polygon","Ink"].includes(this.data.parentType))return this.container;const e=`[data-annotation-id="${this.data.parentId}"]`,t=this.layer.querySelector(e);if(!t)return this.container;const n=new v({container:this.container,trigger:t,color:this.data.color,title:this.data.title,modificationDate:this.data.modificationDate,contents:this.data.contents}),i=parseFloat(t.style.left),r=parseFloat(t.style.width);return this.container.style.transformOrigin=`-${i+r}px -${t.style.top}`,this.container.style.left=i+r+"px",this.container.appendChild(n.render()),this.container}}class v{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.title=e.title,this.modificationDate=e.modificationDate,this.contents=e.contents,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const e=document.createElement("div");e.className="popupWrapper",this.hideElement=this.hideWrapper?e:this.container,this.hideElement.setAttribute("hidden",!0);const t=document.createElement("div");t.className="popup";const n=this.color;if(n){const e=.7*(255-n[0])+n[0],i=.7*(255-n[1])+n[1],s=.7*(255-n[2])+n[2];t.style.backgroundColor=r.Util.makeCssRgb(0|e,0|i,0|s)}const s=document.createElement("h1");s.textContent=this.title,t.appendChild(s);const o=i.PDFDateString.toDateObject(this.modificationDate);if(o){const e=document.createElement("span");e.textContent="{{date}}, {{time}}",e.dataset.l10nId="annotation_date_string",e.dataset.l10nArgs=JSON.stringify({date:o.toLocaleDateString(),time:o.toLocaleTimeString()}),t.appendChild(e)}const a=this._formatContents(this.contents);return t.appendChild(a),this.trigger.addEventListener("click",this._toggle.bind(this)),this.trigger.addEventListener("mouseover",this._show.bind(this,!1)),this.trigger.addEventListener("mouseout",this._hide.bind(this,!1)),t.addEventListener("click",this._hide.bind(this,!0)),e.appendChild(t),e}_formatContents(e){const t=document.createElement("p"),n=e.split(/(?:\r\n?|\n)/);for(let e=0,i=n.length;e<i;++e){const r=n[e];t.appendChild(document.createTextNode(r)),e<i-1&&t.appendChild(document.createElement("br"))}return t}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hasAttribute("hidden")&&(this.hideElement.removeAttribute("hidden"),this.container.style.zIndex+=1)}_hide(e=!0){e&&(this.pinned=!1),this.hideElement.hasAttribute("hidden")||this.pinned||(this.hideElement.setAttribute("hidden",!0),this.container.style.zIndex-=1)}}class b extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class S extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="lineAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=this.svgFactory.createElement("svg:line");return r.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),r.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),r.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),r.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),i.appendChild(r),this.container.append(i),this._createPopup(this.container,r,e),this.container}}class y extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="squareAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.borderStyle.width,s=this.svgFactory.createElement("svg:rect");return s.setAttribute("x",r/2),s.setAttribute("y",r/2),s.setAttribute("width",t-r),s.setAttribute("height",n-r),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","none"),i.appendChild(s),this.container.append(i),this._createPopup(this.container,s,e),this.container}}class C extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){this.container.className="circleAnnotation";const e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n),r=e.borderStyle.width,s=this.svgFactory.createElement("svg:ellipse");return s.setAttribute("cx",t/2),s.setAttribute("cy",n/2),s.setAttribute("rx",t/2-r/2),s.setAttribute("ry",n/2-r/2),s.setAttribute("stroke-width",r||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","none"),i.appendChild(s),this.container.append(i),this._createPopup(this.container,s,e),this.container}}class w extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n);let r=[];for(const t of e.vertices){const n=t.x-e.rect[0],i=e.rect[3]-t.y;r.push(n+","+i)}r=r.join(" ");const s=this.svgFactory.createElement(this.svgElementName);return s.setAttribute("points",r),s.setAttribute("stroke-width",e.borderStyle.width||1),s.setAttribute("stroke","transparent"),s.setAttribute("fill","none"),i.appendChild(s),this.container.append(i),this._createPopup(this.container,s,e),this.container}}class _ extends w{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class A extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class k extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,t=e.rect[2]-e.rect[0],n=e.rect[3]-e.rect[1],i=this.svgFactory.create(t,n);for(const t of e.inkLists){let n=[];for(const i of t){const t=i.x-e.rect[0],r=e.rect[3]-i.y;n.push(`${t},${r}`)}n=n.join(" ");const r=this.svgFactory.createElement(this.svgElementName);r.setAttribute("points",n),r.setAttribute("stroke-width",e.borderStyle.width||1),r.setAttribute("stroke","transparent"),r.setAttribute("fill","none"),this._createPopup(this.container,r,e),i.appendChild(r)}return this.container.append(i),this.container}}class T extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="highlightAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class I extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="underlineAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class O extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="squigglyAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class E extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="strikeoutAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class x extends a{constructor(e){super(e,!!(e.data.hasPopup||e.data.title||e.data.contents),!0)}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(this.container,null,this.data),this.container}}class P extends a{constructor(e){super(e,!0);const{filename:t,content:n}=this.data.file;this.filename=(0,i.getFilenameFromUrl)(t),this.content=n,this.linkService.eventBus&&this.linkService.eventBus.dispatch("fileattachmentannotation",{source:this,id:(0,r.stringToPDFString)(t),filename:t,content:n})}render(){this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),this.data.hasPopup||!this.data.title&&!this.data.contents||this._createPopup(this.container,e,this.data),this.container.appendChild(e),this.container}_download(){this.downloadManager?this.downloadManager.downloadData(this.content,this.filename,""):(0,r.warn)("Download cannot be started due to unavailable download manager")}}t.AnnotationLayer=class{static render(e){const t=[],n=[];for(const i of e.annotations)i&&(i.annotationType!==r.AnnotationType.POPUP?t.push(i):n.push(i));n.length&&t.push(...n);for(const n of t){const t=o.create({data:n,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderInteractiveForms:"boolean"!=typeof e.renderInteractiveForms||e.renderInteractiveForms,svgFactory:new i.DOMSVGFactory,annotationStorage:e.annotationStorage||new s.AnnotationStorage});t.isRenderable&&e.div.appendChild(t.render())}}static update(e){for(const t of e.annotations){const n=e.div.querySelector(`[data-annotation-id="${t.id}"]`);n&&(n.style.transform=`matrix(${e.viewport.transform.join(",")})`)}e.div.removeAttribute("hidden")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderTextLayer=void 0;var i=n(2),r=function(){var e=/\S/;function t(t,n,r){var s,o=document.createElement("span"),a={angle:0,canvasWidth:0,isWhitespace:!1,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1};if(t._textDivs.push(o),s=n.str,!e.test(s))return a.isWhitespace=!0,void t._textDivProperties.set(o,a);var c=i.Util.transform(t._viewport.transform,n.transform),l=Math.atan2(c[1],c[0]),d=r[n.fontName];d.vertical&&(l+=Math.PI/2);var u=Math.sqrt(c[2]*c[2]+c[3]*c[3]),h=u;let p,f;d.ascent?h=d.ascent*h:d.descent&&(h=(1+d.descent)*h),0===l?(p=c[4],f=c[5]-h):(p=c[4]+h*Math.sin(l),f=c[5]-h*Math.cos(l)),o.style.left=p+"px",o.style.top=f+"px",o.style.fontSize=u+"px",o.style.fontFamily=d.fontFamily,o.textContent=n.str,t._fontInspectorEnabled&&(o.dataset.fontName=n.fontName),0!==l&&(a.angle=l*(180/Math.PI));let g=!1;if(n.str.length>1)g=!0;else if(n.transform[0]!==n.transform[3]){const e=Math.abs(n.transform[0]),t=Math.abs(n.transform[3]);e!==t&&Math.max(e,t)/Math.min(e,t)>1.5&&(g=!0)}if(g&&(d.vertical?a.canvasWidth=n.height*t._viewport.scale:a.canvasWidth=n.width*t._viewport.scale),t._textDivProperties.set(o,a),t._textContentStream&&t._layoutText(o),t._enhanceTextSelection){var m=1,v=0;0!==l&&(m=Math.cos(l),v=Math.sin(l));var b,S,y=(d.vertical?n.height:n.width)*t._viewport.scale,C=u;0!==l?(b=[m,v,-v,m,p,f],S=i.Util.getAxialAlignedBoundingBox([0,0,y,C],b)):S=[p,f,p+y,f+C],t._bounds.push({left:S[0],top:S[1],right:S[2],bottom:S[3],div:o,size:[y,C],m:b})}}function n(e){if(!e._canceled){var t=e._textDivs,n=e._capability,i=t.length;if(i>1e5)return e._renderingDone=!0,void n.resolve();if(!e._textContentStream)for(var r=0;r<i;r++)e._layoutText(t[r]);e._renderingDone=!0,n.resolve()}}function r(e,t,n){let i=0;for(let r=0;r<n;r++){const n=e[t++];n>0&&(i=i?Math.min(n,i):n)}return i}function s(e){for(var t=e._bounds,n=e._viewport,s=function(e,t,n){var i=n.map((function(e,t){return{x1:e.left,y1:e.top,x2:e.right,y2:e.bottom,index:t,x1New:void 0,x2New:void 0}}));o(e,i);var r=new Array(n.length);return i.forEach((function(e){var t=e.index;r[t]={left:e.x1New,top:0,right:e.x2New,bottom:0}})),n.map((function(t,n){var s=r[n],o=i[n];o.x1=t.top,o.y1=e-s.right,o.x2=t.bottom,o.y2=e-s.left,o.index=n,o.x1New=void 0,o.x2New=void 0})),o(t,i),i.forEach((function(e){var t=e.index;r[t].top=e.x1New,r[t].bottom=e.x2New})),r}(n.width,n.height,t),a=0;a<s.length;a++){var c=t[a].div,l=e._textDivProperties.get(c);if(0!==l.angle){var d=s[a],u=t[a],h=u.m,p=h[0],f=h[1],g=[[0,0],[0,u.size[1]],[u.size[0],0],u.size],m=new Float64Array(64);g.forEach((function(e,t){var n=i.Util.applyTransform(e,h);m[t+0]=p&&(d.left-n[0])/p,m[t+4]=f&&(d.top-n[1])/f,m[t+8]=p&&(d.right-n[0])/p,m[t+12]=f&&(d.bottom-n[1])/f,m[t+16]=f&&(d.left-n[0])/-f,m[t+20]=p&&(d.top-n[1])/p,m[t+24]=f&&(d.right-n[0])/-f,m[t+28]=p&&(d.bottom-n[1])/p,m[t+32]=p&&(d.left-n[0])/-p,m[t+36]=f&&(d.top-n[1])/-f,m[t+40]=p&&(d.right-n[0])/-p,m[t+44]=f&&(d.bottom-n[1])/-f,m[t+48]=f&&(d.left-n[0])/f,m[t+52]=p&&(d.top-n[1])/-p,m[t+56]=f&&(d.right-n[0])/f,m[t+60]=p&&(d.bottom-n[1])/-p}));var v=1+Math.min(Math.abs(p),Math.abs(f));l.paddingLeft=r(m,32,16)/v,l.paddingTop=r(m,48,16)/v,l.paddingRight=r(m,0,16)/v,l.paddingBottom=r(m,16,16)/v,e._textDivProperties.set(c,l)}else l.paddingLeft=t[a].left-s[a].left,l.paddingTop=t[a].top-s[a].top,l.paddingRight=s[a].right-t[a].right,l.paddingBottom=s[a].bottom-t[a].bottom,e._textDivProperties.set(c,l)}}function o(e,t){t.sort((function(e,t){return e.x1-t.x1||e.index-t.index}));var n=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];t.forEach((function(e){for(var t=0;t<n.length&&n[t].end<=e.y1;)t++;for(var i,r,s=n.length-1;s>=0&&n[s].start>=e.y2;)s--;var o,a,c=-1/0;for(o=t;o<=s;o++){var l;(l=(r=(i=n[o]).boundary).x2>e.x1?r.index>e.index?r.x1New:e.x1:void 0===r.x2New?(r.x2+e.x1)/2:r.x2New)>c&&(c=l)}for(e.x1New=c,o=t;o<=s;o++)void 0===(r=(i=n[o]).boundary).x2New?r.x2>e.x1?r.index>e.index&&(r.x2New=r.x2):r.x2New=c:r.x2New>c&&(r.x2New=Math.max(c,r.x2));var d=[],u=null;for(o=t;o<=s;o++){var h=(r=(i=n[o]).boundary).x2>e.x2?r:e;u===h?d[d.length-1].end=i.end:(d.push({start:i.start,end:i.end,boundary:h}),u=h)}for(n[t].start<e.y1&&(d[0].start=e.y1,d.unshift({start:n[t].start,end:e.y1,boundary:n[t].boundary})),e.y2<n[s].end&&(d[d.length-1].end=e.y2,d.push({start:e.y2,end:n[s].end,boundary:n[s].boundary})),o=t;o<=s;o++)if(void 0===(r=(i=n[o]).boundary).x2New){var p=!1;for(a=t-1;!p&&a>=0&&n[a].start>=r.y1;a--)p=n[a].boundary===r;for(a=s+1;!p&&a<n.length&&n[a].end<=r.y2;a++)p=n[a].boundary===r;for(a=0;!p&&a<d.length;a++)p=d[a].boundary===r;p||(r.x2New=c)}Array.prototype.splice.apply(n,[t,s-t+1].concat(d))})),n.forEach((function(t){var n=t.boundary;void 0===n.x2New&&(n.x2New=Math.max(e,n.x2))}))}function a({textContent:e,textContentStream:t,container:n,viewport:r,textDivs:s,textContentItemsStr:o,enhanceTextSelection:a}){this._textContent=e,this._textContentStream=t,this._container=n,this._document=n.ownerDocument,this._viewport=r,this._textDivs=s||[],this._textContentItemsStr=o||[],this._enhanceTextSelection=!!a,this._fontInspectorEnabled=!(!globalThis.FontInspector||!globalThis.FontInspector.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,i.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}return a.prototype={get promise(){return this._capability.promise},cancel:function(){this._canceled=!0,this._reader&&(this._reader.cancel(new i.AbortException("TextLayer task cancelled.")),this._reader=null),null!==this._renderTimer&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))},_processItems(e,n){for(let i=0,r=e.length;i<r;i++)this._textContentItemsStr.push(e[i].str),t(this,e[i],n)},_layoutText(e){const t=this._textDivProperties.get(e);if(t.isWhitespace)return;let n="";if(0!==t.canvasWidth){const{fontSize:i,fontFamily:r}=e.style;i===this._layoutTextLastFontSize&&r===this._layoutTextLastFontFamily||(this._layoutTextCtx.font=`${i} ${r}`,this._layoutTextLastFontSize=i,this._layoutTextLastFontFamily=r);const{width:s}=this._layoutTextCtx.measureText(e.textContent);s>0&&(t.scale=t.canvasWidth/s,n=`scaleX(${t.scale})`)}0!==t.angle&&(n=`rotate(${t.angle}deg) ${n}`),n.length>0&&(this._enhanceTextSelection&&(t.originalTransform=n),e.style.transform=n),this._textDivProperties.set(e,t),this._container.appendChild(e)},_render:function(e){const t=(0,i.createPromiseCapability)();let r=Object.create(null);const s=this._document.createElement("canvas");if(s.mozOpaque=!0,this._layoutTextCtx=s.getContext("2d",{alpha:!1}),this._textContent){const e=this._textContent.items,n=this._textContent.styles;this._processItems(e,n),t.resolve()}else{if(!this._textContentStream)throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');{const e=()=>{this._reader.read().then(({value:n,done:i})=>{i?t.resolve():(Object.assign(r,n.styles),this._processItems(n.items,r),e())},t.reject)};this._reader=this._textContentStream.getReader(),e()}}t.promise.then(()=>{r=null,e?this._renderTimer=setTimeout(()=>{n(this),this._renderTimer=null},e):n(this)},this._capability.reject)},expandTextDivs:function(e){if(!this._enhanceTextSelection||!this._renderingDone)return;null!==this._bounds&&(s(this),this._bounds=null);const t=[],n=[];for(var i=0,r=this._textDivs.length;i<r;i++){const r=this._textDivs[i],s=this._textDivProperties.get(r);s.isWhitespace||(e?(t.length=0,n.length=0,s.originalTransform&&t.push(s.originalTransform),s.paddingTop>0?(n.push(s.paddingTop+"px"),t.push(`translateY(${-s.paddingTop}px)`)):n.push(0),s.paddingRight>0?n.push(s.paddingRight/s.scale+"px"):n.push(0),s.paddingBottom>0?n.push(s.paddingBottom+"px"):n.push(0),s.paddingLeft>0?(n.push(s.paddingLeft/s.scale+"px"),t.push(`translateX(${-s.paddingLeft/s.scale}px)`)):n.push(0),r.style.padding=n.join(" "),t.length&&(r.style.transform=t.join(" "))):(r.style.padding=null,r.style.transform=s.originalTransform))}}},function(e){var t=new a({textContent:e.textContent,textContentStream:e.textContentStream,container:e.container,viewport:e.viewport,textDivs:e.textDivs,textContentItemsStr:e.textContentItemsStr,enhanceTextSelection:e.enhanceTextSelection});return t._render(e.timeout),t}}();t.renderTextLayer=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var i=n(2),r=n(1),s=n(4);let o=function(){throw new Error("Not implemented: SVGGraphics")};t.SVGGraphics=o;{const e={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},n="http://www.w3.org/XML/1998/namespace",l="http://www.w3.org/1999/xlink",d=["butt","round","square"],u=["miter","round","bevel"],h=function(){const e=new Uint8Array([137,80,78,71,13,10,26,10]),t=new Int32Array(256);for(let e=0;e<256;e++){let n=e;for(let e=0;e<8;e++)n=1&n?3988292384^n>>1&2147483647:n>>1&2147483647;t[e]=n}function n(e,n,i,r){let s=r;const o=n.length;i[s]=o>>24&255,i[s+1]=o>>16&255,i[s+2]=o>>8&255,i[s+3]=255&o,s+=4,i[s]=255&e.charCodeAt(0),i[s+1]=255&e.charCodeAt(1),i[s+2]=255&e.charCodeAt(2),i[s+3]=255&e.charCodeAt(3),s+=4,i.set(n,s),s+=n.length;const a=function(e,n,i){let r=-1;for(let s=n;s<i;s++){const n=255&(r^e[s]);r=r>>>8^t[n]}return-1^r}(i,r+4,s);i[s]=a>>24&255,i[s+1]=a>>16&255,i[s+2]=a>>8&255,i[s+3]=255&a}function r(e){let t=e.length;const n=Math.ceil(t/65535),i=new Uint8Array(2+t+5*n+4);let r=0;i[r++]=120,i[r++]=156;let s=0;for(;t>65535;)i[r++]=0,i[r++]=255,i[r++]=255,i[r++]=0,i[r++]=0,i.set(e.subarray(s,s+65535),r),r+=65535,s+=65535,t-=65535;i[r++]=1,i[r++]=255&t,i[r++]=t>>8&255,i[r++]=255&~t,i[r++]=(65535&~t)>>8&255,i.set(e.subarray(s),r),r+=e.length-s;const o=function(e,t,n){let i=1,r=0;for(let s=t;s<n;++s)i=(i+(255&e[s]))%65521,r=(r+i)%65521;return r<<16|i}(e,0,e.length);return i[r++]=o>>24&255,i[r++]=o>>16&255,i[r++]=o>>8&255,i[r++]=255&o,i}function o(t,o,a,c){const l=t.width,d=t.height;let u,h,p;const f=t.data;switch(o){case i.ImageKind.GRAYSCALE_1BPP:h=0,u=1,p=l+7>>3;break;case i.ImageKind.RGB_24BPP:h=2,u=8,p=3*l;break;case i.ImageKind.RGBA_32BPP:h=6,u=8,p=4*l;break;default:throw new Error("invalid format")}const g=new Uint8Array((1+p)*d);let m=0,v=0;for(let e=0;e<d;++e)g[m++]=0,g.set(f.subarray(v,v+p),m),v+=p,m+=p;if(o===i.ImageKind.GRAYSCALE_1BPP&&c){m=0;for(let e=0;e<d;e++){m++;for(let e=0;e<p;e++)g[m++]^=255}}const b=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,255&l,d>>24&255,d>>16&255,d>>8&255,255&d,u,h,0,0,0]),S=function(e){if(!s.isNodeJS)return r(e);try{let t;t=parseInt(process.versions.node)>=8?e:Buffer.from(e);const n=__webpack_require__(293).deflateSync(t,{level:9});return n instanceof Uint8Array?n:new Uint8Array(n)}catch(e){(0,i.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+e)}return r(e)}(g),y=e.length+36+b.length+S.length,C=new Uint8Array(y);let w=0;return C.set(e,w),w+=e.length,n("IHDR",b,C,w),w+=12+b.length,n("IDATA",S,C,w),w+=12+S.length,n("IEND",new Uint8Array(0),C,w),(0,i.createObjectURL)(C,"image/png",a)}return function(e,t,n){return o(e,void 0===e.kind?i.ImageKind.GRAYSCALE_1BPP:e.kind,t,n)}}();class p{constructor(){this.fontSizeScale=1,this.fontWeight=e.fontWeight,this.fontSize=0,this.textMatrix=i.IDENTITY_MATRIX,this.fontMatrix=i.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=i.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=e.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(e,t){this.x=e,this.y=t}}function a(e){if(Number.isInteger(e))return e.toString();const t=e.toFixed(10);let n=t.length-1;if("0"!==t[n])return t;do{n--}while("0"===t[n]);return t.substring(0,"."===t[n]?n:n+1)}function c(e){if(0===e[4]&&0===e[5]){if(0===e[1]&&0===e[2])return 1===e[0]&&1===e[3]?"":`scale(${a(e[0])} ${a(e[3])})`;if(e[0]===e[3]&&e[1]===-e[2])return`rotate(${a(180*Math.acos(e[0])/Math.PI)})`}else if(1===e[0]&&0===e[1]&&0===e[2]&&1===e[3])return`translate(${a(e[4])} ${a(e[5])})`;return`matrix(${a(e[0])} ${a(e[1])} ${a(e[2])} ${a(e[3])} ${a(e[4])} `+a(e[5])+")"}let f=0,g=0,m=0;t.SVGGraphics=o=class{constructor(e,t,n=!1){this.svgFactory=new r.DOMSVGFactory,this.current=new p,this.transformMatrix=i.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=e,this.objs=t,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!n,this._operatorIdMapping=[];for(const e in i.OPS)this._operatorIdMapping[i.OPS[e]]=e}save(){this.transformStack.push(this.transformMatrix);const e=this.current;this.extraStack.push(e),this.current=e.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(e){this.save(),this.executeOpTree(e),this.restore()}loadDependencies(e){const t=e.fnArray,n=e.argsArray;for(let e=0,r=t.length;e<r;e++)if(t[e]===i.OPS.dependency)for(const t of n[e]){const e=t.startsWith("g_")?this.commonObjs:this.objs,n=new Promise(n=>{e.get(t,n)});this.current.dependencies.push(n)}return Promise.all(this.current.dependencies)}transform(e,t,n,r,s,o){const a=[e,t,n,r,s,o];this.transformMatrix=i.Util.transform(this.transformMatrix,a),this.tgrp=null}getSVG(e,t){this.viewport=t;const n=this._initialize(t);return this.loadDependencies(e).then(()=>(this.transformMatrix=i.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(e)),n))}convertOpList(e){const t=this._operatorIdMapping,n=e.argsArray,i=e.fnArray,r=[];for(let e=0,s=i.length;e<s;e++){const s=i[e];r.push({fnId:s,fn:t[s],args:n[e]})}return function(e){let t=[];const n=[];for(const i of e)"save"!==i.fn?"restore"===i.fn?t=n.pop():t.push(i):(t.push({fnId:92,fn:"group",items:[]}),n.push(t),t=t[t.length-1].items);return t}(r)}executeOpTree(e){for(const t of e){const e=t.fn,n=t.fnId,r=t.args;switch(0|n){case i.OPS.beginText:this.beginText();break;case i.OPS.dependency:break;case i.OPS.setLeading:this.setLeading(r);break;case i.OPS.setLeadingMoveText:this.setLeadingMoveText(r[0],r[1]);break;case i.OPS.setFont:this.setFont(r);break;case i.OPS.showText:case i.OPS.showSpacedText:this.showText(r[0]);break;case i.OPS.endText:this.endText();break;case i.OPS.moveText:this.moveText(r[0],r[1]);break;case i.OPS.setCharSpacing:this.setCharSpacing(r[0]);break;case i.OPS.setWordSpacing:this.setWordSpacing(r[0]);break;case i.OPS.setHScale:this.setHScale(r[0]);break;case i.OPS.setTextMatrix:this.setTextMatrix(r[0],r[1],r[2],r[3],r[4],r[5]);break;case i.OPS.setTextRise:this.setTextRise(r[0]);break;case i.OPS.setTextRenderingMode:this.setTextRenderingMode(r[0]);break;case i.OPS.setLineWidth:this.setLineWidth(r[0]);break;case i.OPS.setLineJoin:this.setLineJoin(r[0]);break;case i.OPS.setLineCap:this.setLineCap(r[0]);break;case i.OPS.setMiterLimit:this.setMiterLimit(r[0]);break;case i.OPS.setFillRGBColor:this.setFillRGBColor(r[0],r[1],r[2]);break;case i.OPS.setStrokeRGBColor:this.setStrokeRGBColor(r[0],r[1],r[2]);break;case i.OPS.setStrokeColorN:this.setStrokeColorN(r);break;case i.OPS.setFillColorN:this.setFillColorN(r);break;case i.OPS.shadingFill:this.shadingFill(r[0]);break;case i.OPS.setDash:this.setDash(r[0],r[1]);break;case i.OPS.setRenderingIntent:this.setRenderingIntent(r[0]);break;case i.OPS.setFlatness:this.setFlatness(r[0]);break;case i.OPS.setGState:this.setGState(r[0]);break;case i.OPS.fill:this.fill();break;case i.OPS.eoFill:this.eoFill();break;case i.OPS.stroke:this.stroke();break;case i.OPS.fillStroke:this.fillStroke();break;case i.OPS.eoFillStroke:this.eoFillStroke();break;case i.OPS.clip:this.clip("nonzero");break;case i.OPS.eoClip:this.clip("evenodd");break;case i.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case i.OPS.paintImageXObject:this.paintImageXObject(r[0]);break;case i.OPS.paintInlineImageXObject:this.paintInlineImageXObject(r[0]);break;case i.OPS.paintImageMaskXObject:this.paintImageMaskXObject(r[0]);break;case i.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(r[0],r[1]);break;case i.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case i.OPS.closePath:this.closePath();break;case i.OPS.closeStroke:this.closeStroke();break;case i.OPS.closeFillStroke:this.closeFillStroke();break;case i.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case i.OPS.nextLine:this.nextLine();break;case i.OPS.transform:this.transform(r[0],r[1],r[2],r[3],r[4],r[5]);break;case i.OPS.constructPath:this.constructPath(r[0],r[1]);break;case i.OPS.endPath:this.endPath();break;case 92:this.group(t.items);break;default:(0,i.warn)("Unimplemented operator "+e)}}}setWordSpacing(e){this.current.wordSpacing=e}setCharSpacing(e){this.current.charSpacing=e}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(e,t,n,i,r,s){const o=this.current;o.textMatrix=o.lineMatrix=[e,t,n,i,r,s],o.textMatrixScale=Math.sqrt(e*e+t*t),o.x=o.lineX=0,o.y=o.lineY=0,o.xcoords=[],o.ycoords=[],o.tspan=this.svgFactory.createElement("svg:tspan"),o.tspan.setAttributeNS(null,"font-family",o.fontFamily),o.tspan.setAttributeNS(null,"font-size",a(o.fontSize)+"px"),o.tspan.setAttributeNS(null,"y",a(-o.y)),o.txtElement=this.svgFactory.createElement("svg:text"),o.txtElement.appendChild(o.tspan)}beginText(){const e=this.current;e.x=e.lineX=0,e.y=e.lineY=0,e.textMatrix=i.IDENTITY_MATRIX,e.lineMatrix=i.IDENTITY_MATRIX,e.textMatrixScale=1,e.tspan=this.svgFactory.createElement("svg:tspan"),e.txtElement=this.svgFactory.createElement("svg:text"),e.txtgrp=this.svgFactory.createElement("svg:g"),e.xcoords=[],e.ycoords=[]}moveText(e,t){const n=this.current;n.x=n.lineX+=e,n.y=n.lineY+=t,n.xcoords=[],n.ycoords=[],n.tspan=this.svgFactory.createElement("svg:tspan"),n.tspan.setAttributeNS(null,"font-family",n.fontFamily),n.tspan.setAttributeNS(null,"font-size",a(n.fontSize)+"px"),n.tspan.setAttributeNS(null,"y",a(-n.y))}showText(t){const r=this.current,s=r.font,o=r.fontSize;if(0===o)return;const l=r.fontSizeScale,d=r.charSpacing,u=r.wordSpacing,h=r.fontDirection,p=r.textHScale*h,f=s.vertical,g=f?1:-1,m=s.defaultVMetrics,v=o*r.fontMatrix[0];let b=0;for(const e of t){if(null===e){b+=h*u;continue}if((0,i.isNum)(e)){b+=g*e*o/1e3;continue}const t=(e.isSpace?u:0)+d,n=e.fontChar;let a,c,p,S=e.width;if(f){let t;const n=e.vmetric||m;t=e.vmetric?n[1]:.5*S,t=-t*v;const i=n[2]*v;S=n?-n[0]:S,a=t/l,c=(b+i)/l}else a=b/l,c=0;(e.isInFont||s.missingFile)&&(r.xcoords.push(r.x+a),f&&r.ycoords.push(-r.y+c),r.tspan.textContent+=n),p=f?S*v-t*h:S*v+t*h,b+=p}r.tspan.setAttributeNS(null,"x",r.xcoords.map(a).join(" ")),f?r.tspan.setAttributeNS(null,"y",r.ycoords.map(a).join(" ")):r.tspan.setAttributeNS(null,"y",a(-r.y)),f?r.y-=b:r.x+=b*p,r.tspan.setAttributeNS(null,"font-family",r.fontFamily),r.tspan.setAttributeNS(null,"font-size",a(r.fontSize)+"px"),r.fontStyle!==e.fontStyle&&r.tspan.setAttributeNS(null,"font-style",r.fontStyle),r.fontWeight!==e.fontWeight&&r.tspan.setAttributeNS(null,"font-weight",r.fontWeight);const S=r.textRenderingMode&i.TextRenderingMode.FILL_STROKE_MASK;if(S===i.TextRenderingMode.FILL||S===i.TextRenderingMode.FILL_STROKE?(r.fillColor!==e.fillColor&&r.tspan.setAttributeNS(null,"fill",r.fillColor),r.fillAlpha<1&&r.tspan.setAttributeNS(null,"fill-opacity",r.fillAlpha)):r.textRenderingMode===i.TextRenderingMode.ADD_TO_PATH?r.tspan.setAttributeNS(null,"fill","transparent"):r.tspan.setAttributeNS(null,"fill","none"),S===i.TextRenderingMode.STROKE||S===i.TextRenderingMode.FILL_STROKE){const e=1/(r.textMatrixScale||1);this._setStrokeAttributes(r.tspan,e)}let y=r.textMatrix;0!==r.textRise&&(y=y.slice(),y[5]+=r.textRise),r.txtElement.setAttributeNS(null,"transform",`${c(y)} scale(${a(p)}, -1)`),r.txtElement.setAttributeNS(n,"xml:space","preserve"),r.txtElement.appendChild(r.tspan),r.txtgrp.appendChild(r.txtElement),this._ensureTransformGroup().appendChild(r.txtElement)}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}addFontStyle(e){if(!e.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const t=(0,i.createObjectURL)(e.data,e.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${e.loadedName}"; src: url(${t}); }\n`}setFont(e){const t=this.current,n=this.commonObjs.get(e[0]);let r=e[1];t.font=n,!this.embedFonts||n.missingFile||this.embeddedFonts[n.loadedName]||(this.addFontStyle(n),this.embeddedFonts[n.loadedName]=n),t.fontMatrix=n.fontMatrix?n.fontMatrix:i.FONT_IDENTITY_MATRIX;let s="normal";n.black?s="900":n.bold&&(s="bold");const o=n.italic?"italic":"normal";r<0?(r=-r,t.fontDirection=-1):t.fontDirection=1,t.fontSize=r,t.fontFamily=n.loadedName,t.fontWeight=s,t.fontStyle=o,t.tspan=this.svgFactory.createElement("svg:tspan"),t.tspan.setAttributeNS(null,"y",a(-t.y)),t.xcoords=[],t.ycoords=[]}endText(){const e=this.current;e.textRenderingMode&i.TextRenderingMode.ADD_TO_PATH_FLAG&&e.txtElement&&e.txtElement.hasChildNodes()&&(e.element=e.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(e){e>0&&(this.current.lineWidth=e)}setLineCap(e){this.current.lineCap=d[e]}setLineJoin(e){this.current.lineJoin=u[e]}setMiterLimit(e){this.current.miterLimit=e}setStrokeAlpha(e){this.current.strokeAlpha=e}setStrokeRGBColor(e,t,n){this.current.strokeColor=i.Util.makeCssRgb(e,t,n)}setFillAlpha(e){this.current.fillAlpha=e}setFillRGBColor(e,t,n){this.current.fillColor=i.Util.makeCssRgb(e,t,n),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(e){this.current.strokeColor=this._makeColorN_Pattern(e)}setFillColorN(e){this.current.fillColor=this._makeColorN_Pattern(e)}shadingFill(e){const t=this.viewport.width,n=this.viewport.height,r=i.Util.inverseTransform(this.transformMatrix),s=i.Util.applyTransform([0,0],r),o=i.Util.applyTransform([0,n],r),a=i.Util.applyTransform([t,0],r),c=i.Util.applyTransform([t,n],r),l=Math.min(s[0],o[0],a[0],c[0]),d=Math.min(s[1],o[1],a[1],c[1]),u=Math.max(s[0],o[0],a[0],c[0]),h=Math.max(s[1],o[1],a[1],c[1]),p=this.svgFactory.createElement("svg:rect");p.setAttributeNS(null,"x",l),p.setAttributeNS(null,"y",d),p.setAttributeNS(null,"width",u-l),p.setAttributeNS(null,"height",h-d),p.setAttributeNS(null,"fill",this._makeShadingPattern(e)),this.current.fillAlpha<1&&p.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(p)}_makeColorN_Pattern(e){return"TilingPattern"===e[0]?this._makeTilingPattern(e):this._makeShadingPattern(e)}_makeTilingPattern(e){const t=e[1],n=e[2],r=e[3]||i.IDENTITY_MATRIX,[s,o,a,c]=e[4],l=e[5],d=e[6],u=e[7],h="shading"+m++,[p,f]=i.Util.applyTransform([s,o],r),[g,v]=i.Util.applyTransform([a,c],r),[b,S]=i.Util.singularValueDecompose2dScale(r),y=l*b,C=d*S,w=this.svgFactory.createElement("svg:pattern");w.setAttributeNS(null,"id",h),w.setAttributeNS(null,"patternUnits","userSpaceOnUse"),w.setAttributeNS(null,"width",y),w.setAttributeNS(null,"height",C),w.setAttributeNS(null,"x",""+p),w.setAttributeNS(null,"y",""+f);const _=this.svg,A=this.transformMatrix,k=this.current.fillColor,T=this.current.strokeColor,I=this.svgFactory.create(g-p,v-f);if(this.svg=I,this.transformMatrix=r,2===u){const e=i.Util.makeCssRgb(...t);this.current.fillColor=e,this.current.strokeColor=e}return this.executeOpTree(this.convertOpList(n)),this.svg=_,this.transformMatrix=A,this.current.fillColor=k,this.current.strokeColor=T,w.appendChild(I.childNodes[0]),this.defs.appendChild(w),`url(#${h})`}_makeShadingPattern(e){switch(e[0]){case"RadialAxial":const t="shading"+m++,n=e[3];let r;switch(e[1]){case"axial":const n=e[4],i=e[5];r=this.svgFactory.createElement("svg:linearGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"x1",n[0]),r.setAttributeNS(null,"y1",n[1]),r.setAttributeNS(null,"x2",i[0]),r.setAttributeNS(null,"y2",i[1]);break;case"radial":const s=e[4],o=e[5],a=e[6],c=e[7];r=this.svgFactory.createElement("svg:radialGradient"),r.setAttributeNS(null,"id",t),r.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),r.setAttributeNS(null,"cx",o[0]),r.setAttributeNS(null,"cy",o[1]),r.setAttributeNS(null,"r",c),r.setAttributeNS(null,"fx",s[0]),r.setAttributeNS(null,"fy",s[1]),r.setAttributeNS(null,"fr",a);break;default:throw new Error("Unknown RadialAxial type: "+e[1])}for(const e of n){const t=this.svgFactory.createElement("svg:stop");t.setAttributeNS(null,"offset",e[0]),t.setAttributeNS(null,"stop-color",e[1]),r.appendChild(t)}return this.defs.appendChild(r),`url(#${t})`;case"Mesh":return(0,i.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error("Unknown IR type: "+e[0])}}setDash(e,t){this.current.dashArray=e,this.current.dashPhase=t}constructPath(e,t){const n=this.current;let r=n.x,s=n.y,o=[],c=0;for(const n of e)switch(0|n){case i.OPS.rectangle:r=t[c++],s=t[c++];const e=r+t[c++],n=s+t[c++];o.push("M",a(r),a(s),"L",a(e),a(s),"L",a(e),a(n),"L",a(r),a(n),"Z");break;case i.OPS.moveTo:r=t[c++],s=t[c++],o.push("M",a(r),a(s));break;case i.OPS.lineTo:r=t[c++],s=t[c++],o.push("L",a(r),a(s));break;case i.OPS.curveTo:r=t[c+4],s=t[c+5],o.push("C",a(t[c]),a(t[c+1]),a(t[c+2]),a(t[c+3]),a(r),a(s)),c+=6;break;case i.OPS.curveTo2:o.push("C",a(r),a(s),a(t[c]),a(t[c+1]),a(t[c+2]),a(t[c+3])),r=t[c+2],s=t[c+3],c+=4;break;case i.OPS.curveTo3:r=t[c+2],s=t[c+3],o.push("C",a(t[c]),a(t[c+1]),a(r),a(s),a(r),a(s)),c+=4;break;case i.OPS.closePath:o.push("Z")}o=o.join(" "),n.path&&e.length>0&&e[0]!==i.OPS.rectangle&&e[0]!==i.OPS.moveTo?o=n.path.getAttributeNS(null,"d")+o:(n.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(n.path)),n.path.setAttributeNS(null,"d",o),n.path.setAttributeNS(null,"fill","none"),n.element=n.path,n.setCurrentPoint(r,s)}endPath(){const e=this.current;if(e.path=null,!this.pendingClip)return;if(!e.element)return void(this.pendingClip=null);const t="clippath"+f++,n=this.svgFactory.createElement("svg:clipPath");n.setAttributeNS(null,"id",t),n.setAttributeNS(null,"transform",c(this.transformMatrix));const i=e.element.cloneNode(!0);"evenodd"===this.pendingClip?i.setAttributeNS(null,"clip-rule","evenodd"):i.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,n.appendChild(i),this.defs.appendChild(n),e.activeClipUrl&&(e.clipGroup=null,this.extraStack.forEach((function(e){e.clipGroup=null})),n.setAttributeNS(null,"clip-path",e.activeClipUrl)),e.activeClipUrl=`url(#${t})`,this.tgrp=null}clip(e){this.pendingClip=e}closePath(){const e=this.current;if(e.path){const t=e.path.getAttributeNS(null,"d")+"Z";e.path.setAttributeNS(null,"d",t)}}setLeading(e){this.current.leading=-e}setTextRise(e){this.current.textRise=e}setTextRenderingMode(e){this.current.textRenderingMode=e}setHScale(e){this.current.textHScale=e/100}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,n]of e)switch(t){case"LW":this.setLineWidth(n);break;case"LC":this.setLineCap(n);break;case"LJ":this.setLineJoin(n);break;case"ML":this.setMiterLimit(n);break;case"D":this.setDash(n[0],n[1]);break;case"RI":this.setRenderingIntent(n);break;case"FL":this.setFlatness(n);break;case"Font":this.setFont(n);break;case"CA":this.setStrokeAlpha(n);break;case"ca":this.setFillAlpha(n);break;default:(0,i.warn)("Unimplemented graphic state operator "+t)}}fill(){const e=this.current;e.element&&(e.element.setAttributeNS(null,"fill",e.fillColor),e.element.setAttributeNS(null,"fill-opacity",e.fillAlpha),this.endPath())}stroke(){const e=this.current;e.element&&(this._setStrokeAttributes(e.element),e.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(e,t=1){const n=this.current;let i=n.dashArray;1!==t&&i.length>0&&(i=i.map((function(e){return t*e}))),e.setAttributeNS(null,"stroke",n.strokeColor),e.setAttributeNS(null,"stroke-opacity",n.strokeAlpha),e.setAttributeNS(null,"stroke-miterlimit",a(n.miterLimit)),e.setAttributeNS(null,"stroke-linecap",n.lineCap),e.setAttributeNS(null,"stroke-linejoin",n.lineJoin),e.setAttributeNS(null,"stroke-width",a(t*n.lineWidth)+"px"),e.setAttributeNS(null,"stroke-dasharray",i.map(a).join(" ")),e.setAttributeNS(null,"stroke-dashoffset",a(t*n.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const e=this.svgFactory.createElement("svg:rect");e.setAttributeNS(null,"x","0"),e.setAttributeNS(null,"y","0"),e.setAttributeNS(null,"width","1px"),e.setAttributeNS(null,"height","1px"),e.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(e)}paintImageXObject(e){const t=e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e);t?this.paintInlineImageXObject(t):(0,i.warn)(`Dependent image with object ID ${e} is not ready yet`)}paintInlineImageXObject(e,t){const n=e.width,i=e.height,r=h(e,this.forceDataSchema,!!t),s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width",a(n)),s.setAttributeNS(null,"height",a(i)),this.current.element=s,this.clip("nonzero");const o=this.svgFactory.createElement("svg:image");o.setAttributeNS(l,"xlink:href",r),o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y",a(-i)),o.setAttributeNS(null,"width",a(n)+"px"),o.setAttributeNS(null,"height",a(i)+"px"),o.setAttributeNS(null,"transform",`scale(${a(1/n)} ${a(-1/i)})`),t?t.appendChild(o):this._ensureTransformGroup().appendChild(o)}paintImageMaskXObject(e){const t=this.current,n=e.width,i=e.height,r=t.fillColor;t.maskId="mask"+g++;const s=this.svgFactory.createElement("svg:mask");s.setAttributeNS(null,"id",t.maskId);const o=this.svgFactory.createElement("svg:rect");o.setAttributeNS(null,"x","0"),o.setAttributeNS(null,"y","0"),o.setAttributeNS(null,"width",a(n)),o.setAttributeNS(null,"height",a(i)),o.setAttributeNS(null,"fill",r),o.setAttributeNS(null,"mask",`url(#${t.maskId})`),this.defs.appendChild(s),this._ensureTransformGroup().appendChild(o),this.paintInlineImageXObject(e,s)}paintFormXObjectBegin(e,t){if(Array.isArray(e)&&6===e.length&&this.transform(e[0],e[1],e[2],e[3],e[4],e[5]),t){const e=t[2]-t[0],n=t[3]-t[1],i=this.svgFactory.createElement("svg:rect");i.setAttributeNS(null,"x",t[0]),i.setAttributeNS(null,"y",t[1]),i.setAttributeNS(null,"width",a(e)),i.setAttributeNS(null,"height",a(n)),this.current.element=i,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(e){const t=this.svgFactory.create(e.width,e.height),n=this.svgFactory.createElement("svg:defs");t.appendChild(n),this.defs=n;const i=this.svgFactory.createElement("svg:g");return i.setAttributeNS(null,"transform",c(e.transform)),t.appendChild(i),this.svg=i,t}_ensureClipGroup(){if(!this.current.clipGroup){const e=this.svgFactory.createElement("svg:g");e.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(e),this.current.clipGroup=e}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",c(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var i=n(2),r=n(23);const s=__webpack_require__(191),o=__webpack_require__(294),a=__webpack_require__(295),c=__webpack_require__(296),l=/^file:\/\/\/[a-zA-Z]:\//;t.PDFNodeStream=class{constructor(e){this.source=e,this.url=function(e){const t=c.parse(e);return"file:"===t.protocol||t.host?t:/^[a-z]:[/\\]/i.test(e)?c.parse("file:///"+e):(t.host||(t.protocol="file:"),t)}(e.url),this.isHttp="http:"===this.url.protocol||"https:"===this.url.protocol,this.isFsUrl="file:"===this.url.protocol,this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new g(this):new p(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=this.isFsUrl?new m(this,e,t):new f(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class d{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)(),this._headersCapability=(0,i.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new i.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class u{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,i.createPromiseCapability)();const t=e.source;this._isStreamingSupported=!t.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return null===e?(this._readCapability=(0,i.createPromiseCapability)(),this.read()):(this._loaded+=e.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._readableStream?this._readableStream.destroy(e):this._error(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",e=>{this._error(e)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function h(e,t){return{protocol:e.protocol,auth:e.auth,host:e.hostname,port:e.port,path:e.path,method:"GET",headers:t}}class p extends d{constructor(e){super(e);const t=t=>{if(404===t.statusCode){const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);return this._storedError=e,void this._headersCapability.reject(e)}this._headersCapability.resolve(),this._setReadableStream(t);const n=e=>this._readableStream.headers[e.toLowerCase()],{allowRangeRequests:s,suggestedLength:o}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=o||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(n)};this._request=null,"http:"===this._url.protocol?this._request=o.request(h(this._url,e.httpHeaders),t):this._request=a.request(h(this._url,e.httpHeaders),t),this._request.on("error",e=>{this._storedError=e,this._headersCapability.reject(e)}),this._request.end()}}class f extends u{constructor(e,t,n){super(e),this._httpHeaders={};for(const t in e.httpHeaders){const n=e.httpHeaders[t];void 0!==n&&(this._httpHeaders[t]=n)}this._httpHeaders.Range=`bytes=${t}-${n-1}`;const r=e=>{if(404!==e.statusCode)this._setReadableStream(e);else{const e=new i.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=e}};this._request=null,"http:"===this._url.protocol?this._request=o.request(h(this._url,this._httpHeaders),r):this._request=a.request(h(this._url,this._httpHeaders),r),this._request.on("error",e=>{this._storedError=e}),this._request.end()}}class g extends d{constructor(e){super(e);let t=decodeURIComponent(this._url.path);l.test(this._url.href)&&(t=t.replace(/^\//,"")),s.lstat(t,(e,n)=>{if(e)return"ENOENT"===e.code&&(e=new i.MissingPDFException(`Missing PDF "${t}".`)),this._storedError=e,void this._headersCapability.reject(e);this._contentLength=n.size,this._setReadableStream(s.createReadStream(t)),this._headersCapability.resolve()})}}class m extends u{constructor(e,t,n){super(e);let i=decodeURIComponent(this._url.path);l.test(this._url.href)&&(i=i.replace(/^\//,"")),this._setReadableStream(s.createReadStream(i,{start:t,end:n-1}))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=function(e,t){return 404===e||0===e&&t.startsWith("file:")?new i.MissingPDFException('Missing PDF "'+t+'".'):new i.UnexpectedResponseException("Unexpected server response ("+e+') while retrieving PDF "'+t+'".',e)},t.extractFilenameFromHeader=function(e){const t=e("Content-Disposition");if(t){let e=(0,r.getFilenameFromContentDispositionHeader)(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch(e){}if(/\.pdf$/i.test(e))return e}return null},t.validateRangeRequestCapabilities=function({getResponseHeader:e,isHttp:t,rangeChunkSize:n,disableRange:r}){(0,i.assert)(n>0,"Range chunk size must be larger than zero");const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(e("Content-Length"),10);return Number.isInteger(o)?(s.suggestedLength=o,o<=2*n||r||!t||"bytes"!==e("Accept-Ranges")||"identity"!==(e("Content-Encoding")||"identity")||(s.allowRangeRequests=!0),s):s},t.validateResponseStatus=function(e){return 200===e||206===e};var i=n(2),r=n(24)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=function(e){let t=!0,n=i("filename\\*","i").exec(e);if(n){n=n[1];let e=o(n);return e=unescape(e),e=a(e),e=c(e),s(e)}if(n=function(e){const t=[];let n;const r=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;null!==(n=r.exec(e));){let[,e,i,r]=n;if(e=parseInt(e,10),e in t){if(0===e)break}else t[e]=[i,r]}const s=[];for(let e=0;e<t.length&&e in t;++e){let[n,i]=t[e];i=o(i),n&&(i=unescape(i),0===e&&(i=a(i))),s.push(i)}return s.join("")}(e),n)return s(c(n));if(n=i("filename","i").exec(e),n){n=n[1];let e=o(n);return e=c(e),s(e)}function i(e,t){return new RegExp("(?:^|;)\\s*"+e+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',t)}function r(e,n){if(e){if(!/^[\x00-\xFF]+$/.test(n))return n;try{const i=new TextDecoder(e,{fatal:!0}),r=Array.from(n,(function(e){return 255&e.charCodeAt(0)}));n=i.decode(new Uint8Array(r)),t=!1}catch(i){if(/^utf-?8$/i.test(e))try{n=decodeURIComponent(escape(n)),t=!1}catch(e){}}}return n}function s(e){return t&&/[\x80-\xff]/.test(e)&&(e=r("utf-8",e),t&&(e=r("iso-8859-1",e))),e}function o(e){if(e.startsWith('"')){const t=e.slice(1).split('\\"');for(let e=0;e<t.length;++e){const n=t[e].indexOf('"');-1!==n&&(t[e]=t[e].slice(0,n),t.length=e+1),t[e]=t[e].replace(/\\(.)/g,"$1")}e=t.join('"')}return e}function a(e){const t=e.indexOf("'");return-1===t?e:r(e.slice(0,t),e.slice(t+1).replace(/^[^']*'/,""))}function c(e){return!e.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(e)?e:e.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,(function(e,t,n,i){if("q"===n||"Q"===n)return r(t,i=(i=i.replace(/_/g," ")).replace(/=([0-9a-fA-F]{2})/g,(function(e,t){return String.fromCharCode(parseInt(t,16))})));try{i=atob(i)}catch(e){}return r(t,i)}))}return""}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var i=n(2),r=n(23);class s{constructor(e,t){this.url=e,t=t||{},this.isHttp=/^https?:/i.test(e),this.httpHeaders=this.isHttp&&t.httpHeaders||{},this.withCredentials=t.withCredentials||!1,this.getXhr=t.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(e,t,n){const i={begin:e,end:t};for(const e in n)i[e]=n[e];return this.request(i)}requestFull(e){return this.request(e)}request(e){const t=this.getXhr(),n=this.currXhrId++,i=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const e in this.httpHeaders){const n=this.httpHeaders[e];void 0!==n&&t.setRequestHeader(e,n)}return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),i.expectedStatus=206):i.expectedStatus=200,t.responseType="arraybuffer",e.onError&&(t.onerror=function(n){e.onError(t.status)}),t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),i.onHeadersReceived=e.onHeadersReceived,i.onDone=e.onDone,i.onError=e.onError,i.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress&&n.onProgress(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const r=n.xhr;if(r.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),4!==r.readyState)return;if(!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],0===r.status&&this.isHttp)return void(n.onError&&n.onError(r.status));const s=r.status||200;if((200!==s||206!==n.expectedStatus)&&s!==n.expectedStatus)return void(n.onError&&n.onError(r.status));const o=function(e){const t=e.response;return"string"!=typeof t?t:(0,i.stringToBytes)(t).buffer}(r);if(206===s){const e=r.getResponseHeader("Content-Range"),t=/bytes (\d+)-(\d+)\/(\d+)/.exec(e);n.onDone({begin:parseInt(t[1],10),chunk:o})}else o?n.onDone({begin:0,chunk:o}):n.onError&&n.onError(r.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}t.PDFNetworkStream=class{constructor(e){this._source=e,this._manager=new s(e.url,{httpHeaders:e.httpHeaders,withCredentials:e.withCredentials}),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new o(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new a(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class o{constructor(e,t){this._manager=e;const n={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=t.url,this._fullRequestId=e.requestFull(n),this._headersReceivedCapability=(0,i.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e),n=e=>t.getResponseHeader(e),{allowRangeRequests:i,suggestedLength:s}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:n,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});i&&(this._isRangeSupported=!0),this._contentLength=s||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(n),this._isRangeSupported&&this._manager.abortRequest(e),this._headersReceivedCapability.resolve()}_onDone(e){e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,this._cachedChunks.length>0||(this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[])}_onError(e){const t=this._url,n=(0,r.createResponseStatusError)(e,t);this._storedError=n,this._headersReceivedCapability.reject(n),this._requests.forEach((function(e){e.reject(n)})),this._requests=[],this._cachedChunks=[]}_onProgress(e){this.onProgress&&this.onProgress({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersReceivedCapability.reject(e),this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class a{constructor(e,t,n){this._manager=e;const i={onDone:this._onDone.bind(this),onProgress:this._onProgress.bind(this)};this._requestId=e.requestRange(t,n,i),this._requests=[],this._queuedChunk=null,this._done=!1,this.onProgress=null,this.onClosed=null}_close(){this.onClosed&&this.onClosed(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._close()}_onProgress(e){!this.isStreamingSupported&&this.onProgress&&this.onProgress({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(null!==this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const e=(0,i.createPromiseCapability)();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._requests.forEach((function(e){e.resolve({value:void 0,done:!0})})),this._requests=[],this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var i=n(2),r=n(23);function s(e,t,n){return{method:"GET",headers:e,signal:n&&n.signal,mode:"cors",credentials:t?"include":"same-origin",redirect:"follow"}}function o(e){const t=new Headers;for(const n in e){const i=e[n];void 0!==i&&t.append(n,i)}return t}t.PDFFetchStream=class{constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.httpHeaders=this.isHttp&&e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?this._fullRequestReader._loaded:0}getFullReader(){return(0,i.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new a(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new c(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader&&this._fullRequestReader.cancel(e),this._rangeRequestReaders.slice(0).forEach((function(t){t.cancel(e)}))}};class a{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=(0,i.createPromiseCapability)(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,this._rangeChunkSize||this._disableRange||(this._disableRange=!0),"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._headers=o(this._stream.httpHeaders);const n=t.url;fetch(n,s(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,r.validateResponseStatus)(e.status))throw(0,r.createResponseStatusError)(e.status,n);this._reader=e.body.getReader(),this._headersCapability.resolve();const t=t=>e.headers.get(t),{allowRangeRequests:s,suggestedLength:o}=(0,r.validateRangeRequestCapabilities)({getResponseHeader:t,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=s,this._contentLength=o||this._contentLength,this._filename=(0,r.extractFilenameFromHeader)(t),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new i.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}class c{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const a=e.source;this._withCredentials=a.withCredentials||!1,this._readCapability=(0,i.createPromiseCapability)(),this._isStreamingSupported=!a.disableStream,"undefined"!=typeof AbortController&&(this._abortController=new AbortController),this._headers=o(this._stream.httpHeaders),this._headers.append("Range",`bytes=${t}-${n-1}`);const c=a.url;fetch(c,s(this._headers,this._withCredentials,this._abortController)).then(e=>{if(!(0,r.validateResponseStatus)(e.status))throw(0,r.createResponseStatusError)(e.status,c);this._readCapability.resolve(),this._reader=e.body.getReader()}).catch(e=>{if(!e||"AbortError"!==e.name)throw e}),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){this._reader&&this._reader.cancel(e),this._abortController&&this._abortController.abort()}}}])},module.exports=factory()}).call(this,__webpack_require__(20),__webpack_require__(186).Buffer)},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t){},function(e,t,n){e.exports=function(){return new Worker(n.p+"pdf.worker.js")}},function(e,t,n){(t=n(299)(!1)).push([e.i,".hiddeVideoTile {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n}\n",""]),e.exports=t},function(e,t,n){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var n=function(e,t){var n=e[1]||"",i=e[3];if(!i)return n;if(t&&"function"==typeof btoa){var r=(o=i,a=btoa(unescape(encodeURIComponent(JSON.stringify(o)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(a),"/*# ".concat(c," */")),s=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[n].concat(s).concat([r]).join("\n")}var o,a,c;return[n].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(n,"}"):n})).join("")},t.i=function(e,n,i){"string"==typeof e&&(e=[[null,e,""]]);var r={};if(i)for(var s=0;s<this.length;s++){var o=this[s][0];null!=o&&(r[o]=!0)}for(var a=0;a<e.length;a++){var c=[].concat(e[a]);i&&r[c[0]]||(n&&(c[2]?c[2]="".concat(n," and ").concat(c[2]):c[2]=n),t.push(c))}},t}},function(e,t,n){"use strict";n.r(t);var i={};n.r(i),n.d(i,"CRENDTIALS_TO_MEETING_URL",(function(){return D})),n.d(i,"ID_APP",(function(){return R})),n.d(i,"APP_STATUS_LOGIN",(function(){return F})),n.d(i,"APP_STATUS_CONFIGURE",(function(){return N})),n.d(i,"APP_STATUS_SESSION",(function(){return L})),n.d(i,"APP_STATUS_ENDING",(function(){return j})),n.d(i,"ID_MEETING_AUDIO_ELEMENT",(function(){return V})),n.d(i,"AUDIO_TEST_SOUND_URL",(function(){return B})),n.d(i,"ID_VIDEO_ELEMENT_FOR_PREVIEW",(function(){return U})),n.d(i,"ID_PREFIX_FOR_VIDEO_ELEMENT",(function(){return W})),n.d(i,"ID_ELEMENT_FOR_PREZENTATION_CANVAS",(function(){return H})),n.d(i,"ID_ELEMENT_FOR_PREZENTATION_VIDEO",(function(){return q})),n.d(i,"PREZENTATION_CANVAS_WIDTH",(function(){return $})),n.d(i,"PREZENTATION_CANVAS_HEIGHT",(function(){return G})),n.d(i,"PREZENTATION_CANVAS_FPS",(function(){return K})),n.d(i,"PREZENTATION_CANVAS_PADDING_TOP",(function(){return z})),n.d(i,"PREZENTATION_CANVAS_PADDING_BOTTOM",(function(){return Y})),n.d(i,"PREZENTATION_CANVAS_PADDING_LEFT",(function(){return J})),n.d(i,"PREZENTATION_CANVAS_PADDING_RIGHT",(function(){return X})),n.d(i,"ID_ELEMENT_FOR_PDF_CANVAS",(function(){return Q})),n.d(i,"MESSAGE_SYSTEM_TOPIC_NAME",(function(){return Z})),n.d(i,"MESSAGE_CHAT_TOPIC_NAME",(function(){return ee})),n.d(i,"COMMAND_DELIMITER",(function(){return te})),n.d(i,"SYSTEM_COMMAND_SET_PRESENTER",(function(){return ne})),n.d(i,"SYSTEM_COMMAND_UNSET_PRESENTER",(function(){return ie})),n.d(i,"SYSTEM_COMMAND_SET_FPS",(function(){return re})),n.d(i,"SYSTEM_COMMAND_DETACH_ATTENDEE",(function(){return se})),n.d(i,"SYSTEM_COMMAND_UNSHARE_CONTENT",(function(){return oe})),n.d(i,"SYSTEM_COMMAND_SET_CANVAS_FG",(function(){return ae})),n.d(i,"SYSTEM_COMMAND_SET_CANVAS_BG",(function(){return ce})),n.d(i,"SYSTEM_COMMAND_IS_PDF_SHARING",(function(){return le})),n.d(i,"SYSTEM_COMMAND_SET_PDF_PAGE_INDEX",(function(){return de})),n.d(i,"SYSTEM_COMMAND_IS_VIDEO_SHARING",(function(){return ue})),n.d(i,"SYSTEM_COMMAND_SHARED_VIDEO_PLAY",(function(){return he})),n.d(i,"CHAT_COMMAND_SEND_MESSAGE",(function(){return pe})),n.d(i,"CHAT_COMMAND_IS_PUBLIC_CHAT",(function(){return fe})),n.d(i,"SOCKET_SERVER_URL",(function(){return ge}));var r=n(2),s=n(3);const o={key:0},a={key:1},c={key:2};var l=n(10),d=n(0);const u={class:"row mt-4"},h={class:"col col-md-6 offset-md-3"},p={class:"card"},f={class:"card-header bg-info text-light"},g={class:"card-body"},m={key:0},v={key:1},b={key:0},S={class:"form-group"},y={class:"input-group mb-2"},C=Object(s.i)("div",{class:"input-group-prepend"},[Object(s.i)("div",{class:"input-group-text bg-info text-light"},[Object(s.i)("i",{class:"fa fa-user","aria-hidden":"true"})])],-1),w={class:"form-group"},_={class:"input-group mb-2"},A=Object(s.i)("div",{class:"input-group-prepend"},[Object(s.i)("div",{class:"input-group-text bg-info text-light"},[Object(s.i)("i",{class:"fa fa-lock","aria-hidden":"true"})])],-1),k=Object(s.i)("div",null,[Object(s.i)("button",{type:"submit",class:"btn btn-block btn-success"},"Join")],-1);const T=Object(s.i)("span",{"aria-hidden":"true"},"",-1);var I={props:["alert","alerts"],data:()=>({}),methods:{dismissAlert(e){for(let t=0;t<this.alerts.length;t++)this.alerts[t]===e&&this.alerts.splice(t,1)}},render:function(e,t,n,i,o,a){return Object(s.q)(),Object(s.d)("div",{class:["alert alert-dismissible fade show my-1",n.alert&&n.alert.type?n.alert.type:"alert-info"],role:"alert"},[Object(s.i)("small",null,Object(d.J)(n.alert&&n.alert.text),1),Object(s.i)("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:t[1]||(t[1]=Object(r.d)(e=>a.dismissAlert(n.alert),["prevent"]))},[T])],2)}},O=I;var E=n(192),x=n.n(E),P={props:["url"],emits:["serverResponse"],data:()=>({response:null}),mounted(){x.a.get(this.url,{validateStatus:function(e){return e>=200&&e<500}}).then(e=>{this.response=e}).catch(e=>{console.error(e),this.response={status:500,message:e.message}}).finally(()=>{this.$emit("serverResponse",this.response)})},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("div",null," Loading ... ")}},M=P;const D="https://rooms.kibo.cz/rooms/gateway/",R="cz-kibo-meeting-chime-client",F="login",N="configure",L="session",j="ending",V="cz-kibo-meeting-chime-client-meeting-audio",B="https://www2.cs.uic.edu/~i101/SoundFiles/StarWars3.wav",U="cz-kibo-meeting-chime-client-video-preview",W="cz-kibo-meeting-chime-client-video-tile-",H="cz-kibo-meeting-chime-client-prezentation-canvas",q="cz-kibo-meeting-chime-client-prezentation-video",$=1280,G=720,K=15,z=50,Y=50,J=50,X=50,Q="cz-kibo-meeting-chime-client-pdf-canvas",Z="system",ee="chat",te="#",ne="setPresenter",ie="unsetPresenter",re="setFps",se="detachAttendee",oe="unshareContent",ae="setCanvasFg",ce="setCanvasBg",le="isPdfSharing",de="setPdfPageIdx",ue="isVideoSharing",he="isSharedVideoPlay",pe="sendMessage",fe="isPublicChat",ge="https://rooms.kibo.cz";n(261);var me={components:{AlertMessage:O,HttpClient:M},props:["meeting","title"],emits:["credentials"],data(){return{isWorking:!1,alerts:[],form:{name:null,pin:null,meeting:this.meeting}}},methods:{getCredentials(e){this.form.name?this.form.pin?this.isWorking=!0:this.alerts.push({text:"PIN required.",type:"alert-danger"}):this.alerts.push({text:"Name required.",type:"alert-danger"})},getURL:e=>new URL(`${e.meeting}/${e.pin}/${e.name}`,D).toString(),serverResponse(e){if(this.isWorking=!1,200==e.status){if(!(e.data&&e.data.meeting&&e.data.meeting.MeetingId))throw new Error("There is not MeetingId.");if(!(e.data&&e.data.attendee&&e.data.attendee.AttendeeId))throw new Error("There is not AttendeeId.");this.$emit("credentials",e.data)}else this.alerts.push({text:`Status: ${e.status}. ${e.statusText}`,type:"alert-danger"})}},render:function(e,t,n,i,o,a){const c=Object(s.s)("HttpClient"),l=Object(s.s)("AlertMessage");return Object(s.q)(),Object(s.d)("div",u,[Object(s.i)("div",h,[Object(s.i)("div",p,[Object(s.i)("div",f,"Join the meeting: "+Object(d.J)(n.title),1),Object(s.i)("div",g,[o.isWorking?(Object(s.q)(),Object(s.d)("div",m,[Object(s.i)(c,{url:a.getURL(this.form),onServerResponse:a.serverResponse},null,8,["url","onServerResponse"])])):(Object(s.q)(),Object(s.d)("div",v,[Object(s.i)("form",{onSubmit:t[3]||(t[3]=Object(r.d)((...e)=>a.getCredentials&&a.getCredentials(...e),["prevent"]))},[o.alerts.length?(Object(s.q)(),Object(s.d)("div",b,[(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(o.alerts,(e,t)=>(Object(s.q)(),Object(s.d)(l,{alert:e,alerts:o.alerts},null,8,["alert","alerts"]))),256))])):Object(s.e)("v-if",!0),Object(s.i)("div",S,[Object(s.i)("div",y,[C,Object(s.z)(Object(s.i)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.form.name=e),class:"form-control",name:"name",placeholder:"Your name during the meeting.",maxlength:"100",autocomplete:"off"},null,512),[[r.c,o.form.name,void 0,{trim:!0}]])])]),Object(s.i)("div",w,[Object(s.i)("div",_,[A,Object(s.z)(Object(s.i)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>o.form.pin=e),class:"form-control",name:"pin",placeholder:"PIN to join the meeting.",maxlength:"100",autocomplete:"off"},null,512),[[r.c,o.form.pin,void 0,{trim:!0}]])])]),k],32)]))])])])])}},ve=me;const be={key:0},Se={class:"row mt-4"},ye={class:"col col-md-6 offset-md-3"},Ce={class:"card "},we=Object(s.i)("div",{class:"card-header bg-info text-light"},"Configure devices",-1),_e={class:"card-body"},Ae={class:"card-footer"};const ke={class:"row mt-4"},Te={class:"col"},Ie=Object(s.i)("h3",null,"Audio input",-1),Oe={class:"input-group"},Ee=Object(s.i)("div",{class:"input-group-prepend"},[Object(s.i)("label",{class:"input-group-text bg-info text-light"},[Object(s.i)("i",{class:"fa fa-microphone","aria-hidden":"true"})])],-1),xe=Object(s.i)("option",{value:""},"Please select one",-1),Pe={class:"input-group-append"},Me={class:"row"},De={class:"col mt-2"},Re={key:0};const Fe={class:"progress"};var Ne={props:["analyserNode"],data:()=>({requestID:null,sample:null,volume:0,secondsPassed:0,oldTimeStamp:0,fps:0}),mounted(){this.sample=new Uint8Array(this.analyserNode.fftSize),this.requestID=this.getRequestAnimationFrame()(this.animationLoop.bind(this))},beforeUnmount(){this.requestID&&this.getCancelAnimationFrame()(this.requestID)},methods:{animationLoop(e){this.secondsPassed=(e-this.oldTimeStamp)/1e3,this.oldTimeStamp=e,this.fps=Math.round(1/this.secondsPassed),this.draw(),this.requestID=this.getRequestAnimationFrame()(this.animationLoop.bind(this))},draw(){this.analyserNode.getByteTimeDomainData(this.sample);let e=.01;for(const t of this.sample)e=Math.max(e,(t-128)/128);let t=(Math.log(.01)-Math.log(e))/Math.log(.01);this.volume=Math.min(Math.max(100*t,0),100)},getRequestAnimationFrame:()=>window.requestAnimationFrame,getCancelAnimationFrame:()=>window.cancelAnimationFrame},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("div",Fe,[Object(s.i)("div",{style:{width:r.volume+"%"},class:"progress-bar progress-bar-striped bg-success",role:"progressbar"},null,4)])}},Le={components:{AudioOscilloscope:Ne},props:["audioInputDevices","meetingSession"],emits:["audioInputSelected"],data:()=>({audioInputTestEnabled:!1,analyserNode:null,isOsciloscope:!1}),mounted(){this.$watch("audioInputDevices",(e,t)=>{this.userChangeDevice({target:{value:""}})})},beforeUnmount(){this.stopTestAudioInput()},methods:{startTestAudioInput(){this.audioInputTestEnabled=!1,this.analyserNode=this.meetingSession.audioVideo.createAnalyserNodeForAudioInput(),this.analyserNode&&(this.isOsciloscope=!0)},stopTestAudioInput(){this.analyserNode&&(this.analyserNode.disconnect(),this.analyserNode.removeOriginalInputs(),this.analyserNode=void 0),this.isOsciloscope=!1},userChangeDevice(e){let t=""==e.target.value?null:e.target.value;this.$emit("audioInputSelected",t),this.stopTestAudioInput(),this.audioInputTestEnabled=!!t}},render:function(e,t,n,i,r,o){const a=Object(s.s)("AudioOscilloscope");return Object(s.q)(),Object(s.d)(s.b,null,[Object(s.i)("div",ke,[Object(s.i)("div",Te,[Ie,Object(s.i)("div",Oe,[Ee,Object(s.i)("select",{onChange:t[1]||(t[1]=e=>o.userChangeDevice(e)),class:"form-control"},[xe,(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.audioInputDevices,e=>(Object(s.q)(),Object(s.d)("option",{value:e.deviceId},Object(d.J)(e.label),9,["value"]))),256))],32),Object(s.i)("div",Pe,[Object(s.i)("button",{onClick:t[2]||(t[2]=(...e)=>o.startTestAudioInput&&o.startTestAudioInput(...e)),class:[[r.audioInputTestEnabled?"btn-success":"btn-outline-secondary"],"btn"],type:"button",disabled:!r.audioInputTestEnabled},"Test",10,["disabled"])])])])]),Object(s.i)("div",Me,[Object(s.i)("div",De,[r.isOsciloscope?(Object(s.q)(),Object(s.d)("div",Re,[Object(s.i)(a,{analyserNode:r.analyserNode},null,8,["analyserNode"])])):Object(s.e)("v-if",!0)])])],64)}},je=Le;const Ve={class:"row"},Be={class:"col"},Ue=Object(s.i)("h3",null,"Audio output",-1),We={class:"input-group"},He=Object(s.i)("div",{class:"input-group-prepend"},[Object(s.i)("label",{class:"input-group-text bg-info text-light"},[Object(s.i)("i",{class:"fa fa-volume-off","aria-hidden":"true"})])],-1),qe=Object(s.i)("option",{value:""},"Please select one",-1),$e={class:"input-group-append"};var Ge={props:["audioOutputDevices","meetingAudioElement"],emits:["audioOutputSelected"],data:()=>({audioOutputTestEnabled:!1}),mounted(){this.$watch("audioOutputDevices",(e,t)=>{this.userChangeDevice({target:{value:""}})})},methods:{startTestAudioOutput(){this.audioOutputTestEnabled=!1,this.meetingAudioElement.src=B,this.meetingAudioElement.play;let e=this;setTimeout((function(){e.meetingAudioElement.pause(),e.meetingAudioElement.currentTime=0,e.meetingAudioElement.src="",e.audioOutputTestEnabled=!0}),3e3)},userChangeDevice(e){let t=""==e.target.value?null:e.target.value;this.$emit("audioOutputSelected",t),this.audioOutputTestEnabled=!!t}},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("div",Ve,[Object(s.i)("div",Be,[Ue,Object(s.i)("div",We,[He,Object(s.i)("select",{onChange:t[1]||(t[1]=e=>o.userChangeDevice(e)),class:"form-control"},[qe,(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.audioOutputDevices,e=>(Object(s.q)(),Object(s.d)("option",{value:e.deviceId},Object(d.J)(e.label),9,["value"]))),256))],32),Object(s.i)("div",$e,[Object(s.i)("button",{onClick:t[2]||(t[2]=(...e)=>o.startTestAudioOutput&&o.startTestAudioOutput(...e)),class:[[r.audioOutputTestEnabled?"btn-success":"btn-outline-secondary"],"btn"],type:"button",disabled:!r.audioOutputTestEnabled},"Test",10,["disabled"])])])])])}},Ke=Ge;const ze={class:"row mt-4"},Ye={class:"col"},Je=Object(s.i)("h3",null,"Video input",-1),Xe={class:"input-group"},Qe=Object(s.i)("div",{class:"input-group-prepend"},[Object(s.i)("label",{class:"input-group-text bg-info text-light"},[Object(s.i)("i",{class:"fa fa-video-camera","aria-hidden":"true"})])],-1),Ze=Object(s.i)("option",{value:""},"Please select one",-1),et={class:"input-group-append"},tt={class:"row"},nt={class:"col mt-2"};var it={CAN_SHARE_CONTENT:!0,IS_AUDIO_INPUT_DEVICE:!0,IS_VIDEO_INPUT_DEVICE:!0,SHOW_MODERATOR_PANEL:!0,SHOW_CHAT_PANEL:!0};var rt={CAN_SHARE_CONTENT:!0,IS_AUDIO_INPUT_DEVICE:!0,IS_VIDEO_INPUT_DEVICE:!0,SHOW_CHAT_PANEL:!0};var st={};var ot={SHOW_VIDEO_TILES_CONTAINER:!1,SUPRESS_ATERTS_DURING_MEETING:!0};var at={FULLBAND_SPEECH_MONO_QUALITY:!0,IS_AUDIO_INPUT_DEVICE:!1,IS_VIDEO_INPUT_DEVICE:!1,VIDEO_INPUT_QUALITY_WIDTH:960,VIDEO_INPUT_QUALITY_HEIGHT:540,VIDEO_INPUT_QUALITY_FRAMERATE:15,VIDEO_INPUT_QUALITY_BANDWIDTH:1400,AUDIO_VIDEO_OBSERVER_CALLBACKS_FOR_REMOVE:[],CAN_SHARE_CONTENT:!1,SHOW_VIDEO_TILES_CONTAINER:!0,SHOW_MODERATOR_PANEL:!1,SHOW_CHAT_PANEL:!1,SUPRESS_ATERTS_DURING_MEETING:!1};const ct={};ct.moderator=it,ct.lektor=rt,ct.listener=st,ct.broadcaster=ot,ct.default=at;var lt=ct;var dt={getConstant(e){let t=i[e];if(void 0===t)throw new Error("No value for constant: "+e);return t},getSetting(e,t){if(lt[t]&&void 0!==lt[t][e])return lt[t][e];if(lt.default&&void 0!==lt.default[e])return lt.default[e];throw new Error("No default value for key: "+e)},getVideoElement(e){if(!e)return;let t=this.getConstant("ID_PREFIX_FOR_VIDEO_ELEMENT")+e;return document.querySelector(`#${t} video`)},getAttendeeName(e){if(!e)return"Unknown";let t=e.split("#");return t[1]?t[1]:"Unknown"},encodeUint8array:e=>(new TextDecoder).decode(e),value2Boolean(e){if("boolean"==typeof e)return e;if("string"==typeof e)return"true"===e;throw new Error("Unknown type of value: "+typeof e)}},ut={props:["videoInputDevices","meetingSession"],emits:["videoInputSelected"],data:()=>({utils:dt,videoInputTestEnabled:!1,showVideoPreview:!1}),mounted(){this.$watch("videoInputDevices",(e,t)=>{this.userChangeDevice({target:{value:""}})})},beforeUnmount(){this.stopVideoPreview()},methods:{startVideoPreview(){this.meetingSession.audioVideo.startVideoPreviewForVideoInput(this.getHTMLElementForVideoPreview()),this.videoInputTestEnabled=!1,this.showVideoPreview=!0},stopVideoPreview(){this.meetingSession.audioVideo.stopVideoPreviewForVideoInput(this.getHTMLElementForVideoPreview())},userChangeDevice(e){let t=""==e.target.value?null:e.target.value;this.stopVideoPreview(),this.$emit("videoInputSelected",t),this.videoInputTestEnabled=!!t,this.showVideoPreview=!1},getHTMLElementForVideoPreview:()=>window.document.getElementById(U)},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)(s.b,null,[Object(s.i)("div",ze,[Object(s.i)("div",Ye,[Je,Object(s.i)("div",Xe,[Qe,Object(s.i)("select",{onChange:t[1]||(t[1]=e=>o.userChangeDevice(e)),class:"form-control"},[Ze,(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.videoInputDevices,e=>(Object(s.q)(),Object(s.d)("option",{value:e.deviceId},Object(d.J)(e.label),9,["value"]))),256))],32),Object(s.i)("div",et,[Object(s.i)("button",{onClick:t[2]||(t[2]=(...e)=>o.startVideoPreview&&o.startVideoPreview(...e)),class:[[r.videoInputTestEnabled?"btn-success":"btn-outline-secondary"],"btn"],type:"button",disabled:!r.videoInputTestEnabled},"Test",10,["disabled"])])])])]),Object(s.i)("div",tt,[Object(s.i)("div",nt,[Object(s.i)("div",{class:["embed-responsive embed-responsive-16by9",[r.showVideoPreview?"":"d-none"]]},[Object(s.i)("video",{id:r.utils.getConstant("ID_VIDEO_ELEMENT_FOR_PREVIEW"),class:"w-100 h-100"},null,8,["id"])],2)])])],64)}},ht={components:{AudioInputDevice:je,AudioOutputDevice:Ke,VideoInputDevice:ut},emits:["startSession"],props:["meetingSession","meetingAudioElement"],data(){return{logger:this.$store.state.logger,role:this.$store.getters.role,isDeviceListReady:!1,isBindAudioElement:!1,isAudioInputDevice:!0,isVideoInputDevice:!0,audioInputDevices:null,audioOutputDevices:null,videoInputDevices:null}},async mounted(){this.audioInputDevices=await this.meetingSession.audioVideo.listAudioInputDevices(),this.audioOutputDevices=await this.meetingSession.audioVideo.listAudioOutputDevices(),this.videoInputDevices=await this.meetingSession.audioVideo.listVideoInputDevices(),this.meetingSession.audioVideo.addDeviceChangeObserver(this.getDeviceChangeObserver()),this.applyProfileSetting(),this.isDeviceListReady=!0},beforeUnmount(){this.meetingSession.audioVideo.removeDeviceChangeObserver(this.getDeviceChangeObserver())},methods:{async audioInputSelected(e){this.$store.commit("audioInputId",e);try{await this.meetingSession.audioVideo.chooseAudioInputDevice(e)}catch(e){return void this.logger.error(e)}},async audioOutputSelected(e){this.$store.commit("audioOutputId",e);try{await this.meetingSession.audioVideo.chooseAudioOutputDevice(e),this.meetingSession.audioVideo.bindAudioElement(this.meetingAudioElement),this.isBindAudioElement=!0}catch(e){return void this.logger.error(e)}},async videoInputSelected(e){this.$store.commit("videoInputId",e);try{await this.meetingSession.audioVideo.chooseVideoInputDevice(e)}catch(e){return void this.logger.error(e)}},userWantStartSession(){this.isBindAudioElement||this.audioOutputSelected(null),this.$emit("startSession")},getDeviceChangeObserver(){return{audioInputsChanged:e=>{this.audioInputDevices=e,this.selectedAudioInputDeviceId=""},audioOutputsChanged:e=>{this.audioOutputDevices=e,this.selectedAudioOutputDeviceId=""},videoInputsChanged:e=>{this.videoInputDevices=e,this.selectedVideoInputDeviceId=""}}},async applyProfileSetting(){dt.getSetting("IS_AUDIO_INPUT_DEVICE",this.role)||(this.audioInputSelected(null),this.isAudioInputDevice=!1),dt.getSetting("IS_VIDEO_INPUT_DEVICE",this.role)?await this.meetingSession.audioVideo.chooseVideoInputQuality(dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH",this.role),dt.getSetting("VIDEO_INPUT_QUALITY_HEIGHT",this.role),dt.getSetting("VIDEO_INPUT_QUALITY_FRAMERATE",this.role),dt.getSetting("VIDEO_INPUT_QUALITY_BANDWIDTH",this.role)):(this.videoInputSelected(null),this.isVideoInputDevice=!1),dt.getSetting("FULLBAND_SPEECH_MONO_QUALITY",this.role)&&this.setFulbandSpeech()},setFulbandSpeech(){this.meetingSession.audioVideo.setAudioProfile(l.AudioProfile.fullbandSpeechMono()),this.meetingSession.audioVideo.setContentAudioProfile(l.AudioProfile.fullbandSpeechMono())}},render:function(e,t,n,i,o,a){const c=Object(s.s)("AudioOutputDevice"),l=Object(s.s)("AudioInputDevice"),d=Object(s.s)("VideoInputDevice");return o.isDeviceListReady?(Object(s.q)(),Object(s.d)("div",be,[Object(s.i)("div",Se,[Object(s.i)("div",ye,[Object(s.i)("div",Ce,[we,Object(s.i)("div",_e,[Object(s.i)(c,{audioOutputDevices:o.audioOutputDevices,meetingAudioElement:n.meetingAudioElement,onAudioOutputSelected:a.audioOutputSelected},null,8,["audioOutputDevices","meetingAudioElement","onAudioOutputSelected"]),o.isAudioInputDevice?(Object(s.q)(),Object(s.d)(l,{key:0,audioInputDevices:o.audioInputDevices,meetingSession:n.meetingSession,onAudioInputSelected:a.audioInputSelected},null,8,["audioInputDevices","meetingSession","onAudioInputSelected"])):Object(s.e)("v-if",!0),o.isVideoInputDevice?(Object(s.q)(),Object(s.d)(d,{key:1,videoInputDevices:o.videoInputDevices,meetingSession:n.meetingSession,onVideoInputSelected:a.videoInputSelected},null,8,["videoInputDevices","meetingSession","onVideoInputSelected"])):Object(s.e)("v-if",!0)]),Object(s.i)("div",Ae,[Object(s.i)("button",{class:"btn btn-success btn-block",onClick:t[1]||(t[1]=Object(r.d)(e=>a.userWantStartSession(),["prevent"]))},"Start a session")])])])])])):Object(s.e)("v-if",!0)}},pt=ht;const ft={class:"navbar sticky-top navbar-expand-sm navbar-light bg-info mb-1"},gt={class:"navbar-brand d-none d-sm-block"},mt={class:"navbar-nav mr-auto"},vt={key:0,class:"nav-item"},bt=Object(s.i)("i",{class:"fa fa-microphone","aria-hidden":"true"},null,-1),St=Object(s.h)(" Voice "),yt={key:1,class:"nav-item"},Ct=Object(s.i)("i",{class:"fa fa-video-camera","aria-hidden":"true"},null,-1),wt=Object(s.h)(" Video "),_t={key:2,class:"nav-item"},At=Object(s.i)("i",{class:"fa fa-share-alt","aria-hidden":"true"},null,-1),kt=Object(s.h)(" Share "),Tt={key:3,class:"nav-item"},It=Object(s.i)("i",{class:"fa fa-desktop","aria-hidden":"true"},null,-1),Ot=Object(s.h)(" Moderator "),Et={class:"nav-item"},xt=Object(s.i)("i",{class:"fa fa-sign-out","aria-hidden":"true"},null,-1),Pt=Object(s.h)(" Leave "),Mt={class:"navbar-text"},Dt=Object(s.i)("i",{class:"fa fa-users","aria-hidden":"true"},null,-1),Rt=Object(s.i)("i",{class:"fa fa-arrow-circle-o-up","aria-hidden":"true"},null,-1),Ft=Object(s.i)("i",{class:"fa fa-arrow-circle-o-down","aria-hidden":"true"},null,-1),Nt={class:"row"},Lt={class:"col"},jt={key:0},Vt={class:"row"},Bt={class:"col"},Ut={class:"row"},Wt={class:"col"},Ht={class:"row mb-1"},qt={class:"col text-center"},$t={class:"row"},Gt={class:"col"};const Kt={class:"card mb-1"},zt=Object(s.i)("div",{class:"card-header"}," Moderator panel ",-1),Yt={class:"card-body p-1"},Jt={class:"row"},Xt={class:"col-12 col-sm-12 col-md-6"},Qt={class:"table table-borderless table-sm table-striped m-0"},Zt={key:0},en=Object(s.i)("i",{class:"fa fa-user"},null,-1),tn={class:"text-right"},nn={class:"btn-group btn-group-sm",role:"group"},rn={class:"col-12 col-sm-12 col-md-6"},sn={class:"row"},on={class:"col-12 col-sm-12 col-md-6"},an={class:"form-group"},cn=Object(s.i)("label",null,"Foreground",-1),ln={class:"input-group input-group-sm mb-3"},dn={class:"input-group-prepend"},un={class:"input-group-text bg-info text-light"},hn={class:"input-group-append"},pn={class:"col-12 col-sm-12 col-md-6"},fn={class:"form-group"},gn=Object(s.i)("label",null,"Background",-1),mn={class:"input-group input-group-sm mb-3"},vn={class:"input-group-prepend"},bn={class:"input-group-text bg-info text-light"},Sn={class:"input-group-append"},yn={class:"row"},Cn={class:"col-12 col-sm-12 col-md-6"},wn={class:"form-group"},_n=Object(s.i)("label",null,"PDF",-1),An={class:"input-group input-group-sm mb-3"},kn={class:"input-group-prepend"},Tn={class:"input-group-text bg-info text-light"},In={class:"input-group-append"},On={class:"col-12 col-sm-12 col-md-6"},En={class:"form-group"},xn=Object(s.i)("label",null,"Video",-1),Pn={class:"input-group input-group-sm mb-3"},Mn={class:"input-group-prepend"},Dn={class:"input-group-text bg-info text-light"},Rn={class:"input-group-append"},Fn={class:"row"},Nn={class:"col-12 col-sm-12 col-md-6"},Ln={class:"form-group"},jn=Object(s.i)("label",null,"Fps",-1),Vn={class:"input-group input-group-sm mb-3"},Bn={class:"input-group-prepend"},Un={class:"input-group-text bg-info text-light"},Wn={class:"input-group-append"},Hn={class:"col-12 col-sm-12 col-md-6"},qn={class:"form-group form-check"},$n={class:"form-check-label"},Gn=Object(s.h)(" is public chat "),Kn=Object(s.i)("small",{class:"form-text text-muted"},"Allow people from all over the world send message to this session chat. Dangerous!.",-1);var zn={components:{},emits:["setPresenter","unsetPresenter","systemMessage","fpsChanged","foregroundChanged","backgroundChanged","detachAttendee","unshareContent","isPublicChat"],props:["attendeeManager"],data(){return{utils:dt,logger:this.$store.state.logger,fps:15,foreground:"",background:"",pdf:"",video:"",isPublicChat:!1}},mounted(){this.fps=this.$store.state.moderatorSetting.fps,this.foreground=this.$store.state.moderatorSetting.foreground,this.backgound=this.$store.state.moderatorSetting.background,this.pdf=this.$store.state.moderatorSetting.pdf,this.video=this.$store.state.moderatorSetting.video,this.isPublicChat=this.$store.state.moderatorSetting.isPublicChat},beforeUnmount(){},methods:{presenterChanged(e){this.attendeeManager.isPresenter(e)?(this.$emit("unsetPresenter",e),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_UNSET_PRESENTER")+dt.getConstant("COMMAND_DELIMITER")+e)):(this.$emit("setPresenter",e),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_SET_PRESENTER")+dt.getConstant("COMMAND_DELIMITER")+e))},detachAttendee(e){this.$emit("detachAttendee",e),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_DETACH_ATTENDEE")+dt.getConstant("COMMAND_DELIMITER")+e)},unshare(e){this.$emit("unshareContent",e),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_UNSHARE_CONTENT")+dt.getConstant("COMMAND_DELIMITER")+e)},setFps(){this.$emit("fpsChanged",this.fps),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_SET_FPS")+dt.getConstant("COMMAND_DELIMITER")+this.fps)},setBackground(){this.$emit("backgroundChanged",this.background),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_SET_CANVAS_BG")+dt.getConstant("COMMAND_DELIMITER")+this.background)},setForeground(){this.$emit("foregroundChanged",this.foreground),this.$emit("systemMessage",dt.getConstant("SYSTEM_COMMAND_SET_CANVAS_FG")+dt.getConstant("COMMAND_DELIMITER")+this.foreground)},setPdf(){this.$store.commit("moderatorSetting",{pdf:this.pdf})},setVideo(){this.$store.commit("moderatorSetting",{video:this.video})},togglePublicChat(){this.$emit("isPublicChat",this.isPublicChat),this.$emit("systemMessage",dt.getConstant("CHAT_COMMAND_IS_PUBLIC_CHAT")+dt.getConstant("COMMAND_DELIMITER")+this.isPublicChat)}},render:function(e,t,n,i,o,a){return Object(s.q)(),Object(s.d)("div",Kt,[zt,Object(s.i)("div",Yt,[Object(s.i)("div",Jt,[Object(s.i)("div",Xt,[Object(s.i)("table",Qt,[(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.attendeeManager.attendeePresenceMap.values(),e=>(Object(s.q)(),Object(s.d)("tbody",{key:e.attendeeId},[e.isContent()?Object(s.e)("v-if",!0):(Object(s.q)(),Object(s.d)("tr",Zt,[Object(s.i)("td",null,[en,Object(s.h)(" "+Object(d.J)(o.utils.getAttendeeName(e.externalUserId)),1)]),Object(s.i)("td",null,Object(d.J)(e.attendeeId),1),Object(s.i)("td",tn,[Object(s.i)("div",nn,[Object(s.i)("button",{type:"button",class:["btn btn-sm",n.attendeeManager.isPresenter(e.attendeeId)?"btn-success":"btn-outline-secondary"],onClick:Object(r.d)(t=>a.presenterChanged(e.attendeeId),["prevent"])},"presenter",10,["onClick"]),Object(s.i)("button",{type:"button",class:["btn btn-sm",n.attendeeManager.shareContent(e.attendeeId)?"btn-danger":"btn-outline-secondary"],onClick:Object(r.d)(t=>a.unshare(e.attendeeId),["prevent"])},"stop sharing",10,["onClick"]),Object(s.i)("button",{type:"button",class:"btn btn-sm btn-outline-danger",onClick:Object(r.d)(t=>a.detachAttendee(e.attendeeId),["prevent"])},"detach",8,["onClick"])])])]))]))),128))])]),Object(s.i)("div",rn,[Object(s.i)("div",sn,[Object(s.i)("div",on,[Object(s.i)("div",an,[cn,Object(s.i)("div",ln,[Object(s.i)("div",dn,[Object(s.i)("span",un,Object(d.J)(e.$store.state.moderatorSetting.foreground?e.$store.state.moderatorSetting.foreground:"Empty slot"),1)]),Object(s.z)(Object(s.i)("input",{type:"text",class:"form-control",placeholder:"Image url | empty","onUpdate:modelValue":t[1]||(t[1]=e=>o.foreground=e)},null,512),[[r.c,o.foreground,void 0,{trim:!0}]]),Object(s.i)("div",hn,[Object(s.i)("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:t[2]||(t[2]=Object(r.d)((...e)=>a.setForeground&&a.setForeground(...e),["prevent"]))},"Set")])])])]),Object(s.i)("div",pn,[Object(s.i)("div",fn,[gn,Object(s.i)("div",mn,[Object(s.i)("div",vn,[Object(s.i)("span",bn,Object(d.J)(e.$store.state.moderatorSetting.background?e.$store.state.moderatorSetting.background:"Empty slot"),1)]),Object(s.z)(Object(s.i)("input",{type:"text",class:"form-control",placeholder:"Image url | empty","onUpdate:modelValue":t[3]||(t[3]=e=>o.background=e)},null,512),[[r.c,o.background,void 0,{trim:!0}]]),Object(s.i)("div",Sn,[Object(s.i)("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:t[4]||(t[4]=Object(r.d)((...e)=>a.setBackground&&a.setBackground(...e),["prevent"]))},"Set")])])])])]),Object(s.i)("div",yn,[Object(s.i)("div",Cn,[Object(s.i)("div",wn,[_n,Object(s.i)("div",An,[Object(s.i)("div",kn,[Object(s.i)("span",Tn,Object(d.J)(e.$store.state.moderatorSetting.pdf?e.$store.state.moderatorSetting.pdf:"Empty slot"),1)]),Object(s.z)(Object(s.i)("input",{type:"text",class:"form-control",placeholder:"PDF url | empty","onUpdate:modelValue":t[5]||(t[5]=e=>o.pdf=e)},null,512),[[r.c,o.pdf,void 0,{trim:!0}]]),Object(s.i)("div",In,[Object(s.i)("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:t[6]||(t[6]=Object(r.d)((...e)=>a.setPdf&&a.setPdf(...e),["prevent"]))},"Set")])])])]),Object(s.i)("div",On,[Object(s.i)("div",En,[xn,Object(s.i)("div",Pn,[Object(s.i)("div",Mn,[Object(s.i)("span",Dn,Object(d.J)(e.$store.state.moderatorSetting.video?e.$store.state.moderatorSetting.video:"Empty slot"),1)]),Object(s.z)(Object(s.i)("input",{type:"text",class:"form-control",placeholder:"Video url | empty","onUpdate:modelValue":t[7]||(t[7]=e=>o.video=e)},null,512),[[r.c,o.video,void 0,{trim:!0}]]),Object(s.i)("div",Rn,[Object(s.i)("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:t[8]||(t[8]=Object(r.d)((...e)=>a.setVideo&&a.setVideo(...e),["prevent"]))},"Set")])])])])]),Object(s.i)("div",Fn,[Object(s.i)("div",Nn,[Object(s.i)("div",Ln,[jn,Object(s.i)("div",Vn,[Object(s.i)("div",Bn,[Object(s.i)("span",Un,"Fps: "+Object(d.J)(e.$store.state.moderatorSetting.fps),1)]),Object(s.z)(Object(s.i)("input",{type:"number",step:"1",min:"1",max:"60",class:"form-control",placeholder:"Number: 1 - 60","onUpdate:modelValue":t[9]||(t[9]=e=>o.fps=e)},null,512),[[r.c,o.fps,void 0,{trim:!0}]]),Object(s.i)("div",Wn,[Object(s.i)("button",{class:"btn btn-outline-secondary btn-sm",type:"button",onClick:t[10]||(t[10]=Object(r.d)((...e)=>a.setFps&&a.setFps(...e),["prevent"]))},"Set")])])])]),Object(s.i)("div",Hn,[Object(s.i)("div",qn,[Object(s.i)("label",$n,[Object(s.z)(Object(s.i)("input",{type:"checkbox",class:"form-check-input","onUpdate:modelValue":t[11]||(t[11]=e=>o.isPublicChat=e),onChange:t[12]||(t[12]=e=>a.togglePublicChat())},null,544),[[r.b,o.isPublicChat]]),Gn]),Kn])])])])])])])}},Yn=zn;const Jn={class:"card mb-1 mt-0"},Xn=Object(s.i)("div",{class:"card-header bg-info text-light"}," Chat panel ",-1),Qn={class:"card-body p-1"},Zn={key:0},ei={class:"input-group"},ti={class:"input-group-append"};var ni=n(193),ii={components:{},emits:[],props:["messages","room"],data(){return{utils:dt,logger:this.$store.state.logger,socket:void 0}},mounted(){this.socket=Object(ni.io)(dt.getConstant("SOCKET_SERVER_URL")+"/observer"),this.socket.on("connect",this.onConnect),this.socket.on("message",this.onMessage)},beforeUnmount(){this.socket.close()},methods:{onConnect(){this.socket.emit("room",this.room),console.log("Connecting to room: "+this.room)},onMessage(e){let t=JSON.parse(e),n=`${t.nickname}: ${t.text}`;this.messages.push({text:n,type:"alert-secondary"})}},render:function(e,t,n,i,r,s){return null}},ri={components:{AlertMessage:O,PublicChat:ii},emits:["sendChatMessage","showChatMessage"],props:["attendeeManager","chatMessages"],data(){return{utils:dt,externalUserId:this.$store.getters.externalUserId,logger:this.$store.state.logger,message:""}},mounted(){},beforeUnmount(){},methods:{sendMessage(){if(this.message){let e=dt.getAttendeeName(this.externalUserId)+": "+this.message;this.$emit("showChatMessage",e),this.$emit("sendChatMessage",dt.getConstant("CHAT_COMMAND_SEND_MESSAGE")+dt.getConstant("COMMAND_DELIMITER")+e),this.message=""}}},render:function(e,t,n,i,o,a){const c=Object(s.s)("AlertMessage"),l=Object(s.s)("PublicChat");return Object(s.q)(),Object(s.d)(s.b,null,[Object(s.i)("div",Jn,[Xn,Object(s.i)("div",Qn,[n.chatMessages.length?(Object(s.q)(),Object(s.d)("div",Zn,[(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.chatMessages,(e,t)=>(Object(s.q)(),Object(s.d)(c,{alert:e,alerts:n.chatMessages},null,8,["alert","alerts"]))),256))])):Object(s.e)("v-if",!0),Object(s.i)("div",ei,[Object(s.z)(Object(s.i)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>o.message=e),type:"text",class:"form-control",maxlength:"256"},null,512),[[r.c,o.message,void 0,{trim:!0}]]),Object(s.i)("div",ti,[Object(s.i)("button",{onClick:t[2]||(t[2]=Object(r.d)((...e)=>a.sendMessage&&a.sendMessage(...e),["prevent"])),class:"btn btn-success",type:"button"},"Send")])])])]),this.$store.state.moderatorSetting.isPublicChat?(Object(s.q)(),Object(s.d)(l,{key:0,messages:n.chatMessages,room:e.$store.state.title},null,8,["messages","room"])):Object(s.e)("v-if",!0)],64)}},si=ri;const oi={class:"row"},ai={class:"col"},ci={class:"bg-dark"};const li={class:"card h-100 text-center"},di=Object(s.i)("video",{class:"card-img-top"},null,-1),ui={class:"card-body"},hi={class:"card-text"};var pi={components:{},emits:[],props:["meetingSession","tileState","attendeeManager"],data(){return{utils:dt,logger:this.$store.state.logger,isHidden:!1}},mounted(){this.meetingSession.audioVideo.bindVideoElement(this.tileState.tileId,dt.getVideoElement(this.tileState.tileId)),this.tileState.isContent&&(this.isHidden=!0),this.attendeeManager.isPresenter(this.tileState.boundAttendeeId)&&(this.isHidden=!0),this.logger.warn("Create video element with ID:#"+this.getElementId())},beforeUnmount(){this.meetingSession.audioVideo.unbindVideoElement(this.tileState.tileId),this.logger.warn("Release video element with ID:#"+this.getElementId())},methods:{getElementId(){return dt.getConstant("ID_PREFIX_FOR_VIDEO_ELEMENT")+this.tileState.tileId},getAttendeeName(){let e=dt.getAttendeeName(this.tileState.boundExternalUserId);return this.tileState.isContent&&(e+="#content"),e}},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("div",{class:["col mb-1",{hiddeVideoTile:r.isHidden}],id:o.getElementId()},[Object(s.i)("div",li,[di,Object(s.i)("div",ui,[Object(s.i)("p",hi,Object(d.J)(o.getAttendeeName()),1)])])],10,["id"])}};let fi=null,gi=-1;var mi={components:{VideoTile:pi},emits:[],props:["meetingSession","attendeeManager","alerts","role"],data(){return{utils:dt,logger:this.$store.state.logger,canvas:null,ctx:null,bgCanvas:null,bgCtx:null,fgCanvas:null,fgCtx:null,requestID:null,frames:[],redraw:!1}},mounted(){this.canvas=document.getElementById(dt.getConstant("ID_ELEMENT_FOR_PREZENTATION_CANVAS")),this.bgCanvas=this.getNewOffscreenCanvasPolyfill(),this.fgCanvas=this.getNewOffscreenCanvasPolyfill(),this.ctx=this.canvas.getContext("2d"),this.bgCtx=this.bgCanvas.getContext("2d"),this.fgCtx=this.fgCanvas.getContext("2d"),window.requestAnimationFrame(this.animationLoop)},beforeUnmount(){this.requestID&&window.cancelAnimationFrame(this.requestID)},computed:{delay(){return gi=-1,1e3/this.$store.state.moderatorSetting.fps},background(){return this.$store.state.moderatorSetting.background},foreground(){return this.$store.state.moderatorSetting.foreground},isForeground(){return!!this.$store.state.moderatorSetting.foreground},countOfTiles(){return this.attendeeManager.tileMap.size},presenter(){return this.attendeeManager.getPresenter()},isHideVideoTiles(){return 0==dt.getSetting("SHOW_VIDEO_TILES_CONTAINER",this.role)}},watch:{background(e,t){this.drawImageFromURL(this.bgCtx,this.$store.state.moderatorSetting.background)},foreground(e,t){this.drawImageFromURL(this.fgCtx,this.$store.state.moderatorSetting.foreground)},countOfTiles(e,t){this.drawImageFromURL(this.bgCtx,this.$store.state.moderatorSetting.background)},presenter(e,t){this.drawImageFromURL(this.bgCtx,this.$store.state.moderatorSetting.background)}},methods:{animationLoop(e){null===fi&&(fi=e);let t=Math.floor((e-fi)/this.delay);t>gi&&(gi=t,this.isForeground?this.redraw&&(this.drawImage(this.ctx,this.fgCanvas),this.logger.warn("Draw foreground image")):(this.update(),this.draw()),this.clear()),this.requestID=window.requestAnimationFrame(this.animationLoop)},update(){let e=!1;this.attendeeManager.tileMap.forEach(t=>{t.isContent&&t.boundVideoElement&&(e=!0,this.frames.push({video:t.boundVideoElement,dx:dt.getConstant("PREZENTATION_CANVAS_WIDTH")-(dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH")+dt.getConstant("PREZENTATION_CANVAS_PADDING_RIGHT")),dy:dt.getConstant("PREZENTATION_CANVAS_PADDING_TOP"),dWidth:dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH"),dHeight:dt.getSetting("VIDEO_INPUT_QUALITY_HEIGHT")}))}),this.attendeeManager.tileMap.forEach(t=>{if(this.attendeeManager.isPresenter(t.boundAttendeeId)&&t.boundVideoElement){let n=e?dt.getConstant("PREZENTATION_CANVAS_PADDING_LEFT"):dt.getConstant("PREZENTATION_CANVAS_WIDTH")-(dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH")+dt.getConstant("PREZENTATION_CANVAS_PADDING_RIGHT")),i=e?dt.getConstant("PREZENTATION_CANVAS_HEIGHT")-(dt.getSetting("VIDEO_INPUT_QUALITY_HEIGHT")/4+dt.getConstant("PREZENTATION_CANVAS_PADDING_BOTTOM")):dt.getConstant("PREZENTATION_CANVAS_PADDING_TOP"),r=e?dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH")/4:dt.getSetting("VIDEO_INPUT_QUALITY_WIDTH"),s=e?dt.getSetting("VIDEO_INPUT_QUALITY_HEIGHT")/4:dt.getSetting("VIDEO_INPUT_QUALITY_HEIGHT");this.frames.push({video:t.boundVideoElement,dx:n,dy:i,dWidth:r,dHeight:s})}})},draw(){this.redraw&&(this.drawImage(this.ctx,this.bgCanvas),this.logger.warn("Draw background image")),this.frames.forEach(e=>{this.ctx.fillStyle="white";this.ctx.fillRect(e.dx-5,e.dy-5,e.dWidth+10,e.dHeight+10),this.ctx.drawImage(e.video,e.dx,e.dy,e.dWidth,e.dHeight)})},clear(){this.frames=[],this.redraw=!1},drawImageFromURL(e,t){let n=new Image;n.onload=()=>{this.drawImage(e,n),this.redraw=!0},n.onerror=()=>{e.fillStyle="#343a40",e.fillRect(0,0,this.canvas.width,this.canvas.height),t&&this.alerts.push({text:"Failed to load image: "+t,type:"alert-danger"}),this.redraw=!0},n.src=t},drawImage(e,t){e.drawImage(t,0,0,this.canvas.width,this.canvas.height)},getNewOffscreenCanvasPolyfill(){if(window.OffscreenCanvas)return new OffscreenCanvas(this.canvas.width,this.canvas.height);let e=document.createElement("canvas");return e.width=this.canvas.width,e.height=this.canvas.height,e}},render:function(e,t,n,i,r,o){const a=Object(s.s)("VideoTile");return Object(s.q)(),Object(s.d)(s.b,null,[Object(s.i)("div",{class:["row row-cols-1 row-cols-sm-2 row-cols-md-4 row-cols-lg-6 row-cols-xl-12",{hiddeVideoTile:o.isHideVideoTiles}]},[(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(n.attendeeManager.tileMap.values(),e=>(Object(s.q)(),Object(s.d)(a,{key:e.tileId,tileState:e,meetingSession:n.meetingSession,attendeeManager:n.attendeeManager},null,8,["tileState","meetingSession","attendeeManager"]))),128))],2),Object(s.i)("div",oi,[Object(s.i)("div",ai,[Object(s.i)("div",ci,[Object(s.i)("canvas",{class:"d-block mx-auto my-2 bg-chime",id:r.utils.getConstant("ID_ELEMENT_FOR_PREZENTATION_CANVAS"),width:r.utils.getConstant("PREZENTATION_CANVAS_WIDTH"),height:r.utils.getConstant("PREZENTATION_CANVAS_HEIGHT")},null,8,["id","width","height"])])])])],64)}},vi=mi;var bi={emits:["contentShareDidStart","contentShareDidStop"],props:["meetingSession"],data(){return{logger:this.$store.state.logger}},mounted(){this.meetingSession.audioVideo.addContentShareObserver(this.getContentShareObserver())},beforeUnmount(){this.meetingSession.audioVideo.removeContentShareObserver(this.getContentShareObserver())},methods:{getContentShareObserver(){return{contentShareDidStart:()=>{this.logger.info("Content share session is started"),this.$emit("contentShareDidStart")},contentShareDidStop:()=>{this.logger.info("Content share session is stopped"),this.$emit("contentShareDidStop")}}}},render:function(e,t,n,i,r,s){return null}},Si=bi;class yi{constructor(e){this._attendeeId=e,this._externalUserId,this._roles=[]}get attendeeId(){return this._attendeeId}get externalUserId(){return this._externalUserId}set externalUserId(e){this._externalUserId=e}addRole(e){this._roles.push(e)}hasRole(e){return this._roles.includes(e)}isContent(){let e=this._attendeeId.split("#");return!(!e[1]||"content"!=e[1])}removeRole(e){let t=this._roles.indexOf(e);-1!==t&&this._roles.splice(t,1)}}class Ci{constructor(){this.attendeePresenceMap=new Map,this.tileMap=new Map,this.presenter=""}getPresenter(){return this.presenter}setPresenter(e){this.unsetPresenter(),this.presenter=e;let t=this.getTileState(this.getPresenter());t&&this.addHiddeClass(t)}unsetPresenter(){let e=this.getTileState(this.getPresenter());e&&this.removeHiddeClass(e),this.presenter=""}isPresenter(e){return e&&e==this.presenter}shareContent(e){let t=e+"#content";return!!this.attendeePresenceMap.get(t)}getTileState(e){let t=null;return this.tileMap.forEach(n=>{n.boundAttendeeId==e&&(t=n)}),t}getAttendee(e){let t=this.tileMap.get(e);if(t)return this.attendeePresenceMap.get(t.boundAttendeeId)}addHiddeClass(e){let t=dt.getConstant("ID_PREFIX_FOR_VIDEO_ELEMENT")+e.tileId,n=document.getElementById(t);n&&n.classList.add("hiddeVideoTile")}removeHiddeClass(e){let t=dt.getConstant("ID_PREFIX_FOR_VIDEO_ELEMENT")+e.tileId,n=document.getElementById(t);n&&n.classList.remove("hiddeVideoTile")}}var wi={emits:[],props:["meetingSession","attendeeManager"],data:()=>({}),mounted(){this.meetingSession.audioVideo.realtimeSubscribeToAttendeeIdPresence(this.attendeePresenceChange)},beforeUnmount(){this.meetingSession.audioVideo.realtimeUnsubscribeToAttendeeIdPresence(this.attendeePresenceChange)},methods:{attendeePresenceChange(e,t,n,i,r){if(t){let t=new yi(e);t.externalUserId=n,t.addRole(this.$store.getters.role),this.attendeeManager.attendeePresenceMap.set(e,t)}else this.attendeeManager.attendeePresenceMap.delete(e)}},render:function(e,t,n,i,r,s){return null}},_i=wi;var Ai={emits:["metricsDidReceive","videoTileDidUpdate","videoTileWasRemoved"],props:["meetingSession","alerts"],data(){return{logger:this.$store.state.logger,role:this.$store.getters.role,isVideoAvailable:!0}},mounted(){this.meetingSession.audioVideo.addObserver(this.getAudioVideoObserver())},beforeUnmount(){this.meetingSession.audioVideo.removeObserver(this.getAudioVideoObserver())},methods:{getAudioVideoObserver(){let e={audioVideoDidStart:()=>{this.logger.info("audioVideoObserver: audioVideoDidStart()")},audioVideoDidStartConnecting:e=>{e&&this.logger.warn("audioVideoObserver: audioVideoDidStartConnecting()")},audioVideoDidStop:e=>{const t=e.statusCode();t===l.MeetingSessionStatusCode.Left?this.logger.info("You left the session"):this.logger.info("Stopped with a session status code: ",t)},connectionDidBecomeGood:()=>{this.logger.info("audioVideoObserver: connectionDidBecomeGood()")},connectionDidBecomePoor:()=>{this.logger.warn("audioVideoObserver: connectionDidBecomePoor()"),this.alerts.push({text:"Your connection is poor.",type:"alert-danger"})},connectionDidSuggestStopVideo:()=>{this.logger.warn("audioVideoObserver: connectionDidSuggestStopVideo()"),this.alerts.push({text:"It is recommended to turn off the video.",type:"alert-danger"})},connectionHealthDidChange:e=>{this.logger.info("audioVideoObserver: connectionHealthDidChange()")},encodingSimulcastLayersDidChange:e=>{this.logger.info("audioVideoObserver: encodingSimulcastLayersDidChange()")},estimatedDownlinkBandwidthLessThanRequired:(e,t)=>{this.logger.warn("audioVideoObserver: estimatedDownlinkBandwidthLessThanRequired()")},eventDidReceive:(e,t)=>{this.logger.info("eventDidReceive: "+e)},metricsDidReceive:e=>{const t=e.getObservableMetrics();let n=0,i=0;"number"!=typeof t.availableSendBandwidth||isNaN(t.availableSendBandwidth)?"number"!=typeof t.availableOutgoingBitrate||isNaN(t.availableOutgoingBitrate)||(n=Math.floor(t.availableOutgoingBitrate/1e3)):n=Math.floor(t.availableSendBandwidth/1e3),"number"!=typeof t.availableReceiveBandwidth||isNaN(t.availableReceiveBandwidth)?"number"!=typeof t.availableIncomingBitrate||isNaN(t.availableIncomingBitrate)||(i=Math.floor(t.availableIncomingBitrate/1e3)):i=Math.floor(t.availableReceiveBandwidth/1e3),this.$emit("metricsDidReceive",{up:n,down:i})},remoteVideoSourcesDidChange:e=>{this.logger.info("audioVideoObserver: remoteVideoSourcesDidChange()")},videoAvailabilityDidChange:e=>{e.canStartLocalVideo&&(this.isVideoAvailable=!0)},videoSendDidBecomeUnavailable:()=>{this.isVideoAvailable=!1},videoNotReceivingEnoughData:e=>{this.logger.warn("audioVideoObserver: videoNotReceivingEnoughData()")},videoReceiveBandwidthDidChange:(e,t)=>{this.logger.info(`Receiving bandwidth changed from ${t} to ${e}`)},videoSendBandwidthDidChange:(e,t)=>{this.logger.info(`Sending bandwidth changed from ${t} to ${e}`)},videoSendHealthDidChange:(e,t)=>{this.logger.info(`Sending bitrate in kilobits per second: ${e} and ${t}`)},videoTileDidUpdate:e=>{e.boundAttendeeId&&this.$emit("videoTileDidUpdate",e)},videoTileWasRemoved:e=>{this.$emit("videoTileWasRemoved",e)}};return dt.getSetting("AUDIO_VIDEO_OBSERVER_CALLBACKS_FOR_REMOVE",this.role).forEach((function(t){e[t]&&"function"==typeof e[t]&&(delete e[t],this.logger.info("Callback "+t+" has been remove."))})),e}},render:function(e,t,n,i,r,s){return null}},ki=Ai;var Ti={emits:["setPresenter","unsetPresenter","showChatMessage","setFps","detachAttendee","unshareContent","setCanvasBg","setCanvasFg","setPdfPageIndex","pdfSharingChanged","videoSharingChanged","sharedVideoPlay","isPublicChat"],props:["meetingSession","attendeeManager"],data(){return{logger:this.$store.state.logger,role:this.$store.getters.role}},mounted(){this.meetingSession.audioVideo.realtimeSubscribeToReceiveDataMessage(dt.getConstant("MESSAGE_SYSTEM_TOPIC_NAME"),this.systemMessageReceived),dt.getSetting("SHOW_CHAT_PANEL",this.role)&&this.meetingSession.audioVideo.realtimeSubscribeToReceiveDataMessage(dt.getConstant("MESSAGE_CHAT_TOPIC_NAME"),this.chatMessageReceived)},beforeUnmount(){this.meetingSession.audioVideo.realtimeUnsubscribeFromReceiveDataMessage(dt.getConstant("MESSAGE_SYSTEM_TOPIC_NAME")),this.meetingSession.audioVideo.realtimeUnsubscribeFromReceiveDataMessage(dt.getConstant("MESSAGE_CHAT_TOPIC_NAME"))},methods:{systemMessageReceived(e){this.messageReceived(e)},chatMessageReceived(e){this.messageReceived(e)},messageReceived(e){let t=dt.encodeUint8array(e.data),n=t.split(dt.getConstant("COMMAND_DELIMITER"));2!=n.length&&this.logger.warn("Received data in bad format "+t);let i=n[0],r=n[1];switch(i){case dt.getConstant("SYSTEM_COMMAND_SET_PRESENTER"):this.$emit("setPresenter",r);break;case dt.getConstant("SYSTEM_COMMAND_UNSET_PRESENTER"):this.$emit("unsetPresenter",r);break;case dt.getConstant("CHAT_COMMAND_SEND_MESSAGE"):this.$emit("showChatMessage",r);break;case dt.getConstant("SYSTEM_COMMAND_SET_FPS"):this.$emit("setFps",r);break;case dt.getConstant("SYSTEM_COMMAND_DETACH_ATTENDEE"):this.$emit("detachAttendee",r);break;case dt.getConstant("SYSTEM_COMMAND_UNSHARE_CONTENT"):this.$emit("unshareContent",r);break;case dt.getConstant("SYSTEM_COMMAND_SET_CANVAS_FG"):this.$emit("setCanvasFg",r);break;case dt.getConstant("SYSTEM_COMMAND_SET_CANVAS_BG"):this.$emit("setCanvasBg",r);break;case dt.getConstant("SYSTEM_COMMAND_SET_PDF_PAGE_INDEX"):this.$emit("setPdfPageIndex",r);break;case dt.getConstant("SYSTEM_COMMAND_IS_PDF_SHARING"):this.$emit("pdfSharingChanged",r);break;case dt.getConstant("SYSTEM_COMMAND_IS_VIDEO_SHARING"):this.$emit("videoSharingChanged",r);break;case dt.getConstant("SYSTEM_COMMAND_SHARED_VIDEO_PLAY"):this.$emit("sharedVideoPlay",r);break;case dt.getConstant("CHAT_COMMAND_IS_PUBLIC_CHAT"):this.$emit("isPublicChat",r);break;default:this.logger.warn("Unknown command "+i)}}},render:function(e,t,n,i,r,s){return null}},Ii=Ti;const Oi={key:0,class:"btn-group btn-group-sm mx-auto"};const Ei=n(291),xi=n(297);Ei.GlobalWorkerOptions.workerPort=new xi;var Pi={components:{},props:["src","pageIndex"],data:()=>({utils:dt,pdf:void 0,totalPagesCount:0,currentPageIndex:0,canvas:null,ctx:null}),watch:{pageIndex(e,t){t>e?this.currentPageIndex--:this.currentPageIndex++,this.currentPageIndex>this.totalPagesCount-1&&(this.currentPageIndex=this.totalPagesCount-1),this.currentPageIndex<0&&(this.currentPageIndex=0),this.render()}},mounted(){this.canvas=document.getElementById(dt.getConstant("ID_ELEMENT_FOR_PDF_CANVAS")),this.ctx=this.canvas.getContext("2d"),this.fetchPDF()},beforeUnmount(){this.pdf.destroy()},methods:{fetchPDF(){Ei.getDocument(this.src).promise.then(e=>{this.pdf=e,this.totalPagesCount=e.numPages,this.render()})},render(){this.pdf.getPage(this.currentPageIndex+1).then(e=>{this.drawPage(e)})},drawPage(e){let t=e.getViewport({scale:1}),n=Math.min(this.canvas.height/t.height,this.canvas.width/t.width),i=e.getViewport({scale:n});e.render({canvasContext:this.ctx,viewport:i})}},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("canvas",{class:"d-block hiddeVideoTile",id:r.utils.getConstant("ID_ELEMENT_FOR_PDF_CANVAS"),width:r.utils.getSetting("VIDEO_INPUT_QUALITY_WIDTH"),height:r.utils.getSetting("VIDEO_INPUT_QUALITY_HEIGHT")},null,8,["id","width","height"])}},Mi={components:{PDFDocument:Pi},emits:["sendSystemMessage","pdfPageIndexChanged"],props:["pageIndex","isNavbarVisible"],data:()=>({utils:dt}),computed:{},watch:{},mounted(){},beforeUnmount(){},methods:{PDFPrevPage(){let e=parseInt(this.pageIndex,10)-1;this.$emit("pdfPageIndexChanged",e),this.$emit("sendSystemMessage",dt.getConstant("SYSTEM_COMMAND_SET_PDF_PAGE_INDEX")+dt.getConstant("COMMAND_DELIMITER")+e)},PDFNextPage(){let e=parseInt(this.pageIndex,10)+1;this.$emit("pdfPageIndexChanged",e),this.$emit("sendSystemMessage",dt.getConstant("SYSTEM_COMMAND_SET_PDF_PAGE_INDEX")+dt.getConstant("COMMAND_DELIMITER")+e)}},render:function(e,t,n,i,o,a){const c=Object(s.s)("PDFDocument");return Object(s.q)(),Object(s.d)(s.b,null,[n.isNavbarVisible?(Object(s.q)(),Object(s.d)("div",Oi,[Object(s.i)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=Object(r.d)(e=>a.PDFPrevPage(),["prevent"]))},"Prev"),Object(s.i)("button",{class:"btn btn-success",onClick:t[2]||(t[2]=Object(r.d)(e=>a.PDFNextPage(),["prevent"]))},"Next")])):Object(s.e)("v-if",!0),e.$store.state.moderatorSetting.pdf?(Object(s.q)(),Object(s.d)(c,{key:1,pageIndex:n.pageIndex,src:e.$store.state.moderatorSetting.pdf},null,8,["pageIndex","src"])):Object(s.e)("v-if",!0)],64)}};const Di={key:0,class:"btn-group btn-group-sm mx-auto"};var Ri={components:{},emits:[],props:["src","isVideoPlay"],data(){return{utils:dt,logger:this.$store.state.logger,video:void 0}},computed:{},watch:{isVideoPlay(e){e?this.play():this.pause()}},mounted(){this.video=document.getElementById(dt.getConstant("ID_ELEMENT_FOR_PREZENTATION_VIDEO"))},beforeUnmount(){},methods:{async play(){try{await this.video.play()}catch(e){this.logger.error(e)}},pause(){this.video.pause()}},render:function(e,t,n,i,r,o){return Object(s.q)(),Object(s.d)("video",{class:"d-block hiddeVideoTile",preload:"auto",loop:"true",crossOrigin:"anonymous",playsinline:"true",id:r.utils.getConstant("ID_ELEMENT_FOR_PREZENTATION_VIDEO"),width:r.utils.getSetting("VIDEO_INPUT_QUALITY_WIDTH"),height:r.utils.getSetting("VIDEO_INPUT_QUALITY_HEIGHT"),src:n.src},null,8,["id","width","height","src"])}},Fi={components:{VideoPrezentation:Ri},emits:["sendSystemMessage","sharedVideoPlay"],props:["isNavbarVisible","isVideoPlay"],data:()=>({utils:dt}),computed:{},watch:{},mounted(){},beforeUnmount(){},methods:{toggle(){let e=!this.isVideoPlay;this.$emit("sharedVideoPlay",e),this.$emit("sendSystemMessage",dt.getConstant("SYSTEM_COMMAND_SHARED_VIDEO_PLAY")+dt.getConstant("COMMAND_DELIMITER")+e)}},render:function(e,t,n,i,o,a){const c=Object(s.s)("VideoPrezentation");return Object(s.q)(),Object(s.d)(s.b,null,[n.isNavbarVisible?(Object(s.q)(),Object(s.d)("div",Di,[Object(s.i)("button",{class:"btn btn-success",onClick:t[1]||(t[1]=Object(r.d)(e=>a.toggle(),["prevent"]))},Object(d.J)(n.isVideoPlay?"Stop":"Play"),1)])):Object(s.e)("v-if",!0),e.$store.state.moderatorSetting.video?(Object(s.q)(),Object(s.d)(c,{key:1,isVideoPlay:n.isVideoPlay,src:e.$store.state.moderatorSetting.video},null,8,["isVideoPlay","src"])):Object(s.e)("v-if",!0)],64)}},Ni={components:{VideoTileContainer:vi,AlertMessage:O,ModeratorPanel:Yn,ChatPanel:si,ContentShareObserver:Si,AttendeePresenceObserver:_i,AudioVideoObserver:ki,MessagingObserver:Ii,PDFNavbar:Mi,VideoNavbar:Fi},emits:["configureDevices","endSession"],props:["meetingSession"],data(){return{utils:dt,logger:this.$store.state.logger,role:this.$store.getters.role,localAttendeeId:this.$store.getters.attendeeId,isAudio:this.isLocalAudio(),isVideo:!1,isShare:!1,alerts:[],chatMessages:[],uplink:0,downlink:0,attendeeManager:new Ci,isPdfSharing:!1,pdfPageIndex:0,isVideoSharing:!1,isSharedVideoPlay:!1,isModeratorPanelVisible:!1}},mounted(){this.meetingSession.audioVideo.start(),this.muteLocalAudio(),this.logger.info(this.showVideoInputQualitySettings())},beforeUnmount(){this.leaveMeeting()},computed:{isAlertsAllowed(){return 0==dt.getSetting("SUPRESS_ATERTS_DURING_MEETING",this.role)},isPDFNavbarVisible(){return this.isPdfSharing&&this.attendeeManager.isPresenter(this.localAttendeeId)},isVideoNavbarVisible(){return this.isVideoSharing&&this.attendeeManager.isPresenter(this.localAttendeeId)}},methods:{toggleAudio(){this.logger.info("toggleAudio - handler"),this.isLocalAudio()?(this.muteLocalAudio(),this.isAudio=!1):(this.unmuteLocalAudio(),this.isAudio=!0)},async toggleVideo(){if(this.logger.info("toggleVideo - handler"),this.isVideo=!this.isVideo,this.isVideo)try{await this.meetingSession.audioVideo.chooseVideoInputDevice(this.$store.state.videoInputDeviceId),this.meetingSession.audioVideo.startLocalVideoTile()}catch(e){return void this.logger.error(e)}else this.stopLocalVideo()},stopLocalVideo(){this.meetingSession.audioVideo.stopLocalVideoTile(),this.meetingSession.audioVideo.removeLocalVideoTile(),this.isVideo=!1},async toggleShare(){this.logger.info("toggleShare - handler"),this.isShare=!this.isShare;try{this.isShare?this.startSharing():this.stopSharing()}catch(e){this.logger.warn(e)}},async startSharing(){this.$store.state.moderatorSetting.pdf?this.startSharingPDF():this.$store.state.moderatorSetting.video?this.startSharingVideo():this.startSharingScreen()},async startSharingScreen(){await this.meetingSession.audioVideo.startContentShareFromScreenCapture()},async startSharingPDF(){let e=document.getElementById(dt.getConstant("ID_ELEMENT_FOR_PDF_CANVAS"));e||this.logger.warn("PDF Canvas not found. #ID"+dt.getConstant("ID_ELEMENT_FOR_PDF_CANVAS")),await this.meetingSession.audioVideo.startContentShare(e.captureStream()),this.isPdfSharing=!0,this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_IS_PDF_SHARING")+dt.getConstant("COMMAND_DELIMITER")+!0),this.setPdfPageIndex(-1)},stopSharingPDF(){this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_IS_PDF_SHARING")+dt.getConstant("COMMAND_DELIMITER")+!1),this.isPdfSharing=!1},async startSharingVideo(){this.isSharedVideoPlay=!0,this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_SHARED_VIDEO_PLAY")+dt.getConstant("COMMAND_DELIMITER")+!0);let e,t=document.getElementById(dt.getConstant("ID_ELEMENT_FOR_PREZENTATION_VIDEO"));t||this.logger.warn("Video for prezentation not found. #ID"+dt.getConstant("ID_ELEMENT_FOR_PREZENTATION_VIDEO")),e=t.mozCaptureStream?t.mozCaptureStream():t.captureStream(),await this.meetingSession.audioVideo.startContentShare(e),this.isVideoSharing=!0,this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_IS_VIDEO_SHARING")+dt.getConstant("COMMAND_DELIMITER")+!0)},stopSharingVideo(){this.isSharedVideoPlay=!1,this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_SHARED_VIDEO_PLAY")+dt.getConstant("COMMAND_DELIMITER")+!1),this.isVideoSharing=!1,this.sendSystemMessage(dt.getConstant("SYSTEM_COMMAND_IS_VIDEO_SHARING")+dt.getConstant("COMMAND_DELIMITER")+!1)},async stopSharing(){this.$store.state.moderatorSetting.pdf&&this.stopSharingPDF(),this.$store.state.moderatorSetting.video&&this.stopSharingVideo(),await this.meetingSession.audioVideo.stopContentShare(),this.isShare=!1},leaveMeeting(){this.stopLocalVideo(),this.stopSharing(),this.meetingSession.audioVideo.stop(),this.logger.warn("a user leave the session")},showVideoInputQualitySettings(){let e=this.meetingSession.audioVideo.getVideoInputQualitySettings();return`VideoQuality: width: ${e.videoWidth}, height: ${e.videoHeight}, fps: ${e.videoFrameRate}, bandWidth: ${e.videoMaxBandwidthKbps} Kbps`},muteLocalAudio(){this.meetingSession.audioVideo.realtimeMuteLocalAudio(),this.isAudio=!1,this.logger.info("Local audio muted.")},unmuteLocalAudio(){this.meetingSession.audioVideo.realtimeUnmuteLocalAudio(),this.isAudio=!0,this.logger.info("Local audio unmuted.")},isLocalAudio(){return!this.meetingSession.audioVideo.realtimeIsLocalAudioMuted()},showChatMessage(e){e&&this.chatMessages.push({text:e,type:"alert-info"})},sendChatMessage(e){this.sendMessage(dt.getConstant("MESSAGE_CHAT_TOPIC_NAME"),e,3e5)},sendSystemMessage(e){this.sendMessage(dt.getConstant("MESSAGE_SYSTEM_TOPIC_NAME"),e,3e5)},sendMessage(e,t,n){try{this.meetingSession.audioVideo.realtimeSendDataMessage(e,t,n)}catch(e){this.logger.error(e)}},setPresenter(e){this.attendeeManager.setPresenter(e)},unsetPresenter(e){this.attendeeManager.unsetPresenter()},setFps(e){this.$store.commit("moderatorSetting",{fps:e})},toggleModeratorPanel(){this.isModeratorPanelVisible=!this.isModeratorPanelVisible},detachAttendee(e){e==this.localAttendeeId&&(this.logger.warn("Moderator detach attendee from the session. AtendeeId: "+e),this.$emit("endSession"))},unshareContent(e){e==this.localAttendeeId&&(this.logger.warn("Moderator stoped sharing content for attendee: "+e),this.stopSharing())},setCanvasFg(e){this.$store.commit("moderatorSetting",{foreground:e})},setCanvasBg(e){this.$store.commit("moderatorSetting",{background:e})},setPdfPageIndex(e){this.pdfPageIndex=e},setIsPdfSharing(e){this.isPdfSharing=dt.value2Boolean(e)},setIsVideoSharing(e){this.isVideoSharing=dt.value2Boolean(e)},toggleSharedVideoPlay(e){this.isSharedVideoPlay=dt.value2Boolean(e)},setIsPublicChat(e){this.$store.commit("moderatorSetting",{isPublicChat:dt.value2Boolean(e)})},metricsDidReceive(e){e&&(this.downlink=e.down,this.uplink=e.up)},videoTileDidUpdate(e){this.attendeeManager.tileMap.set(e.tileId,e),this.attendeeManager.isPresenter(e.boundAttendeeId)&&this.attendeeManager.setPresenter(e.boundAttendeeId)},videoTileWasRemoved(e){this.attendeeManager.tileMap.delete(e)}},render:function(e,t,n,i,o,a){const c=Object(s.s)("AlertMessage"),l=Object(s.s)("ModeratorPanel"),u=Object(s.s)("VideoTileContainer"),h=Object(s.s)("PDFNavbar"),p=Object(s.s)("VideoNavbar"),f=Object(s.s)("ChatPanel"),g=Object(s.s)("AudioVideoObserver"),m=Object(s.s)("AttendeePresenceObserver"),v=Object(s.s)("MessagingObserver");return Object(s.q)(),Object(s.d)(s.b,null,[Object(s.i)("nav",ft,[Object(s.i)("span",gt,Object(d.J)(e.$store.state.title),1),Object(s.i)("ul",mt,[o.utils.getSetting("IS_AUDIO_INPUT_DEVICE",o.role)?(Object(s.q)(),Object(s.d)("li",vt,[Object(s.i)("a",{class:["nav-link text-light",o.isAudio?"active":""],href:"#",onClick:t[1]||(t[1]=Object(r.d)((...e)=>a.toggleAudio&&a.toggleAudio(...e),["prevent"]))},[bt,St],2)])):Object(s.e)("v-if",!0),o.utils.getSetting("IS_VIDEO_INPUT_DEVICE",o.role)?(Object(s.q)(),Object(s.d)("li",yt,[Object(s.i)("a",{class:["nav-link text-light",o.isVideo?"active":""],href:"#",onClick:t[2]||(t[2]=Object(r.d)((...e)=>a.toggleVideo&&a.toggleVideo(...e),["prevent"]))},[Ct,wt],2)])):Object(s.e)("v-if",!0),o.utils.getSetting("CAN_SHARE_CONTENT",o.role)?(Object(s.q)(),Object(s.d)("li",_t,[Object(s.i)("a",{class:["nav-link text-light",o.isShare?"active":""],href:"#",onClick:t[3]||(t[3]=Object(r.d)((...e)=>a.toggleShare&&a.toggleShare(...e),["prevent"]))},[At,kt],2)])):Object(s.e)("v-if",!0),o.utils.getSetting("SHOW_MODERATOR_PANEL",o.role)?(Object(s.q)(),Object(s.d)("li",Tt,[Object(s.i)("a",{class:["nav-link text-light",o.isModeratorPanelVisible?"active":""],href:"#",onClick:t[4]||(t[4]=Object(r.d)((...e)=>a.toggleModeratorPanel&&a.toggleModeratorPanel(...e),["prevent"]))},[It,Ot],2)])):Object(s.e)("v-if",!0),Object(s.i)("li",Et,[Object(s.i)("a",{class:"nav-link text-light",href:"#",onClick:t[5]||(t[5]=Object(r.d)(t=>e.$emit("endSession"),["prevent"]))},[xt,Pt])])]),Object(s.i)("span",Mt,[Dt,Object(s.h)(" "+Object(d.J)(this.attendeeManager.attendeePresenceMap.size)+" | ",1),Rt,Object(s.h)(" "+Object(d.J)(o.uplink)+" | ",1),Ft,Object(s.h)(" "+Object(d.J)(o.downlink),1)])]),Object(s.i)("div",Nt,[Object(s.i)("div",Lt,[o.alerts.length&&a.isAlertsAllowed?(Object(s.q)(),Object(s.d)("div",jt,[(Object(s.q)(!0),Object(s.d)(s.b,null,Object(s.r)(o.alerts,(e,t)=>(Object(s.q)(),Object(s.d)(c,{alert:e,alerts:o.alerts},null,8,["alert","alerts"]))),256))])):Object(s.e)("v-if",!0)])]),Object(s.i)("div",Vt,[Object(s.i)("div",Bt,[o.isModeratorPanelVisible?(Object(s.q)(),Object(s.d)(l,{key:0,attendeeManager:o.attendeeManager,onSetPresenter:a.setPresenter,onUnsetPresenter:a.unsetPresenter,onDetachAttendee:a.detachAttendee,onUnshareContent:a.unshareContent,onFpsChanged:a.setFps,onBackgroundChanged:a.setCanvasBg,onForegroundChanged:a.setCanvasFg,onIsPublicChat:a.setIsPublicChat,onSystemMessage:a.sendSystemMessage},null,8,["attendeeManager","onSetPresenter","onUnsetPresenter","onDetachAttendee","onUnshareContent","onFpsChanged","onBackgroundChanged","onForegroundChanged","onIsPublicChat","onSystemMessage"])):Object(s.e)("v-if",!0)])]),Object(s.i)("div",Ut,[Object(s.i)("div",Wt,[Object(s.i)(u,{meetingSession:n.meetingSession,attendeeManager:o.attendeeManager,alerts:o.alerts,role:o.role},null,8,["meetingSession","attendeeManager","alerts","role"])])]),Object(s.i)("div",Ht,[Object(s.i)("div",qt,[Object(s.i)(h,{isNavbarVisible:a.isPDFNavbarVisible,pageIndex:o.pdfPageIndex,onSendSystemMessage:a.sendSystemMessage,onPdfPageIndexChanged:a.setPdfPageIndex},null,8,["isNavbarVisible","pageIndex","onSendSystemMessage","onPdfPageIndexChanged"]),Object(s.i)(p,{isNavbarVisible:a.isVideoNavbarVisible,isVideoPlay:o.isSharedVideoPlay,onSendSystemMessage:a.sendSystemMessage,onSharedVideoPlay:a.toggleSharedVideoPlay},null,8,["isNavbarVisible","isVideoPlay","onSendSystemMessage","onSharedVideoPlay"])])]),Object(s.i)("div",$t,[Object(s.i)("div",Gt,[o.utils.getSetting("SHOW_CHAT_PANEL",o.role)?(Object(s.q)(),Object(s.d)(f,{key:0,attendeeManager:o.attendeeManager,chatMessages:o.chatMessages,onSendChatMessage:a.sendChatMessage,onShowChatMessage:a.showChatMessage},null,8,["attendeeManager","chatMessages","onSendChatMessage","onShowChatMessage"])):Object(s.e)("v-if",!0)])]),Object(s.i)(g,{meetingSession:n.meetingSession,alerts:o.alerts,onMetricsDidReceive:a.metricsDidReceive,onVideoTileDidUpdate:a.videoTileDidUpdate,onVideoTileWasRemoved:a.videoTileWasRemoved},null,8,["meetingSession","alerts","onMetricsDidReceive","onVideoTileDidUpdate","onVideoTileWasRemoved"]),Object(s.i)(m,{meetingSession:n.meetingSession,attendeeManager:o.attendeeManager},null,8,["meetingSession","attendeeManager"]),Object(s.i)(v,{meetingSession:n.meetingSession,attendeeManager:o.attendeeManager,onSetPresenter:a.setPresenter,onUnsetPresenter:a.unsetPresenter,onSetFps:a.setFps,onDetachAttendee:a.detachAttendee,onUnshareContent:a.unshareContent,onSetCanvasFg:a.setCanvasFg,onSetCanvasBg:a.setCanvasBg,onPdfSharingChanged:a.setIsPdfSharing,onSetPdfPageIndex:a.setPdfPageIndex,onVideoSharingChanged:a.setIsVideoSharing,onSharedVideoPlay:a.toggleSharedVideoPlay,onShowChatMessage:a.showChatMessage,onIsPublicChat:a.setIsPublicChat},null,8,["meetingSession","attendeeManager","onSetPresenter","onUnsetPresenter","onSetFps","onDetachAttendee","onUnshareContent","onSetCanvasFg","onSetCanvasBg","onPdfSharingChanged","onSetPdfPageIndex","onVideoSharingChanged","onSharedVideoPlay","onShowChatMessage","onIsPublicChat"])],64)}},Li={components:{LoginForm:ve,DeviceConfigurator:pt,Session:Ni},props:["meeting","title"],data(){return{utils:dt,status:dt.getConstant("APP_STATUS_LOGIN"),meetingSession:null,logger:this.$store.state.logger}},mounted(){this.title?this.$store.commit("title",this.title):this.$store.commit("title","AWS Chime")},methods:{createMeetingSession(e){this.$store.commit("credentials",e);const t=new l.DefaultDeviceController(this.logger,{enableWebAudio:!0}),n=new l.MeetingSessionConfiguration(e.meeting,e.attendee);this.meetingSession=new l.DefaultMeetingSession(n,this.logger,t),this.status=dt.getConstant("APP_STATUS_CONFIGURE")},login(){this.status=dt.getConstant("APP_STATUS_LOGIN")},configureDevices(){this.status=dt.getConstant("APP_STATUS_CONFIGURE")},startSession(){this.status=dt.getConstant("APP_STATUS_SESSION")},getMeetingAudioElement:()=>window.document.getElementById(dt.getConstant("ID_MEETING_AUDIO_ELEMENT"))}},ji=n(194);(Li.__cssModules={}).$style=ji.default,Li.render=function(e,t,n,i,r,l){const d=Object(s.s)("LoginForm"),u=Object(s.s)("DeviceConfigurator"),h=Object(s.s)("Session");return Object(s.q)(),Object(s.d)(s.b,null,[r.status===r.utils.getConstant("APP_STATUS_LOGIN")?(Object(s.q)(),Object(s.d)("div",o,[Object(s.i)(d,{meeting:n.meeting,title:n.title,onCredentials:l.createMeetingSession},null,8,["meeting","title","onCredentials"])])):Object(s.e)("v-if",!0),r.status===r.utils.getConstant("APP_STATUS_CONFIGURE")?(Object(s.q)(),Object(s.d)("div",a,[Object(s.i)(u,{meetingSession:r.meetingSession,meetingAudioElement:l.getMeetingAudioElement(),onStartSession:t[1]||(t[1]=e=>l.startSession())},null,8,["meetingSession","meetingAudioElement"])])):Object(s.e)("v-if",!0),r.status===r.utils.getConstant("APP_STATUS_SESSION")?(Object(s.q)(),Object(s.d)("div",c,[Object(s.i)(h,{meetingSession:r.meetingSession,onConfigureDevices:t[2]||(t[2]=e=>l.configureDevices()),onEndSession:l.login},null,8,["meetingSession","onEndSession"])])):Object(s.e)("v-if",!0),Object(s.i)("audio",{style:{display:"none"},id:r.utils.getConstant("ID_MEETING_AUDIO_ELEMENT")},null,8,["id"])],64)};var Vi=Li,Bi=n(195);const Ui=new l.ConsoleLogger("MeetingLogs",l.LogLevel.WARN);var Wi=Object(Bi.a)({state:()=>({logger:Ui,title:null,videoInputDeviceId:null,audioInputDeviceId:null,audioOutputDeviceId:null,credentials:{},moderatorSetting:{fps:dt.getConstant("PREZENTATION_CANVAS_FPS"),background:"",foreground:"",pdf:"",video:"",isPublicChat:!1}}),mutations:{title(e,t){e.title=t},credentials(e,t){e.credentials=t},videoInputId(e,t){e.videoInputDeviceId=t},audioInputId(e,t){e.audioInputDeviceId=t},audioOutputId(e,t){e.audioOutputDeviceId=t},moderatorSetting(e,t){if(t.fps){let n=1,i=60;e.moderatorSetting.fps=Math.min(Math.max(parseInt(t.fps),n),i)}"string"==typeof t.background&&(e.moderatorSetting.background=t.background),"string"==typeof t.foreground&&(e.moderatorSetting.foreground=t.foreground),"string"==typeof t.pdf&&(e.moderatorSetting.pdf=t.pdf),"string"==typeof t.video&&(e.moderatorSetting.video=t.video),"boolean"==typeof t.isPublicChat&&(e.moderatorSetting.isPublicChat=t.isPublicChat)}},getters:{role:e=>e.credentials.role,attendeeId(e){if(e.credentials.attendee)return e.credentials.attendee.AttendeeId},externalUserId(e){if(e.credentials.attendee)return e.credentials.attendee.ExternalUserId}}});const Hi=document.querySelector("#"+R).dataset.meeting,qi=document.querySelector("#"+R).dataset.title,$i=Object(r.a)(Vi,{meeting:Hi,title:qi});$i.use(Wi),$i.mount("#"+R)},function(e,t,n){"use strict";function i(e,t){for(var n=[],i={},r=0;r<t.length;r++){var s=t[r],o=s[0],a={id:e+":"+r,css:s[1],media:s[2],sourceMap:s[3]};i[o]?i[o].parts.push(a):n.push(i[o]={id:o,parts:[a]})}return n}n.r(t),n.d(t,"default",(function(){return p}));var r="undefined"!=typeof document;if("undefined"!=typeof DEBUG&&DEBUG&&!r)throw new Error("vue-style-loader cannot be used in a non-browser environment. Use { target: 'node' } in your Webpack config to indicate a server-rendering environment.");var s={},o=r&&(document.head||document.getElementsByTagName("head")[0]),a=null,c=0,l=!1,d=function(){},u=null,h="undefined"!=typeof navigator&&/msie [6-9]\b/.test(navigator.userAgent.toLowerCase());function p(e,t,n,r){l=n,u=r||{};var o=i(e,t);return f(o),function(t){for(var n=[],r=0;r<o.length;r++){var a=o[r];(c=s[a.id]).refs--,n.push(c)}t?f(o=i(e,t)):o=[];for(r=0;r<n.length;r++){var c;if(0===(c=n[r]).refs){for(var l=0;l<c.parts.length;l++)c.parts[l]();delete s[c.id]}}}}function f(e){for(var t=0;t<e.length;t++){var n=e[t],i=s[n.id];if(i){i.refs++;for(var r=0;r<i.parts.length;r++)i.parts[r](n.parts[r]);for(;r<n.parts.length;r++)i.parts.push(m(n.parts[r]));i.parts.length>n.parts.length&&(i.parts.length=n.parts.length)}else{var o=[];for(r=0;r<n.parts.length;r++)o.push(m(n.parts[r]));s[n.id]={id:n.id,refs:1,parts:o}}}}function g(){var e=document.createElement("style");return e.type="text/css",o.appendChild(e),e}function m(e){var t,n,i=document.querySelector('style[data-vue-ssr-id~="'+e.id+'"]');if(i){if(l)return d;i.parentNode.removeChild(i)}if(h){var r=c++;i=a||(a=g()),t=S.bind(null,i,r,!1),n=S.bind(null,i,r,!0)}else i=g(),t=y.bind(null,i),n=function(){i.parentNode.removeChild(i)};return t(e),function(i){if(i){if(i.css===e.css&&i.media===e.media&&i.sourceMap===e.sourceMap)return;t(e=i)}else n()}}var v,b=(v=[],function(e,t){return v[e]=t,v.filter(Boolean).join("\n")});function S(e,t,n,i){var r=n?"":i.css;if(e.styleSheet)e.styleSheet.cssText=b(t,r);else{var s=document.createTextNode(r),o=e.childNodes;o[t]&&e.removeChild(o[t]),o.length?e.insertBefore(s,o[t]):e.appendChild(s)}}function y(e,t){var n=t.css,i=t.media,r=t.sourceMap;if(i&&e.setAttribute("media",i),u.ssrId&&e.setAttribute("data-vue-ssr-id",t.id),r&&(n+="\n/*# sourceURL="+r.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */"),e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}}]);
//# sourceMappingURL=client-chime.js.map